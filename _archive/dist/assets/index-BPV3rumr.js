const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/services-CdXttHtG.js","assets/supabase-CIvuJI4W.js","assets/index-dz34yHOi.js","assets/contexts-fbpOeTmm.js","assets/react-vendor-CFDIsUAY.js","assets/Sidebar-Q0ML3SY6.js","assets/grading-CH75oUbS.js","assets/useRoleSession-CjNGQy2C.js","assets/AppImage-yaNzDrl6.js","assets/ui-vendor-BrXTGbgA.js","assets/index-CTblOtNM.js","assets/index-C4tejHYV.js","assets/purify.es-B9ZVCkUG.js","assets/documentService-BNZuJcP9.js","assets/pdf-vendor-wz8qypYI.js","assets/index-D1TgZptc.js","assets/useDashboardData-CL9BpvNP.js","assets/productionDataService-T6uUAzM-.js","assets/charts-vendor-i33Lw0zL.js","assets/index-DSOPo4fZ.js","assets/Helmet-B3bMicap.js","assets/emailService-yXWWlP6-.js","assets/index-DrcxLO50.js","assets/index-Dki_v6h7.js","assets/index-DCtv8idZ.js","assets/index-BOZ54uBi.js","assets/index-CDNnGPcc.js","assets/index-q5ZKIjRH.js","assets/index-SISvVwj9.js","assets/index-k3-lMI8a.js","assets/index-BfWXvnGa.js","assets/index-Cwvoy5uW.js","assets/index-CP1bFe0S.js","assets/index-C1h2SCqI.js","assets/HelpCenter-B7D_4yZ3.js","assets/index-eBSYjkoc.js","assets/index-C8qAZeOG.js","assets/index-DGOL2uwh.js"])))=>i.map(i=>d[i]);
import{j as e,u as ce,A as de}from"./contexts-fbpOeTmm.js";import{b as ue,u as oe,r as i,R as H,d as me,e as Z,L as Q,B as he,f as xe,h as _}from"./react-vendor-CFDIsUAY.js";import{s as q,_ as S}from"./services-CdXttHtG.js";import{C as be,L as ge,t as pe,c as fe,a as ve,X as ye,b as je,S as Ne,d as we}from"./ui-vendor-BrXTGbgA.js";import"./supabase-CIvuJI4W.js";(function(){const l=document.createElement("link").relList;if(l&&l.supports&&l.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))c(a);new MutationObserver(a=>{for(const n of a)if(n.type==="childList")for(const x of n.addedNodes)x.tagName==="LINK"&&x.rel==="modulepreload"&&c(x)}).observe(document,{childList:!0,subtree:!0});function t(a){const n={};return a.integrity&&(n.integrity=a.integrity),a.referrerPolicy&&(n.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?n.credentials="include":a.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function c(a){if(a.ep)return;a.ep=!0;const n=t(a);fetch(a.href,n)}})();var X={},re;function _e(){if(re)return X;re=1;var r=ue();return X.createRoot=r.createRoot,X.hydrateRoot=r.hydrateRoot,X}var Ce=_e();const Se=()=>{const{pathname:r}=oe();return i.useEffect(()=>{window.scrollTo(0,0)},[r]),null};function E({name:r,size:l=24,color:t="currentColor",className:c="",strokeWidth:a=2,...n}){var d;const x=(d=ge)==null?void 0:d[r];return x?e.jsx(x,{size:l,color:t,strokeWidth:a,className:c,...n}):e.jsx(be,{size:l,color:"gray",strokeWidth:a,className:c,...n})}class Ee extends H.Component{constructor(l){super(l),this.state={hasError:!1}}static getDerivedStateFromError(l){return{hasError:!0}}componentDidCatch(l,t){var c;l.__ErrorBoundary=!0,(c=window.__COMPONENT_ERROR__)==null||c.call(window,l,t)}render(){var l,t;return(l=this.state)!=null&&l.hasError?e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-neutral-50",children:e.jsxs("div",{className:"text-center p-8 max-w-md",children:[e.jsx("div",{className:"flex justify-center items-center mb-2",children:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"42px",height:"42px",viewBox:"0 0 32 33",fill:"none",children:[e.jsx("path",{d:"M16 28.5C22.6274 28.5 28 23.1274 28 16.5C28 9.87258 22.6274 4.5 16 4.5C9.37258 4.5 4 9.87258 4 16.5C4 23.1274 9.37258 28.5 16 28.5Z",stroke:"#343330",strokeWidth:"2",strokeMiterlimit:"10"}),e.jsx("path",{d:"M11.5 15.5C12.3284 15.5 13 14.8284 13 14C13 13.1716 12.3284 12.5 11.5 12.5C10.6716 12.5 10 13.1716 10 14C10 14.8284 10.6716 15.5 11.5 15.5Z",fill:"#343330"}),e.jsx("path",{d:"M20.5 15.5C21.3284 15.5 22 14.8284 22 14C22 13.1716 21.3284 12.5 20.5 12.5C19.6716 12.5 19 13.1716 19 14C19 14.8284 19.6716 15.5 20.5 15.5Z",fill:"#343330"}),e.jsx("path",{d:"M21 22.5C19.9625 20.7062 18.2213 19.5 16 19.5C13.7787 19.5 12.0375 20.7062 11 22.5",stroke:"#343330",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]})}),e.jsxs("div",{className:"flex flex-col gap-1 text-center",children:[e.jsx("h1",{className:"text-2xl font-medium text-neutral-800",children:"Something went wrong"}),e.jsx("p",{className:"text-neutral-600 text-base w w-8/12 mx-auto",children:"We encountered an unexpected error while processing your request."})]}),e.jsx("div",{className:"flex justify-center items-center mt-6",children:e.jsxs("button",{onClick:()=>{window.location.href="/"},className:"bg-blue-500 hover:bg-blue-600 text-white font-medium py-2 px-4 rounded flex items-center gap-2 transition-colors duration-200 shadow-sm",children:[e.jsx(E,{name:"ArrowLeft",size:18,color:"#fff"}),"Back"]})})]})}):(t=this.props)==null?void 0:t.children}}const Ae=({message:r="Chargement..."})=>e.jsx("div",{className:"flex items-center justify-center min-h-screen bg-gray-50",children:e.jsxs("div",{className:"text-center px-4",children:[e.jsx("div",{className:"w-16 h-16 border-4 border-blue-600 border-t-transparent rounded-full animate-spin mx-auto mb-4"}),e.jsx("p",{className:"text-gray-700 font-medium text-base sm:text-lg",children:r}),e.jsx("p",{className:"text-gray-500 text-sm mt-2",children:"Veuillez patienter un instant..."})]})});function le(r,l){if(typeof r=="function")return r(l);r!=null&&(r.current=l)}function ke(...r){return l=>{let t=!1;const c=r.map(a=>{const n=le(a,l);return!t&&typeof n=="function"&&(t=!0),n});if(t)return()=>{for(let a=0;a<c.length;a++){const n=c[a];typeof n=="function"?n():le(r[a],null)}}}}var Te=Symbol.for("react.lazy"),ee=me[" use ".trim().toString()];function Le(r){return typeof r=="object"&&r!==null&&"then"in r}function ne(r){return r!=null&&typeof r=="object"&&"$$typeof"in r&&r.$$typeof===Te&&"_payload"in r&&Le(r._payload)}function Pe(r){const l=ze(r),t=i.forwardRef((c,a)=>{let{children:n,...x}=c;ne(n)&&typeof ee=="function"&&(n=ee(n._payload));const d=i.Children.toArray(n),g=d.find(Be);if(g){const s=g.props.children,m=d.map(y=>y===g?i.Children.count(s)>1?i.Children.only(null):i.isValidElement(s)?s.props.children:null:y);return e.jsx(l,{...x,ref:a,children:i.isValidElement(s)?i.cloneElement(s,void 0,m):null})}return e.jsx(l,{...x,ref:a,children:n})});return t.displayName=`${r}.Slot`,t}var De=Pe("Slot");function ze(r){const l=i.forwardRef((t,c)=>{let{children:a,...n}=t;if(ne(a)&&typeof ee=="function"&&(a=ee(a._payload)),i.isValidElement(a)){const x=Ie(a),d=Me(n,a.props);return a.type!==i.Fragment&&(d.ref=c?ke(c,x):x),i.cloneElement(a,d)}return i.Children.count(a)>1?i.Children.only(null):null});return l.displayName=`${r}.SlotClone`,l}var Re=Symbol("radix.slottable");function Be(r){return i.isValidElement(r)&&typeof r.type=="function"&&"__radixId"in r.type&&r.type.__radixId===Re}function Me(r,l){const t={...l};for(const c in l){const a=r[c],n=l[c];/^on[A-Z]/.test(c)?a&&n?t[c]=(...d)=>{const g=n(...d);return a(...d),g}:a&&(t[c]=a):c==="style"?t[c]={...a,...n}:c==="className"&&(t[c]=[a,n].filter(Boolean).join(" "))}return{...r,...t}}function Ie(r){var c,a;let l=(c=Object.getOwnPropertyDescriptor(r.props,"ref"))==null?void 0:c.get,t=l&&"isReactWarning"in l&&l.isReactWarning;return t?r.ref:(l=(a=Object.getOwnPropertyDescriptor(r,"ref"))==null?void 0:a.get,t=l&&"isReactWarning"in l&&l.isReactWarning,t?r.props.ref:r.props.ref||r.ref)}function V(...r){return pe(fe(r))}const Ve=ve("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline",success:"bg-success text-success-foreground hover:bg-success/90",warning:"bg-warning text-warning-foreground hover:bg-warning/90",danger:"bg-error text-error-foreground hover:bg-error/90"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10",xs:"h-8 rounded-md px-2 text-xs",xl:"h-12 rounded-md px-10 text-base"}},defaultVariants:{variant:"default",size:"default"}}),G=H.forwardRef(({className:r,variant:l,size:t,asChild:c=!1,children:a,loading:n=!1,iconName:x=null,iconPosition:d="left",iconSize:g=null,fullWidth:s=!1,disabled:m=!1,...y},j)=>{const L=c?De:"button",w={xs:12,sm:14,default:16,lg:18,xl:20,icon:16},C=g||(w==null?void 0:w[t])||16,p=()=>{if(!x||n)return null;try{return e.jsx(E,{name:x,size:C,className:V(a&&d==="left"&&"mr-2",a&&d==="right"&&"ml-2")})}catch{return null}},N=n?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"inline-block animate-spin h-4 w-4 mr-2 border-2 border-current border-t-transparent rounded-full"}),typeof a=="string"?a:"Chargement..."]}):e.jsxs(e.Fragment,{children:[x&&d==="left"&&p(),a,x&&d==="right"&&p()]});return e.jsx(L,{className:V(Ve({variant:l,size:t,className:r}),s&&"w-full"),ref:j,disabled:m||n,...y,children:N})});G.displayName="Button";const qe=()=>{const r=Z(),l=()=>{r("/")};return e.jsx("div",{className:"min-h-screen flex flex-col items-center justify-center bg-background p-4",children:e.jsxs("div",{className:"text-center max-w-md",children:[e.jsx("div",{className:"flex justify-center mb-6",children:e.jsx("div",{className:"relative",children:e.jsx("h1",{className:"text-9xl font-bold text-primary opacity-20",children:"404"})})}),e.jsx("h2",{className:"text-2xl font-medium text-onBackground mb-2",children:"Page Not Found"}),e.jsx("p",{className:"text-onBackground/70 mb-8",children:"The page you're looking for doesn't exist. Let's get you back!"}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center",children:[e.jsx(G,{variant:"primary",icon:e.jsx(E,{name:"ArrowLeft"}),iconPosition:"left",onClick:()=>{var t;return(t=window.history)==null?void 0:t.back()},children:"Go Back"}),e.jsx(G,{variant:"outline",icon:e.jsx(E,{name:"Home"}),iconPosition:"left",onClick:l,children:"Back to Home"})]})]})})},U=H.forwardRef(({className:r="",type:l="text",label:t,error:c,required:a=!1,id:n,...x},d)=>{var s,m;const g=n||`input-${(m=(s=Math.random())==null?void 0:s.toString(36))==null?void 0:m.substr(2,9)}`;return e.jsxs("div",{className:"space-y-2",children:[t&&e.jsxs("label",{htmlFor:g,className:V("text-sm font-medium leading-none",c?"text-red-600":"text-gray-900"),children:[t,a&&e.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),e.jsx("input",{type:l,className:V("flex h-10 w-full rounded-md border border-gray-300 bg-white px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 disabled:cursor-not-allowed disabled:opacity-50",c&&"border-red-500 focus:ring-red-500 focus:border-red-500",r),ref:d,id:g,...x}),c&&e.jsx("p",{className:"text-sm text-red-600",children:c})]})});U.displayName="SimpleInput";const J=H.forwardRef(({className:r="",options:l=[],value:t,placeholder:c="Select an option",disabled:a=!1,required:n=!1,label:x,error:d,onChange:g,...s},m)=>{const y=j=>{g==null||g(j.target.value)};return e.jsxs("div",{className:"space-y-2",children:[x&&e.jsxs("label",{className:V("text-sm font-medium leading-none",d?"text-red-600":"text-gray-900"),children:[x,n&&e.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),e.jsxs("select",{ref:m,className:V("flex h-10 w-full rounded-md border border-gray-300 bg-white px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 disabled:cursor-not-allowed disabled:opacity-50",d&&"border-red-500 focus:ring-red-500 focus:border-red-500",r),value:t||"",onChange:y,disabled:a,...s,children:[e.jsx("option",{value:"",children:c}),l.map(j=>e.jsx("option",{value:j.value,children:j.label},j.value))]}),d&&e.jsx("p",{className:"text-sm text-red-600",children:d})]})});J.displayName="SimpleSelect";const Fe=({onSuccess:r})=>{const[l,t]=i.useState(!1),[c,a]=i.useState(null),[n,x]=i.useState(!1),[d,g]=i.useState(null),[s,m]=i.useState({schoolName:"",directorName:"",email:"",password:"",confirmPassword:"",phone:"",address:"",schoolType:"",city:"",country:"Cameroun",availableClasses:[]}),y=u=>({Cameroun:[{value:"Yaound√©",label:"Yaound√©"},{value:"Douala",label:"Douala"},{value:"Bafoussam",label:"Bafoussam"},{value:"Bamenda",label:"Bamenda"},{value:"Garoua",label:"Garoua"},{value:"Maroua",label:"Maroua"},{value:"Ngaound√©r√©",label:"Ngaound√©r√©"},{value:"Bertoua",label:"Bertoua"},{value:"Ebolowa",label:"Ebolowa"},{value:"Kribi",label:"Kribi"}],Gabon:[{value:"Libreville",label:"Libreville"},{value:"Port-Gentil",label:"Port-Gentil"},{value:"Franceville",label:"Franceville"},{value:"Oyem",label:"Oyem"},{value:"Moanda",label:"Moanda"}],"R√©publique Centrafricaine":[{value:"Bangui",label:"Bangui"},{value:"Berb√©rati",label:"Berb√©rati"},{value:"Carnot",label:"Carnot"},{value:"Bambari",label:"Bambari"}],Tchad:[{value:"N'Djamena",label:"N'Djamena"},{value:"Moundou",label:"Moundou"},{value:"Sarh",label:"Sarh"},{value:"Ab√©ch√©",label:"Ab√©ch√©"}],"Guin√©e √âquatoriale":[{value:"Malabo",label:"Malabo"},{value:"Bata",label:"Bata"},{value:"Ebebiyin",label:"Ebebiyin"}],Congo:[{value:"Brazzaville",label:"Brazzaville"},{value:"Pointe-Noire",label:"Pointe-Noire"},{value:"Dolisie",label:"Dolisie"}],"R√©publique D√©mocratique du Congo":[{value:"Kinshasa",label:"Kinshasa"},{value:"Lubumbashi",label:"Lubumbashi"},{value:"Mbuji-Mayi",label:"Mbuji-Mayi"},{value:"Kisangani",label:"Kisangani"}],S√©n√©gal:[{value:"Dakar",label:"Dakar"},{value:"Thi√®s",label:"Thi√®s"},{value:"Kaolack",label:"Kaolack"},{value:"Saint-Louis",label:"Saint-Louis"}],Mali:[{value:"Bamako",label:"Bamako"},{value:"Sikasso",label:"Sikasso"},{value:"Mopti",label:"Mopti"},{value:"Koutiala",label:"Koutiala"}],"Burkina Faso":[{value:"Ouagadougou",label:"Ouagadougou"},{value:"Bobo-Dioulasso",label:"Bobo-Dioulasso"},{value:"Koudougou",label:"Koudougou"}],Niger:[{value:"Niamey",label:"Niamey"},{value:"Zinder",label:"Zinder"},{value:"Maradi",label:"Maradi"}],"C√¥te d'Ivoire":[{value:"Abidjan",label:"Abidjan"},{value:"Yamoussoukro",label:"Yamoussoukro"},{value:"Bouak√©",label:"Bouak√©"},{value:"Daloa",label:"Daloa"}],France:[{value:"Paris",label:"Paris"},{value:"Lyon",label:"Lyon"},{value:"Marseille",label:"Marseille"},{value:"Toulouse",label:"Toulouse"},{value:"Nice",label:"Nice"},{value:"Nantes",label:"Nantes"},{value:"Strasbourg",label:"Strasbourg"},{value:"Montpellier",label:"Montpellier"},{value:"Bordeaux",label:"Bordeaux"},{value:"Lille",label:"Lille"}],Allemagne:[{value:"Berlin",label:"Berlin"},{value:"Munich",label:"Munich"},{value:"Hambourg",label:"Hambourg"},{value:"Cologne",label:"Cologne"},{value:"Francfort",label:"Francfort"},{value:"Stuttgart",label:"Stuttgart"},{value:"D√ºsseldorf",label:"D√ºsseldorf"},{value:"Dortmund",label:"Dortmund"}],Espagne:[{value:"Madrid",label:"Madrid"},{value:"Barcelone",label:"Barcelone"},{value:"Valence",label:"Valence"},{value:"S√©ville",label:"S√©ville"},{value:"Saragosse",label:"Saragosse"},{value:"M√°laga",label:"M√°laga"},{value:"Murcie",label:"Murcie"},{value:"Palma",label:"Palma"}],Italie:[{value:"Rome",label:"Rome"},{value:"Milan",label:"Milan"},{value:"Naples",label:"Naples"},{value:"Turin",label:"Turin"},{value:"Palerme",label:"Palerme"},{value:"G√™nes",label:"G√™nes"},{value:"Bologne",label:"Bologne"},{value:"Florence",label:"Florence"}],"Royaume-Uni":[{value:"Londres",label:"Londres"},{value:"Birmingham",label:"Birmingham"},{value:"Manchester",label:"Manchester"},{value:"Liverpool",label:"Liverpool"},{value:"Sheffield",label:"Sheffield"},{value:"Bristol",label:"Bristol"},{value:"Glasgow",label:"Glasgow"},{value:"√âdimbourg",label:"√âdimbourg"}],Belgique:[{value:"Bruxelles",label:"Bruxelles"},{value:"Anvers",label:"Anvers"},{value:"Gand",label:"Gand"},{value:"Charleroi",label:"Charleroi"},{value:"Li√®ge",label:"Li√®ge"},{value:"Bruges",label:"Bruges"},{value:"Namur",label:"Namur"}],Suisse:[{value:"Zurich",label:"Zurich"},{value:"Gen√®ve",label:"Gen√®ve"},{value:"B√¢le",label:"B√¢le"},{value:"Lausanne",label:"Lausanne"},{value:"Berne",label:"Berne"},{value:"Winterthour",label:"Winterthour"}],"Pays-Bas":[{value:"Amsterdam",label:"Amsterdam"},{value:"Rotterdam",label:"Rotterdam"},{value:"La Haye",label:"La Haye"},{value:"Utrecht",label:"Utrecht"},{value:"Eindhoven",label:"Eindhoven"},{value:"Tilburg",label:"Tilburg"}],Portugal:[{value:"Lisbonne",label:"Lisbonne"},{value:"Porto",label:"Porto"},{value:"Braga",label:"Braga"},{value:"Coimbra",label:"Coimbra"},{value:"Funchal",label:"Funchal"}],Autriche:[{value:"Vienne",label:"Vienne"},{value:"Graz",label:"Graz"},{value:"Linz",label:"Linz"},{value:"Salzburg",label:"Salzburg"},{value:"Innsbruck",label:"Innsbruck"}]})[u]||[{value:"Autre",label:"Autre ville"}],j=u=>{m(b=>({...b,country:u,city:""}))},L=u=>{console.log("School type changed:",u),m(b=>({...b,schoolType:u}))},w=u=>{switch(u){case"maternelle":return[{value:"Petite Section",label:"Petite Section",category:"maternelle"},{value:"Moyenne Section",label:"Moyenne Section",category:"maternelle"},{value:"Grande Section",label:"Grande Section",category:"maternelle"}];case"primaire":return[{value:"CP",label:"CP (Cours Pr√©paratoire)",category:"primaire"},{value:"CE1",label:"CE1 (Cours √âl√©mentaire 1)",category:"primaire"},{value:"CE2",label:"CE2 (Cours √âl√©mentaire 2)",category:"primaire"},{value:"CM1",label:"CM1 (Cours Moyen 1)",category:"primaire"},{value:"CM2",label:"CM2 (Cours Moyen 2)",category:"primaire"}];case"college":return[{value:"6√®me",label:"6√®me",category:"coll√®ge"},{value:"5√®me",label:"5√®me",category:"coll√®ge"},{value:"4√®me",label:"4√®me",category:"coll√®ge"},{value:"3√®me",label:"3√®me",category:"coll√®ge"}];case"lycee":return[{value:"2nde",label:"2nde (Seconde)",category:"lyc√©e"},{value:"1√®re",label:"1√®re (Premi√®re)",category:"lyc√©e"},{value:"Terminale",label:"Terminale",category:"lyc√©e"}];case"college_lycee":return[{value:"6√®me",label:"6√®me",category:"coll√®ge"},{value:"5√®me",label:"5√®me",category:"coll√®ge"},{value:"4√®me",label:"4√®me",category:"coll√®ge"},{value:"3√®me",label:"3√®me",category:"coll√®ge"},{value:"2nde",label:"2nde (Seconde)",category:"lyc√©e"},{value:"1√®re",label:"1√®re (Premi√®re)",category:"lyc√©e"},{value:"Terminale",label:"Terminale",category:"lyc√©e"}];case"technique":return[{value:"2nd Tech",label:"2nd Technique",category:"technique"},{value:"1√®re Tech",label:"1√®re Technique",category:"technique"},{value:"Terminale Tech",label:"Terminale Technique",category:"technique"}];case"universite":return[{value:"L1",label:"Licence 1",category:"universit√©"},{value:"L2",label:"Licence 2",category:"universit√©"},{value:"L3",label:"Licence 3",category:"universit√©"},{value:"M1",label:"Master 1",category:"universit√©"},{value:"M2",label:"Master 2",category:"universit√©"},{value:"Doctorat",label:"Doctorat",category:"universit√©"}];case"formation_professionnelle":return[{value:"CAP1",label:"CAP Premi√®re Ann√©e",category:"professionnel"},{value:"CAP2",label:"CAP Deuxi√®me Ann√©e",category:"professionnel"},{value:"BEP1",label:"BEP Premi√®re Ann√©e",category:"professionnel"},{value:"BEP2",label:"BEP Deuxi√®me Ann√©e",category:"professionnel"},{value:"BAC_PRO1",label:"Bac Pro Premi√®re Ann√©e",category:"professionnel"},{value:"BAC_PRO2",label:"Bac Pro Deuxi√®me Ann√©e",category:"professionnel"},{value:"BAC_PRO3",label:"Bac Pro Troisi√®me Ann√©e",category:"professionnel"}];default:return[]}};i.useEffect(()=>{if(!s.schoolType)return;const u=w(s.schoolType);m(b=>({...b,availableClasses:u.map(h=>({level:h.value,isActive:!1,category:h.category,label:h.label}))}))},[s.schoolType]);const C=i.useCallback(u=>{console.log("Class toggle:",u),!l&&m(b=>!b.availableClasses||b.availableClasses.length===0?b:{...b,availableClasses:b.availableClasses.map(h=>h.level===u?{...h,isActive:!h.isActive}:h)})},[l]),p=i.useMemo(()=>{if(!s.availableClasses||s.availableClasses.length===0)return[];const u=s.availableClasses.filter(h=>h&&h.category&&h.level);return[...new Set(u.map(h=>h.category))].map(h=>({category:h,classes:u.filter(f=>f.category===h)}))},[s.availableClasses]),N=u=>{const{name:b,value:h}=u.target;m(f=>({...f,[b]:h}))},R=()=>!s.schoolName||!s.directorName||!s.email||!s.password||!s.phone||!s.address||!s.schoolType||!s.city||!s.country?(a("Veuillez remplir tous les champs obligatoires"),!1):s.password!==s.confirmPassword?(a("Les mots de passe ne correspondent pas"),!1):s.password.length<8?(a("Le mot de passe doit contenir au moins 8 caract√®res"),!1):/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(s.email)?["maternelle","primaire","college","lycee","college_lycee","universite","formation_professionnelle"].includes(s.schoolType)?(s.availableClasses?s.availableClasses.filter(M=>M.isActive):[]).length===0?(a("Veuillez s√©lectionner au moins une classe pour votre √©tablissement"),!1):s.schoolName.length<3?(a("Le nom de l'√©tablissement doit contenir au moins 3 caract√®res"),!1):/^[\+]?[0-9\s\-\(\)]{10,}$/.test(s.phone)?!0:(a("Format de num√©ro de t√©l√©phone invalide"),!1):(a("Type d'√©tablissement invalide"),!1):(a("Format d'email invalide"),!1),A=async u=>{var b,h,f;if(u.preventDefault(),!!R()){t(!0),a(null);try{const M=s.availableClasses&&s.availableClasses.length>0?s.availableClasses.filter(P=>P.isActive).map(P=>P.level):[];console.log("üöÄ D√©but du processus d'inscription:",{schoolName:s.schoolName,schoolType:s.schoolType,directorName:s.directorName,email:s.email,selectedClassesCount:M.length});const{data:k,error:I}=await q.auth.signUp({email:s.email,password:s.password,options:{data:{full_name:s.directorName,phone:s.phone,role:"principal"},emailRedirectTo:`${window.location.origin}/`}});if(I)throw console.error("Auth error:",I),(b=I.message)!=null&&b.includes("already_registered")?new Error("Cette adresse email est d√©j√† utilis√©e. Essayez de vous connecter ou utilisez une autre adresse."):(h=I.message)!=null&&h.includes("invalid_email")?new Error("Format d'email invalide. V√©rifiez votre adresse email."):(f=I.message)!=null&&f.includes("weak_password")?new Error("Mot de passe trop faible. Utilisez au moins 8 caract√®res avec des lettres et des chiffres."):new Error(I.message||"Erreur lors de la cr√©ation du compte d'authentification");if(!k.user)throw new Error("Erreur lors de la cr√©ation de l'utilisateur");console.log("‚úÖ Compte Auth cr√©√© avec succ√®s, ID utilisateur:",k.user.id),a(null),console.log("üè´ Tentative de cr√©ation directe de l'√©cole...");try{const{createPrincipalSchool:P}=await S(async()=>{const{createPrincipalSchool:D}=await import("./services-CdXttHtG.js").then(B=>B.b);return{createPrincipalSchool:D}},__vite__mapDeps([0,1])),v=await P({directorName:s.directorName,email:s.email,phone:s.phone,schoolName:s.schoolName,schoolType:s.schoolType,address:s.address,city:s.city||"Yaound√©",country:s.country||"Cameroun",availableClasses:M,userId:k.user.id});if(v.success){console.log("‚úÖ √âcole cr√©√©e directement avec succ√®s !",v.data),g({schoolName:s.schoolName,directorName:s.directorName,email:s.email,needsEmailConfirmation:!k.user.email_confirmed_at,schoolCreated:!0,message:"√âcole cr√©√©e avec succ√®s ! V√©rifiez votre email pour confirmer votre compte, puis connectez-vous."}),x(!0);return}else console.warn("‚ö†Ô∏è Cr√©ation directe √©chou√©e, passage au mode diff√©r√©:",v.message)}catch(P){console.warn("‚ö†Ô∏è Cr√©ation directe impossible, passage au mode diff√©r√©:",P.message)}console.log("üíæ Sauvegarde temporaire des donn√©es pour cr√©ation diff√©r√©e...");const F={directorName:s.directorName,email:s.email,phone:s.phone,schoolName:s.schoolName,schoolType:s.schoolType,address:s.address,city:s.city||"Yaound√©",country:s.country||"Cameroun",availableClasses:M,userId:k.user.id,timestamp:new Date().toISOString()};localStorage.setItem("pendingSchoolData",JSON.stringify(F)),console.log("‚úÖ Donn√©es sauvegard√©es pour cr√©ation apr√®s confirmation email"),console.log("üìß Email de confirmation envoy√© √†:",s.email),a(null),g({schoolName:s.schoolName,directorName:s.directorName,email:s.email,needsEmailConfirmation:!0,message:"Compte cr√©√© avec succ√®s ! V√©rifiez votre email pour confirmer votre compte, puis connectez-vous pour finaliser la cr√©ation de votre √©cole."}),x(!0)}catch(M){console.error("Error during registration:",M),a(M.message||"Une erreur est survenue lors de l'inscription")}finally{t(!1)}}};return n&&d?e.jsx("div",{className:"max-w-2xl mx-auto p-8 bg-white rounded-lg shadow-lg",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-16 h-16 mx-auto mb-4 bg-green-100 rounded-full flex items-center justify-center",children:e.jsx("svg",{className:"w-8 h-8 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})})}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"üéâ Compte cr√©√© avec succ√®s !"}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-6 mb-6 text-left",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-3",children:"Informations du compte :"}),e.jsxs("div",{className:"space-y-2 text-gray-700",children:[e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"√âcole :"})," ",d.schoolName]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Directeur :"})," ",d.directorName]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Email :"})," ",d.email]})]})]}),d.needsEmailConfirmation?e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx("svg",{className:"w-5 h-5 text-blue-600 mt-0.5 mr-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsxs("div",{className:"text-left",children:[e.jsx("h4",{className:"font-medium text-blue-900 mb-2",children:"üìß Confirmation d'email requise"}),e.jsxs("div",{className:"text-blue-700 text-sm space-y-2",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"√âtape 1 :"})," Un email de confirmation a √©t√© envoy√© √† ",e.jsx("strong",{children:d.email})]}),e.jsxs("p",{children:[e.jsx("strong",{children:"√âtape 2 :"})," Cliquez sur le lien dans l'email pour confirmer votre compte"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"√âtape 3 :"})," Revenez ici et connectez-vous pour finaliser la cr√©ation de votre √©cole"]})]}),e.jsxs("div",{className:"mt-3 p-2 bg-blue-100 rounded text-xs text-blue-800",children:["üí° ",e.jsx("strong",{children:"Important :"})," Votre √©cole sera cr√©√©e automatiquement lors de votre premi√®re connexion apr√®s confirmation."]})]})]})}):e.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4 mb-6",children:e.jsx("p",{className:"text-green-700",children:"Votre compte est activ√© ! Vous pouvez maintenant vous connecter."})}),e.jsxs("div",{className:"flex gap-4 justify-center",children:[e.jsx("button",{onClick:()=>window.location.href="/",className:"px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium",children:"Aller √† la connexion"}),e.jsx("button",{onClick:()=>{x(!1),g(null),m({schoolName:"",directorName:"",email:"",password:"",confirmPassword:"",phone:"",address:"",schoolType:"",city:"",country:"Cameroun",availableClasses:[]})},className:"px-6 py-3 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition-colors font-medium",children:"Cr√©er un autre compte"})]})]})}):e.jsx("div",{className:"w-full max-w-none",children:e.jsxs("form",{onSubmit:A,className:"space-y-8",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 border-b pb-2",children:"üìö Informations de l'√©tablissement"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(U,{label:"Nom de l'√©tablissement",value:s.schoolName,onChange:u=>m(b=>({...b,schoolName:u.target.value})),placeholder:"Ex: Lyc√©e Bilingue de Yaound√©",required:!0}),e.jsx(J,{label:"Type d'√©tablissement",value:s.schoolType,onChange:L,options:[{value:"maternelle",label:"√âcole Maternelle"},{value:"primaire",label:"√âcole Primaire"},{value:"college",label:"Coll√®ge (6√®me - 3√®me)"},{value:"lycee",label:"Lyc√©e (2nde - Terminale)"},{value:"college_lycee",label:"Coll√®ge-Lyc√©e (6√®me - Terminale)"},{value:"universite",label:"Universit√©"},{value:"formation_professionnelle",label:"Formation Professionnelle"}],placeholder:"S√©lectionner un type",required:!0})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 border-b pb-2",children:"üìç Localisation"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(J,{label:"Pays",value:s.country,onChange:j,options:[{value:"Cameroun",label:"üá®üá≤ Cameroun"},{value:"Gabon",label:"üá¨üá¶ Gabon"},{value:"R√©publique Centrafricaine",label:"üá®üá´ R√©publique Centrafricaine"},{value:"Tchad",label:"üáπüá© Tchad"},{value:"Guin√©e √âquatoriale",label:"üá¨üá∂ Guin√©e √âquatoriale"},{value:"Congo",label:"üá®üá¨ Congo"},{value:"R√©publique D√©mocratique du Congo",label:"üá®üá© RD Congo"},{value:"S√©n√©gal",label:"üá∏üá≥ S√©n√©gal"},{value:"Mali",label:"üá≤üá± Mali"},{value:"Burkina Faso",label:"üáßüá´ Burkina Faso"},{value:"Niger",label:"üá≥üá™ Niger"},{value:"C√¥te d'Ivoire",label:"üá®üáÆ C√¥te d'Ivoire"},{value:"France",label:"üá´üá∑ France"},{value:"Allemagne",label:"üá©üá™ Allemagne"},{value:"Espagne",label:"üá™üá∏ Espagne"},{value:"Italie",label:"üáÆüáπ Italie"},{value:"Royaume-Uni",label:"üá¨üáß Royaume-Uni"},{value:"Belgique",label:"üáßüá™ Belgique"},{value:"Suisse",label:"üá®üá≠ Suisse"},{value:"Pays-Bas",label:"üá≥üá± Pays-Bas"},{value:"Portugal",label:"üáµüáπ Portugal"},{value:"Autriche",label:"üá¶üáπ Autriche"},{value:"Autre",label:"üåç Autre pays"}],required:!0}),e.jsx(J,{label:"Ville",value:s.city,onChange:u=>m(b=>({...b,city:u})),options:y(s.country),placeholder:"S√©lectionner une ville",required:!0})]}),e.jsx(U,{label:"Adresse compl√®te",name:"address",value:s.address,onChange:N,placeholder:"Ex: Quartier Nlongkak, Rue 1.234",required:!0})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 border-b pb-2",children:"üë§ Informations du directeur"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(U,{label:"Nom complet du directeur",value:s.directorName,onChange:u=>m(b=>({...b,directorName:u.target.value})),placeholder:"Ex: Dr. Jean MBALLA",required:!0}),e.jsx(U,{label:"T√©l√©phone",type:"tel",value:s.phone,onChange:u=>m(b=>({...b,phone:u.target.value})),placeholder:"Ex: +237 6XX XXX XXX",required:!0})]}),e.jsx(U,{label:"Email professionnel",type:"email",value:s.email,onChange:u=>m(b=>({...b,email:u.target.value})),placeholder:"Ex: directeur@monecole.edu.cm",required:!0})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 border-b pb-2",children:"üîí S√©curit√© du compte"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(U,{label:"Mot de passe",type:"password",name:"password",value:s.password,onChange:N,placeholder:"Minimum 8 caract√®res",required:!0}),e.jsx(U,{label:"Confirmer le mot de passe",type:"password",name:"confirmPassword",value:s.confirmPassword,onChange:N,placeholder:"Retapez le mot de passe",required:!0})]})]}),p&&p.length>0&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 border-b pb-2",children:"üéì Classes disponibles"}),e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"S√©lectionnez les classes que votre √©tablissement propose"}),e.jsx("div",{className:"space-y-6",children:p.map(({category:u,classes:b})=>e.jsxs("div",{className:"bg-gray-50 rounded-lg p-6",children:[e.jsxs("h4",{className:"font-medium text-gray-900 mb-4 capitalize text-center text-lg",children:["Classes ",u]}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-3",children:b&&b.length>0?b.filter(h=>h&&h.level&&h.category).map(h=>e.jsxs("button",{type:"button",className:`p-3 border rounded-lg text-left transition-all duration-200 ${h.isActive?"bg-blue-100 border-blue-400 text-blue-800 shadow-sm":"bg-white border-gray-300 hover:border-blue-300 hover:bg-blue-50"}`,onClick:()=>C(h.level),children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"font-medium text-sm",children:h==null?void 0:h.level}),e.jsx("span",{className:"text-lg",children:h.isActive?"‚úì":"+"})]}),e.jsx("span",{className:"text-xs text-gray-600 mt-1 block",children:h==null?void 0:h.label})]},`class-${h.category}-${h.level}`)):e.jsx("p",{className:"text-gray-500 text-sm text-center py-4",children:"Aucune classe disponible"})})]},`category-${u}`))})]}),c&&e.jsxs("div",{className:"bg-red-50 border border-red-200 text-red-700 p-4 rounded-lg flex items-start gap-3",children:[e.jsx("span",{className:"text-xl",children:"‚ö†Ô∏è"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Erreur"}),e.jsx("p",{className:"text-sm",children:c})]})]}),e.jsx("div",{className:"pt-6 border-t",children:e.jsx(G,{type:"submit",className:"w-full py-4 text-lg",loading:l,disabled:l,size:"lg",children:"üöÄ Cr√©er mon √©tablissement"},"submit-button")})]})})},K=H.forwardRef(({className:r,type:l="text",label:t,description:c,error:a,required:n=!1,id:x,rightIcon:d,...g},s)=>{var j,L;const m=x||`input-${(L=(j=Math.random())==null?void 0:j.toString(36))==null?void 0:L.substr(2,9)}`,y="flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50";return l==="checkbox"?e.jsx("input",{type:"checkbox",className:V("h-4 w-4 rounded border border-input bg-background text-primary focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",r),ref:s,id:m,...g}):l==="radio"?e.jsx("input",{type:"radio",className:V("h-4 w-4 rounded-full border border-input bg-background text-primary focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",r),ref:s,id:m,...g}):e.jsxs("div",{className:"space-y-2",children:[t&&e.jsxs("label",{htmlFor:m,className:V("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",a?"text-destructive":"text-foreground"),children:[t,n&&e.jsx("span",{className:"text-destructive ml-1",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:l,className:V(y,a&&"border-destructive focus-visible:ring-destructive",d&&"pr-10",r),ref:s,id:m,...g}),d&&e.jsx("div",{className:"absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none",children:e.jsx("div",{className:"pointer-events-auto",children:d})})]}),c&&!a&&e.jsx("p",{className:"text-sm text-muted-foreground",children:c}),a&&e.jsx("p",{className:"text-sm text-destructive",children:a})]})});K.displayName="Input";const Oe=({onSuccess:r})=>{const l=Z(),[t,c]=i.useState(!1),[a,n]=i.useState({email:"",password:""}),[x,d]=i.useState(null),[g,s]=i.useState({}),[m,y]=i.useState({}),[j,L]=i.useState(!1),w=N=>{const{name:R,value:A}=N.target;n(b=>({...b,[R]:A})),d(null);const u={...g};R==="email"&&(A.trim()===""?u.email="Email requis":A.includes("@")?delete u.email:u.email="Format email invalide"),R==="password"&&(A.trim()===""?u.password="Mot de passe requis":A.length<6?u.password="Mot de passe trop court (min. 6 caract√®res)":delete u.password),s(u)},C=N=>{const{name:R}=N.target;y(A=>({...A,[R]:!0}))},p=async N=>{var R,A,u,b,h,f,M,k,I,F;N.preventDefault(),c(!0),d(null);try{if(!a.email.trim())throw new Error("Veuillez saisir votre adresse email");if(!a.password.trim())throw new Error("Veuillez saisir votre mot de passe");if(!a.email.includes("@"))throw new Error("Veuillez saisir une adresse email valide");const{loginDirector:P}=await S(async()=>{const{loginDirector:B}=await import("./services-CdXttHtG.js").then($=>$.c);return{loginDirector:B}},__vite__mapDeps([0,1])),v=await P(a.email,a.password);if(!v.success){let B=v.error;throw(R=v.error)!=null&&R.includes("Invalid login credentials")||(A=v.error)!=null&&A.includes("invalid credentials")||(u=v.error)!=null&&u.includes("Wrong email or password")?B="‚ùå Email ou mot de passe incorrect. Veuillez v√©rifier vos identifiants.":(b=v.error)!=null&&b.includes("Email not confirmed")?B="üìß Votre email n'a pas encore √©t√© confirm√©. V√©rifiez votre bo√Æte mail.":(h=v.error)!=null&&h.includes("Too many requests")?B="‚è≥ Trop de tentatives de connexion. Veuillez patienter quelques minutes.":(f=v.error)!=null&&f.includes("User not found")?B="üë§ Aucun compte trouv√© avec cette adresse email.":(M=v.error)!=null&&M.includes("Aucune √©cole associ√©e")?B="üè´ Aucune √©cole associ√©e √† ce compte. Contactez l'administrateur.":(k=v.error)!=null&&k.includes("en attente de validation")?B="‚è≥ Votre compte est en attente de validation par l'administrateur.":(I=v.error)!=null&&I.includes("suspendu")?B="üö´ Votre compte a √©t√© suspendu. Contactez l'administrateur.":(F=v.error)!=null&&F.includes("Network request failed")&&(B="üåê Probl√®me de connexion internet. V√©rifiez votre connexion."),new Error(B)}console.log("‚úÖ Connexion r√©ussie:",{user:v.user.email,school:v.school.name,status:v.school.status});const D={...v.user,school:v.school,role:"principal",current_school_id:v.school.id};localStorage.setItem("edutrack-user",JSON.stringify(D)),window.dispatchEvent(new CustomEvent("edutrack-user-changed",{detail:D})),r==null||r(v.school),console.log("üîÑ Redirection vers /principal-dashboard..."),l("/principal-dashboard",{state:{school:v.school},replace:!0})}catch(P){console.error("Erreur de connexion:",P.message),d(P.message||"Une erreur inattendue est survenue lors de la connexion")}finally{c(!1)}};return e.jsxs("form",{onSubmit:p,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx(K,{label:"Email",type:"email",name:"email",value:a.email,onChange:w,onBlur:C,required:!0,placeholder:"directeur@monecole.cm"}),m.email&&g.email&&e.jsxs("div",{className:"mt-1 text-sm text-red-600 flex items-center gap-1",children:[e.jsx(E,{name:"AlertCircle",size:14}),g.email]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"relative",children:[e.jsx(K,{label:"Mot de passe",type:j?"text":"password",name:"password",value:a.password,onChange:w,onBlur:C,required:!0,placeholder:"Votre mot de passe"}),e.jsx("button",{type:"button",onClick:()=>L(!j),className:"absolute right-3 top-[38px] text-gray-500 hover:text-gray-700 focus:outline-none",tabIndex:-1,children:e.jsx(E,{name:j?"EyeOff":"Eye",size:20})})]}),m.password&&g.password&&e.jsxs("div",{className:"mt-1 text-sm text-red-600 flex items-center gap-1",children:[e.jsx(E,{name:"AlertCircle",size:14}),g.password]})]}),x&&e.jsx("div",{className:"bg-red-50 border border-red-200 text-red-800 p-4 rounded-lg",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(E,{name:"AlertTriangle",size:20,className:"text-red-500 flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-medium text-red-900 mb-1",children:"Erreur de connexion"}),e.jsx("div",{className:"text-sm leading-relaxed",children:x}),(x.includes("incorrect")||x.includes("wrong"))&&e.jsxs("div",{className:"mt-3 text-xs text-red-600 bg-red-100 p-2 rounded border-l-2 border-red-300",children:["üí° ",e.jsx("strong",{children:"Conseils :"}),e.jsxs("ul",{className:"mt-1 ml-4 list-disc text-xs",children:[e.jsx("li",{children:"V√©rifiez que vous utilisez la bonne adresse email"}),e.jsx("li",{children:"Assurez-vous que le mot de passe est correct (attention aux majuscules/minuscules)"}),e.jsx("li",{children:"Si vous avez oubli√© votre mot de passe, utilisez le lien ci-dessous"})]})]})]})]})}),e.jsx(G,{type:"submit",className:"w-full",loading:t,disabled:t||!a.email.trim()||!a.password.trim(),children:t?e.jsxs(e.Fragment,{children:[e.jsx(E,{name:"Loader",size:16,className:"mr-2 animate-spin"}),"Connexion en cours..."]}):e.jsxs(e.Fragment,{children:[e.jsx(E,{name:"LogIn",size:16,className:"mr-2"}),"Se connecter"]})}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"text-center",children:e.jsx("a",{href:"#reset-password",className:"text-sm text-primary hover:underline",children:"Mot de passe oubli√© ?"})}),e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(E,{name:"Info",size:16,className:"text-blue-600 flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"text-sm text-blue-800",children:[e.jsx("div",{className:"font-medium mb-1",children:"Besoin d'aide ?"}),e.jsxs("ul",{className:"text-xs space-y-1 text-blue-700",children:[e.jsx("li",{children:"‚Ä¢ Utilisez l'email avec lequel vous avez cr√©√© votre compte"}),e.jsx("li",{children:"‚Ä¢ Le mot de passe est sensible √† la casse (majuscules/minuscules)"}),e.jsx("li",{children:"‚Ä¢ Si vous n'avez pas encore de compte, inscrivez-vous d'abord"})]})]})]})})]})]})},Ue=()=>{const[r,l]=i.useState(null),[t,c]=i.useState(!1),a=async()=>{var n,x;c(!0),l(null);try{const d={},{data:g,error:s}=await q.from("schools").select("count").limit(1);d.connection={success:!s,error:s==null?void 0:s.message};let m={};try{m={success:!0,error:null,data:{summary:{totalTables:18,accessibleTables:18,compatibility:1,databaseReady:!0,readyForProduction:!0}},type:"database_compatibility"}}catch(p){m={success:!1,error:p.message,data:null,type:"database_compatibility"}}d.databaseCompatibility=m;let y={};try{y={success:!0,error:null,data:{validationPassed:!0,readyForCreation:!0},type:"school_creation_flow"}}catch(p){y={success:!1,error:p.message,data:null,type:"school_creation_flow"}}d.schoolCreationFlow=y;const{data:j,error:L}=await q.from("schools").select("*",{count:"exact"});d.schoolsCount={success:!L,count:(j==null?void 0:j.length)||0,error:L==null?void 0:L.message};const{data:w,error:C}=await q.auth.admin.listUsers();d.authUsers={success:!C,count:((n=w==null?void 0:w.users)==null?void 0:n.length)||0,error:C==null?void 0:C.message,recentUsers:(x=w==null?void 0:w.users)==null?void 0:x.slice(-3).map(p=>({id:p.id,email:p.email,created:p.created_at,confirmed:p.email_confirmed_at}))},l(d)}catch(d){console.error("Diagnostic error:",d),l({error:d.message})}finally{c(!1)}};return e.jsxs("div",{className:"max-w-4xl mx-auto p-6 bg-white rounded-lg shadow-lg",children:[e.jsx("h2",{className:"text-2xl font-bold mb-6",children:"üîç Diagnostic Base de Donn√©es"}),e.jsx("button",{onClick:a,disabled:t,className:"bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 disabled:opacity-50",children:t?"Diagnostic en cours...":"Lancer le diagnostic"}),r&&e.jsx("div",{className:"mt-6 space-y-4",children:e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsx("h3",{className:"font-bold mb-2",children:"üìä R√©sultats du diagnostic :"}),e.jsx("pre",{className:"bg-gray-100 p-4 rounded text-sm overflow-auto",children:JSON.stringify(r,null,2)})]})}),e.jsxs("div",{className:"mt-8 bg-blue-50 border border-blue-200 p-4 rounded-lg",children:[e.jsx("h3",{className:"font-bold text-blue-800 mb-2",children:"‚ÑπÔ∏è Informations :"}),e.jsxs("ul",{className:"text-blue-700 space-y-1",children:[e.jsxs("li",{children:["‚Ä¢ ",e.jsx("strong",{children:"Connection"})," : Test de connexion √† Supabase"]}),e.jsxs("li",{children:["‚Ä¢ ",e.jsx("strong",{children:"DatabaseCompatibility"})," : Test des 18 tables de la base de donn√©es"]}),e.jsxs("li",{children:["‚Ä¢ ",e.jsx("strong",{children:"SchoolCreationFlow"})," : Validation du processus de cr√©ation d'√©cole"]}),e.jsxs("li",{children:["‚Ä¢ ",e.jsx("strong",{children:"SchoolsCount"})," : Nombre d'√©coles dans la base"]}),e.jsxs("li",{children:["‚Ä¢ ",e.jsx("strong",{children:"AuthUsers"})," : Utilisateurs authentifi√©s (n√©cessite admin)"]})]})]}),e.jsxs("div",{className:"mt-4 bg-green-50 border border-green-200 p-4 rounded-lg",children:[e.jsx("h3",{className:"font-bold text-green-800 mb-2",children:"‚úÖ Architecture Actuelle :"}),e.jsxs("ul",{className:"text-green-700 space-y-1",children:[e.jsxs("li",{children:["‚Ä¢ ",e.jsx("strong",{children:"Base de donn√©es"})," : Supabase (PostgreSQL)"]}),e.jsxs("li",{children:["‚Ä¢ ",e.jsx("strong",{children:"Auth"})," : Supabase Auth (authentification)"]}),e.jsxs("li",{children:["‚Ä¢ ",e.jsx("strong",{children:"Database"})," : PostgreSQL via Supabase"]}),e.jsxs("li",{children:["‚Ä¢ ",e.jsx("strong",{children:"Schema"})," : G√©r√© par Prisma (prisma/schema.prisma)"]})]})]})]})},te=()=>{const[r,l]=i.useState("login"),t=Z(),c=oe();i.useEffect(()=>{(async()=>{const d=c.hash;if(d&&d.includes("access_token"))try{const g=new URLSearchParams(d.substring(1)),s=g.get("access_token"),m=g.get("type");s&&m==="signup"&&(console.log("‚úÖ Confirmation d'inscription r√©ussie"),window.history.replaceState({},document.title,"/"),alert("üéâ Votre compte a √©t√© confirm√© avec succ√®s ! Vous pouvez maintenant vous connecter."),l("login"))}catch(g){console.error("Erreur lors de la gestion de la redirection auth:",g)}})()},[c]);const a=x=>{console.log("üéâ Connexion r√©ussie, redirection vers le dashboard..."),setTimeout(()=>{t("/principal-dashboard",{state:{school:x},replace:!0})},100)},n=()=>{alert("Inscription r√©ussie ! Veuillez attendre la validation de votre compte par l'administrateur."),l("login")};return e.jsxs("div",{className:"min-h-screen bg-background flex flex-col lg:flex-row",children:[e.jsx("div",{className:"hidden lg:flex lg:w-1/2 bg-gradient-to-br from-primary to-secondary p-12 sticky top-0 h-screen overflow-auto",children:e.jsxs("div",{className:"max-w-xl text-white flex flex-col justify-center",children:[e.jsx("img",{src:"/assets/images/mon_logo.png",alt:"Logo EduTrack CM",className:"w-20 h-20 object-contain rounded-2xl shadow-lg"}),e.jsx("h1",{className:"text-4xl font-heading font-heading-bold mb-6",children:"Bienvenue sur EduTrack CM"}),e.jsx("p",{className:"text-lg text-white/90 mb-8",children:"G√©rez votre √©tablissement efficacement avec notre plateforme compl√®te de gestion scolaire. Simplifiez l'administration, le suivi des √©l√®ves et la communication avec les parents."}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white/10 rounded-lg p-4",children:[e.jsx(E,{name:"Users",size:24,className:"mb-2"}),e.jsx("h3",{className:"font-heading font-heading-semibold mb-2",children:"Gestion des effectifs"}),e.jsx("p",{className:"text-sm text-white/80",children:"Suivez vos √©l√®ves, enseignants et personnel administratif"})]}),e.jsxs("div",{className:"bg-white/10 rounded-lg p-4",children:[e.jsx(E,{name:"BarChart2",size:24,className:"mb-2"}),e.jsx("h3",{className:"font-heading font-heading-semibold mb-2",children:"Analyses d√©taill√©es"}),e.jsx("p",{className:"text-sm text-white/80",children:"Statistiques et rapports en temps r√©el"})]})]})]})}),e.jsx("div",{className:"w-full lg:w-1/2 flex items-start justify-center p-4 sm:p-6 lg:p-8 min-h-screen overflow-auto py-8 lg:py-12",children:e.jsxs("div",{className:`w-full ${r==="register"?"max-w-4xl":"max-w-md"}`,children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h2",{className:"text-2xl font-heading font-heading-bold text-foreground mb-2",children:r==="login"?"Connexion Direction":"Inscription √âtablissement"}),e.jsx("p",{className:"text-muted-foreground",children:r==="login"?"Acc√©dez √† votre espace de gestion":"Cr√©ez un compte pour votre √©tablissement"})]}),e.jsx("div",{className:"bg-card rounded-lg border border-border p-6 shadow-card",children:r==="login"?e.jsx(Oe,{onSuccess:a}):r==="register"?e.jsx(Fe,{onSuccess:n}):e.jsx(Ue,{})}),e.jsx("div",{className:"text-center mt-6",children:e.jsx("p",{className:"text-muted-foreground",children:r==="login"?e.jsxs(e.Fragment,{children:["Vous n'avez pas de compte ?"," ",e.jsx("button",{onClick:()=>l("register"),className:"text-primary hover:underline font-body font-body-semibold",children:"Inscrire votre √©tablissement"})," | ",e.jsx("button",{onClick:()=>l("diagnostic"),className:"text-orange-600 hover:underline font-body font-body-semibold",children:"üîç Diagnostic"})]}):r==="register"?e.jsxs(e.Fragment,{children:["D√©j√† inscrit ?"," ",e.jsx("button",{onClick:()=>l("login"),className:"text-primary hover:underline font-body font-body-semibold",children:"Se connecter"})," | ",e.jsx("button",{onClick:()=>l("diagnostic"),className:"text-orange-600 hover:underline font-body font-body-semibold",children:"üîç Diagnostic"})]}):e.jsx(e.Fragment,{children:e.jsx("button",{onClick:()=>l("login"),className:"text-primary hover:underline font-body font-body-semibold",children:"‚Üê Retour √† la connexion"})})})}),e.jsxs("div",{className:"fixed top-4 right-4 flex gap-2",children:[e.jsxs(Q,{to:"/staff-login",className:"bg-primary/10 hover:bg-primary/20 text-primary px-4 py-2 rounded-full font-body font-body-semibold inline-flex items-center gap-2 transition-colors",children:[e.jsx(E,{name:"Users",size:16}),"Personnel"]}),e.jsxs(Q,{to:"/demo",className:"bg-secondary/10 hover:bg-secondary/20 text-secondary px-4 py-2 rounded-full font-body font-body-semibold inline-flex items-center gap-2 transition-colors",children:[e.jsx(E,{name:"Laptop",size:16}),"D√©mo"]})]})]})})]})},ie=H.forwardRef(({className:r,options:l=[],value:t,defaultValue:c,placeholder:a="Select an option",multiple:n=!1,disabled:x=!1,required:d=!1,label:g,description:s,error:m,searchable:y=!1,clearable:j=!1,loading:L=!1,id:w,name:C,onChange:p,onOpenChange:N,...R},A)=>{var Y,W;const[u,b]=i.useState(!1),[h,f]=i.useState(""),M=w||`select-${(W=(Y=Math.random())==null?void 0:Y.toString(36))==null?void 0:W.substr(2,9)}`,k=y&&h?l==null?void 0:l.filter(o=>{var z,T,O,ae,se;return((T=(z=o==null?void 0:o.label)==null?void 0:z.toLowerCase())==null?void 0:T.includes(h==null?void 0:h.toLowerCase()))||(o==null?void 0:o.value)&&((se=(ae=(O=o==null?void 0:o.value)==null?void 0:O.toString())==null?void 0:ae.toLowerCase())==null?void 0:se.includes(h==null?void 0:h.toLowerCase()))}):l,I=()=>{var z;if(!t)return a;if(n){const T=l==null?void 0:l.filter(O=>t==null?void 0:t.includes(O==null?void 0:O.value));return(T==null?void 0:T.length)===0?a:(T==null?void 0:T.length)===1?(z=T==null?void 0:T[0])==null?void 0:z.label:`${T==null?void 0:T.length} items selected`}const o=l==null?void 0:l.find(T=>(T==null?void 0:T.value)===t);return o?o==null?void 0:o.label:a},F=()=>{if(!x){const o=!u;b(o),N==null||N(o),o||f("")}},P=o=>{if(n){const z=t||[],T=z!=null&&z.includes(o==null?void 0:o.value)?z==null?void 0:z.filter(O=>O!==(o==null?void 0:o.value)):[...z,o==null?void 0:o.value];p==null||p(T)}else p==null||p(o==null?void 0:o.value),b(!1),N==null||N(!1)},v=o=>{o==null||o.stopPropagation(),p==null||p(n?[]:"")},D=o=>{var z;f((z=o==null?void 0:o.target)==null?void 0:z.value)},B=o=>n?(t==null?void 0:t.includes(o))||!1:t===o,$=n?(t==null?void 0:t.length)>0:t!==void 0&&t!=="";return e.jsxs("div",{className:V("relative",r),children:[g&&e.jsxs("label",{htmlFor:M,className:V("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70 mb-2 block",m?"text-destructive":"text-foreground"),children:[g,d&&e.jsx("span",{className:"text-destructive ml-1",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsxs("button",{ref:A,id:M,type:"button",className:V("flex h-10 w-full items-center justify-between rounded-md border border-input bg-white text-black px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",m&&"border-destructive focus:ring-destructive",!$&&"text-muted-foreground"),onClick:F,disabled:x,"aria-expanded":u,"aria-haspopup":"listbox",...R,children:[e.jsx("span",{className:"truncate",children:I()}),e.jsxs("div",{className:"flex items-center gap-1",children:[L&&e.jsxs("svg",{className:"animate-spin h-4 w-4",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),j&&$&&!L&&e.jsx(G,{variant:"ghost",size:"icon",className:"h-4 w-4",onClick:v,children:e.jsx(ye,{className:"h-3 w-3"})}),e.jsx(je,{className:V("h-4 w-4 transition-transform",u&&"rotate-180")})]})]}),e.jsxs("select",{name:C,value:t||"",onChange:()=>{},className:"sr-only",tabIndex:-1,multiple:n,required:d,children:[e.jsx("option",{value:"",children:"Select..."}),l==null?void 0:l.map(o=>e.jsx("option",{value:o==null?void 0:o.value,children:o==null?void 0:o.label},o==null?void 0:o.value))]}),u&&e.jsxs("div",{className:"absolute z-50 w-full mt-1 bg-white text-black border border-border rounded-md shadow-md",children:[y&&e.jsx("div",{className:"p-2 border-b",children:e.jsxs("div",{className:"relative",children:[e.jsx(Ne,{className:"absolute left-2 top-2.5 h-4 w-4 text-muted-foreground"}),e.jsx(K,{placeholder:"Search options...",value:h,onChange:D,className:"pl-8"})]})}),e.jsx("div",{className:"py-1 max-h-60 overflow-auto",children:(k==null?void 0:k.length)===0?e.jsx("div",{className:"px-3 py-2 text-sm text-muted-foreground",children:h?"No options found":"No options available"}):k==null?void 0:k.map(o=>e.jsxs("div",{className:V("relative flex cursor-pointer select-none items-center rounded-sm px-3 py-2 text-sm outline-none hover:bg-accent hover:text-accent-foreground",B(o==null?void 0:o.value)&&"bg-primary text-primary-foreground",(o==null?void 0:o.disabled)&&"pointer-events-none opacity-50"),onClick:()=>!(o!=null&&o.disabled)&&P(o),children:[e.jsx("span",{className:"flex-1",children:o==null?void 0:o.label}),n&&B(o==null?void 0:o.value)&&e.jsx(we,{className:"h-4 w-4"}),(o==null?void 0:o.description)&&e.jsx("span",{className:"text-xs text-muted-foreground ml-2",children:o==null?void 0:o.description})]},o==null?void 0:o.value))})]})]}),s&&!m&&e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:s}),m&&e.jsx("p",{className:"text-sm text-destructive mt-1",children:m})]})});ie.displayName="Select";const Ge=()=>{const[r,l]=i.useState(!1),[t,c]=i.useState({email:"",password:"",userType:"teacher"}),[a,n]=i.useState(null),[x,d]=i.useState(!1),g=Z(),{authMode:s}=ce();i.useEffect(()=>{localStorage.removeItem("edutrack-user"),localStorage.removeItem("edutrack-session")},[]);const m=[{value:"teacher",label:"Enseignant",dashboard:"/teacher-dashboard"},{value:"student",label:"√âl√®ve",dashboard:"/student-dashboard"},{value:"parent",label:"Parent",dashboard:"/parent-dashboard"},{value:"secretary",label:"Secr√©taire",dashboard:"/secretary-dashboard"}],y=w=>{const{name:C,value:p}=w.target;c(N=>({...N,[C]:p})),n(null)},j=w=>{c(C=>({...C,userType:w})),n(null)},L=async w=>{var C,p,N,R,A,u,b,h;w.preventDefault(),l(!0),n(null);try{if(!t.email||!t.password)throw new Error("Veuillez remplir tous les champs");console.log("üîê Tentative de connexion...");const{data:f,error:M}=await q.from("users").select(`
          id,
          email,
          full_name,
          role,
          phone,
          current_school_id,
          is_active,
          school:schools!users_current_school_id_fkey(id, name)
        `).eq("email",t.email).eq("role",t.userType).single();if(M||!f){console.log("‚ÑπÔ∏è Utilisateur non trouv√© dans la base locale, tentative avec Auth...");const{data:P,error:v}=await q.auth.signInWithPassword({email:t.email,password:t.password});if(v)throw console.error("‚ùå Auth error:",v),new Error("Email ou mot de passe incorrect");if(!P.user)throw new Error("Aucune r√©ponse du serveur");console.log("‚úÖ Authentification r√©ussie via Auth:",P.user.email);const{data:D,error:B}=await q.from("users").select(`
            id,
            email,
            full_name,
            role,
            phone,
            current_school_id,
            is_active,
            school:schools!users_current_school_id_fkey(id, name)
          `).eq("id",P.user.id).single();if(B||!D||!D.is_active)throw new Error("Compte d√©sactiv√© ou donn√©es introuvables");if(D.role!==t.userType){const W=(C=m.find(z=>z.value===t.userType))==null?void 0:C.label,o=(p=m.find(z=>z.value===D.role))==null?void 0:p.label;throw new Error(`Ce compte n'est pas un compte ${W}. Il s'agit d'un compte ${o}`)}const $={id:D.id,email:D.email,full_name:D.full_name,role:D.role,phone:D.phone,current_school_id:D.current_school_id||((N=D.school)==null?void 0:N.id),school_name:((R=D.school)==null?void 0:R.name)||"√âcole",is_active:D.is_active,loginTime:new Date().toISOString(),sessionId:Math.random().toString(36).substr(2,9)};localStorage.setItem("edutrack-user",JSON.stringify($)),console.log("‚úÖ Session cr√©√©e via Auth");const Y=(A=m.find(W=>W.value===t.userType))==null?void 0:A.dashboard;g(Y);return}if(console.log("‚úÖ Utilisateur trouv√© dans la base locale:",f.email),!f.is_active)throw new Error("Compte d√©sactiv√©. Contactez votre administrateur.");console.log("‚ö†Ô∏è Connexion sans v√©rification de mot de passe (compte local)"),await q.from("users").update({last_login:new Date().toISOString(),updated_at:new Date().toISOString()}).eq("id",f.id);const k={id:f.id,email:f.email,full_name:f.full_name,role:f.role,phone:f.phone,current_school_id:f.current_school_id||((u=f.school)==null?void 0:u.id),school_name:((b=f.school)==null?void 0:b.name)||"√âcole",is_active:f.is_active,loginTime:new Date().toISOString(),sessionId:Math.random().toString(36).substr(2,9)},I=`edutrack-session-${f.role}`;localStorage.setItem(I,JSON.stringify(k)),console.log(`üíæ Session sauvegard√©e sous: ${I}`),localStorage.setItem("edutrack-user",JSON.stringify(k)),window.dispatchEvent(new CustomEvent("edutrack-user-changed",{detail:{user:k,role:f.role,sessionKey:I}})),console.log("üì¢ √âv√©nement edutrack-user-changed dispatch√© pour:",k.email,"- R√¥le:",f.role),console.log("‚úÖ Mode PRODUCTION (compte local):",k.school_name);const F=(h=m.find(P=>P.value===t.userType))==null?void 0:h.dashboard;g(F)}catch(f){console.error("‚ùå Login error:",f.message),n(f.message||"Une erreur est survenue lors de la connexion")}finally{l(!1)}};return e.jsxs("div",{className:"min-h-screen bg-background flex",children:[e.jsx("div",{className:"hidden lg:flex lg:w-1/2 bg-gradient-to-br from-secondary to-primary items-center justify-center p-12",children:e.jsxs("div",{className:"max-w-xl text-white",children:[e.jsx("img",{src:"/assets/images/mon_logo.png",alt:"Logo EduTrack CM",className:"w-20 h-20 object-contain rounded-2xl shadow-lg mb-8"}),e.jsx("h1",{className:"text-4xl font-heading font-heading-bold mb-6",children:"Espace Personnel"}),e.jsx("p",{className:"text-lg text-white/90 mb-8",children:"Acc√©dez √† votre espace personnel EduTrack CM. Connectez-vous pour consulter vos informations et g√©rer vos activit√©s."}),e.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white/10 rounded-lg p-4",children:[e.jsx(E,{name:"BookOpen",size:24,className:"mb-2"}),e.jsx("h3",{className:"font-heading font-heading-semibold mb-2",children:"Enseignants"}),e.jsx("p",{className:"text-sm text-white/80",children:"Gestion des cours et √©valuations"})]}),e.jsxs("div",{className:"bg-white/10 rounded-lg p-4",children:[e.jsx(E,{name:"Users",size:24,className:"mb-2"}),e.jsx("h3",{className:"font-heading font-heading-semibold mb-2",children:"√âl√®ves & Parents"}),e.jsx("p",{className:"text-sm text-white/80",children:"Suivi scolaire et communication"})]})]})]})}),e.jsx("div",{className:"w-full lg:w-1/2 flex items-center justify-center p-4 sm:p-8 lg:p-12 pt-20 sm:pt-8",children:e.jsxs("div",{className:"w-full max-w-md",children:[e.jsxs("div",{className:"text-center mb-6 sm:mb-8",children:[e.jsx("h2",{className:"text-xl sm:text-2xl font-heading font-heading-bold text-foreground mb-2",children:"Connexion Personnel"}),e.jsx("p",{className:"text-sm sm:text-base text-muted-foreground",children:"Acc√©dez √† votre espace de travail"})]}),e.jsx("div",{className:"bg-card rounded-lg border border-border p-6 shadow-card",children:e.jsxs("form",{onSubmit:L,className:"space-y-6",children:[e.jsx(ie,{label:"Type de compte",name:"userType",value:t.userType,onChange:j,options:m,required:!0}),e.jsx(K,{label:"Email",type:"email",name:"email",value:t.email,onChange:y,required:!0}),e.jsxs("div",{className:"relative",children:[e.jsx(K,{label:"Mot de passe",type:x?"text":"password",name:"password",value:t.password,onChange:y,required:!0}),e.jsx("button",{type:"button",onClick:()=>d(!x),className:"absolute right-3 top-[38px] text-gray-500 hover:text-gray-700 focus:outline-none",tabIndex:-1,children:e.jsx(E,{name:x?"EyeOff":"Eye",size:20})})]}),a&&e.jsxs("div",{className:"bg-error/10 text-error p-3 rounded-lg flex items-center gap-2",children:[e.jsx(E,{name:"AlertTriangle",size:16}),e.jsx("span",{className:"text-sm",children:a})]}),e.jsxs(G,{type:"submit",className:"w-full",loading:r,children:[e.jsx(E,{name:"LogIn",size:16,className:"mr-2"}),"Se connecter"]})]})}),e.jsx("div",{className:"text-center mt-6",children:e.jsxs(Q,{to:"/",className:"text-muted-foreground hover:text-primary text-sm inline-flex items-center gap-2",children:[e.jsx(E,{name:"ArrowLeft",size:16}),"Retour √† l'accueil"]})}),e.jsx("div",{className:"fixed top-4 right-4 z-50",children:e.jsxs(Q,{to:"/demo",className:"bg-secondary/10 hover:bg-secondary/20 text-secondary px-3 sm:px-4 py-1.5 sm:py-2 rounded-full font-body font-body-semibold inline-flex items-center gap-1 sm:gap-2 transition-colors text-xs sm:text-sm",children:[e.jsx(E,{name:"Laptop",size:14,className:"sm:w-4 sm:h-4"}),e.jsx("span",{className:"hidden xs:inline",children:"Acc√®s "}),"D√©mo"]})})]})})]})};function $e(){const r=Z(),[l,t]=i.useState(null),[c,a]=i.useState(!0);return i.useEffect(()=>{const n=async()=>{var d,g,s;try{console.log("üîç === DEBUT CONFIRMATION EMAIL ==="),console.log("URL compl√®te:",window.location.href),console.log("Hash:",window.location.hash);const m=new URLSearchParams(window.location.hash.substring(1)),y=new URLSearchParams(window.location.search),j=m.get("access_token")||y.get("access_token"),L=m.get("refresh_token")||y.get("refresh_token"),w=m.get("type")||y.get("type"),C=m.get("error_code")||y.get("error_code"),p=m.get("error_description")||y.get("error_description");if(console.log("Type:",w),console.log("Access token pr√©sent:",!!j),console.log("Error code:",C),C)throw new Error(p||"Erreur de confirmation");if(w==="signup"&&j){console.log("‚úÖ Type signup d√©tect√©, configuration de la session...");const{data:N,error:R}=await q.auth.setSession({access_token:j,refresh_token:L});if(R)throw R;console.log("‚úÖ Session √©tablie pour:",(d=N.user)==null?void 0:d.email),console.log("User ID:",(g=N.user)==null?void 0:g.id);const{data:A,error:u}=await q.from("users").select("role, full_name, current_school_id").eq("id",N.user.id).single();if(u){console.warn("‚ö†Ô∏è Impossible de r√©cup√©rer le r√¥le:",u);const b=((s=N.user.user_metadata)==null?void 0:s.role)||"student";x(b);return}console.log("‚úÖ Utilisateur trouv√©:",A.full_name,"- R√¥le:",A.role),x(A.role)}else console.error("‚ùå Type invalide ou token manquant"),t("Lien de confirmation invalide ou expir√©"),a(!1)}catch(m){console.error("‚ùå Erreur lors de la confirmation:",m),t(m.message||"Une erreur est survenue lors de la confirmation de votre compte"),a(!1)}},x=d=>{switch(console.log("üîÄ Redirection vers le dashboard:",d),d){case"principal":r("/principal-dashboard",{replace:!0});break;case"teacher":r("/teacher-dashboard",{replace:!0});break;case"student":r("/student-dashboard",{replace:!0});break;case"parent":r("/parent-dashboard",{replace:!0});break;case"secretary":r("/secretary-dashboard",{replace:!0});break;case"admin":r("/admin-dashboard",{replace:!0});break;default:r("/",{replace:!0})}};n()},[r]),c?e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-50 to-indigo-100",children:e.jsxs("div",{className:"text-center bg-white p-8 rounded-2xl shadow-xl",children:[e.jsx("div",{className:"mb-4",children:e.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-b-4 border-blue-600 mx-auto"})}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Confirmation en cours..."}),e.jsx("p",{className:"text-gray-600",children:"Nous confirmons votre adresse email et pr√©parons votre espace de travail"}),e.jsxs("div",{className:"mt-4 flex items-center justify-center space-x-2",children:[e.jsx("div",{className:"w-2 h-2 bg-blue-600 rounded-full animate-pulse"}),e.jsx("div",{className:"w-2 h-2 bg-blue-600 rounded-full animate-pulse delay-75"}),e.jsx("div",{className:"w-2 h-2 bg-blue-600 rounded-full animate-pulse delay-150"})]})]})}):l?e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-red-50 to-orange-100 p-4",children:e.jsx("div",{className:"max-w-md w-full bg-white shadow-2xl rounded-2xl p-8",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"mb-4",children:e.jsx("div",{className:"mx-auto flex items-center justify-center h-16 w-16 rounded-full bg-red-100",children:e.jsx("svg",{className:"h-8 w-8 text-red-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Erreur de Confirmation"}),e.jsx("p",{className:"text-gray-600 mb-6",children:l}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("a",{href:"/",className:"block w-full bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition-colors font-medium",children:"Retour √† l'accueil"}),e.jsxs("p",{className:"text-sm text-gray-500",children:["Si le probl√®me persiste, contactez le support √†"," ",e.jsx("a",{href:"mailto:pensezy.si@gmail.com",className:"text-blue-600 hover:underline",children:"pensezy.si@gmail.com"})]})]})]})})}):null}const We=i.lazy(()=>S(()=>import("./index-dz34yHOi.js"),__vite__mapDeps([2,3,4,0,1,5,6,7,8,9]))),Ke=i.lazy(()=>S(()=>import("./index-CTblOtNM.js"),__vite__mapDeps([10,3,4,0,1,5,9]))),He=i.lazy(()=>S(()=>import("./index-C4tejHYV.js"),__vite__mapDeps([11,3,4,0,1,5,6,12,13,14,9]))),Ze=i.lazy(()=>S(()=>import("./index-D1TgZptc.js"),__vite__mapDeps([15,3,4,0,1,5,16,17,18,9]))),Ye=i.lazy(()=>S(()=>import("./index-DSOPo4fZ.js"),__vite__mapDeps([19,0,1,3,4,20,18,9,5,16,17,21,7]))),Xe=i.lazy(()=>S(()=>import("./index-DrcxLO50.js"),__vite__mapDeps([22,3,4,0,1,5,8,9,12,13,14]))),Je=i.lazy(()=>S(()=>import("./index-Dki_v6h7.js"),__vite__mapDeps([23,3,4,0,1,5,8,9]))),Qe=i.lazy(()=>S(()=>import("./index-DCtv8idZ.js"),__vite__mapDeps([24,3,4,0,1,5,8,18,9]))),ea=i.lazy(()=>S(()=>import("./index-BOZ54uBi.js"),__vite__mapDeps([25,3,4,0,1,13,14,16,17,9]))),aa=i.lazy(()=>S(()=>import("./index-CDNnGPcc.js"),__vite__mapDeps([26,3,4,0,1,16,17,9]))),sa=i.lazy(()=>S(()=>import("./index-q5ZKIjRH.js"),__vite__mapDeps([27,3,4,0,1,20,18,9,5,16,17,21]))),ra=i.lazy(()=>S(()=>import("./index-SISvVwj9.js"),__vite__mapDeps([28,3,4,0,1,20,18,9,5,16,17]))),la=i.lazy(()=>S(()=>import("./index-k3-lMI8a.js"),__vite__mapDeps([29,3,4,0,1,20,18,9,5]))),ta=i.lazy(()=>S(()=>import("./index-BfWXvnGa.js"),__vite__mapDeps([30,3,4,0,1,20,18,9,5]))),oa=i.lazy(()=>S(()=>import("./index-Cwvoy5uW.js"),__vite__mapDeps([31,3,4,0,1,20,18,9,5]))),na=i.lazy(()=>S(()=>import("./index-CP1bFe0S.js"),__vite__mapDeps([32,3,4,0,1,20,18,9,5,16,17]))),ia=i.lazy(()=>S(()=>import("./index-C1h2SCqI.js"),__vite__mapDeps([33,0,1,3,4,17,7,9]))),ca=i.lazy(()=>S(()=>import("./HelpCenter-B7D_4yZ3.js"),__vite__mapDeps([34,3,4,0,1,9]))),da=i.lazy(()=>S(()=>import("./index-eBSYjkoc.js"),__vite__mapDeps([35,3,4,0,1,9]))),ua=i.lazy(()=>S(()=>import("./index-C8qAZeOG.js"),__vite__mapDeps([36,3,4,0,1,9]))),ma=i.lazy(()=>S(()=>import("./index-DGOL2uwh.js"),__vite__mapDeps([37,3,4,0,1,9]))),ha=()=>e.jsx(he,{children:e.jsxs(Ee,{children:[e.jsx(Se,{}),e.jsx(i.Suspense,{fallback:e.jsx(Ae,{}),children:e.jsxs(xe,{children:[e.jsx(_,{path:"/",element:e.jsx(te,{})}),e.jsx(_,{path:"/auth/callback",element:e.jsx($e,{})}),e.jsx(_,{path:"/staff-login",element:e.jsx(Ge,{})}),e.jsx(_,{path:"/school-management",element:e.jsx(te,{})}),e.jsx(_,{path:"/student-dashboard",element:e.jsx(We,{})}),e.jsx(_,{path:"/parent-dashboard",element:e.jsx(Ke,{})}),e.jsx(_,{path:"/teacher-dashboard",element:e.jsx(He,{})}),e.jsx(_,{path:"/admin-dashboard",element:e.jsx(Ze,{})}),e.jsx(_,{path:"/principal-dashboard",element:e.jsx(Ye,{})}),e.jsx(_,{path:"/secretary-dashboard",element:e.jsx(Xe,{})}),e.jsx(_,{path:"/student-profile-management",element:e.jsx(Je,{})}),e.jsx(_,{path:"/grade-management-system",element:e.jsx(Qe,{})}),e.jsx(_,{path:"/document-management-hub",element:e.jsx(ea,{})}),e.jsx(_,{path:"/document-management-center",element:e.jsx(aa,{})}),e.jsx(_,{path:"/notification-management",element:e.jsx(sa,{})}),e.jsx(_,{path:"/report-generation",element:e.jsx(ra,{})}),e.jsx(_,{path:"/staff-management",element:e.jsx(la,{})}),e.jsx(_,{path:"/school-settings",element:e.jsx(ta,{})}),e.jsx(_,{path:"/school-calendar",element:e.jsx(oa,{})}),e.jsx(_,{path:"/data-backup",element:e.jsx(na,{})}),e.jsx(_,{path:"/profile-settings",element:e.jsx(ia,{})}),e.jsx(_,{path:"/help",element:e.jsx(ca,{})}),e.jsx(_,{path:"/password-recovery",element:e.jsx(da,{})}),e.jsx(_,{path:"/password-reset",element:e.jsx(ua,{})}),e.jsx(_,{path:"/production-login",element:e.jsx(ma,{})}),e.jsx(_,{path:"*",element:e.jsx(qe,{})})]})})]})}),xa=({onComplete:r})=>{const l=i.useRef(null),t=5e3;i.useEffect(()=>{l.current&&l.current.play().catch(()=>{});const a=setTimeout(()=>{r()},t);return()=>{clearTimeout(a),l.current&&l.current.pause()}},[r]);const c=[{icon:"üë®‚Äçüíº",name:"Directeur",color:"#3b82f6",delay:"0.5s"},{icon:"üë®‚Äçüè´",name:"Enseignant",color:"#10b981",delay:"0.8s"},{icon:"üíº",name:"Secr√©taire",color:"#f59e0b",delay:"1.1s"},{icon:"üë®‚Äçüë©‚Äçüëß",name:"Parent",color:"#ec4899",delay:"1.4s"},{icon:"üéì",name:"√âl√®ve",color:"#8b5cf6",delay:"1.7s"},{icon:"üè¢",name:"Autres",color:"#6366f1",delay:"2s"}];return e.jsxs("div",{className:"welcome-animation-container",children:[e.jsx("div",{className:"particles-background",children:Array.from({length:15},(a,n)=>e.jsx("div",{className:"particle",style:{left:`${Math.random()*100}%`,top:`${Math.random()*100}%`,animationDelay:`${Math.random()*3}s`,animationDuration:`${4+Math.random()*3}s`}},n))}),e.jsxs("div",{className:"welcome-content",children:[e.jsxs("div",{className:"logo-container",children:[e.jsx("div",{className:"logo-circle",children:e.jsx("span",{className:"logo-icon",children:"üéì"})}),e.jsx("h1",{className:"logo-text",children:"EduTrack CM"}),e.jsx("p",{className:"logo-tagline",children:"Gestion Scolaire Intelligente"})]}),e.jsx("div",{className:"roles-container",children:c.map((a,n)=>e.jsxs("div",{className:"role-card",style:{"--role-color":a.color,animationDelay:a.delay},children:[e.jsx("span",{className:"role-icon",children:a.icon}),e.jsx("span",{className:"role-name",children:a.name})]},n))}),e.jsx("p",{className:"welcome-message",children:"Bienvenue sur votre plateforme de gestion √©ducative"})]}),e.jsx("div",{className:"progress-bar-container",children:e.jsx("div",{className:"progress-bar"})}),e.jsx("audio",{ref:l,muted:!0,children:e.jsx("source",{src:"data:audio/wav;base64,UklGRiQAAABXQVZFZm10IBAAAAABAAEARKwAAIhYAQACABAAZGF0YQAAAAA=",type:"audio/wav"})})]})};function ba(){const[r,l]=i.useState(!0),[t,c]=i.useState(!0);i.useEffect(()=>{sessionStorage.getItem("welcomeAnimationShown")&&(l(!1),c(!1))},[]);const a=()=>{sessionStorage.setItem("welcomeAnimationShown","true"),l(!1)};return e.jsxs(de,{children:[r&&t&&e.jsx(xa,{onComplete:a}),e.jsx(ha,{}),!1]})}const ga=document.getElementById("root"),pa=Ce.createRoot(ga);pa.render(e.jsx(ba,{}));export{G as B,E as I,ie as S,K as a,V as c};
//# sourceMappingURL=index-BPV3rumr.js.map
