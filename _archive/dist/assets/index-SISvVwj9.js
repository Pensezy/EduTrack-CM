import{j as e}from"./contexts-fbpOeTmm.js";import{r as m}from"./react-vendor-CFDIsUAY.js";import{H as G}from"./Helmet-B3bMicap.js";import{H as I,S as A}from"./Sidebar-Q0ML3SY6.js";import{I as l,B as p}from"./index-BPV3rumr.js";import{u as B}from"./useDashboardData-CL9BpvNP.js";import"./services-CdXttHtG.js";import"./supabase-CIvuJI4W.js";import"./charts-vendor-i33Lw0zL.js";import"./ui-vendor-BrXTGbgA.js";import"./productionDataService-T6uUAzM-.js";const W=()=>{var u,g,b,f,j,v,N,y,w;const[d,$]=m.useState(!1),[i,x]=m.useState(null),[r,k]=m.useState({period:"monthly",class:"all",subject:"all",format:"pdf"}),{isProduction:E,user:a}=B(),h=()=>{$(!d)},F=[{id:"academic",title:"Rapport Académique",description:"Performance des élèves par classe et matière",icon:"BookOpen",color:"bg-blue-500",fields:["period","class","subject"]},{id:"attendance",title:"Rapport de Présence",description:"Statistiques de présence des élèves",icon:"UserCheck",color:"bg-green-500",fields:["period","class"]},{id:"financial",title:"Rapport Financier",description:"État des paiements de scolarité",icon:"CreditCard",color:"bg-purple-500",fields:["period","class"]},{id:"teacher",title:"Rapport Enseignants",description:"Performance et évaluations du personnel",icon:"Users",color:"bg-orange-500",fields:["period"]},{id:"behavior",title:"Rapport Disciplinaire",description:"Incidents et comportements des élèves",icon:"Shield",color:"bg-red-500",fields:["period","class"]},{id:"overall",title:"Rapport Global",description:"Vue d'ensemble de l'établissement",icon:"BarChart3",color:"bg-indigo-500",fields:["period"]}],T=[{id:1,title:`Configuration ${((u=a==null?void 0:a.schoolData)==null?void 0:u.name)||"École"} - ${new Date().toLocaleDateString("fr-FR")}`,type:"overall",date:new Date().toISOString().split("T")[0],status:"ready",size:"1.2 MB"},{id:2,title:`Classes configurées - ${((g=a==null?void 0:a.schoolData)==null?void 0:g.type)||"Établissement"}`,type:"academic",date:new Date().toISOString().split("T")[0],status:"ready",size:"0.8 MB"},{id:3,title:"Rapport système - État opérationnel",type:"teacher",date:new Date().toISOString().split("T")[0],status:"ready",size:"0.5 MB"}],z=s=>{var o;x(s),console.log("Génération rapport:",s.title,"pour",(o=a==null?void 0:a.schoolData)==null?void 0:o.name),console.log("Filtres appliqués:",r),setTimeout(()=>{var S,R,D;const t={schoolName:((S=a==null?void 0:a.schoolData)==null?void 0:S.name)||"École",schoolType:((R=a==null?void 0:a.schoolData)==null?void 0:R.type)||"Établissement",classes:((D=a==null?void 0:a.schoolData)==null?void 0:D.available_classes)||[],reportType:s.title,generatedAt:new Date().toLocaleString("fr-FR"),format:r.format.toUpperCase()},P=new Blob([`RAPPORT: ${t.reportType}
`,`ÉCOLE: ${t.schoolName}
`,`TYPE: ${t.schoolType}
`,`CLASSES: ${t.classes.join(", ")}
`,`PÉRIODE: ${r.period}
`,`CLASSE SÉLECTIONNÉE: ${r.class}
`,`GÉNÉRÉ LE: ${t.generatedAt}
`,`
--- DONNÉES DU RAPPORT ---
`,`Ce fichier contiendrait les vraies données de votre école.
`,`En version complète, il inclurait:
`,`- Statistiques détaillées par classe
`,`- Graphiques et analyses
`,`- Données de performance
`,`- Recommandations personnalisées
`],{type:"text/plain"}),C=window.URL.createObjectURL(P),n=document.createElement("a");n.href=C,n.download=`${s.title.replace(/\s+/g,"_")}_${t.schoolName.replace(/\s+/g,"_")}_${new Date().toISOString().split("T")[0]}.txt`,document.body.appendChild(n),n.click(),document.body.removeChild(n),window.URL.revokeObjectURL(C),alert(`Rapport "${s.title}" généré avec succès !

Fichier téléchargé: ${n.download}
École: ${t.schoolName}
Format: ${t.format}`),x(null)},2500)},c=(s,o)=>{k(t=>({...t,[s]:o}))},O=s=>{switch(s){case"ready":return"CheckCircle";case"generating":return"Clock";case"error":return"XCircle";default:return"FileText"}},L=s=>{switch(s){case"ready":return"text-green-500";case"generating":return"text-yellow-500";case"error":return"text-red-500";default:return"text-gray-500"}};return e.jsxs(e.Fragment,{children:[e.jsxs(G,{children:[e.jsx("title",{children:"Génération de Rapports - EduTrack CM"}),e.jsx("meta",{name:"description",content:"Générer des rapports personnalisés pour l'école"})]}),e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx(I,{userRole:"principal",userName:((b=a==null?void 0:a.schoolData)==null?void 0:b.director_name)||((j=(f=a==null?void 0:a.schoolData)==null?void 0:f.users)==null?void 0:j.full_name)||(a==null?void 0:a.full_name)||((v=a==null?void 0:a.email)==null?void 0:v.split("@")[0])||"Directeur",isCollapsed:d,onToggleSidebar:h}),e.jsxs("div",{className:"flex pt-16",children:[e.jsx(A,{userRole:"principal",isCollapsed:d,onToggle:h}),e.jsxs("main",{className:`flex-1 transition-all duration-300 ${d?"lg:ml-20":"lg:ml-64"} p-6`,children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-10 h-10 bg-primary/10 rounded-lg flex items-center justify-center",children:e.jsx(l,{name:"FileBarChart",size:20,className:"text-primary"})}),e.jsx("h1",{className:"text-2xl font-heading font-heading-bold text-foreground",children:"Génération de Rapports"})]}),E&&e.jsxs("div",{className:"flex items-center space-x-2 bg-green-50 border border-green-200 rounded-lg px-3 py-2",children:[e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"}),e.jsx("span",{className:"text-sm font-medium text-green-700",children:"Mode réel"})]})]}),e.jsxs("p",{className:"text-muted-foreground",children:["Créer des rapports personnalisés pour ",((N=a==null?void 0:a.schoolData)==null?void 0:N.name)||"votre école"]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsx("div",{className:"lg:col-span-2",children:e.jsxs("div",{className:"bg-card border border-border rounded-lg p-6 shadow-card",children:[e.jsx("h2",{className:"text-lg font-heading font-heading-semibold text-card-foreground mb-6",children:"Types de Rapports"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:F.map(s=>e.jsxs("div",{className:"border border-border rounded-lg p-4 hover:border-primary transition-colors",children:[e.jsxs("div",{className:"flex items-start space-x-3 mb-4",children:[e.jsx("div",{className:`w-10 h-10 ${s.color} rounded-lg flex items-center justify-center`,children:e.jsx(l,{name:s.icon,size:20,className:"text-white"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-medium text-foreground mb-1",children:s.title}),e.jsx("p",{className:"text-sm text-muted-foreground",children:s.description})]})]}),e.jsx(p,{onClick:()=>z(s),className:"w-full",disabled:(i==null?void 0:i.id)===s.id,children:(i==null?void 0:i.id)===s.id?e.jsxs(e.Fragment,{children:[e.jsx(l,{name:"Loader2",size:16,className:"mr-2 animate-spin"}),"Génération..."]}):e.jsxs(e.Fragment,{children:[e.jsx(l,{name:"Download",size:16,className:"mr-2"}),"Générer"]})})]},s.id))})]})}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-card border border-border rounded-lg p-6 shadow-card",children:[e.jsx("h3",{className:"text-lg font-heading font-heading-semibold text-card-foreground mb-4",children:"Filtres"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-foreground mb-2",children:"Période"}),e.jsxs("select",{value:r.period,onChange:s=>c("period",s.target.value),className:"w-full p-2 border border-input bg-background rounded-md",children:[e.jsx("option",{value:"weekly",children:"Hebdomadaire"}),e.jsx("option",{value:"monthly",children:"Mensuel"}),e.jsx("option",{value:"quarterly",children:"Trimestriel"}),e.jsx("option",{value:"yearly",children:"Annuel"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-foreground mb-2",children:"Classe"}),e.jsxs("select",{value:r.class,onChange:s=>c("class",s.target.value),className:"w-full p-2 border border-input bg-background rounded-md",children:[e.jsx("option",{value:"all",children:"Toutes les classes"}),((w=(y=a==null?void 0:a.schoolData)==null?void 0:y.available_classes)==null?void 0:w.map((s,o)=>e.jsx("option",{value:s,children:s},o)))||e.jsx("option",{value:"none",children:"Aucune classe configurée"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-foreground mb-2",children:"Format"}),e.jsxs("select",{value:r.format,onChange:s=>c("format",s.target.value),className:"w-full p-2 border border-input bg-background rounded-md",children:[e.jsx("option",{value:"pdf",children:"PDF"}),e.jsx("option",{value:"excel",children:"Excel"}),e.jsx("option",{value:"csv",children:"CSV"})]})]})]})]}),e.jsxs("div",{className:"bg-card border border-border rounded-lg p-6 shadow-card",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-heading font-heading-semibold text-card-foreground",children:"Rapports Récents"}),e.jsx(p,{variant:"ghost",size:"sm",children:e.jsx(l,{name:"RefreshCw",size:14})})]}),e.jsx("div",{className:"space-y-3",children:T.map(s=>e.jsxs("div",{className:"p-3 border border-border rounded-lg hover:bg-muted/50 transition-colors",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("div",{className:"flex items-center space-x-2",children:e.jsx("h4",{className:"text-sm font-medium text-foreground",children:s.title})}),e.jsx("span",{className:`${L(s.status)}`,children:e.jsx(l,{name:O(s.status),size:16})})]}),e.jsxs("div",{className:"flex items-center justify-between text-xs text-muted-foreground",children:[e.jsx("span",{children:s.date}),s.status==="ready"&&e.jsxs(p,{variant:"ghost",size:"sm",children:[e.jsx(l,{name:"Download",size:12,className:"mr-1"}),s.size]})]})]},s.id))})]})]})]})]})]})]})]})};export{W as default};
//# sourceMappingURL=index-SISvVwj9.js.map
