import{j as e}from"./contexts-fbpOeTmm.js";import{e as E,i as I,r as l}from"./react-vendor-CFDIsUAY.js";import{I as r,a as g,B as d}from"./index-BPV3rumr.js";import"./services-CdXttHtG.js";import"./supabase-CIvuJI4W.js";import"./ui-vendor-BrXTGbgA.js";const $=()=>{const m=E(),[x]=I(),[c,o]=l.useState("loading"),[b,p]=l.useState(!1),[a,N]=l.useState({password:"",confirmPassword:""}),[i,u]=l.useState({}),[T,v]=l.useState(null),[f,w]=l.useState(null);l.useEffect(()=>{const t=x.get("token"),s=x.get("email");if(!t||!s){o("error");return}y(t,s)},[x]);const y=async(t,s)=>{try{await new Promise(n=>setTimeout(n,1e3)),v(t),w(s),o("reset")}catch(n){console.error("Token invalide:",n),o("error")}},j=t=>{const{name:s,value:n}=t.target;N(h=>({...h,[s]:n})),i[s]&&u(h=>({...h,[s]:""}))},z=t=>{const s={};return t.length<8?s.password="Le mot de passe doit contenir au moins 8 caractères":/(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[!@#$%^&*])/.test(t)||(s.password="Le mot de passe doit contenir au moins une majuscule, une minuscule, un chiffre et un caractère spécial"),s},C=async t=>{t.preventDefault();const s=z(a.password);if(a.password!==a.confirmPassword&&(s.confirmPassword="Les mots de passe ne correspondent pas"),Object.keys(s).length>0){u(s);return}p(!0);try{await new Promise(n=>setTimeout(n,2e3)),o("success")}catch(n){console.error("Erreur réinitialisation:",n),u({general:"Erreur lors de la réinitialisation. Veuillez réessayer."})}finally{p(!1)}},S=()=>e.jsx("div",{className:"max-w-md mx-auto",children:e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("div",{className:"w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Validation du lien"}),e.jsx("p",{className:"text-gray-600",children:"Vérification de votre demande de réinitialisation..."})]})}),L=()=>e.jsxs("div",{className:"max-w-md mx-auto",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(r,{name:"Key",size:24,className:"text-green-600"})}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Nouveau mot de passe"}),e.jsxs("p",{className:"text-gray-600",children:["Créez un nouveau mot de passe sécurisé pour ",e.jsx("strong",{children:f})]})]}),e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 shadow-sm p-6",children:[i.general&&e.jsxs("div",{className:"mb-6 p-4 bg-red-50 border border-red-200 rounded-lg flex items-start space-x-3",children:[e.jsx(r,{name:"AlertCircle",size:20,className:"text-red-600 mt-0.5"}),e.jsx("p",{className:"text-red-800",children:i.general})]}),e.jsxs("form",{onSubmit:C,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx(g,{label:"Nouveau mot de passe",type:"password",name:"password",value:a.password,onChange:j,placeholder:"••••••••••••",icon:"Lock",error:i.password}),e.jsxs("div",{className:"mt-2 text-xs text-gray-500",children:[e.jsx("p",{children:"Le mot de passe doit contenir :"}),e.jsxs("ul",{className:"mt-1 space-y-1",children:[e.jsx("li",{className:a.password.length>=8?"text-green-600":"text-gray-500",children:"• Au moins 8 caractères"}),e.jsx("li",{className:/(?=.*[a-z])/.test(a.password)?"text-green-600":"text-gray-500",children:"• Une lettre minuscule"}),e.jsx("li",{className:/(?=.*[A-Z])/.test(a.password)?"text-green-600":"text-gray-500",children:"• Une lettre majuscule"}),e.jsx("li",{className:/(?=.*\d)/.test(a.password)?"text-green-600":"text-gray-500",children:"• Un chiffre"}),e.jsx("li",{className:/(?=.*[!@#$%^&*])/.test(a.password)?"text-green-600":"text-gray-500",children:"• Un caractère spécial (!@#$%^&*)"})]})]})]}),e.jsx(g,{label:"Confirmer le mot de passe",type:"password",name:"confirmPassword",value:a.confirmPassword,onChange:j,placeholder:"••••••••••••",icon:"Lock",error:i.confirmPassword}),e.jsxs(d,{type:"submit",loading:b,className:"w-full bg-green-600 hover:bg-green-700",disabled:!a.password||!a.confirmPassword,children:[e.jsx(r,{name:"Check",size:16,className:"mr-2"}),"Confirmer le nouveau mot de passe"]})]})]})]}),k=()=>e.jsxs("div",{className:"max-w-md mx-auto",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(r,{name:"CheckCircle",size:24,className:"text-green-600"})}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Mot de passe mis à jour !"}),e.jsx("p",{className:"text-gray-600",children:"Votre mot de passe a été modifié avec succès"})]}),e.jsx("div",{className:"bg-white rounded-lg border border-gray-200 shadow-sm p-6",children:e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx(r,{name:"Shield",size:48,className:"text-green-600 mx-auto"}),e.jsx("p",{className:"text-gray-700",children:"Vous pouvez maintenant vous connecter avec votre nouveau mot de passe."}),e.jsxs(d,{onClick:()=>m("/production-login"),className:"w-full bg-blue-600 hover:bg-blue-700",children:[e.jsx(r,{name:"LogIn",size:16,className:"mr-2"}),"Se connecter maintenant"]})]})}),e.jsx("div",{className:"mt-6 bg-green-50 border border-green-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(r,{name:"Shield",size:20,className:"text-green-600 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-green-900",children:"Conseils de sécurité"}),e.jsxs("ul",{className:"text-sm text-green-700 mt-2 space-y-1",children:[e.jsx("li",{children:"• Ne partagez jamais votre mot de passe"}),e.jsx("li",{children:"• Changez-le régulièrement"}),e.jsx("li",{children:"• Utilisez un mot de passe unique pour ce compte"}),e.jsx("li",{children:"• Déconnectez-vous des postes partagés"})]})]})]})})]}),P=()=>e.jsxs("div",{className:"max-w-md mx-auto",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(r,{name:"XCircle",size:24,className:"text-red-600"})}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Lien invalide"}),e.jsx("p",{className:"text-gray-600",children:"Ce lien de réinitialisation n'est plus valide"})]}),e.jsx("div",{className:"bg-white rounded-lg border border-gray-200 shadow-sm p-6",children:e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx(r,{name:"AlertTriangle",size:48,className:"text-red-600 mx-auto"}),e.jsx("p",{className:"text-gray-700",children:"Le lien de réinitialisation peut avoir expiré ou déjà été utilisé."}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(d,{onClick:()=>m("/password-recovery"),className:"w-full bg-blue-600 hover:bg-blue-700",children:[e.jsx(r,{name:"RotateCcw",size:16,className:"mr-2"}),"Demander un nouveau lien"]}),e.jsxs(d,{onClick:()=>m("/production-login"),variant:"outline",className:"w-full",children:[e.jsx(r,{name:"ArrowLeft",size:16,className:"mr-2"}),"Retour à la connexion"]})]})]})}),e.jsx("div",{className:"mt-6 bg-blue-50 border border-blue-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(r,{name:"Clock",size:20,className:"text-blue-600 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-blue-900",children:"Pourquoi le lien est-il invalide ?"}),e.jsxs("ul",{className:"text-sm text-blue-700 mt-2 space-y-1",children:[e.jsx("li",{children:"• Le lien a expiré (valide 24h)"}),e.jsx("li",{children:"• Il a déjà été utilisé"}),e.jsx("li",{children:"• L'URL est incorrecte ou tronquée"}),e.jsx("li",{children:"• Une nouvelle demande a annulé ce lien"})]})]})]})})]});return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center p-4",children:e.jsxs("div",{className:"w-full max-w-lg",children:[c==="loading"&&S(),c==="reset"&&L(),c==="success"&&k(),c==="error"&&P()]})})};export{$ as default};
//# sourceMappingURL=index-C8qAZeOG.js.map
