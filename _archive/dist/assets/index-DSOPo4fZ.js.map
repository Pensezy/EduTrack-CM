{"version":3,"mappings":"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","names":["MetricCard","title","value","change","changeType","icon","description","trend","onClick","navigateTo","navigate","useNavigate","getChangeColor","getChangeIcon","getGradientColors","getIconBgColor","getProgressColor","handleClick","isClickable","jsxs","e","jsx","Icon","ClassAverageChart","selectedSubject","setSelectedSubject","useState","selectedGrade","setSelectedGrade","selectedPeriod","setSelectedPeriod","data","loadClassAverages","useDashboardData","availableClasses","useEffect","chartData","subjectOptions","uniqueLevels","classe","gradeOptions","level","periodOptions","getFilteredData","filteredData","item","_a","CustomTooltip","active","payload","label","_b","s","Button","Select","ResponsiveContainer","BarChart","CartesianGrid","XAxis","YAxis","Tooltip","Bar","AttendanceChart","selectedClass","setSelectedClass","loadAttendance","rawData","dataPoint","classOptions","getData","getDisplayLines","colors","lines","index","classKey","className","entry","LineChart","Legend","line","Line","PaymentStatusChart","viewType","setViewType","loadPayments","paymentData","emptyClassPaymentData","viewOptions","getFilteredClassData","renderLegend","props","PieChart","Pie","Cell","Fragment","QuickActions","activeAction","setActiveAction","user","quickActions","recentActivities","_c","getActivityIcon","type","_d","action","activity","SchoolSettings","loading","setLoading","saving","setSaving","customClassName","setCustomClassName","showCustomInput","setShowCustomInput","useAuth","schoolDataFromDatabase","schoolDataFromUser","finalSchoolData","getCurrentEmail","schoolData","setSchoolData","currentEmail","getAvailableClassesByType","prev","cls","schoolTypes","schoolType","handleInputChange","field","handleClassToggle","classLevel","handleAddCustomClass","handleRemoveCustomClass","handleSchoolTypeChange","newType","handleSave","resolve","error","getActiveClassesCount","getSchoolTypeLabel","t","getSchoolTypeDescription","Input","category","classItem","classInfo","c","SystemStatus","systemHealth","setSystemHealth","lastUpdate","setLastUpdate","activeTab","setActiveTab","interval","systemMetrics","securityAlerts","getStatusColor","status","getStatusBg","getStatusText","getAlertIcon","getAlertColor","formatTime","date","tabs","renderTabContent","metric","alert","tab","AccountsManagement","location","useLocation","searchTerm","setSearchTerm","selectedRole","setSelectedRole","selectedStatus","setSelectedStatus","showCreateForm","setShowCreateForm","showPassword","setShowPassword","authUser","setUser","userDataLoaded","setUserDataLoaded","userData","supabase","academicYearData","userWithSchool","err","subtabParam","accounts","setAccounts","loadingAccounts","setLoadingAccounts","newUser","setNewUser","setAvailableClasses","availableSubjects","setAvailableSubjects","availableStudents","setAvailableStudents","loadingReference","setLoadingReference","showAddSubject","setShowAddSubject","newSubjectName","setNewSubjectName","addingSubject","setAddingSubject","detectedLevel","determineSchoolLevel","accountStats","acc","filteredAccounts","account","matchesSearch","matchesRole","accountStatus","roleOptions","statusOptions","newUserRoleOptions","permissionsOptions","getDefaultSubjectsBySchoolType","subjectsByType","name","schoolError","dbClasses","classesError","dbClassesMap","formattedClasses","tempCount","realCount","defaultSubjects","customSubjects","allSubjectsMap","subject","allSubjects","parentsData","parentsError","formattedParents","parent","handleAddSubject","fetchError","updatedCustomSubjects","updateError","newSubject","handleResetPassword","accountId","accountName","accountEmail","generateSecurePassword","sendPasswordResetEmail","email","newPassword","handleResendCredentials","sendCredentialsReminder","handleUnlock","loadAccountsFromSupabase","handleCreateUser","cleanPhone","rolePrefix","nameParts","firstName","lastName","userId","newUserId","userError","teacherData","teacherError","teacherId","academicYearId","assignments","classId","subjectId","classData","subjectData","assignmentError","secretaryError","parentData","parentError","generatedMatricule","generateStudentMatricule","newStudentUserId","generatedEmail","generatedPassword","generateStudentEmail","generateStudentPassword","studentUserData","studentUserError","finalClassId","newClassData","newClassError","studentData","studentError","linkError","authData","authError","isEmailConfigured","recipientEmail","emailContent","hasPersonalEmail","selectedParent","p","getRoleLabel","emailResult","sendCredentialsEmail","successMessage","parentHasPersonalEmail","isParent","isTeacher","isSecretary","errorDetails","configMessage","fallbackMessage","errorMessage","role","schoolId","year","nextNumber","lastMatricule","matricule","schoolName","cleanSchoolName","classNameLower","keyword","teachersData","teachersError","secretariesData","secretariesError","studentsData","studentsError","allPersonnel","teacher","secretary","student","_e","_f","sortedPersonnel","a","b","handleDeactivateAccount","handleReactivateAccount","lowercase","uppercase","numbers","symbols","allChars","password","i","generatePassword","renderOverview","renderAccountsList","renderSecurity","renderCreateForm","count","isActive","subj","values","option","id","perm","opt","DatabaseDiagnosticService","tableUser","tableUserError","tableAccessTests","accessResults","test","userEmail","userMetadata","schools","results","DatabaseDiagnostic","diagnostic","setDiagnostic","repairing","setRepairing","runDiagnostic","result","repairPermissions","permissions","tableName","access","school","SchoolYearValidationTab","activeSection","setActiveSection","currentSchoolYear","nextSchoolYear","pendingRequests","setPendingRequests","validationStats","setValidationStats","showCreateModal","setShowCreateModal","newRequest","setNewRequest","productionDataService","requests","requestsError","stats","statsError","classTransitions","getStatusBadge","statusConfig","config","getPriorityBadge","priority","priorityConfig","handleApproveRequest","requestId","req","handleRejectRequest","notes","handleCreateRequest","sections","section","request","doc","PrincipalDashboard","isSidebarCollapsed","setIsSidebarCollapsed","currentTime","setCurrentTime","showMobileMenu","setShowMobileMenu","diagnosticClickCount","setDiagnosticClickCount","saved","diagnosticModeEnabled","setDiagnosticModeEnabled","showDiagnosticToast","setShowDiagnosticToast","newClassName","setNewClassName","addingClass","setAddingClass","classError","setClassError","classSuccess","setClassSuccess","principalUser","useRoleSession","refresh","currentUser","schoolDataFromState","tabParam","timer","handleClickOutside","event","toggleSidebar","handleTabChange","tabId","handleDiagnosticClick","newCount","keyMetrics","tabOptions","handleAddClass","classNameTrimmed","currentClasses","__vitePreload","supabase2","n","updatedClasses","yearError","nameLower","handleRemoveClass","suggestions","levelDescription","availableSuggestions","suggestion","m","Helmet","Header","Sidebar","_h","_g","_i","getTabBadge","hasAlert"],"ignoreList":[],"sources":["../../src/pages/principal-dashboard/components/MetricCard.jsx","../../src/pages/principal-dashboard/components/ClassAverageChart.jsx","../../src/pages/principal-dashboard/components/AttendanceChart.jsx","../../src/pages/principal-dashboard/components/PaymentStatusChart.jsx","../../src/pages/principal-dashboard/components/QuickActions.jsx","../../src/pages/principal-dashboard/components/SchoolSettings.jsx","../../src/pages/principal-dashboard/components/SystemStatus.jsx","../../src/pages/principal-dashboard/components/AccountsManagement.jsx","../../src/services/databaseDiagnosticService.js","../../src/pages/principal-dashboard/components/DatabaseDiagnostic.jsx","../../src/pages/principal-dashboard/components/SchoolYearValidationTab.jsx","../../src/pages/principal-dashboard/index.jsx"],"sourcesContent":["import React from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport Icon from '../../../components/AppIcon';\r\n\r\nconst MetricCard = ({ title, value, change, changeType, icon, description, trend, onClick, navigateTo }) => {\r\n  const navigate = useNavigate();\r\n  const getChangeColor = () => {\r\n    if (changeType === 'positive') return 'text-green-600';\r\n    if (changeType === 'negative') return 'text-red-600';\r\n    return 'text-gray-600';\r\n  };\r\n\r\n  const getChangeIcon = () => {\r\n    if (changeType === 'positive') return 'TrendingUp';\r\n    if (changeType === 'negative') return 'TrendingDown';\r\n    return 'Minus';\r\n  };\r\n\r\n  const getGradientColors = () => {\r\n    if (changeType === 'positive') return 'from-green-50 to-emerald-50 border-green-200';\r\n    if (changeType === 'negative') return 'from-red-50 to-pink-50 border-red-200';\r\n    return 'from-blue-50 to-indigo-50 border-blue-200';\r\n  };\r\n\r\n  const getIconBgColor = () => {\r\n    if (changeType === 'positive') return 'from-green-600 to-emerald-600';\r\n    if (changeType === 'negative') return 'from-red-600 to-pink-600';\r\n    return 'from-blue-600 to-indigo-600';\r\n  };\r\n\r\n  const getProgressColor = () => {\r\n    if (changeType === 'positive') return 'bg-gradient-to-r from-green-500 to-emerald-500';\r\n    if (changeType === 'negative') return 'bg-gradient-to-r from-red-500 to-pink-500';\r\n    return 'bg-gradient-to-r from-blue-500 to-indigo-500';\r\n  };\r\n\r\n  const handleClick = () => {\r\n    if (onClick) {\r\n      onClick();\r\n    } else if (navigateTo) {\r\n      navigate(navigateTo);\r\n    }\r\n  };\r\n\r\n  const isClickable = onClick || navigateTo;\r\n\r\n  return (\r\n    <div\r\n      className={`group bg-gradient-to-br ${getGradientColors()} border-2 rounded-2xl p-4 sm:p-5 shadow-lg hover:shadow-2xl transition-all duration-300 ${isClickable ? 'cursor-pointer hover:scale-105 active:scale-100' : ''}`}\r\n      onClick={isClickable ? handleClick : undefined}\r\n      role={isClickable ? 'button' : undefined}\r\n      tabIndex={isClickable ? 0 : undefined}\r\n      onKeyPress={isClickable ? (e) => e.key === 'Enter' && handleClick() : undefined}\r\n    >\r\n      <div className=\"flex items-start justify-between mb-3 sm:mb-4\">\r\n        <div className=\"flex items-center space-x-2 sm:space-x-3 flex-1 min-w-0\">\r\n          <div className={`w-10 h-10 sm:w-12 sm:h-12 bg-gradient-to-br ${getIconBgColor()} rounded-xl flex items-center justify-center shadow-md group-hover:scale-110 transition-transform flex-shrink-0`}>\r\n            <Icon name={icon} size={20} className=\"text-white sm:w-6 sm:h-6\" />\r\n          </div>\r\n          <div className=\"flex-1 min-w-0\">\r\n            <h3 className=\"font-heading font-heading-bold text-xs sm:text-sm text-gray-900 mb-0.5 truncate\">\r\n              {title}\r\n            </h3>\r\n            {description && (\r\n              <p className=\"font-caption font-caption-normal text-[10px] sm:text-xs text-gray-600 truncate\">\r\n                {description}\r\n              </p>\r\n            )}\r\n          </div>\r\n        </div>\r\n        {change && (\r\n          <div className={`flex items-center space-x-1 px-2 py-1 rounded-full bg-white/60 backdrop-blur-sm ${getChangeColor()} flex-shrink-0`}>\r\n            <Icon name={getChangeIcon()} size={14} />\r\n            <span className=\"font-caption font-caption-bold text-xs\">\r\n              {Math.abs(change)}%\r\n            </span>\r\n          </div>\r\n        )}\r\n      </div>\r\n      \r\n      <div className=\"space-y-2 sm:space-y-3\">\r\n        <div className=\"flex items-baseline justify-between\">\r\n          <span className=\"font-heading font-heading-bold text-2xl sm:text-3xl text-gray-900\">\r\n            {value}\r\n          </span>\r\n          {isClickable && (\r\n            <Icon name=\"ChevronRight\" size={16} className=\"text-gray-400 group-hover:text-gray-600 transition-colors sm:hidden\" />\r\n          )}\r\n        </div>\r\n        {trend !== undefined && (\r\n          <div className=\"w-full bg-white/50 rounded-full h-2 overflow-hidden shadow-inner\">\r\n            <div \r\n              className={`h-2 rounded-full transition-all duration-1000 ${getProgressColor()}`}\r\n              style={{ width: `${Math.min(100, Math.max(0, trend))}%` }}\r\n            />\r\n          </div>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default MetricCard;","import React, { useState, useEffect } from 'react';\nimport { BarChart, Bar, XAxis, YAxis, CartesianGrid, Tooltip, ResponsiveContainer } from 'recharts';\nimport Icon from '../../../components/AppIcon';\nimport Button from '../../../components/ui/Button';\nimport Select from '../../../components/ui/Select';\nimport useDashboardData from '../../../hooks/useDashboardData';\n\nconst ClassAverageChart = () => {\n  const [selectedSubject, setSelectedSubject] = useState('all');\n  const [selectedGrade, setSelectedGrade] = useState('all');\n  const [selectedPeriod, setSelectedPeriod] = useState('current');\n  \n  // Hook pour les donnes avec switch automatique dmo/production\n  const { data, loading, loadClassAverages } = useDashboardData();\n\n  // Rcuprer les classes dynamiquement\n  const availableClasses = data.classes || [];\n\n  // Recharger les donnes quand les filtres changent\n  useEffect(() => {\n    loadClassAverages({\n      subject: selectedSubject,\n      grade: selectedGrade,\n      period: selectedPeriod\n    });\n  }, [selectedSubject, selectedGrade, selectedPeriod]);\n\n  // Utiliser les donnes du hook\n  const chartData = data.classAverages || [];\n\n  const subjectOptions = [\n    { value: 'all', label: 'Toutes les matires' },\n    { value: 'mathematics', label: 'Mathmatiques' },\n    { value: 'french', label: 'Franais' },\n    { value: 'science', label: 'Sciences' },\n    { value: 'history', label: 'Histoire' }\n  ];\n\n  // Gnrer dynamiquement les options de niveaux selon les classes relles\n  // Ddupliquer les niveaux pour viter les cls en double\n  const uniqueLevels = [...new Set(availableClasses.map(classe => classe.level || classe.name))];\n  const gradeOptions = [\n    { value: 'all', label: 'Tous les niveaux' },\n    ...uniqueLevels.map(level => ({\n      value: level,\n      label: level\n    }))\n  ];\n\n  const periodOptions = [\n    { value: 'current', label: 'Trimestre actuel' },\n    { value: 'previous', label: 'Trimestre prcdent' },\n    { value: 'year', label: 'Anne scolaire' }\n  ];\n\n  const getFilteredData = () => {\n    let filteredData = chartData;\n    \n    if (selectedGrade !== 'all') {\n      filteredData = filteredData?.filter(item => item?.class?.includes(selectedGrade + 'me'));\n    }\n    \n    return filteredData?.map(item => ({\n      ...item,\n      displayValue: selectedSubject === 'all' ? item?.average : item?.[selectedSubject]\n    }));\n  };\n\n  const CustomTooltip = ({ active, payload, label }) => {\n    if (active && payload && payload?.length) {\n      const data = payload?.[0]?.payload;\n      return (\n        <div className=\"bg-popover border border-border rounded-lg p-3 shadow-modal\">\n          <p className=\"font-heading font-heading-semibold text-sm text-popover-foreground mb-2\">\n            {label}\n          </p>\n          {selectedSubject === 'all' ? (\n            <div className=\"space-y-1\">\n              <p className=\"font-body font-body-normal text-sm text-muted-foreground\">\n                Mathmatiques: <span className=\"text-popover-foreground font-body-semibold\">{data?.mathematics}/100</span>\n              </p>\n              <p className=\"font-body font-body-normal text-sm text-muted-foreground\">\n                Franais: <span className=\"text-popover-foreground font-body-semibold\">{data?.french}/100</span>\n              </p>\n              <p className=\"font-body font-body-normal text-sm text-muted-foreground\">\n                Sciences: <span className=\"text-popover-foreground font-body-semibold\">{data?.science}/100</span>\n              </p>\n              <p className=\"font-body font-body-normal text-sm text-muted-foreground\">\n                Histoire: <span className=\"text-popover-foreground font-body-semibold\">{data?.history}/100</span>\n              </p>\n              <div className=\"border-t border-border pt-1 mt-2\">\n                <p className=\"font-body font-body-semibold text-sm text-popover-foreground\">\n                  Moyenne: {data?.average}/100\n                </p>\n              </div>\n            </div>\n          ) : (\n            <p className=\"font-body font-body-semibold text-sm text-popover-foreground\">\n              {subjectOptions?.find(s => s?.value === selectedSubject)?.label}: {data?.[selectedSubject]}/100\n            </p>\n          )}\n        </div>\n      );\n    }\n    return null;\n  };\n\n  return (\n    <div className=\"bg-card border border-border rounded-lg p-6 shadow-card\">\n      <div className=\"flex items-center justify-between mb-6\">\n        <div className=\"flex items-center space-x-3\">\n          <div className=\"w-10 h-10 bg-primary/10 rounded-lg flex items-center justify-center\">\n            <Icon name=\"BarChart3\" size={20} className=\"text-primary\" />\n          </div>\n          <div>\n            <h2 className=\"font-heading font-heading-semibold text-lg text-card-foreground\">\n              Moyennes par classe\n            </h2>\n            <p className=\"font-caption font-caption-normal text-sm text-muted-foreground\">\n              Performance acadmique dtaille\n            </p>\n          </div>\n        </div>\n        <div className=\"flex items-center space-x-2\">\n          <Button variant=\"ghost\" size=\"icon\">\n            <Icon name=\"Download\" size={16} />\n          </Button>\n          <Button variant=\"ghost\" size=\"icon\">\n            <Icon name=\"RefreshCw\" size={16} />\n          </Button>\n        </div>\n      </div>\n      <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6\">\n        <Select\n          label=\"Matire\"\n          options={subjectOptions}\n          value={selectedSubject}\n          onChange={setSelectedSubject}\n        />\n        <Select\n          label=\"Niveau\"\n          options={gradeOptions}\n          value={selectedGrade}\n          onChange={setSelectedGrade}\n        />\n        <Select\n          label=\"Priode\"\n          options={periodOptions}\n          value={selectedPeriod}\n          onChange={setSelectedPeriod}\n        />\n      </div>\n      <div className=\"w-full h-80\" aria-label=\"Graphique des moyennes par classe\">\n        <ResponsiveContainer width=\"100%\" height=\"100%\">\n          <BarChart data={getFilteredData()} margin={{ top: 20, right: 30, left: 20, bottom: 5 }}>\n            <CartesianGrid strokeDasharray=\"3 3\" stroke=\"var(--color-border)\" />\n            <XAxis \n              dataKey=\"class\" \n              stroke=\"var(--color-text-secondary)\"\n              fontSize={12}\n              fontFamily=\"Inter, sans-serif\"\n            />\n            <YAxis \n              stroke=\"var(--color-text-secondary)\"\n              fontSize={12}\n              fontFamily=\"Inter, sans-serif\"\n              domain={[0, 100]}\n            />\n            <Tooltip content={<CustomTooltip />} />\n            <Bar \n              dataKey=\"displayValue\" \n              fill=\"var(--color-primary)\"\n              radius={[4, 4, 0, 0]}\n              name={selectedSubject === 'all' ? 'Moyenne gnrale' : subjectOptions?.find(s => s?.value === selectedSubject)?.label}\n            />\n          </BarChart>\n        </ResponsiveContainer>\n      </div>\n      <div className=\"flex items-center justify-between mt-4 pt-4 border-t border-border\">\n        <div className=\"flex items-center space-x-4\">\n          <div className=\"flex items-center space-x-2\">\n            <div className=\"w-3 h-3 bg-primary rounded-sm\" />\n            <span className=\"font-caption font-caption-normal text-xs text-muted-foreground\">\n              {selectedSubject === 'all' ? 'Moyenne gnrale' : subjectOptions?.find(s => s?.value === selectedSubject)?.label}\n            </span>\n          </div>\n        </div>\n        <p className=\"font-caption font-caption-normal text-xs text-muted-foreground\">\n          Dernire mise  jour: {new Date().toLocaleDateString('fr-FR')} {new Date().toLocaleTimeString('fr-FR', { hour: '2-digit', minute: '2-digit' })}\n        </p>\n      </div>\n    </div>\n  );\n};\n\nexport default ClassAverageChart;","import React, { useState, useEffect } from 'react';\nimport { LineChart, Line, XAxis, YAxis, CartesianGrid, Tooltip, ResponsiveContainer, Legend } from 'recharts';\nimport Icon from '../../../components/AppIcon';\nimport Button from '../../../components/ui/Button';\nimport Select from '../../../components/ui/Select';\nimport useDashboardData from '../../../hooks/useDashboardData';\n\nconst AttendanceChart = () => {\n  const [selectedClass, setSelectedClass] = useState('all');\n  const [selectedPeriod, setSelectedPeriod] = useState('week');\n\n  // Hook pour charger les donnes\n  const { data, loading, loadAttendance } = useDashboardData();\n\n  // Rcuprer les classes dynamiquement\n  const availableClasses = data.classes || [];\n\n  // Recharger les donnes quand la priode change\n  useEffect(() => {\n    loadAttendance(selectedPeriod);\n  }, [selectedPeriod]);\n\n  // Convertir les donnes du hook au format graphique\n  const convertAttendanceData = (rawData) => {\n    if (!rawData || rawData.length === 0) return [];\n\n    // Donnes relles avec classes dynamiques\n    const dataPoint = {\n      period: rawData[0]?.day || `Jour 1`,\n      overall: 0\n    };\n\n    // Ajouter dynamiquement les classes relles de l'cole\n    availableClasses.forEach(classe => {\n      dataPoint[classe.name || classe.level] = 0; // Taux de prsence  0 par dfaut\n    });\n\n    return [dataPoint];\n  };\n\n  const chartData = convertAttendanceData(data.attendance || []);\n\n  // Gnrer dynamiquement les options de classes\n  const classOptions = [\n    { value: 'all', label: 'Toutes les classes' },\n    ...availableClasses.map(classe => ({\n      value: classe.name || classe.level,\n      label: classe.name || `${classe.level}${classe.section ? ' ' + classe.section : ''}`\n    }))\n  ];\n\n  const periodOptions = [\n    { value: 'week', label: 'Cette semaine' },\n    { value: 'month', label: 'Ce mois' },\n    { value: 'term', label: 'Ce trimestre' }\n  ];\n\n  const getData = () => {\n    return chartData;\n  };\n\n  const getDisplayLines = () => {\n    const colors = ['var(--color-success)', 'var(--color-warning)', 'var(--color-accent)', 'var(--color-secondary)', 'var(--color-info)'];\n\n    if (selectedClass === 'all') {\n      const lines = [\n        { key: 'overall', color: 'var(--color-primary)', name: 'Moyenne gnrale' }\n      ];\n\n      // Ajouter dynamiquement les lignes pour chaque classe relle\n      availableClasses.forEach((classe, index) => {\n        const classKey = classe.name || classe.level;\n        const className = classe.name || `${classe.level}${classe.section ? ' ' + classe.section : ''}`;\n        lines.push({\n          key: classKey,\n          color: colors[index % colors.length],\n          name: className\n        });\n      });\n\n      return lines;\n    } else {\n      return [\n        { key: selectedClass, color: 'var(--color-primary)', name: selectedClass },\n        { key: 'overall', color: 'var(--color-muted-foreground)', name: 'Moyenne cole' }\n      ];\n    }\n  };\n\n  const CustomTooltip = ({ active, payload, label }) => {\n    if (active && payload && payload?.length) {\n      return (\n        <div className=\"bg-popover border border-border rounded-lg p-3 shadow-modal\">\n          <p className=\"font-heading font-heading-semibold text-sm text-popover-foreground mb-2\">\n            {label}\n          </p>\n          <div className=\"space-y-1\">\n            {payload?.map((entry, index) => (\n              <p key={index} className=\"font-body font-body-normal text-sm text-muted-foreground\">\n                <span style={{ color: entry?.color }}></span> {entry?.name}: {entry?.value}%\n              </p>\n            ))}\n          </div>\n        </div>\n      );\n    }\n    return null;\n  };\n\n  return (\n    <div className=\"bg-card border border-border rounded-lg p-6 shadow-card\">\n      <div className=\"flex items-center justify-between mb-6\">\n        <div className=\"flex items-center space-x-3\">\n          <div className=\"w-10 h-10 bg-success/10 rounded-lg flex items-center justify-center\">\n            <Icon name=\"Users\" size={20} className=\"text-success\" />\n          </div>\n          <div>\n            <h2 className=\"font-heading font-heading-semibold text-lg text-card-foreground\">\n              Taux de prsence\n            </h2>\n            <p className=\"font-caption font-caption-normal text-sm text-muted-foreground\">\n              Suivi de l'assiduit par niveau\n            </p>\n          </div>\n        </div>\n        <div className=\"flex items-center space-x-2\">\n          <Button variant=\"ghost\" size=\"icon\">\n            <Icon name=\"Download\" size={16} />\n          </Button>\n          <Button variant=\"ghost\" size=\"icon\">\n            <Icon name=\"RefreshCw\" size={16} />\n          </Button>\n        </div>\n      </div>\n      <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4 mb-6\">\n        <Select\n          label=\"Classe\"\n          options={classOptions}\n          value={selectedClass}\n          onChange={setSelectedClass}\n        />\n        <Select\n          label=\"Priode\"\n          options={periodOptions}\n          value={selectedPeriod}\n          onChange={setSelectedPeriod}\n        />\n      </div>\n      <div className=\"w-full h-80\" aria-label=\"Graphique du taux de prsence\">\n        <ResponsiveContainer width=\"100%\" height=\"100%\">\n          <LineChart data={getData()} margin={{ top: 20, right: 30, left: 20, bottom: 5 }}>\n            <CartesianGrid strokeDasharray=\"3 3\" stroke=\"var(--color-border)\" />\n            <XAxis\n              dataKey=\"period\"\n              stroke=\"var(--color-text-secondary)\"\n              fontSize={12}\n              fontFamily=\"Inter, sans-serif\"\n            />\n            <YAxis\n              stroke=\"var(--color-text-secondary)\"\n              fontSize={12}\n              fontFamily=\"Inter, sans-serif\"\n              domain={[80, 100]}\n            />\n            <Tooltip content={<CustomTooltip />} />\n            <Legend\n              wrapperStyle={{\n                fontSize: '12px',\n                fontFamily: 'Inter, sans-serif',\n                color: 'var(--color-text-secondary)'\n              }}\n            />\n            {getDisplayLines()?.map((line) => (\n              <Line\n                key={line?.key}\n                type=\"monotone\"\n                dataKey={line?.key}\n                stroke={line?.color}\n                strokeWidth={2}\n                dot={{ fill: line?.color, strokeWidth: 2, r: 4 }}\n                activeDot={{ r: 6, stroke: line?.color, strokeWidth: 2 }}\n                name={line?.name}\n              />\n            ))}\n          </LineChart>\n        </ResponsiveContainer>\n      </div>\n      <div className=\"flex items-center justify-between mt-4 pt-4 border-t border-border\">\n        <div className=\"flex items-center space-x-2\">\n          <Icon name=\"Info\" size={14} className=\"text-muted-foreground\" />\n          <span className=\"font-caption font-caption-normal text-xs text-muted-foreground\">\n            Aucune donne d'assiduit disponible\n          </span>\n        </div>\n        <p className=\"font-caption font-caption-normal text-xs text-muted-foreground\">\n          Dernire mise  jour: {new Date().toLocaleDateString('fr-FR')} {new Date().toLocaleTimeString('fr-FR', { hour: '2-digit', minute: '2-digit' })}\n        </p>\n      </div>\n    </div>\n  );\n};\n\nexport default AttendanceChart;\n","import React, { useState, useEffect } from 'react';\nimport { PieChart, Pie, Cell, ResponsiveContainer, Tooltip, Legend, BarChart, Bar, XAxis, YAxis, CartesianGrid } from 'recharts';\nimport Icon from '../../../components/AppIcon';\nimport Button from '../../../components/ui/Button';\nimport Select from '../../../components/ui/Select';\nimport useDashboardData from '../../../hooks/useDashboardData';\n\nconst PaymentStatusChart = () => {\n  const [selectedClass, setSelectedClass] = useState('all');\n  const [selectedPeriod, setSelectedPeriod] = useState('current');\n  const [viewType, setViewType] = useState('pie');\n  \n  // Hook pour les donnes avec switch automatique dmo/production\n  const { data, loading, loadPayments } = useDashboardData();\n\n  // Rcuprer les classes dynamiquement\n  const availableClasses = data.classes || [];\n\n  // Recharger les donnes quand ncessaire\n  useEffect(() => {\n    loadPayments();\n  }, [selectedClass, selectedPeriod]);\n\n  // Convertir les donnes pour le format attendu par le graphique\n  const convertPaymentData = (rawData) => {\n    if (!rawData || rawData.length === 0) return [];\n    \n    return rawData.map(item => ({\n      name: item.status,\n      value: item.count,\n      percentage: item.percentage,\n      color: item.color\n    }));\n  };\n\n  const paymentData = convertPaymentData(data.payments || []);\n\n\n  // Gnrer dynamiquement les donnes vides selon les classes relles\n  const emptyClassPaymentData = availableClasses.length > 0 \n    ? availableClasses.map(classe => ({\n        class: classe.name || `${classe.level}${classe.section ? ' ' + classe.section : ''}`,\n        paid: 0,\n        late: 0,\n        unpaid: 0,\n        total: 0,\n        rate: 0\n      }))\n    : [{ class: 'Aucune classe', paid: 0, late: 0, unpaid: 0, total: 0, rate: 0 }];\n\n  // Gnrer dynamiquement les options de classes\n  const classOptions = [\n    { value: 'all', label: 'Toutes les classes' },\n    ...availableClasses.map(classe => ({\n      value: classe.name || classe.level,\n      label: classe.name || `${classe.level}${classe.section ? ' ' + classe.section : ''}`\n    }))\n  ];\n\n  const periodOptions = [\n    { value: 'current', label: 'Trimestre actuel' },\n    { value: 'previous', label: 'Trimestre prcdent' },\n    { value: 'year', label: 'Anne scolaire' }\n  ];\n\n  const viewOptions = [\n    { value: 'pie', label: 'Vue circulaire' },\n    { value: 'bar', label: 'Vue par classe' }\n  ];\n\n  const getFilteredClassData = () => {\n    // Return empty class payment data (no demo data)\n    return emptyClassPaymentData;\n  };\n\n  const CustomTooltip = ({ active, payload, label }) => {\n    if (active && payload && payload?.length) {\n      if (viewType === 'pie') {\n        const data = payload?.[0];\n        return (\n          <div className=\"bg-popover border border-border rounded-lg p-3 shadow-modal\">\n            <p className=\"font-heading font-heading-semibold text-sm text-popover-foreground mb-1\">\n              {data?.name}\n            </p>\n            <p className=\"font-body font-body-normal text-sm text-muted-foreground\">\n              Nombre: <span className=\"text-popover-foreground font-body-semibold\">{data?.value}</span>\n            </p>\n            <p className=\"font-body font-body-normal text-sm text-muted-foreground\">\n              Pourcentage: <span className=\"text-popover-foreground font-body-semibold\">{data?.payload?.percentage}%</span>\n            </p>\n          </div>\n        );\n      } else {\n        const data = payload?.[0]?.payload;\n        return (\n          <div className=\"bg-popover border border-border rounded-lg p-3 shadow-modal\">\n            <p className=\"font-heading font-heading-semibold text-sm text-popover-foreground mb-2\">\n              {label}\n            </p>\n            <div className=\"space-y-1\">\n              <p className=\"font-body font-body-normal text-sm text-muted-foreground\">\n                Pay: <span className=\"text-success font-body-semibold\">{data?.paid}</span>\n              </p>\n              <p className=\"font-body font-body-normal text-sm text-muted-foreground\">\n                En retard: <span className=\"text-warning font-body-semibold\">{data?.late}</span>\n              </p>\n              <p className=\"font-body font-body-normal text-sm text-muted-foreground\">\n                Impay: <span className=\"text-error font-body-semibold\">{data?.unpaid}</span>\n              </p>\n              <div className=\"border-t border-border pt-1 mt-2\">\n                <p className=\"font-body font-body-semibold text-sm text-popover-foreground\">\n                  Taux de paiement: {data?.rate}%\n                </p>\n              </div>\n            </div>\n          </div>\n        );\n      }\n    }\n    return null;\n  };\n\n  const renderLegend = (props) => {\n    const { payload } = props;\n    return (\n      <div className=\"flex justify-center space-x-6 mt-4\">\n        {payload?.map((entry, index) => (\n          <div key={index} className=\"flex items-center space-x-2\">\n            <div \n              className=\"w-3 h-3 rounded-sm\" \n              style={{ backgroundColor: entry?.color }}\n            />\n            <span className=\"font-caption font-caption-normal text-xs text-muted-foreground\">\n              {entry?.value}\n            </span>\n          </div>\n        ))}\n      </div>\n    );\n  };\n\n  return (\n    <div className=\"bg-card border border-border rounded-lg p-6 shadow-card\">\n      <div className=\"flex items-center justify-between mb-6\">\n        <div className=\"flex items-center space-x-3\">\n          <div className=\"w-10 h-10 bg-warning/10 rounded-lg flex items-center justify-center\">\n            <Icon name=\"CreditCard\" size={20} className=\"text-warning\" />\n          </div>\n          <div>\n            <h2 className=\"font-heading font-heading-semibold text-lg text-card-foreground\">\n              Statut des paiements\n            </h2>\n            <p className=\"font-caption font-caption-normal text-sm text-muted-foreground\">\n              Suivi des frais de scolarit\n            </p>\n          </div>\n        </div>\n        <div className=\"flex items-center space-x-2\">\n          <Button variant=\"ghost\" size=\"icon\">\n            <Icon name=\"Download\" size={16} />\n          </Button>\n          <Button variant=\"ghost\" size=\"icon\">\n            <Icon name=\"RefreshCw\" size={16} />\n          </Button>\n        </div>\n      </div>\n      <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6\">\n        <Select\n          label=\"Vue\"\n          options={viewOptions}\n          value={viewType}\n          onChange={setViewType}\n        />\n        <Select\n          label=\"Classe\"\n          options={classOptions}\n          value={selectedClass}\n          onChange={setSelectedClass}\n        />\n        <Select\n          label=\"Priode\"\n          options={periodOptions}\n          value={selectedPeriod}\n          onChange={setSelectedPeriod}\n        />\n      </div>\n      <div className=\"w-full h-80\" aria-label=\"Graphique du statut des paiements\">\n        <ResponsiveContainer width=\"100%\" height=\"100%\">\n          {viewType === 'pie' ? (\n            <PieChart>\n              <Pie\n                data={paymentData}\n                cx=\"50%\"\n                cy=\"50%\"\n                innerRadius={60}\n                outerRadius={120}\n                paddingAngle={2}\n                dataKey=\"value\"\n              >\n                {paymentData?.map((entry, index) => (\n                  <Cell key={`cell-${index}`} fill={entry?.color} />\n                ))}\n              </Pie>\n              <Tooltip content={<CustomTooltip />} />\n              <Legend content={renderLegend} />\n            </PieChart>\n          ) : (\n            <BarChart data={getFilteredClassData()} margin={{ top: 20, right: 30, left: 20, bottom: 5 }}>\n              <CartesianGrid strokeDasharray=\"3 3\" stroke=\"var(--color-border)\" />\n              <XAxis \n                dataKey=\"class\" \n                stroke=\"var(--color-text-secondary)\"\n                fontSize={12}\n                fontFamily=\"Inter, sans-serif\"\n              />\n              <YAxis \n                stroke=\"var(--color-text-secondary)\"\n                fontSize={12}\n                fontFamily=\"Inter, sans-serif\"\n              />\n              <Tooltip content={<CustomTooltip />} />\n              <Legend />\n              <Bar dataKey=\"paid\" fill=\"var(--color-success)\" name=\"Pay\" radius={[2, 2, 0, 0]} />\n              <Bar dataKey=\"late\" fill=\"var(--color-warning)\" name=\"En retard\" radius={[2, 2, 0, 0]} />\n              <Bar dataKey=\"unpaid\" fill=\"var(--color-error)\" name=\"Impay\" radius={[2, 2, 0, 0]} />\n            </BarChart>\n          )}\n        </ResponsiveContainer>\n      </div>\n      <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4 mt-6 pt-4 border-t border-border\">\n        <>\n          <div className=\"text-center\">\n            <div className=\"flex items-center justify-center space-x-2 mb-1\">\n              <div className=\"w-3 h-3 bg-success rounded-sm\" />\n              <span className=\"font-heading font-heading-semibold text-lg text-card-foreground\">\n                0\n              </span>\n            </div>\n            <p className=\"font-caption font-caption-normal text-xs text-muted-foreground\">\n              Paiements  jour (0%)\n            </p>\n          </div>\n          <div className=\"text-center\">\n            <div className=\"flex items-center justify-center space-x-2 mb-1\">\n              <div className=\"w-3 h-3 bg-warning rounded-sm\" />\n              <span className=\"font-heading font-heading-semibold text-lg text-card-foreground\">\n                0\n              </span>\n            </div>\n            <p className=\"font-caption font-caption-normal text-xs text-muted-foreground\">\n              Paiements en retard (0%)\n            </p>\n          </div>\n          <div className=\"text-center\">\n            <div className=\"flex items-center justify-center space-x-2 mb-1\">\n              <div className=\"w-3 h-3 bg-error rounded-sm\" />\n              <span className=\"font-heading font-heading-semibold text-lg text-card-foreground\">\n                0\n              </span>\n            </div>\n            <p className=\"font-caption font-caption-normal text-xs text-muted-foreground\">\n              Paiements impays (0%)\n            </p>\n          </div>\n        </>\n      </div>\n      <div className=\"flex items-center justify-between mt-4 pt-4 border-t border-border\">\n        <div className=\"flex items-center space-x-4\">\n          <>\n            <div className=\"flex items-center space-x-2\">\n              <Icon name=\"Euro\" size={14} className=\"text-muted-foreground\" />\n              <span className=\"font-caption font-caption-normal text-xs text-muted-foreground\">\n                Montant collect: 0 FCFA\n              </span>\n            </div>\n            <div className=\"flex items-center space-x-2\">\n              <Icon name=\"Info\" size={14} className=\"text-muted-foreground\" />\n              <span className=\"font-caption font-caption-normal text-xs text-muted-foreground\">\n                Aucune transaction enregistre\n              </span>\n            </div>\n          </>\n        </div>\n        <p className=\"font-caption font-caption-normal text-xs text-muted-foreground\">\n          Dernire mise  jour: {new Date().toLocaleDateString('fr-FR')} {new Date().toLocaleTimeString('fr-FR', { hour: '2-digit', minute: '2-digit' })}\n        </p>\n      </div>\n    </div>\n  );\n};\n\nexport default PaymentStatusChart;","import React, { useState } from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport Icon from '../../../components/AppIcon';\r\nimport Button from '../../../components/ui/Button';\r\nimport useDashboardData from '../../../hooks/useDashboardData';\r\n\r\nconst QuickActions = () => {\r\n  const [activeAction, setActiveAction] = useState(null);\r\n  const navigate = useNavigate();\r\n\r\n  const {\r\n    data,\r\n    user\r\n  } = useDashboardData();\r\n\r\n  const quickActions = [\r\n    {\r\n      id: 'staff-login',\r\n      title: 'Connexion Personnel',\r\n      description: 'Accs pour enseignants, lves et parents',\r\n      icon: 'LogIn',\r\n      color: 'bg-primary',\r\n      path: '/staff-login'\r\n    },\r\n    {\r\n      id: 'notifications',\r\n      title: 'Envoyer une notification',\r\n      description: 'Diffuser un message  toute l\\'cole',\r\n      icon: 'Bell',\r\n      color: 'bg-secondary',\r\n      path: '/notification-management'\r\n    },\r\n    {\r\n      id: 'reports',\r\n      title: 'Gnrer un rapport',\r\n      description: 'Crer des rapports personnaliss',\r\n      icon: 'FileBarChart',\r\n      color: 'bg-success',\r\n      path: '/report-generation'\r\n    },\r\n    {\r\n      id: 'staff',\r\n      title: 'Gestion du personnel',\r\n      description: 'Crer et grer les comptes du personnel',\r\n      icon: 'Users',\r\n      color: 'bg-warning',\r\n      path: '/principal-dashboard?tab=accounts'\r\n    },\r\n    {\r\n      id: 'calendar',\r\n      title: 'Calendrier scolaire',\r\n      description: 'Grer les vnements et vacances',\r\n      icon: 'Calendar',\r\n      color: 'bg-accent',\r\n      path: '/school-calendar'\r\n    }\r\n  ];\r\n\r\n  const recentActivities = [\r\n    {\r\n      id: 1,\r\n      title: 'cole configure',\r\n      description: `Configuration de ${user?.schoolData?.name || 'votre cole'}`,\r\n      time: 'rcemment',\r\n      icon: 'School',\r\n      type: 'success'\r\n    },\r\n    {\r\n      id: 2,\r\n      title: 'Classes configures',\r\n      description: `${user?.schoolData?.available_classes?.length || 0} classes dfinies`,\r\n      time: 'rcemment',\r\n      icon: 'BookOpen',\r\n      type: 'success'\r\n    },\r\n    {\r\n      id: 3,\r\n      title: 'Systme oprationnel',\r\n      description: 'Connexion  la base de donnes tablie',\r\n      time: 'maintenant',\r\n      icon: 'Database',\r\n      type: 'success'\r\n    },\r\n    {\r\n      id: 4,\r\n      title: 'Systme actif',\r\n      description: 'Donnes synchronises',\r\n      time: 'maintenant',\r\n      icon: 'Shield',\r\n      type: 'info'\r\n    }\r\n  ];\r\n\r\n  const getActivityIcon = (type) => {\r\n    switch (type) {\r\n      case 'success':\r\n        return 'CheckCircle';\r\n      case 'warning':\r\n        return 'AlertTriangle';\r\n      case 'error':\r\n        return 'XCircle';\r\n      default:\r\n        return 'Info';\r\n    }\r\n  };\r\n\r\n  const getActivityColor = (type) => {\r\n    switch (type) {\r\n      case 'success':\r\n        return 'text-success';\r\n      case 'warning':\r\n        return 'text-warning';\r\n      case 'error':\r\n        return 'text-error';\r\n      default:\r\n        return 'text-primary';\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      {/* Quick Actions Grid - Modernis */}\r\n      <div className=\"bg-white border-2 border-gray-200 rounded-2xl p-6 shadow-lg hover:shadow-xl transition-shadow\">\r\n        <div className=\"flex items-center justify-between mb-6\">\r\n          <div className=\"flex items-center\">\r\n            <div className=\"w-10 h-10 bg-gradient-to-br from-amber-500 to-orange-500 rounded-xl flex items-center justify-center mr-3 shadow-md\">\r\n              <Icon name=\"Zap\" size={20} className=\"text-white\" />\r\n            </div>\r\n            <div>\r\n              <h2 className=\"text-lg font-semibold text-gray-900\">\r\n                Actions Rapides\r\n              </h2>\r\n              <p className=\"text-xs text-gray-500\">\r\n                Accs direct aux fonctions principales pour {user?.schoolData?.name || 'votre cole'}\r\n              </p>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\">\r\n          {quickActions?.map((action) => (\r\n            <button\r\n              key={action?.id}\r\n              onClick={() => navigate(action?.path)}\r\n              className=\"group p-5 bg-gradient-to-br from-gray-50 to-white hover:from-blue-50 hover:to-indigo-50 border-2 border-gray-200 hover:border-blue-400 rounded-2xl transition-all duration-300 text-left hover:shadow-lg hover:scale-105\"\r\n            >\r\n              <div className=\"flex items-start space-x-3\">\r\n                <div className={`w-12 h-12 bg-gradient-to-br ${action?.color?.replace('bg-', 'from-')} ${action?.color?.replace('bg-primary', 'to-blue-600').replace('bg-secondary', 'to-indigo-600').replace('bg-success', 'to-green-600').replace('bg-warning', 'to-amber-600').replace('bg-accent', 'to-purple-600')} rounded-xl flex items-center justify-center shadow-md group-hover:scale-110 transition-transform`}>\r\n                  <Icon name={action?.icon} size={20} className=\"text-white\" />\r\n                </div>\r\n                <div className=\"flex-1 min-w-0\">\r\n                  <h3 className=\"font-bold text-gray-900 text-sm mb-1 group-hover:text-blue-700\">\r\n                    {action?.title}\r\n                  </h3>\r\n                  <p className=\"text-xs text-gray-600\">\r\n                    {action?.description}\r\n                  </p>\r\n                </div>\r\n                <Icon name=\"ChevronRight\" size={16} className=\"text-gray-400 group-hover:text-blue-600 group-hover:translate-x-1 transition-all\" />\r\n              </div>\r\n            </button>\r\n          ))}\r\n        </div>\r\n      </div>\r\n      {/* Recent Activities - Modernis */}\r\n      <div className=\"bg-white border-2 border-gray-200 rounded-2xl p-6 shadow-lg hover:shadow-xl transition-shadow\">\r\n        <div className=\"flex items-center justify-between mb-6\">\r\n          <div className=\"flex items-center\">\r\n            <div className=\"w-10 h-10 bg-gradient-to-br from-blue-600 to-indigo-600 rounded-xl flex items-center justify-center mr-3 shadow-md\">\r\n              <Icon name=\"Activity\" size={20} className=\"text-white\" />\r\n            </div>\r\n            <div>\r\n              <h2 className=\"text-lg font-semibold text-gray-900\">\r\n                Activits Rcentes\r\n              </h2>\r\n              <p className=\"text-xs text-gray-500\">\r\n                Historique des dernires actions\r\n              </p>\r\n            </div>\r\n          </div>\r\n          <button className=\"px-3 py-1.5 text-sm font-medium bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors flex items-center space-x-1\">\r\n            <Icon name=\"ExternalLink\" size={14} />\r\n            <span>Voir tout</span>\r\n          </button>\r\n        </div>\r\n\r\n        <div className=\"space-y-3\">\r\n          {recentActivities?.map((activity) => (\r\n            <div\r\n              key={activity?.id}\r\n              className=\"flex items-start space-x-3 p-4 rounded-xl bg-gradient-to-r from-gray-50 to-white hover:from-blue-50 hover:to-indigo-50 border border-gray-200 hover:border-blue-300 transition-all duration-300 hover:shadow-md\"\r\n            >\r\n              <div className={`flex-shrink-0 mt-1 w-8 h-8 rounded-lg flex items-center justify-center ${\r\n                activity?.type === 'success' ? 'bg-gradient-to-br from-green-100 to-emerald-100 text-green-600' :\r\n                activity?.type === 'warning' ? 'bg-gradient-to-br from-amber-100 to-orange-100 text-amber-600' :\r\n                activity?.type === 'error' ? 'bg-gradient-to-br from-red-100 to-pink-100 text-red-600' :\r\n                'bg-gradient-to-br from-blue-100 to-indigo-100 text-blue-600'\r\n              }`}>\r\n                <Icon name={getActivityIcon(activity?.type)} size={16} />\r\n              </div>\r\n              <div className=\"flex-1 min-w-0\">\r\n                <div className=\"flex items-center justify-between mb-1\">\r\n                  <h3 className=\"font-semibold text-sm text-gray-900\">\r\n                    {activity?.title}\r\n                  </h3>\r\n                  <span className=\"text-xs text-gray-500 flex-shrink-0 ml-2\">\r\n                    Il y a {activity?.time}\r\n                  </span>\r\n                </div>\r\n                <p className=\"text-sm text-gray-600\">\r\n                  {activity?.description}\r\n                </p>\r\n              </div>\r\n            </div>\r\n          ))}\r\n        </div>\r\n\r\n        <div className=\"flex items-center justify-center mt-6 pt-4 border-t border-gray-200\">\r\n          <button className=\"px-4 py-2 text-sm font-medium bg-gradient-to-r from-blue-50 to-indigo-50 text-blue-700 rounded-lg hover:from-blue-100 hover:to-indigo-100 transition-all flex items-center space-x-2\">\r\n            <Icon name=\"RefreshCw\" size={14} />\r\n            <span>Actualiser</span>\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default QuickActions;","import React, { useState, useEffect } from 'react';\r\nimport Icon from '../../../components/AppIcon';\r\nimport Button from '../../../components/ui/Button';\r\nimport Input from '../../../components/ui/Input';\r\nimport Select from '../../../components/ui/Select';\r\nimport { useAuth } from '../../../contexts/AuthContext';\r\nimport { useDashboardData } from '../../../hooks/useDashboardData';\r\n\r\nconst SchoolSettings = () => {\r\n  const [loading, setLoading] = useState(false);\r\n  const [saving, setSaving] = useState(false);\r\n  const [customClassName, setCustomClassName] = useState('');\r\n  const [showCustomInput, setShowCustomInput] = useState(false);\r\n\r\n  const { user } = useAuth();\r\n  const { data, loading: dataLoading } = useDashboardData();\r\n\r\n  const schoolDataFromDatabase = data.schoolDetails;\r\n  const schoolDataFromUser = user?.schoolData;\r\n  const finalSchoolData = schoolDataFromDatabase || schoolDataFromUser;\r\n\r\n  const getCurrentEmail = () => {\r\n    return (\r\n      finalSchoolData?.email ||\r\n      finalSchoolData?.director_email ||\r\n      finalSchoolData?.users?.email ||\r\n      user?.schoolData?.users?.email ||\r\n      user?.email ||\r\n      ''\r\n    );\r\n  };\r\n\r\n  // tat des donnes cole bas sur le mode - initialisation vide\r\n  const [schoolData, setSchoolData] = useState({\r\n    name: '',\r\n    type: 'college',\r\n    phone: '',\r\n    email: '',\r\n    address: '',\r\n    availableClasses: []\r\n  });\r\n\r\n  useEffect(() => {\r\n    const currentEmail = getCurrentEmail();\r\n\r\n    setSchoolData({\r\n      name: finalSchoolData?.name || finalSchoolData?.director_name || user?.full_name || 'Votre tablissement',\r\n      type: finalSchoolData?.type || 'college',\r\n      phone: finalSchoolData?.phone || user?.phone || '',\r\n      email: currentEmail,\r\n      address: finalSchoolData?.address || '',\r\n      availableClasses: (finalSchoolData?.available_classes)?.map(className => ({\r\n        level: className,\r\n        isActive: true,\r\n        isCustom: false\r\n      })) || []\r\n    });\r\n  }, [user, data]);\r\n\r\n  // Mettre  jour les classes disponibles quand le type change\r\n  useEffect(() => {\r\n    const availableClasses = getAvailableClassesByType(schoolData.type);\r\n    setSchoolData(prev => ({\r\n      ...prev,\r\n      availableClasses: [\r\n        ...availableClasses.map(cls => ({ \r\n          level: cls.value, \r\n          isActive: false, \r\n          isCustom: false,\r\n          category: cls.category \r\n        })),\r\n        // Garder les classes personnalises existantes\r\n        ...prev.availableClasses.filter(cls => cls.isCustom)\r\n      ]\r\n    }));\r\n  }, [schoolData.type]);\r\n\r\n  const schoolTypes = [\r\n    { value: 'maternelle', label: 'cole Maternelle' },\r\n    { value: 'primaire', label: 'cole Primaire' },\r\n    { value: 'college', label: 'Collge (6me - 3me)' },\r\n    { value: 'lycee', label: 'Lyce (2nde - Terminale)' },\r\n    { value: 'college_lycee', label: 'Collge-Lyce (6me - Terminale)' },\r\n    { value: 'universite', label: 'Universit' },\r\n    { value: 'formation_professionnelle', label: 'Formation Professionnelle' }\r\n  ];\r\n\r\n  // Classes disponibles selon le type d'tablissement\r\n  const getAvailableClassesByType = (schoolType) => {\r\n    switch (schoolType) {\r\n      case 'maternelle':\r\n        return [\r\n          { value: 'Petite Section', label: 'Petite Section', category: 'maternelle' },\r\n          { value: 'Moyenne Section', label: 'Moyenne Section', category: 'maternelle' },\r\n          { value: 'Grande Section', label: 'Grande Section', category: 'maternelle' }\r\n        ];\r\n      case 'primaire':\r\n        return [\r\n          { value: 'CP', label: 'CP (Cours Prparatoire)', category: 'primaire' },\r\n          { value: 'CE1', label: 'CE1 (Cours lmentaire 1)', category: 'primaire' },\r\n          { value: 'CE2', label: 'CE2 (Cours lmentaire 2)', category: 'primaire' },\r\n          { value: 'CM1', label: 'CM1 (Cours Moyen 1)', category: 'primaire' },\r\n          { value: 'CM2', label: 'CM2 (Cours Moyen 2)', category: 'primaire' }\r\n        ];\r\n      case 'college':\r\n        return [\r\n          { value: '6me', label: '6me', category: 'collge' },\r\n          { value: '5me', label: '5me', category: 'collge' },\r\n          { value: '4me', label: '4me', category: 'collge' },\r\n          { value: '3me', label: '3me', category: 'collge' }\r\n        ];\r\n      case 'lycee':\r\n        return [\r\n          { value: '2nde', label: '2nde (Seconde)', category: 'lyce' },\r\n          { value: '1re', label: '1re (Premire)', category: 'lyce' },\r\n          { value: 'Terminale', label: 'Terminale', category: 'lyce' }\r\n        ];\r\n      case 'college_lycee':\r\n        return [\r\n          { value: '6me', label: '6me', category: 'collge' },\r\n          { value: '5me', label: '5me', category: 'collge' },\r\n          { value: '4me', label: '4me', category: 'collge' },\r\n          { value: '3me', label: '3me', category: 'collge' },\r\n          { value: '2nde', label: '2nde (Seconde)', category: 'lyce' },\r\n          { value: '1re', label: '1re (Premire)', category: 'lyce' },\r\n          { value: 'Terminale', label: 'Terminale', category: 'lyce' }\r\n        ];\r\n      case 'universite':\r\n        return [\r\n          { value: 'L1', label: 'Licence 1', category: 'universit' },\r\n          { value: 'L2', label: 'Licence 2', category: 'universit' },\r\n          { value: 'L3', label: 'Licence 3', category: 'universit' },\r\n          { value: 'M1', label: 'Master 1', category: 'universit' },\r\n          { value: 'M2', label: 'Master 2', category: 'universit' },\r\n          { value: 'Doctorat', label: 'Doctorat', category: 'universit' }\r\n        ];\r\n      case 'formation_professionnelle':\r\n        return [\r\n          { value: 'CAP1', label: 'CAP Premire Anne', category: 'professionnel' },\r\n          { value: 'CAP2', label: 'CAP Deuxime Anne', category: 'professionnel' },\r\n          { value: 'BEP1', label: 'BEP Premire Anne', category: 'professionnel' },\r\n          { value: 'BEP2', label: 'BEP Deuxime Anne', category: 'professionnel' },\r\n          { value: 'BAC_PRO1', label: 'Bac Pro Premire Anne', category: 'professionnel' },\r\n          { value: 'BAC_PRO2', label: 'Bac Pro Deuxime Anne', category: 'professionnel' },\r\n          { value: 'BAC_PRO3', label: 'Bac Pro Troisime Anne', category: 'professionnel' }\r\n        ];\r\n      default:\r\n        return [];\r\n    }\r\n  };\r\n\r\n  const handleInputChange = (field, value) => {\r\n    setSchoolData(prev => ({\r\n      ...prev,\r\n      [field]: value\r\n    }));\r\n  };\r\n\r\n  const handleClassToggle = (classLevel) => {\r\n    setSchoolData(prev => ({\r\n      ...prev,\r\n      availableClasses: prev.availableClasses.map(cls => \r\n        cls.level === classLevel \r\n          ? { ...cls, isActive: !cls.isActive }\r\n          : cls\r\n      )\r\n    }));\r\n  };\r\n\r\n  const handleAddCustomClass = () => {\r\n    if (!customClassName.trim()) return;\r\n    \r\n    // Vrifier si la classe existe dj\r\n    const exists = schoolData.availableClasses.some(cls => \r\n      cls.level.toLowerCase() === customClassName.trim().toLowerCase()\r\n    );\r\n    \r\n    if (exists) {\r\n      alert('Cette classe existe dj !');\r\n      return;\r\n    }\r\n\r\n    setSchoolData(prev => ({\r\n      ...prev,\r\n      availableClasses: [\r\n        ...prev.availableClasses,\r\n        { \r\n          level: customClassName.trim(), \r\n          isActive: true, \r\n          isCustom: true,\r\n          category: 'personnalise' \r\n        }\r\n      ]\r\n    }));\r\n    \r\n    setCustomClassName('');\r\n    setShowCustomInput(false);\r\n  };\r\n\r\n  const handleRemoveCustomClass = (classLevel) => {\r\n    setSchoolData(prev => ({\r\n      ...prev,\r\n      availableClasses: prev.availableClasses.filter(cls => cls.level !== classLevel)\r\n    }));\r\n  };\r\n\r\n  const handleSchoolTypeChange = (newType) => {\r\n    setSchoolData(prev => ({\r\n      ...prev,\r\n      type: newType\r\n    }));\r\n  };\r\n\r\n  const handleSave = async () => {\r\n    setSaving(true);\r\n\r\n    try {\r\n      await new Promise(resolve => setTimeout(resolve, 2000));\r\n      alert('Paramtres sauvegards avec succs !');\r\n    } catch (error) {\r\n      console.error('Erreur lors de la sauvegarde:', error);\r\n      alert('Erreur lors de la sauvegarde');\r\n    }\r\n\r\n    setSaving(false);\r\n  };\r\n\r\n  const getActiveClassesCount = () => {\r\n    return schoolData.availableClasses.filter(cls => cls.isActive).length;\r\n  };\r\n\r\n  const getSchoolTypeLabel = () => {\r\n    const type = schoolTypes.find(t => t.value === schoolData.type);\r\n    return type ? type.label : 'Non dfini';\r\n  };\r\n\r\n  const getSchoolTypeDescription = (type) => {\r\n    switch (type) {\r\n      case 'maternelle':\r\n        return 'cole maternelle : Petite, Moyenne et Grande Section pour les enfants de 3  6 ans.';\r\n      case 'primaire':\r\n        return 'cole primaire : Classes de CP  CM2 pour les enfants de 6  11 ans.';\r\n      case 'college':\r\n        return 'Collge : Classes de 6me  3me pour le premier cycle du secondaire (Cameroun).';\r\n      case 'lycee':\r\n        return 'Lyce : Classes de 2nde  Terminale pour le second cycle du secondaire (Cameroun).';\r\n      case 'college_lycee':\r\n        return 'Collge-Lyce : tablissement complet de la 6me  la Terminale (trs courant au Cameroun).';\r\n      case 'universite':\r\n        return 'Universit : Enseignement suprieur (Licence, Master, Doctorat).';\r\n      case 'formation_professionnelle':\r\n        return 'Formation professionnelle : CAP, BEP, Bac Pro pour l\\'apprentissage de mtiers spcialiss.';\r\n      default:\r\n        return 'Slectionnez un type d\\'tablissement pour voir les classes appropries.';\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n\r\n      {/* En-tte des paramtres */}\r\n      <div className=\"bg-card border border-border rounded-lg p-6 shadow-card\">\r\n        <div className=\"flex items-center justify-between mb-6\">\r\n          <div className=\"flex items-center space-x-3\">\r\n            <div className=\"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center\">\r\n              <Icon name=\"School\" size={20} className=\"text-blue-600\" />\r\n            </div>\r\n            <div>\r\n              <h2 className=\"font-heading font-heading-semibold text-lg text-card-foreground\">\r\n                Paramtres de l'tablissement\r\n              </h2>\r\n              <p className=\"font-caption font-caption-normal text-sm text-muted-foreground\">\r\n                Configuration et informations gnrales\r\n              </p>\r\n            </div>\r\n          </div>\r\n          <Button\r\n            onClick={handleSave}\r\n            loading={saving}\r\n          >\r\n            <Icon name=\"Save\" size={16} className=\"mr-2\" />\r\n            Sauvegarder\r\n          </Button>\r\n        </div>\r\n\r\n        {/* Statistiques rapides avec email visible */}\r\n        <div className=\"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6\">\r\n          <div className=\"bg-blue-50 rounded-lg p-4\">\r\n            <div className=\"flex items-center space-x-3\">\r\n              <Icon name=\"GraduationCap\" size={20} className=\"text-blue-600\" />\r\n              <div>\r\n                <p className=\"font-body font-body-semibold text-sm text-blue-900\">\r\n                  Type d'tablissement\r\n                </p>\r\n                <p className=\"font-caption font-caption-normal text-xs text-blue-700\">\r\n                  {getSchoolTypeLabel()}\r\n                </p>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div className=\"bg-green-50 rounded-lg p-4\">\r\n            <div className=\"flex items-center space-x-3\">\r\n              <Icon name=\"Users\" size={20} className=\"text-green-600\" />\r\n              <div>\r\n                <p className=\"font-body font-body-semibold text-sm text-green-900\">\r\n                  Classes actives\r\n                </p>\r\n                <p className=\"font-caption font-caption-normal text-xs text-green-700\">\r\n                  {getActiveClassesCount()} niveaux disponibles\r\n                </p>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div className=\"bg-purple-50 rounded-lg p-4\">\r\n            <div className=\"flex items-center space-x-3\">\r\n              <Icon name=\"Calendar\" size={20} className=\"text-purple-600\" />\r\n              <div>\r\n                <p className=\"font-body font-body-semibold text-sm text-purple-900\">\r\n                  Anne scolaire\r\n                </p>\r\n                <p className=\"font-caption font-caption-normal text-xs text-purple-700\">\r\n                  2025-2026\r\n                </p>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div className=\"bg-orange-50 rounded-lg p-4\">\r\n            <div className=\"flex items-center space-x-3\">\r\n              <Icon name=\"Mail\" size={20} className=\"text-orange-600\" />\r\n              <div className=\"flex-1 min-w-0\">\r\n                <p className=\"font-body font-body-semibold text-sm text-orange-900\">\r\n                  Email principal\r\n                </p>\r\n                <p className=\"font-caption font-caption-normal text-xs text-orange-700 truncate\" \r\n                   title={getCurrentEmail() || 'Non dfini - Veuillez configurer'}>\r\n                  {getCurrentEmail() ? (\r\n                    <span className=\"flex items-center\">\r\n                      <Icon name=\"CheckCircle\" size={12} className=\"mr-1 text-green-600\" />\r\n                      {getCurrentEmail()}\r\n                    </span>\r\n                  ) : (\r\n                    <span className=\"flex items-center text-red-600\">\r\n                      <Icon name=\"AlertCircle\" size={12} className=\"mr-1\" />\r\n                      Non dfini\r\n                    </span>\r\n                  )}\r\n                </p>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Informations gnrales */}\r\n        <div className=\"space-y-6\">\r\n          <div>\r\n            <h4 className=\"font-semibold text-gray-900 mb-4 text-sm\">Informations de base</h4>\r\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n              <Input\r\n                label=\"Nom de l'tablissement\"\r\n                value={schoolData.name}\r\n                onChange={(e) => handleInputChange('name', e.target.value)}\r\n                placeholder=\"Ex: Complexe Scolaire Excellence\"\r\n              />\r\n              \r\n              <Select\r\n                label=\"Type d'tablissement\"\r\n                value={schoolData.type}\r\n                onChange={handleSchoolTypeChange}\r\n                options={schoolTypes}\r\n              />\r\n            </div>\r\n          </div>\r\n\r\n          <div>\r\n            <h4 className=\"font-semibold text-gray-900 mb-4 text-sm flex items-center\">\r\n              <Icon name=\"Phone\" size={16} className=\"mr-2 text-blue-600\" />\r\n              Informations de contact\r\n            </h4>\r\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n              <Input\r\n                label=\"Email de l'tablissement\"\r\n                type=\"email\"\r\n                value={schoolData.email || getCurrentEmail()}\r\n                onChange={(e) => handleInputChange('email', e.target.value)}\r\n                placeholder={getCurrentEmail() || \"contact@votre-ecole.cm\"}\r\n                helperText=\" Email principal pour les communications officielles\"\r\n              />\r\n\r\n              <Input\r\n                label=\"Tlphone\"\r\n                value={schoolData.phone}\r\n                onChange={(e) => handleInputChange('phone', e.target.value)}\r\n                placeholder=\"+237 6XX XXX XXX\"\r\n                helperText=\" Numro principal de l'tablissement\"\r\n              />\r\n            </div>\r\n          </div>\r\n\r\n          <div>\r\n            <h4 className=\"font-semibold text-gray-900 mb-4 text-sm flex items-center\">\r\n              <Icon name=\"MapPin\" size={16} className=\"mr-2 text-green-600\" />\r\n              Localisation\r\n            </h4>\r\n            <Input\r\n              label=\"Adresse complte\"\r\n              value={schoolData.address}\r\n              onChange={(e) => handleInputChange('address', e.target.value)}\r\n              placeholder=\"Quartier, Ville, Rgion\"\r\n              helperText=\" Adresse physique de l'tablissement\"\r\n            />\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Configuration des classes */}\r\n      <div className=\"bg-card border border-border rounded-lg p-6 shadow-card\">\r\n        <div className=\"flex items-center justify-between mb-6\">\r\n          <div className=\"flex items-center space-x-3\">\r\n            <div className=\"w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center\">\r\n              <Icon name=\"Users\" size={20} className=\"text-green-600\" />\r\n            </div>\r\n            <div>\r\n              <h3 className=\"font-heading font-heading-semibold text-lg text-card-foreground\">\r\n                Classes disponibles\r\n              </h3>\r\n              <p className=\"font-caption font-caption-normal text-sm text-muted-foreground\">\r\n                Slectionnez les niveaux proposs dans votre tablissement\r\n              </p>\r\n            </div>\r\n          </div>\r\n          <div className=\"text-sm text-muted-foreground\">\r\n            {getActiveClassesCount()} / {schoolData.availableClasses.length} classes actives\r\n          </div>\r\n        </div>\r\n\r\n        {/* Classes par catgorie */}\r\n        {schoolData.availableClasses.length > 0 && (\r\n          <div className=\"space-y-6\">\r\n            {/* Grouper les classes par catgorie */}\r\n            {[...new Set(schoolData.availableClasses.map(cls => cls.category || 'autre'))].map(category => (\r\n              <div key={category || 'autre'}>\r\n                <h4 className=\"font-body font-body-semibold text-sm text-gray-900 mb-3 capitalize\">\r\n                  Classes {category}\r\n                </h4>\r\n                <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\">\r\n                  {schoolData.availableClasses\r\n                    .filter(cls => (cls.category || 'autre') === category)\r\n                    .map((classItem) => {\r\n                      const availableClasses = getAvailableClassesByType(schoolData.type);\r\n                      const classInfo = availableClasses.find(c => c.value === classItem.level);\r\n                      \r\n                      return (\r\n                        <div\r\n                          key={classItem.level}\r\n                          className={`p-4 rounded-lg border-2 cursor-pointer transition-all duration-200 relative ${\r\n                            classItem.isActive\r\n                              ? 'border-green-300 bg-green-50 hover:bg-green-100'\r\n                              : 'border-gray-200 bg-gray-50 hover:bg-gray-100'\r\n                          }`}\r\n                          onClick={() => handleClassToggle(classItem.level)}\r\n                        >\r\n                          <div className=\"flex items-center justify-between\">\r\n                            <div className=\"flex items-center space-x-3\">\r\n                              <div className={`w-8 h-8 rounded-lg flex items-center justify-center ${\r\n                                classItem.isActive ? 'bg-green-100' : 'bg-gray-100'\r\n                              }`}>\r\n                                <Icon \r\n                                  name={classItem.isActive ? \"CheckCircle\" : \"Circle\"} \r\n                                  size={16} \r\n                                  className={classItem.isActive ? 'text-green-600' : 'text-gray-400'} \r\n                                />\r\n                              </div>\r\n                              <div>\r\n                                <p className={`font-body font-body-semibold text-sm ${\r\n                                  classItem.isActive ? 'text-green-900' : 'text-gray-600'\r\n                                }`}>\r\n                                  {classItem.level}\r\n                                  {classItem.isCustom && (\r\n                                    <span className=\"ml-2 text-xs bg-blue-100 text-blue-800 px-2 py-1 rounded-full\">\r\n                                      Personnalise\r\n                                    </span>\r\n                                  )}\r\n                                </p>\r\n                                <p className={`font-caption font-caption-normal text-xs ${\r\n                                  classItem.isActive ? 'text-green-700' : 'text-gray-500'\r\n                                }`}>\r\n                                  {classInfo?.label || classItem.category}\r\n                                </p>\r\n                              </div>\r\n                            </div>\r\n                            <div className=\"flex items-center space-x-2\">\r\n                              {classItem.isActive && (\r\n                                <Icon name=\"Check\" size={16} className=\"text-green-600\" />\r\n                              )}\r\n                              {classItem.isCustom && (\r\n                                <button\r\n                                  onClick={(e) => {\r\n                                    e.stopPropagation();\r\n                                    handleRemoveCustomClass(classItem.level);\r\n                                  }}\r\n                                  className=\"text-red-500 hover:text-red-700 p-1\"\r\n                                  title=\"Supprimer cette classe personnalise\"\r\n                                >\r\n                                  <Icon name=\"Trash2\" size={14} />\r\n                                </button>\r\n                              )}\r\n                            </div>\r\n                          </div>\r\n                        </div>\r\n                      );\r\n                    })}\r\n                </div>\r\n              </div>\r\n            ))}\r\n          </div>\r\n        )}\r\n\r\n        {/* Bouton pour ajouter une classe personnalise */}\r\n        <div className=\"mt-6\">\r\n          {!showCustomInput ? (\r\n            <Button\r\n              variant=\"outline\"\r\n              onClick={() => setShowCustomInput(true)}\r\n              className=\"border-dashed border-gray-300 hover:border-blue-400 hover:bg-blue-50\"\r\n            >\r\n              <Icon name=\"Plus\" size={16} className=\"mr-2\" />\r\n              Ajouter une classe personnalise\r\n            </Button>\r\n          ) : (\r\n            <div className=\"flex space-x-3 items-end\">\r\n              <div className=\"flex-1\">\r\n                <Input\r\n                  label=\"Nom de la classe\"\r\n                  value={customClassName}\r\n                  onChange={(e) => setCustomClassName(e.target.value)}\r\n                  placeholder=\"Ex: CP3, BEP, CAP...\"\r\n                  onKeyPress={(e) => e.key === 'Enter' && handleAddCustomClass()}\r\n                />\r\n              </div>\r\n              <Button\r\n                onClick={handleAddCustomClass}\r\n                disabled={!customClassName.trim()}\r\n                className=\"bg-green-600 hover:bg-green-700\"\r\n              >\r\n                <Icon name=\"Check\" size={16} />\r\n              </Button>\r\n              <Button\r\n                variant=\"outline\"\r\n                onClick={() => {\r\n                  setShowCustomInput(false);\r\n                  setCustomClassName('');\r\n                }}\r\n              >\r\n                <Icon name=\"X\" size={16} />\r\n              </Button>\r\n            </div>\r\n          )}\r\n        </div>\r\n\r\n        <div className=\"mt-6 p-4 bg-blue-50 rounded-lg\">\r\n          <div className=\"flex items-start space-x-3\">\r\n            <Icon name=\"Info\" size={16} className=\"text-blue-600 mt-0.5\" />\r\n            <div>\r\n              <p className=\"font-body font-body-semibold text-sm text-blue-900 mb-1\">\r\n                Configuration adapte - {getSchoolTypeLabel()}\r\n              </p>\r\n              <p className=\"font-caption font-caption-normal text-xs text-blue-700\">\r\n                {getSchoolTypeDescription(schoolData.type)}\r\n                <br />\r\n                Les classes slectionnes seront disponibles pour l'inscription des lves et l'affectation des enseignants.\r\n              </p>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default SchoolSettings;","import React, { useState, useEffect } from 'react';\r\nimport Icon from '../../../components/AppIcon';\r\nimport Button from '../../../components/ui/Button';\r\nimport SchoolSettings from './SchoolSettings';\r\nimport { useAuth } from '../../../contexts/AuthContext';\r\nimport { useDashboardData } from '../../../hooks/useDashboardData';\r\n\r\nconst SystemStatus = () => {\r\n  const [systemHealth, setSystemHealth] = useState('excellent');\r\n  const [lastUpdate, setLastUpdate] = useState(new Date());\r\n  const [activeTab, setActiveTab] = useState('system');\r\n\r\n  const { user } = useAuth();\r\n  const { data, loading } = useDashboardData();\r\n\r\n  useEffect(() => {\r\n    const interval = setInterval(() => {\r\n      setLastUpdate(new Date());\r\n    }, 30000); // Update every 30 seconds\r\n\r\n    return () => clearInterval(interval);\r\n  }, []);\r\n\r\n  const systemMetrics = [\r\n    {\r\n      id: 'database',\r\n      name: 'Base de donnes Supabase',\r\n      status: 'online',\r\n      uptime: '100%',\r\n      responseTime: '15ms',\r\n      icon: 'Database',\r\n      description: `Donnes de ${user?.schoolData?.name || 'votre cole'}`\r\n    },\r\n    {\r\n      id: 'storage',\r\n      name: 'Stockage Supabase',\r\n      status: 'online',\r\n      uptime: '99.9%',\r\n      responseTime: '25ms',\r\n      icon: 'HardDrive',\r\n      description: 'Documents et fichiers'\r\n    },\r\n    {\r\n      id: 'auth',\r\n      name: 'Authentification',\r\n      status: 'online',\r\n      uptime: '100%',\r\n      responseTime: '8ms',\r\n      icon: 'Shield',\r\n      description: 'Systme de connexion scuris'\r\n    },\r\n    {\r\n      id: 'api',\r\n      name: 'API Supabase',\r\n      status: 'online',\r\n      uptime: '99.8%',\r\n      responseTime: '45ms',\r\n      icon: 'Wifi',\r\n      description: 'Interface de programmation'\r\n    }\r\n  ];\r\n\r\n  const securityAlerts = [\r\n    {\r\n      id: 1,\r\n      type: 'success',\r\n      title: 'Systme oprationnel',\r\n      message: `${user?.schoolData?.name || 'Votre cole'} fonctionne normalement`,\r\n      time: '1 minute',\r\n      severity: 'low'\r\n    },\r\n    {\r\n      id: 2,\r\n      type: 'info',\r\n      title: 'Sauvegarde automatique',\r\n      message: 'Donnes sauvegardes sur Supabase avec succs',\r\n      time: '30 minutes',\r\n      severity: 'low'\r\n    }\r\n  ];\r\n\r\n  const getStatusColor = (status) => {\r\n    switch (status) {\r\n      case 'online':\r\n        return 'text-success';\r\n      case 'warning':\r\n        return 'text-warning';\r\n      case 'offline':\r\n        return 'text-error';\r\n      default:\r\n        return 'text-muted-foreground';\r\n    }\r\n  };\r\n\r\n  const getStatusBg = (status) => {\r\n    switch (status) {\r\n      case 'online':\r\n        return 'bg-success/10';\r\n      case 'warning':\r\n        return 'bg-warning/10';\r\n      case 'offline':\r\n        return 'bg-error/10';\r\n      default:\r\n        return 'bg-muted/10';\r\n    }\r\n  };\r\n\r\n  const getStatusText = (status) => {\r\n    switch (status) {\r\n      case 'online':\r\n        return 'En ligne';\r\n      case 'warning':\r\n        return 'Attention';\r\n      case 'offline':\r\n        return 'Hors ligne';\r\n      default:\r\n        return 'Inconnu';\r\n    }\r\n  };\r\n\r\n  const getAlertIcon = (type) => {\r\n    switch (type) {\r\n      case 'success':\r\n        return 'CheckCircle';\r\n      case 'warning':\r\n        return 'AlertTriangle';\r\n      case 'error':\r\n        return 'XCircle';\r\n      default:\r\n        return 'Info';\r\n    }\r\n  };\r\n\r\n  const getAlertColor = (type) => {\r\n    switch (type) {\r\n      case 'success':\r\n        return 'text-success';\r\n      case 'warning':\r\n        return 'text-warning';\r\n      case 'error':\r\n        return 'text-error';\r\n      default:\r\n        return 'text-primary';\r\n    }\r\n  };\r\n\r\n  const formatTime = (date) => {\r\n    return date?.toLocaleTimeString('fr-FR', {\r\n      hour: '2-digit',\r\n      minute: '2-digit',\r\n      second: '2-digit'\r\n    });\r\n  };\r\n\r\n  const tabs = [\r\n    { id: 'system', label: 'tat du systme', icon: 'Activity' },\r\n    { id: 'school', label: 'Paramtres cole', icon: 'School' }\r\n  ];\r\n  const renderTabContent = () => {\r\n    switch (activeTab) {\r\n      case 'school':\r\n        return <SchoolSettings />;\r\n      case 'system':\r\n      default:\r\n        return (\r\n          <div className=\"space-y-6\">\r\n            {/* System Health Overview avec indicateur de mode - Modernis */}\r\n            <div className=\"bg-white border-2 border-gray-200 rounded-2xl p-6 shadow-lg hover:shadow-xl transition-shadow\">\r\n        <div className=\"flex items-center justify-between mb-6\">\r\n          <div className=\"flex items-center\">\r\n            <div className=\"w-12 h-12 bg-gradient-to-br from-green-600 to-emerald-600 rounded-xl flex items-center justify-center mr-3 shadow-md\">\r\n              <Icon name=\"Activity\" size={24} className=\"text-white\" />\r\n            </div>\r\n            <div>\r\n              <h2 className=\"text-lg font-semibold text-gray-900\">\r\n                tat du Systme\r\n              </h2>\r\n              <p className=\"text-xs text-gray-500\">\r\n                Surveillance relle - {user?.schoolData?.name || 'Votre cole'}\r\n              </p>\r\n            </div>\r\n          </div>\r\n          <div className=\"flex items-center space-x-3\">\r\n            <div className=\"flex items-center space-x-2 px-3 py-2 rounded-lg bg-gradient-to-r from-green-50 to-emerald-50 border-2 border-green-200\">\r\n              <div className=\"w-2 h-2 bg-green-500 rounded-full animate-pulse\" />\r\n              <span className=\"text-xs font-semibold text-green-700\">\r\n                Systme oprationnel\r\n              </span>\r\n            </div>\r\n            <button className=\"p-2 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors\">\r\n              <Icon name=\"RefreshCw\" size={16} className=\"text-gray-700\" />\r\n            </button>\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\">\r\n          {systemMetrics?.map((metric) => (\r\n            <div\r\n              key={metric?.id}\r\n              className=\"p-5 bg-gradient-to-br from-gray-50 to-white border-2 border-gray-200 rounded-2xl hover:border-blue-400 hover:shadow-lg hover:scale-105 transition-all duration-300\"\r\n            >\r\n              <div className=\"flex items-start justify-between mb-3\">\r\n                <div className=\"flex items-center space-x-3\">\r\n                  <div className={`w-10 h-10 rounded-xl flex items-center justify-center shadow-md ${\r\n                    metric?.status === 'online' \r\n                      ? 'bg-gradient-to-br from-green-600 to-emerald-600' \r\n                      : metric?.status === 'warning'\r\n                      ? 'bg-gradient-to-br from-amber-500 to-orange-500'\r\n                      : 'bg-gradient-to-br from-red-500 to-pink-500'\r\n                  }`}>\r\n                    <Icon name={metric?.icon} size={16} className=\"text-white\" />\r\n                  </div>\r\n                  <div>\r\n                    <h3 className=\"font-body font-body-semibold text-sm text-card-foreground\">\r\n                      {metric?.name}\r\n                    </h3>\r\n                    <p className=\"font-caption font-caption-normal text-xs text-muted-foreground\">\r\n                      {metric?.description}\r\n                    </p>\r\n                  </div>\r\n                </div>\r\n                <span className={`px-2 py-1 rounded-full text-xs font-caption font-caption-normal ${getStatusBg(metric?.status)} ${getStatusColor(metric?.status)}`}>\r\n                  {getStatusText(metric?.status)}\r\n                </span>\r\n              </div>\r\n              \r\n              <div className=\"grid grid-cols-2 gap-4 text-xs\">\r\n                <div>\r\n                  <p className=\"font-caption font-caption-normal text-muted-foreground\">Disponibilit</p>\r\n                  <p className=\"font-body font-body-semibold text-card-foreground\">{metric?.uptime}</p>\r\n                </div>\r\n                <div>\r\n                  <p className=\"font-caption font-caption-normal text-muted-foreground\">Temps rponse</p>\r\n                  <p className=\"font-body font-body-semibold text-card-foreground\">{metric?.responseTime}</p>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          ))}\r\n        </div>\r\n      </div>\r\n      {/* Security Alerts avec indicateur de mode */}\r\n      <div className=\"bg-card border border-border rounded-lg p-6 shadow-card\">\r\n        <div className=\"flex items-center justify-between mb-6\">\r\n          <div className=\"flex items-center space-x-3\">\r\n            <div className=\"w-10 h-10 bg-success/10 rounded-lg flex items-center justify-center\">\r\n              <Icon name=\"Shield\" size={20} className=\"text-success\" />\r\n            </div>\r\n            <div>\r\n              <h2 className=\"font-heading font-heading-semibold text-lg text-card-foreground\">\r\n                Alertes scurit\r\n              </h2>\r\n              <p className=\"font-caption font-caption-normal text-sm text-muted-foreground\">\r\n                Surveillance relle des vnements\r\n              </p>\r\n            </div>\r\n          </div>\r\n          <Button variant=\"ghost\" size=\"sm\">\r\n            <Icon name=\"ExternalLink\" size={14} className=\"mr-2\" />\r\n            Voir tout\r\n          </Button>\r\n        </div>\r\n\r\n        <div className=\"space-y-4\">\r\n          {securityAlerts?.map((alert) => (\r\n            <div\r\n              key={alert?.id}\r\n              className=\"flex items-start space-x-3 p-3 rounded-lg hover:bg-muted/50 transition-micro\"\r\n            >\r\n              <div className={`flex-shrink-0 mt-1 ${getAlertColor(alert?.type)}`}>\r\n                <Icon name={getAlertIcon(alert?.type)} size={16} />\r\n              </div>\r\n              <div className=\"flex-1 min-w-0\">\r\n                <div className=\"flex items-center justify-between\">\r\n                  <h3 className=\"font-body font-body-semibold text-sm text-card-foreground\">\r\n                    {alert?.title}\r\n                  </h3>\r\n                  <span className=\"font-caption font-caption-normal text-xs text-muted-foreground\">\r\n                    Il y a {alert?.time}\r\n                  </span>\r\n                </div>\r\n                <p className=\"font-body font-body-normal text-sm text-muted-foreground mt-1\">\r\n                  {alert?.message}\r\n                </p>\r\n                <div className=\"flex items-center space-x-2 mt-2\">\r\n                  <span className={`px-2 py-1 rounded-full text-xs font-caption font-caption-normal ${\r\n                    alert?.severity === 'high' ? 'bg-error/10 text-error' :\r\n                    alert?.severity === 'medium'? 'bg-warning/10 text-warning' : 'bg-primary/10 text-primary'\r\n                  }`}>\r\n                    {alert?.severity === 'high' ? 'Critique' :\r\n                     alert?.severity === 'medium' ? 'Moyen' : 'Faible'}\r\n                  </span>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          ))}\r\n        </div>\r\n      </div>\r\n      {/* System Information avec donnes dynamiques */}\r\n      <div className=\"bg-card border border-border rounded-lg p-6 shadow-card\">\r\n        <div className=\"flex items-center justify-between mb-4\">\r\n          <h3 className=\"font-heading font-heading-semibold text-lg text-card-foreground\">\r\n            Informations systme\r\n          </h3>\r\n          <span className=\"font-caption font-caption-normal text-xs text-muted-foreground\">\r\n            Dernire mise  jour: {formatTime(lastUpdate)}\r\n          </span>\r\n        </div>\r\n\r\n        <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6\">\r\n          <div className=\"text-center\">\r\n            <div className=\"flex items-center justify-center space-x-2 mb-2\">\r\n              <Icon name=\"Users\" size={16} className=\"text-primary\" />\r\n              <span className=\"font-heading font-heading-bold text-xl text-card-foreground\">\r\n                {data?.activeUsers || '1'}\r\n              </span>\r\n            </div>\r\n            <p className=\"font-caption font-caption-normal text-xs text-muted-foreground\">\r\n              Utilisateurs connects\r\n            </p>\r\n          </div>\r\n          <div className=\"text-center\">\r\n            <div className=\"flex items-center justify-center space-x-2 mb-2\">\r\n              <Icon name=\"Database\" size={16} className=\"text-success\" />\r\n              <span className=\"font-heading font-heading-bold text-xl text-card-foreground\">\r\n                {data?.storageUsed || '1.2 GB'}\r\n              </span>\r\n            </div>\r\n            <p className=\"font-caption font-caption-normal text-xs text-muted-foreground\">\r\n              Espace utilis\r\n            </p>\r\n          </div>\r\n          <div className=\"text-center\">\r\n            <div className=\"flex items-center justify-center space-x-2 mb-2\">\r\n              <Icon name=\"Zap\" size={16} className=\"text-success\" />\r\n              <span className=\"font-heading font-heading-bold text-xl text-card-foreground\">\r\n                100%\r\n              </span>\r\n            </div>\r\n            <p className=\"font-caption font-caption-normal text-xs text-muted-foreground\">\r\n              Disponibilit Supabase\r\n            </p>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Information systme */}\r\n      <div className=\"rounded-lg p-4 bg-green-50 border border-green-200\">\r\n        <div className=\"flex items-start space-x-3\">\r\n          <Icon name=\"Database\" size={20} className=\"text-green-600\" />\r\n          <div>\r\n            <h4 className=\"font-medium mb-2 text-green-800\">\r\n              Mode Production - Systme\r\n            </h4>\r\n            <p className=\"text-sm text-green-700\">\r\n              Mtriques systme relles pour {user?.schoolData?.name || 'votre tablissement'}. Surveillance authentique via Supabase avec donnes scurises.\r\n            </p>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n        );\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      {/* Navigation par onglets */}\r\n      <div className=\"flex space-x-1 bg-gray-100 p-1 rounded-lg w-fit\">\r\n        {tabs.map((tab) => (\r\n          <button\r\n            key={tab.id}\r\n            onClick={() => setActiveTab(tab.id)}\r\n            className={`flex items-center space-x-2 px-4 py-2 text-sm rounded-md transition-all duration-200 ${\r\n              activeTab === tab.id\r\n                ? 'bg-white text-blue-600 shadow-sm font-medium' \r\n                : 'text-gray-600 hover:text-gray-900 hover:bg-gray-50'\r\n            }`}\r\n          >\r\n            <Icon name={tab.icon} size={16} />\r\n            <span>{tab.label}</span>\r\n          </button>\r\n        ))}\r\n      </div>\r\n\r\n      {/* Contenu de l'onglet */}\r\n      {renderTabContent()}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default SystemStatus;","import React, { useState, useEffect } from 'react';\r\nimport { useLocation } from 'react-router-dom';\r\nimport Icon from '../../../components/AppIcon';\r\nimport Button from '../../../components/ui/Button';\r\nimport Input from '../../../components/ui/Input';\r\nimport Select from '../../../components/ui/Select';\r\nimport { useAuth } from '../../../contexts/AuthContext';\r\nimport useDashboardData from '../../../hooks/useDashboardData';\r\nimport { supabase } from '../../../lib/supabase';\r\nimport { sendCredentialsEmail, isEmailConfigured } from '../../../services/emailService';\r\n\r\nconst AccountsManagement = () => {\r\n  const location = useLocation();\r\n  const [activeTab, setActiveTab] = useState('overview');\r\n  const [searchTerm, setSearchTerm] = useState('');\r\n  const [selectedRole, setSelectedRole] = useState('all');\r\n  const [selectedStatus, setSelectedStatus] = useState('all');\r\n  const [showCreateForm, setShowCreateForm] = useState(false);\r\n  const [showPassword, setShowPassword] = useState(false);\r\n\r\n  // Hooks pour la gestion des donnes\r\n  const { user: authUser } = useAuth();\r\n  const { data, loading } = useDashboardData();\r\n\r\n  // tat pour les donnes compltes de l'utilisateur\r\n  const [user, setUser] = useState(authUser);\r\n  const [userDataLoaded, setUserDataLoaded] = useState(false);\r\n\r\n  // Charger les donnes compltes du directeur depuis Supabase\r\n  useEffect(() => {\r\n    const loadUserData = async () => {\r\n      if (!authUser?.id) {\r\n        setUser(authUser);\r\n        setUserDataLoaded(true);\r\n        return;\r\n      }\r\n\r\n      try {\r\n        const { data: userData, error } = await supabase\r\n          .from('users')\r\n          .select(`\r\n            id, \r\n            email, \r\n            full_name, \r\n            role, \r\n            phone, \r\n            current_school_id,\r\n            school:schools!users_current_school_id_fkey(id, name)\r\n          `)\r\n          .eq('id', authUser.id)\r\n          .single();\r\n\r\n        if (error) {\r\n          console.error(' Erreur chargement donnes utilisateur:', error);\r\n          setUser(authUser); // Fallback sur authUser\r\n        } else {\r\n          console.log(' Donnes utilisateur charges:', userData);\r\n          \r\n          // Charger aussi le type d'cole et l'anne acadmique courante\r\n          const { data: schoolData } = await supabase\r\n            .from('schools')\r\n            .select('type')\r\n            .eq('id', userData.current_school_id)\r\n            .single();\r\n          \r\n          // Rcuprer l'anne acadmique courante\r\n          const { data: academicYearData } = await supabase\r\n            .from('academic_years')\r\n            .select('id, name')\r\n            .eq('school_id', userData.current_school_id)\r\n            .eq('is_current', true)\r\n            .single();\r\n          \r\n          console.log(' Anne acadmique courante:', academicYearData);\r\n          \r\n          // Aplatir les donnes school\r\n          const userWithSchool = {\r\n            ...userData,\r\n            school_id: userData.school?.id || userData.current_school_id,\r\n            school_name: userData.school?.name || 'cole',\r\n            school_type: schoolData?.type || 'combined',\r\n            academic_year_id: academicYearData?.id || null,\r\n            academic_year_name: academicYearData?.name || null\r\n          };\r\n          \r\n          setUser(userWithSchool);\r\n        }\r\n      } catch (err) {\r\n        console.error(' Exception chargement utilisateur:', err);\r\n        setUser(authUser); // Fallback sur authUser\r\n      } finally {\r\n        setUserDataLoaded(true);\r\n      }\r\n    };\r\n\r\n    loadUserData();\r\n  }, [authUser]);\r\n\r\n  // Grer la navigation directe vers un sous-onglet via l'URL\r\n  useEffect(() => {\r\n    const urlParams = new URLSearchParams(location.search);\r\n    const subtabParam = urlParams.get('subtab');\r\n    if (subtabParam && ['overview', 'accounts', 'create', 'security'].includes(subtabParam)) {\r\n      setActiveTab(subtabParam);\r\n    }\r\n    \r\n    // Rinitialiser le filtre de rle s'il contient 'principal' (plus disponible)\r\n    if (selectedRole === 'principal') {\r\n      setSelectedRole('all');\r\n    }\r\n  }, [location.search, selectedRole]);\r\n\r\n  // tat pour le chargement des comptes rels\r\n  const [accounts, setAccounts] = useState([]);\r\n  const [loadingAccounts, setLoadingAccounts] = useState(false);\r\n\r\n  // Nouvel utilisateur  crer\r\n  const [newUser, setNewUser] = useState({\r\n    fullName: '',\r\n    email: '',\r\n    phone: '',\r\n    role: 'student',\r\n    password: '',\r\n    status: 'active',\r\n    // Champs spcifiques enseignant\r\n    specialty: '',\r\n    hireDate: new Date().toISOString().split('T')[0],\r\n    selectedClasses: [],\r\n    selectedSubjects: [],\r\n    weeklyHours: '',\r\n    // Champs spcifiques secrtaire\r\n    permissions: [],\r\n    department: '',\r\n    // Champs spcifiques lve\r\n    schoolLevel: 'primary', // 'primary' ou 'secondary'\r\n    matricule: '', // Gnr automatiquement pour le secondaire\r\n    classId: '',\r\n    dateOfBirth: '',\r\n    parentId: '', // ID du parent existant (au lieu de parentName/Phone/Email)\r\n    // Anciens champs (pour compatibilit si ncessaire)\r\n    parentName: '',\r\n    parentPhone: '',\r\n    parentEmail: '',\r\n    // Champs spcifiques parent\r\n    selectedChildren: [],\r\n    profession: '',\r\n    address: ''\r\n  });\r\n\r\n  // tats pour les donnes de rfrence\r\n  const [availableClasses, setAvailableClasses] = useState([]);\r\n  const [availableSubjects, setAvailableSubjects] = useState([]);\r\n  const [availableStudents, setAvailableStudents] = useState([]);\r\n  const [loadingReference, setLoadingReference] = useState(false);\r\n\r\n  // tats pour l'ajout de nouvelles matires\r\n  const [showAddSubject, setShowAddSubject] = useState(false);\r\n  const [newSubjectName, setNewSubjectName] = useState('');\r\n  const [addingSubject, setAddingSubject] = useState(false);\r\n\r\n  // Dtection automatique du school_level quand la classe change\r\n  useEffect(() => {\r\n    if (newUser.role === 'student' && newUser.classId) {\r\n      const selectedClass = availableClasses.find(c => c.value === newUser.classId);\r\n      if (selectedClass && user?.school_type) {\r\n        const detectedLevel = determineSchoolLevel(user.school_type, selectedClass.label);\r\n        if (detectedLevel !== newUser.schoolLevel) {\r\n          setNewUser(prev => ({ ...prev, schoolLevel: detectedLevel }));\r\n          console.log(` Niveau dtect automatiquement: ${detectedLevel} (classe: ${selectedClass.label}, type cole: ${user.school_type})`);\r\n        }\r\n      }\r\n    }\r\n  }, [newUser.classId, newUser.role, availableClasses, user?.school_type]);\r\n\r\n\r\n  // Statistiques des comptes\r\n  const accountStats = {\r\n    total: accounts.length,\r\n    active: accounts.filter(acc => {\r\n      const isActive = acc.is_active !== undefined ? acc.is_active : acc.status === 'active';\r\n      return isActive;\r\n    }).length,\r\n    inactive: accounts.filter(acc => acc.status === 'inactive').length,\r\n    locked: accounts.filter(acc => acc.is_locked).length,\r\n    byRole: {\r\n      principal: accounts.filter(acc => acc.role === 'principal').length,\r\n      teacher: accounts.filter(acc => acc.role === 'teacher').length,\r\n      secretary: accounts.filter(acc => acc.role === 'secretary').length,\r\n      student: accounts.filter(acc => acc.role === 'student').length,\r\n      parent: accounts.filter(acc => acc.role === 'parent').length\r\n    }\r\n  };\r\n\r\n  // Filtrage des comptes\r\n  const filteredAccounts = accounts.filter(account => {\r\n    const matchesSearch = account.full_name.toLowerCase().includes(searchTerm.toLowerCase()) ||\r\n                         account.email.toLowerCase().includes(searchTerm.toLowerCase());\r\n    const matchesRole = selectedRole === 'all' || account.role === selectedRole;\r\n\r\n    // Grer is_active (Supabase)\r\n    const accountStatus = account.is_active !== undefined\r\n      ? (account.is_active ? 'active' : 'inactive')\r\n      : account.status;\r\n    const matchesStatus = selectedStatus === 'all' || accountStatus === selectedStatus;\r\n\r\n    return matchesSearch && matchesRole && matchesStatus;\r\n  });\r\n\r\n  // Options pour les filtres\r\n  const roleOptions = [\r\n    { value: 'all', label: 'Tous les rles' },\r\n    { value: 'teacher', label: 'Enseignant' },\r\n    { value: 'secretary', label: 'Secrtaire' },\r\n    { value: 'student', label: 'lve' },\r\n    { value: 'parent', label: 'Parent' }\r\n  ];\r\n\r\n  const statusOptions = [\r\n    { value: 'all', label: 'Tous les statuts' },\r\n    { value: 'active', label: 'Actif' },\r\n    { value: 'inactive', label: 'Inactif' }\r\n  ];\r\n\r\n  const newUserRoleOptions = [\r\n    { value: 'student', label: 'lve' },\r\n    { value: 'parent', label: 'Parent' },\r\n    { value: 'teacher', label: 'Enseignant' },\r\n    { value: 'secretary', label: 'Secrtaire' }\r\n  ];\r\n\r\n  const permissionsOptions = [\r\n    { value: 'manage_students', label: 'Grer les lves' },\r\n    { value: 'manage_grades', label: 'Grer les notes' },\r\n    { value: 'manage_attendance', label: 'Grer les prsences' },\r\n    { value: 'manage_communications', label: 'Grer les communications' },\r\n    { value: 'view_reports', label: 'Voir les rapports' }\r\n  ];\r\n\r\n  // Fonction helper pour obtenir les matires par dfaut selon le type d'cole\r\n  const getDefaultSubjectsBySchoolType = (schoolType) => {\r\n    const subjectsByType = {\r\n      'Maternelle': ['veil', 'Psychomotricit', 'Langage', 'Arts plastiques', 'Musique', 'Jeux ducatifs'],\r\n      'Primaire': ['Mathmatiques', 'Franais', 'Lecture', 'criture', 'Histoire', 'Gographie', 'Sciences', 'ducation Civique et Morale', 'Arts Plastiques', 'Musique', 'ducation Physique et Sportive', 'Anglais', 'Informatique', 'Travaux Manuels', 'Hygine et Sant', 'Bibliothque'],\r\n      'Collge': ['Mathmatiques', 'Franais', 'Anglais', 'Histoire-Gographie', 'Sciences de la Vie et de la Terre', 'Physique-Chimie', 'Technologie', 'ducation Physique et Sportive', 'Arts Plastiques', 'Musique', 'ducation Civique', 'Espagnol', 'Allemand', 'Informatique'],\r\n      'Lyce Gnral': ['Mathmatiques', 'Franais', 'Philosophie', 'Histoire-Gographie', 'Anglais', 'Espagnol', 'Allemand', 'Physique-Chimie', 'Sciences de la Vie et de la Terre', 'Sciences conomiques et Sociales', 'ducation Physique et Sportive', 'Arts Plastiques', 'Musique', 'NSI (Numrique et Sciences Informatiques)', 'SI (Sciences de l\\'Ingnieur)', 'HGGSP', 'HLP', 'LLCER', 'Biologie-cologie', 'Mathmatiques Expertes'],\r\n      'Lyce Technique': ['Mathmatiques', 'Franais', 'Anglais', 'Histoire-Gographie', 'Physique-Chimie', 'lectrotechnique', 'Mcanique', 'Gnie Civil', 'Informatique', 'conomie-Gestion', 'Construction', 'CAO/DAO', 'Automatisme', 'Sciences de l\\'Ingnieur', 'Tlcommunications', 'Maintenance', 'nergie', 'ducation Physique et Sportive'],\r\n      'Lyce Professionnel': ['Mathmatiques', 'Franais', 'Anglais', 'Histoire-Gographie', 'Commerce', 'Vente', 'Comptabilit', 'Secrtariat', 'Cuisine', 'Htellerie', 'Coiffure', 'Esthtique', 'Mcanique Auto', 'lectricit', 'Menuiserie', 'Soudure', 'Mode', 'Agriculture']\r\n    };\r\n\r\n    const subjects = subjectsByType[schoolType] || subjectsByType['Collge'];\r\n    return subjects.map((name, index) => ({ id: `default-${index}`, name }));\r\n  };\r\n\r\n  // Onglets de navigation\r\n  const tabs = [\r\n    { id: 'overview', label: 'Aperu gnral', icon: 'BarChart3' },\r\n    { id: 'accounts', label: 'Liste des comptes', icon: 'Users' },\r\n    { id: 'security', label: 'Scurit', icon: 'Shield' },\r\n    { id: 'create', label: 'Crer un compte', icon: 'UserPlus' }\r\n  ];\r\n\r\n  // Charger les donnes de rfrence pour le formulaire\r\n  useEffect(() => {\r\n    const loadReferenceData = async () => {\r\n      console.log(' Chargement donnes rfrence...');\r\n      console.log('  - user:', user);\r\n      console.log('  - school_id:', user?.current_school_id);\r\n\r\n      if (!user?.current_school_id) {\r\n        console.warn(' Pas de school_id - Impossible de charger les donnes');\r\n        return;\r\n      }\r\n\r\n      setLoadingReference(true);\r\n      try {\r\n        // Charger les donnes de l'cole (classes et matires personnalises)\r\n        console.log(' Chargement donnes cole...');\r\n        const { data: schoolData, error: schoolError } = await supabase\r\n          .from('schools')\r\n          .select('available_classes, type, custom_subjects')\r\n          .eq('id', user.current_school_id)\r\n          .single();\r\n\r\n        if (schoolError) {\r\n          console.error(' Erreur chargement donnes cole:', schoolError);\r\n        } else {\r\n          console.log(' Donnes cole charges:', schoolData);\r\n          console.log(' Classes dans available_classes:', schoolData?.available_classes);\r\n\r\n          // Charger les classes depuis available_classes ET la table classes\r\n          if (schoolData?.available_classes && Array.isArray(schoolData.available_classes)) {\r\n            // Charger depuis la table classes (avec UUID rels)\r\n            const { data: dbClasses, error: classesError } = await supabase\r\n              .from('classes')\r\n              .select('id, name, level')\r\n              .eq('school_id', user.current_school_id)\r\n              .order('level')\r\n              .order('name');\r\n\r\n            // Crer un Map des classes de la table classes par nom\r\n            const dbClassesMap = new Map();\r\n            if (!classesError && dbClasses) {\r\n              dbClasses.forEach(cls => {\r\n                dbClassesMap.set(cls.name, {\r\n                  value: cls.id,\r\n                  label: cls.name,\r\n                  level: cls.level\r\n                });\r\n              });\r\n              console.log(` ${dbClasses.length} classe(s) charge(s) depuis la table classes`);\r\n            }\r\n\r\n            // Fusionner avec available_classes pour afficher TOUTES les classes\r\n            const formattedClasses = schoolData.available_classes.map((className, index) => {\r\n              // Si la classe existe dans la table classes, utiliser son UUID\r\n              if (dbClassesMap.has(className)) {\r\n                return dbClassesMap.get(className);\r\n              }\r\n              // Sinon, crer un ID temporaire\r\n              return {\r\n                value: `temp-${index}-${className}`, // ID temporaire unique\r\n                label: className,\r\n                isTemporary: true // Flag pour crer la classe  la vole\r\n              };\r\n            });\r\n\r\n            setAvailableClasses(formattedClasses);\r\n            \r\n            const tempCount = formattedClasses.filter(c => c.isTemporary).length;\r\n            const realCount = formattedClasses.length - tempCount;\r\n            console.log(` ${formattedClasses.length} classe(s) disponible(s) (${realCount} avec UUID, ${tempCount} temporaire(s))`);\r\n          } else {\r\n            console.warn(' Aucune classe disponible dans available_classes');\r\n            setAvailableClasses([]);\r\n          }\r\n\r\n          // Charger les matires (par dfaut + personnalises)\r\n          const defaultSubjects = getDefaultSubjectsBySchoolType(schoolData.type);\r\n          const customSubjects = (schoolData.custom_subjects || []).map(name => ({ id: `custom-${name}`, name }));\r\n          \r\n          // Utiliser un Set pour liminer les doublons par nom\r\n          const allSubjectsMap = new Map();\r\n          [...defaultSubjects, ...customSubjects].forEach(subject => {\r\n            if (!allSubjectsMap.has(subject.name)) {\r\n              allSubjectsMap.set(subject.name, { value: subject.id, label: subject.name });\r\n            }\r\n          });\r\n          \r\n          const allSubjects = Array.from(allSubjectsMap.values());\r\n          setAvailableSubjects(allSubjects);\r\n          console.log(` ${allSubjects.length} matire(s) disponible(s) (sans doublons)`);\r\n        }\r\n\r\n        console.log(' Chargement parents...');\r\n        // Charger les parents (pour lier aux lves)\r\n        // Note: parents n'a pas de school_id ni is_active directement\r\n        const { data: parentsData, error: parentsError } = await supabase\r\n          .from('parents')\r\n          .select(`\r\n            id,\r\n            first_name,\r\n            last_name,\r\n            users!inner (\r\n              id,\r\n              email,\r\n              phone,\r\n              full_name\r\n            )\r\n          `)\r\n          .order('last_name');\r\n\r\n        if (parentsError) {\r\n          console.error(' Erreur chargement parents:', parentsError);\r\n          setAvailableStudents([]); // Vider si erreur\r\n        } else {\r\n          console.log(' Parents chargs:', parentsData?.length || 0);\r\n          const formattedParents = (parentsData || []).map(parent => ({\r\n            id: parent.id,\r\n            user_id: parent.users.id,\r\n            full_name: parent.users.full_name || `${parent.first_name} ${parent.last_name}`,\r\n            email: parent.users.email,\r\n            phone: parent.users.phone\r\n          }));\r\n          console.log(' Parents formats:', formattedParents.length);\r\n          setAvailableStudents(formattedParents); // Rutiliser availableStudents pour les parents\r\n        }\r\n      } catch (error) {\r\n        console.error(' Erreur chargement donnes rfrence:', error);\r\n      } finally {\r\n        setLoadingReference(false);\r\n      }\r\n    };\r\n\r\n    if (activeTab === 'create' && userDataLoaded) {\r\n      loadReferenceData();\r\n    }\r\n  }, [activeTab, user?.current_school_id, userDataLoaded]);\r\n\r\n  // Fonction pour ajouter une nouvelle matire\r\n  const handleAddSubject = async () => {\r\n    if (!newSubjectName.trim()) {\r\n      alert('Veuillez entrer le nom de la matire');\r\n      return;\r\n    }\r\n\r\n    // Vrifier si la matire existe dj\r\n    if (availableSubjects.some(s => s.label.toLowerCase() === newSubjectName.trim().toLowerCase())) {\r\n      alert('Cette matire existe dj');\r\n      return;\r\n    }\r\n\r\n    setAddingSubject(true);\r\n\r\n    try {\r\n      // Sauvegarder dans Supabase\r\n      const { data: schoolData, error: fetchError } = await supabase\r\n        .from('schools')\r\n        .select('custom_subjects')\r\n        .eq('id', user.current_school_id)\r\n        .single();\r\n\r\n      if (fetchError) {\r\n        throw new Error('Erreur lors de la rcupration des matires');\r\n      }\r\n\r\n      const currentCustomSubjects = schoolData.custom_subjects || [];\r\n      const updatedCustomSubjects = [...currentCustomSubjects, newSubjectName.trim()];\r\n\r\n      const { error: updateError } = await supabase\r\n        .from('schools')\r\n        .update({ custom_subjects: updatedCustomSubjects })\r\n        .eq('id', user.current_school_id);\r\n\r\n      if (updateError) {\r\n        throw new Error('Erreur lors de l\\'ajout de la matire');\r\n      }\r\n\r\n      // Mettre  jour la liste locale\r\n      const newSubject = {\r\n        value: `custom-${Date.now()}`,\r\n        label: newSubjectName.trim()\r\n      };\r\n      setAvailableSubjects(prev => [...prev, newSubject]);\r\n      setNewSubjectName('');\r\n      setShowAddSubject(false);\r\n      alert(' Matire ajoute avec succs !');\r\n    } catch (error) {\r\n      console.error('Erreur ajout matire:', error);\r\n      alert(` Erreur : ${error.message}`);\r\n    } finally {\r\n      setAddingSubject(false);\r\n    }\r\n  };\r\n\r\n  // Test de la configuration EmailJS\r\n  const testEmailConfiguration = async () => {\r\n    const testEmail = prompt('Entrez votre adresse email pour recevoir un email de test :');\r\n    \r\n    if (!testEmail || !testEmail.includes('@')) {\r\n      alert('Adresse email invalide.');\r\n      return;\r\n    }\r\n\r\n    setLoadingAccounts(true);\r\n\r\n    try {\r\n      console.log(' Test de configuration EmailJS...');\r\n      \r\n      const emailResult = await sendCredentialsEmail({\r\n        recipientEmail: testEmail,\r\n        recipientName: 'Utilisateur Test',\r\n        role: 'Enseignant Test',\r\n        email: testEmail,\r\n        password: 'TestPassword123!',\r\n        schoolName: user?.school_name || 'cole Test',\r\n        principalName: user?.full_name || 'Directeur Test',\r\n      });\r\n\r\n      if (emailResult.success) {\r\n        alert(\r\n          ` Test russi !\\n\\n` +\r\n          `Un email de test a t envoy  ${testEmail}\\n\\n` +\r\n          `Vrifiez votre bote de rception (et les spams).\\n\\n` +\r\n          `Si vous recevez l'email, la configuration fonctionne correctement !`\r\n        );\r\n      } else {\r\n        alert(\r\n          ` Test chou\\n\\n` +\r\n          `Erreur : ${emailResult.error}\\n\\n` +\r\n          `${emailResult.technicalError ? `Dtails : ${emailResult.technicalError}\\n\\n` : ''}` +\r\n          `Consultez la console (F12) pour plus de dtails.\\n\\n` +\r\n          `Voir le guide : docs/EMAIL_TROUBLESHOOTING.md`\r\n        );\r\n      }\r\n    } catch (error) {\r\n      alert(` Erreur inattendue :\\n\\n${error.message}`);\r\n    } finally {\r\n      setLoadingAccounts(false);\r\n    }\r\n  };\r\n\r\n  // Gestion des actions sur les comptes\r\n  const handleResetPassword = (accountId, accountName, accountEmail) => {\r\n    const newPassword = generateSecurePassword();\r\n    \r\n    const confirmAction = confirm(\r\n      `Rinitialiser le mot de passe pour ${accountName} ?\\n\\n` +\r\n      `Un nouveau mot de passe sera gnr automatiquement.\\n\\n` +\r\n      `Voulez-vous l'envoyer par email  ${accountEmail} ?`\r\n    );\r\n    \r\n    if (!confirmAction) return;\r\n\r\n    // Logique de rinitialisation relle\r\n    console.log('Rinitialisation mot de passe pour:', accountId);\r\n    // Ici on enverrait l'email automatiquement\r\n    sendPasswordResetEmail(accountEmail, accountName, newPassword);\r\n  };\r\n\r\n  // Envoyer un email de rinitialisation\r\n  const sendPasswordResetEmail = (email, name, newPassword) => {\r\n    // Cette fonction serait connecte  un service d'email rel\r\n    console.log('Envoi email de rinitialisation :', email);\r\n    alert(`Email de rinitialisation envoy  ${email} !\\n\\n${name} recevra :\\n- Son nouveau mot de passe temporaire\\n- Un lien pour se connecter\\n- L'obligation de changer son mot de passe`);\r\n  };\r\n\r\n  // Renvoyer les identifiants par email\r\n  const handleResendCredentials = (accountId, accountName, accountEmail) => {\r\n    const confirmSend = confirm(\r\n      `Renvoyer les identifiants de connexion  ${accountName} ?\\n\\n` +\r\n      `Un email sera envoy  ${accountEmail} avec :\\n` +\r\n      `- Son email de connexion\\n` +\r\n      `- Un lien pour rinitialiser son mot de passe\\n` +\r\n      `- Les instructions de premire connexion`\r\n    );\r\n    \r\n    if (!confirmSend) return;\r\n\r\n    // Logique d'envoi relle\r\n    console.log('Renvoi identifiants pour:', accountId);\r\n    sendCredentialsReminder(accountEmail, accountName);\r\n  };\r\n\r\n  // Envoyer un rappel d'identifiants\r\n  const sendCredentialsReminder = (email, name) => {\r\n    console.log('Envoi rappel identifiants :', email);\r\n    alert(`Rappel d'identifiants envoy  ${email} !\\n\\n${name} recevra :\\n- Son email de connexion\\n- Un lien pour rinitialiser son mot de passe si ncessaire\\n- Le lien de connexion  la plateforme`);\r\n  };\r\n\r\n  const handleToggleStatus = (accountId, accountName, currentStatus) => {\r\n    const newStatus = currentStatus === 'active' ? 'inactive' : 'active';\r\n    // Logique de changement de statut relle\r\n    console.log('Changement statut pour:', accountId, 'vers:', newStatus);\r\n    alert(`Compte ${accountName} ${newStatus === 'active' ? 'activ' : 'dsactiv'}`);\r\n  };\r\n\r\n  const handleUnlock = async (accountId, accountName) => {\r\n    const confirmed = confirm(\r\n      `Dbloquer le compte de ${accountName} ?\\n\\n` +\r\n      `Les tentatives de connexion choues seront rinitialises.`\r\n    );\r\n\r\n    if (!confirmed) {\r\n      return;\r\n    }\r\n\r\n    setLoadingAccounts(true);\r\n\r\n    try {\r\n      const { data, error } = await supabase.rpc('unlock_user_account', {\r\n        p_user_id: accountId,\r\n        p_unlocked_by: user.id\r\n      });\r\n\r\n      if (error) {\r\n        throw error;\r\n      }\r\n\r\n      if (data && !data.success) {\r\n        throw new Error(data.error || 'Erreur lors du dblocage');\r\n      }\r\n\r\n      alert(` Compte de ${accountName} dbloqu avec succs !`);\r\n      \r\n      // Recharger la liste\r\n      await loadAccountsFromSupabase();\r\n      \r\n    } catch (error) {\r\n      console.error(' Erreur dblocage compte:', error);\r\n      alert(` Erreur lors du dblocage :\\n\\n${error.message}`);\r\n    } finally {\r\n      setLoadingAccounts(false);\r\n    }\r\n  };\r\n\r\n  const handleCreateUser = async () => {\r\n    // Validation des champs obligatoires\r\n    if (!newUser.fullName) {\r\n      alert('Veuillez saisir le nom complet');\r\n      return;\r\n    }\r\n\r\n    // Pour les lves, validations spcifiques\r\n    if (newUser.role === 'student') {\r\n      if (!newUser.classId) {\r\n        alert('Veuillez slectionner une classe pour l\\'lve');\r\n        return;\r\n      }\r\n      if (!newUser.parentId) {\r\n        alert('Veuillez slectionner un parent/tuteur pour l\\'lve.\\n\\nSi le parent n\\'existe pas, crez d\\'abord son compte avec le rle \"Parent\".');\r\n        return;\r\n      }\r\n      // Pas besoin d'email ou password pour les lves (gnr auto si secondaire)\r\n    } else if (newUser.role === 'parent') {\r\n      // Pour les parents : tlphone et adresse obligatoires\r\n      if (!newUser.phone) {\r\n        alert('Veuillez saisir le numro de tlphone du parent (obligatoire)');\r\n        return;\r\n      }\r\n      if (!newUser.address) {\r\n        alert('Veuillez saisir l\\'adresse du parent (obligatoire)');\r\n        return;\r\n      }\r\n      if (!newUser.password) {\r\n        alert('Veuillez saisir un mot de passe');\r\n        return;\r\n      }\r\n      if (newUser.password.length < 8) {\r\n        alert('Le mot de passe doit contenir au moins 8 caractres');\r\n        return;\r\n      }\r\n      // Email optionnel pour les parents - gnrer un email par dfaut si non fourni\r\n      if (!newUser.email) {\r\n        // Gnrer un email bas sur le tlphone\r\n        const cleanPhone = newUser.phone.replace(/\\s+/g, '').replace(/\\+/g, '');\r\n        newUser.email = `parent${cleanPhone}@edutrack.cm`;\r\n        console.log(' Email gnr pour parent sans email:', newUser.email);\r\n      }\r\n    } else {\r\n      // Pour le personnel (enseignant, secrtaire, directeur, etc.)\r\n      // Tlphone obligatoire pour gnrer un email si ncessaire\r\n      if (!newUser.phone) {\r\n        alert('Veuillez saisir le numro de tlphone (obligatoire)');\r\n        return;\r\n      }\r\n      if (!newUser.password) {\r\n        alert('Veuillez saisir un mot de passe');\r\n        return;\r\n      }\r\n      // Validation du mot de passe\r\n      if (newUser.password.length < 8) {\r\n        alert('Le mot de passe doit contenir au moins 8 caractres');\r\n        return;\r\n      }\r\n      \r\n      // Email optionnel pour le personnel - gnrer un email par dfaut si non fourni\r\n      if (!newUser.email) {\r\n        // Gnrer un email bas sur le rle et le tlphone\r\n        const cleanPhone = newUser.phone.replace(/\\s+/g, '').replace(/\\+/g, '');\r\n        const rolePrefix = {\r\n          'teacher': 'enseignant',\r\n          'secretary': 'secretaire',\r\n          'principal': 'directeur',\r\n          'admin': 'admin'\r\n        }[newUser.role] || 'staff';\r\n        \r\n        newUser.email = `${rolePrefix}${cleanPhone}@edutrack.cm`;\r\n        console.log(` Email gnr pour ${newUser.role} sans email:`, newUser.email);\r\n      }\r\n    }\r\n\r\n    setLoadingAccounts(true);\r\n\r\n    try {\r\n      //  MODE PRODUCTION - Cration relle avec Supabase\r\n      console.log('Cration compte avec Supabase...');\r\n\r\n      // Vrification de l'utilisateur connect (mode production)\r\n      if (!user) {\r\n        alert(' Erreur : Utilisateur non connect. Veuillez vous reconnecter.');\r\n        console.error('User is null');\r\n        setLoadingAccounts(false);\r\n        return;\r\n      }\r\n\r\n      if (!user.current_school_id) {\r\n        console.error(' current_school_id manquant. User data:', user);\r\n        alert(\r\n          ` Erreur : Votre compte n'est pas associ  une cole.\\n\\n` +\r\n          `Email: ${user?.email || 'N/A'}\\n` +\r\n          `Rle: ${user?.role || 'N/A'}\\n\\n` +\r\n          `Veuillez contacter l'administrateur systme.`\r\n        );\r\n        setLoadingAccounts(false);\r\n        return;\r\n      }\r\n\r\n      // Sparer le nom complet en prnom et nom\r\n      const nameParts = newUser.fullName.trim().split(' ');\r\n      const firstName = nameParts[0] || '';\r\n      const lastName = nameParts.slice(1).join(' ') || firstName;\r\n\r\n      let userId = null;\r\n\r\n      // Pour le personnel (enseignants, secrtaires) ET les parents, crer directement dans la base sans auth\r\n      if (newUser.role === 'teacher' || newUser.role === 'secretary' || newUser.role === 'parent') {\r\n        console.log('Cration compte personnel/parent...');\r\n\r\n        // Gnrer un UUID pour le nouvel utilisateur\r\n        const newUserId = crypto.randomUUID();\r\n\r\n        // 1. Crer l'utilisateur dans la table users\r\n        const { data: userData, error: userError } = await supabase\r\n          .from('users')\r\n          .insert({\r\n            id: newUserId,\r\n            email: newUser.email,\r\n            full_name: newUser.fullName,\r\n            phone: newUser.phone,\r\n            role: newUser.role,\r\n            current_school_id: user.current_school_id,\r\n            is_active: true,\r\n            created_at: new Date().toISOString(),\r\n            updated_at: new Date().toISOString()\r\n          })\r\n          .select()\r\n          .single();\r\n\r\n        if (userError) {\r\n          throw new Error(`Erreur cration utilisateur: ${userError.message}`);\r\n        }\r\n\r\n        userId = userData.id;\r\n        console.log(' Utilisateur cr:', userId);\r\n\r\n        // 2. Crer l'entre dans la table spcifique (teachers, secretaries ou parents)\r\n        if (newUser.role === 'teacher') {\r\n          const { data: teacherData, error: teacherError } = await supabase\r\n            .from('teachers')\r\n            .insert({\r\n              school_id: user.current_school_id,\r\n              user_id: userId,\r\n              first_name: firstName,\r\n              last_name: lastName,\r\n              specialty: newUser.specialty || '',\r\n              hire_date: newUser.hireDate || new Date().toISOString(),\r\n              is_active: true,\r\n              created_at: new Date().toISOString(),\r\n              updated_at: new Date().toISOString()\r\n            })\r\n            .select('id')\r\n            .single();\r\n\r\n          if (teacherError) {\r\n            console.error('Erreur cration enseignant:', teacherError);\r\n            throw new Error(`Erreur cration enseignant: ${teacherError.message}`);\r\n          }\r\n\r\n          // Crer les assignations de classes et matires\r\n          const teacherId = teacherData.id;\r\n\r\n          // Rcuprer l'anne acadmique courante\r\n          const { data: academicYearData } = await supabase\r\n            .from('academic_years')\r\n            .select('id')\r\n            .eq('school_id', user.current_school_id)\r\n            .eq('is_current', true)\r\n            .single();\r\n\r\n          const academicYearId = academicYearData?.id;\r\n\r\n          if (academicYearId) {\r\n            // Crer les assignations pour chaque combinaison classe-matire\r\n              const assignments = [];\r\n              \r\n              // Si des classes et matires sont slectionnes\r\n              if (newUser.selectedClasses.length > 0 && newUser.selectedSubjects.length > 0) {\r\n                for (const classId of newUser.selectedClasses) {\r\n                  for (const subjectId of newUser.selectedSubjects) {\r\n                    const classData = availableClasses.find(c => c.value === classId);\r\n                    const subjectData = availableSubjects.find(s => s.value === subjectId);\r\n                    \r\n                    assignments.push({\r\n                      teacher_id: teacherId,\r\n                      school_id: user.current_school_id,\r\n                      academic_year_id: academicYearId,\r\n                      class_id: classId,\r\n                      subject_id: subjectId,\r\n                      class_name: classData?.label || '',\r\n                      subject_name: subjectData?.label || '',\r\n                      schedule: {\r\n                        weekly_hours: parseInt(newUser.weeklyHours) || 0\r\n                      },\r\n                      is_active: true\r\n                    });\r\n                  }\r\n                }\r\n              }\r\n\r\n              if (assignments.length > 0) {\r\n                const { error: assignmentError } = await supabase\r\n                  .from('teacher_assignments')\r\n                  .insert(assignments);\r\n\r\n                if (assignmentError) {\r\n                  console.error('Erreur cration assignations:', assignmentError);\r\n                  // Ne pas bloquer, l'utilisateur est cr\r\n                }\r\n              }\r\n            }\r\n\r\n          } else if (newUser.role === 'secretary') {\r\n            const { error: secretaryError } = await supabase\r\n              .from('secretaries')\r\n              .insert({\r\n                school_id: user.current_school_id,\r\n                user_id: userId,\r\n                first_name: firstName,\r\n                last_name: lastName,\r\n                hire_date: newUser.hireDate || new Date().toISOString(),\r\n                is_active: true,\r\n                created_at: new Date().toISOString(),\r\n                updated_at: new Date().toISOString()\r\n              });\r\n\r\n            if (secretaryError) {\r\n              console.error('Erreur cration secrtaire:', secretaryError);\r\n              throw new Error(`Erreur cration secrtaire: ${secretaryError.message}`);\r\n            }\r\n\r\n            // TODO: Grer les permissions de la secrtaire (table secretary_permissions)\r\n          } else if (newUser.role === 'parent') {\r\n            const { data: parentData, error: parentError} = await supabase\r\n              .from('parents')\r\n              .insert({\r\n                user_id: userId,\r\n                first_name: firstName,\r\n                last_name: lastName,\r\n                phone: newUser.phone,\r\n                email: newUser.email,\r\n                profession: newUser.profession || null,\r\n                address: newUser.address || null\r\n              })\r\n              .select('id')\r\n              .single();\r\n\r\n            if (parentError) {\r\n              console.error('Erreur cration parent:', parentError);\r\n              throw new Error(`Erreur cration parent: ${parentError.message}`);\r\n            }\r\n\r\n            console.log(' Compte parent cr. Les enfants seront lis lors de la cration des lves.');\r\n          }\r\n\r\n          console.log(' Compte personnel cr:', userId);\r\n          \r\n        } else if (newUser.role === 'student') {\r\n          // Diffrencier primaire et secondaire\r\n          console.log(` Cration compte lve - Niveau: ${newUser.schoolLevel}`);\r\n          \r\n          // Gnrer le matricule (obligatoire pour tous)\r\n          const generatedMatricule = await generateStudentMatricule(user.current_school_id);\r\n          console.log(' Matricule gnr:', generatedMatricule);\r\n          \r\n          let newStudentUserId = null;\r\n          let generatedEmail = null;\r\n          let generatedPassword = null;\r\n          \r\n          // Crer un compte utilisateur UNIQUEMENT pour le secondaire\r\n          if (newUser.schoolLevel === 'secondary') {\r\n            console.log(' lve du secondaire - Cration des identifiants...');\r\n            \r\n            // Gnrer l'email automatique\r\n            generatedEmail = generateStudentEmail(generatedMatricule, user.school_name || 'ecole');\r\n            console.log(' Email gnr:', generatedEmail);\r\n            \r\n            // Gnrer le mot de passe\r\n            generatedPassword = generateStudentPassword(firstName);\r\n            console.log(' Mot de passe gnr:', generatedPassword);\r\n            \r\n            // Crer le compte utilisateur dans la table users\r\n            newStudentUserId = crypto.randomUUID();\r\n            \r\n            const { data: studentUserData, error: studentUserError } = await supabase\r\n              .from('users')\r\n              .insert({\r\n                id: newStudentUserId,\r\n                email: generatedEmail,\r\n                full_name: newUser.fullName,\r\n                phone: newUser.phone || null,\r\n                role: 'student',\r\n                password_hash: generatedPassword, // Stocker le mot de passe en clair pour l'instant\r\n                current_school_id: user.current_school_id,\r\n                is_active: true,\r\n                created_at: new Date().toISOString(),\r\n                updated_at: new Date().toISOString()\r\n              })\r\n              .select()\r\n              .single();\r\n\r\n            if (studentUserError) {\r\n              throw new Error(`Erreur cration compte lve: ${studentUserError.message}`);\r\n            }\r\n\r\n            userId = newStudentUserId;\r\n            console.log(' Compte utilisateur cr pour lve du secondaire');\r\n          } else {\r\n            console.log(' lve du primaire - Aucun compte utilisateur cr');\r\n          }\r\n\r\n          // Grer le class_id : OBLIGATOIRE pour tous les lves\r\n          if (!newUser.classId) {\r\n            throw new Error('La slection d\\'une classe est obligatoire pour crer un lve');\r\n          }\r\n          \r\n          let finalClassId = newUser.classId;\r\n          \r\n          if (newUser.classId.startsWith('temp-')) {\r\n            console.log(' ID temporaire dtect, cration de la classe dans la table classes...');\r\n            \r\n            // Rcuprer le nom de la classe depuis availableClasses\r\n            const selectedClass = availableClasses.find(c => c.value === newUser.classId);\r\n            \r\n            if (!selectedClass) {\r\n              throw new Error('Classe slectionne introuvable dans la liste des classes disponibles');\r\n            }\r\n            \r\n            if (selectedClass.isTemporary) {\r\n              // Utiliser la fonction determineSchoolLevel pour dtecter correctement le niveau\r\n              const detectedLevel = determineSchoolLevel(user.school_type, selectedClass.label);\r\n              \r\n              console.log(` Cration classe - Niveau dtect: ${detectedLevel} pour \"${selectedClass.label}\" (type cole: ${user.school_type})`);\r\n              \r\n              // Vrifier que academic_year_id existe\r\n              if (!user.academic_year_id) {\r\n                console.error(' Aucune anne acadmique courante trouve');\r\n                throw new Error('Veuillez d\\'abord crer une anne acadmique courante pour cette cole');\r\n              }\r\n              \r\n              // Crer la classe dans la table classes\r\n              const { data: newClassData, error: newClassError } = await supabase\r\n                .from('classes')\r\n                .insert({\r\n                  school_id: user.current_school_id,\r\n                  name: selectedClass.label,\r\n                  level: detectedLevel,\r\n                  academic_year_id: user.academic_year_id\r\n                })\r\n                .select('id')\r\n                .single();\r\n\r\n              if (newClassError) {\r\n                console.error(' Erreur cration classe:', newClassError);\r\n                // BLOQUER la cration de l'lve si la classe ne peut pas tre cre\r\n                throw new Error(`Impossible de crer la classe \"${selectedClass.label}\": ${newClassError.message}`);\r\n              }\r\n              \r\n              finalClassId = newClassData.id;\r\n              console.log(' Classe cre avec UUID:', finalClassId);\r\n            }\r\n          }\r\n          \r\n          // Vrification finale : s'assurer que finalClassId est valide\r\n          if (!finalClassId || finalClassId === 'null' || finalClassId === 'undefined') {\r\n            throw new Error('Une classe valide doit tre assigne  l\\'lve');\r\n          }\r\n\r\n          // Crer l'entre dans la table students\r\n          console.log(` Cration lve avec school_level: ${newUser.schoolLevel}`);\r\n          \r\n          const { data: studentData, error: studentError } = await supabase\r\n            .from('students')\r\n            .insert({\r\n              school_id: user.current_school_id,\r\n              user_id: newUser.schoolLevel === 'secondary' ? newStudentUserId : null, // NULL pour primaire, user_id pour secondaire\r\n              matricule: newUser.schoolLevel === 'secondary' ? generatedMatricule : null, // Nouvelle colonne pour secondaire\r\n              registration_number: generatedMatricule, // Ancienne colonne pour compatibilit\r\n              first_name: firstName,\r\n              last_name: lastName,\r\n              class_id: finalClassId, // UUID rel ou null\r\n              date_of_birth: newUser.dateOfBirth || null,\r\n              school_level: newUser.schoolLevel, // IMPORTANT: dfinir le niveau\r\n              is_active: true,\r\n              created_at: new Date().toISOString(),\r\n              updated_at: new Date().toISOString()\r\n            })\r\n            .select('id')\r\n            .single();\r\n\r\n          if (studentError) {\r\n            console.error('Erreur cration lve:', studentError);\r\n            throw new Error(`Erreur cration lve: ${studentError.message}`);\r\n          }\r\n\r\n          // Crer la relation parent-lve dans parent_students (table simplifie)\r\n          const { error: linkError } = await supabase\r\n            .from('parent_students')\r\n            .insert({\r\n              parent_id: newUser.parentId,\r\n              student_id: studentData.id,\r\n              relationship: 'parent',\r\n              is_primary: true\r\n            });\r\n\r\n          if (linkError) {\r\n            console.error('Erreur liaison parent-lve:', linkError);\r\n            // Ne pas bloquer, l'lve est cr\r\n          } else {\r\n            console.log(' Relation parent-lve cre');\r\n          }\r\n\r\n          // Stocker les identifiants gnrs pour l'email au parent (UNIQUEMENT pour secondaire)\r\n          if (newUser.schoolLevel === 'secondary' && generatedEmail && generatedPassword) {\r\n            newUser.generatedEmail = generatedEmail;\r\n            newUser.generatedPassword = generatedPassword;\r\n            newUser.generatedMatricule = generatedMatricule;\r\n            console.log(` lve du secondaire cr avec compte utilisateur`);\r\n          } else {\r\n            newUser.generatedMatricule = generatedMatricule;\r\n            console.log(` lve du primaire cr sans compte utilisateur`);\r\n          }\r\n          \r\n        } else {\r\n          // Pour les directeurs/admins, utiliser signUp normal (avec email automatique)\r\n          console.log('Cration compte directeur/admin via signUp...');\r\n          \r\n          const { data: authData, error: authError } = await supabase.auth.signUp({\r\n            email: newUser.email,\r\n            password: newUser.password,\r\n            options: {\r\n              data: {\r\n                full_name: newUser.fullName,\r\n                phone: newUser.phone,\r\n                role: newUser.role,\r\n                school: {\r\n                  id: user.current_school_id,\r\n                  name: user.school_name || 'cole'\r\n                }\r\n              }\r\n            }\r\n          });\r\n\r\n          if (authError || !authData.user) {\r\n            throw new Error(authError?.message || 'Erreur cration compte');\r\n          }\r\n\r\n          userId = authData.user.id;\r\n          console.log(' Compte directeur/admin cr:', userId);\r\n\r\n          // Crer entre dans users pour directeurs/admins\r\n          await supabase.from('users').insert({\r\n            id: userId,\r\n            email: newUser.email,\r\n            full_name: newUser.fullName,\r\n            phone: newUser.phone,\r\n            role: newUser.role,\r\n            current_school_id: user.current_school_id,\r\n            created_by_user_id: user.id,\r\n            is_active: true\r\n          });\r\n        }\r\n\r\n        // tape 2: Envoyer l'email avec les identifiants\r\n        if (newUser.role !== 'principal' && newUser.role !== 'admin') {\r\n          console.log(' Envoi de l\\'email avec les identifiants...');\r\n          console.log('Configuration email actuelle:', { \r\n            configured: isEmailConfigured(),\r\n            hasServiceId: !!import.meta.env.VITE_EMAILJS_SERVICE_ID,\r\n            hasTemplateId: !!import.meta.env.VITE_EMAILJS_TEMPLATE_ID,\r\n            hasPublicKey: !!import.meta.env.VITE_EMAILJS_PUBLIC_KEY,\r\n          });\r\n          \r\n          // Logique d'envoi d'email selon si l'utilisateur a un email personnel ou non\r\n          let recipientEmail, emailContent, hasPersonalEmail;\r\n          \r\n          if (newUser.role === 'student') {\r\n            // lve : envoyer au parent avec les identifiants gnrs\r\n            const selectedParent = availableStudents.find(p => p.id === newUser.parentId);\r\n            hasPersonalEmail = selectedParent?.email && !selectedParent.email.includes('@edutrack.cm');\r\n            \r\n            recipientEmail = hasPersonalEmail ? selectedParent.email : user.email; // Email du parent ou du directeur\r\n            emailContent = {\r\n              recipientEmail: recipientEmail,\r\n              recipientName: hasPersonalEmail ? (selectedParent?.full_name || 'Parent') : user.full_name,\r\n              role: 'lve',\r\n              email: newUser.generatedEmail,\r\n              password: newUser.generatedPassword,\r\n              matricule: newUser.generatedMatricule,\r\n              studentName: newUser.fullName,\r\n              parentName: selectedParent?.full_name,\r\n              parentPhone: selectedParent?.phone,\r\n              isStudent: true,\r\n              hasPersonalEmail: hasPersonalEmail,\r\n              schoolName: user.school_name || 'Votre tablissement',\r\n              principalName: user.full_name || 'Le Directeur',\r\n            };\r\n          } else {\r\n            // Personnel (enseignant, secrtaire, parent)\r\n            hasPersonalEmail = newUser.email && !newUser.email.includes('@edutrack.cm');\r\n            recipientEmail = hasPersonalEmail ? newUser.email : user.email; // Email personnel ou du directeur\r\n            \r\n            emailContent = {\r\n              recipientEmail: recipientEmail,\r\n              recipientName: hasPersonalEmail ? newUser.fullName : user.full_name,\r\n              role: getRoleLabel(newUser.role),\r\n              email: newUser.email,\r\n              password: newUser.password,\r\n              phone: newUser.phone,\r\n              staffName: newUser.fullName,\r\n              hasPersonalEmail: hasPersonalEmail,\r\n              schoolName: user.school_name || 'Votre tablissement',\r\n              principalName: user.full_name || 'Le Directeur',\r\n            };\r\n          }\r\n\r\n          let emailResult = { success: true };\r\n          \r\n          if (emailContent) {\r\n            console.log(` Envoi email  ${hasPersonalEmail ? 'l\\'utilisateur' : 'au directeur'}:`, recipientEmail);\r\n            emailResult = await sendCredentialsEmail(emailContent);\r\n            console.log(' Rsultat de l\\'envoi:', emailResult);\r\n          }\r\n\r\n          if (emailResult.success) {\r\n            // Email envoy avec succs\r\n            let successMessage;\r\n            \r\n            if (newUser.role === 'student') {\r\n              // lve : diffrencier primaire et secondaire\r\n              const selectedParent = availableStudents.find(p => p.id === newUser.parentId);\r\n              const parentHasPersonalEmail = selectedParent?.email && !selectedParent.email.includes('@edutrack.cm');\r\n              \r\n              if (newUser.schoolLevel === 'secondary') {\r\n                // Secondaire : compte cr avec identifiants\r\n                successMessage = (\r\n                  ` Compte lve cr avec succs !\\n\\n` +\r\n                  `Nom : ${newUser.fullName}\\n` +\r\n                  `Classe : ${availableClasses.find(c => c.value === newUser.classId)?.label || 'N/A'}\\n\\n` +\r\n                  ` COMPTE PERSONNEL CR :\\n` +\r\n                  ` Matricule : ${newUser.generatedMatricule}\\n` +\r\n                  ` Email : ${newUser.generatedEmail}\\n` +\r\n                  ` Mot de passe : ${newUser.generatedPassword}\\n\\n` +\r\n                  ` Parent li :\\n` +\r\n                  ` Nom : ${selectedParent?.full_name || 'N/A'}\\n` +\r\n                  ` Email : ${selectedParent?.email || 'Non renseign'}\\n` +\r\n                  ` Tlphone : ${selectedParent?.phone || 'Non renseign'}\\n\\n` +\r\n                  ` EMAIL ENVOY :\\n` +\r\n                  `${parentHasPersonalEmail \r\n                    ? ` Envoy au parent : ${selectedParent.email}\\n   Le parent a reu les identifiants de connexion de son enfant.`\r\n                    : ` Envoy au directeur : ${user.email}\\n    Le parent n'a pas d'email personnel.\\n   Les identifiants ont t envoys  votre adresse.\\n   Veuillez les communiquer au parent par tlphone : ${selectedParent?.phone || 'N/A'}`\r\n                  }\\n\\n` +\r\n                  `L'lve peut maintenant :\\n` +\r\n                  ` Se connecter  la plateforme\\n` +\r\n                  ` Consulter ses notes et devoirs\\n` +\r\n                  ` Voir son emploi du temps`\r\n                );\r\n              } else {\r\n                // Primaire : pas de compte utilisateur\r\n                successMessage = (\r\n                  ` lve du primaire enregistr avec succs !\\n\\n` +\r\n                  `Nom : ${newUser.fullName}\\n` +\r\n                  `Classe : ${availableClasses.find(c => c.value === newUser.classId)?.label || 'N/A'}\\n` +\r\n                  ` Matricule : ${newUser.generatedMatricule}\\n\\n` +\r\n                  ` Parent li :\\n` +\r\n                  ` Nom : ${selectedParent?.full_name || 'N/A'}\\n` +\r\n                  ` Email : ${selectedParent?.email || 'Non renseign'}\\n` +\r\n                  ` Tlphone : ${selectedParent?.phone || 'Non renseign'}\\n\\n` +\r\n                  ` NOTE : Les lves du primaire n'ont pas de compte personnel.\\n` +\r\n                  `Le parent peut consulter les informations de son enfant via son propre compte parent.`\r\n                );\r\n              }\r\n            } else {\r\n              // Personnel (enseignant, secrtaire, directeur) et Parents\r\n              const isParent = newUser.role === 'parent';\r\n              const isTeacher = newUser.role === 'teacher';\r\n              const isSecretary = newUser.role === 'secretary';\r\n              const hasPersonalEmail = newUser.email && !newUser.email.includes('@edutrack.cm');\r\n              \r\n              successMessage = (\r\n                ` Compte cr avec succs !\\n\\n` +\r\n                `Utilisateur : ${newUser.fullName}\\n` +\r\n                `Tlphone : ${newUser.phone}\\n` +\r\n                `Email connexion : ${newUser.email}\\n` +\r\n                `Rle : ${getRoleLabel(newUser.role)}\\n` +\r\n                `${isParent && newUser.profession ? `Profession : ${newUser.profession}\\n` : ''}` +\r\n                `${isParent && newUser.address ? `Adresse : ${newUser.address}\\n` : ''}` +\r\n                `${isTeacher && newUser.specialty ? `Spcialit : ${newUser.specialty}\\n` : ''}` +\r\n                `\\n` +\r\n                ` Identifiants de connexion :\\n` +\r\n                ` Email : ${newUser.email}\\n` +\r\n                ` Mot de passe : ${newUser.password}\\n\\n` +\r\n                ` EMAIL ENVOY :\\n` +\r\n                `${hasPersonalEmail \r\n                  ? ` Envoy  l'utilisateur : ${newUser.email}\\n   ${isParent ? 'Le parent' : isTeacher ? 'L\\'enseignant' : 'La secrtaire'} a reu ses identifiants de connexion.`\r\n                  : ` Envoy au directeur : ${user.email}\\n    ${isParent ? 'Le parent' : isTeacher ? 'L\\'enseignant' : 'La secrtaire'} n'a pas d'email personnel.\\n   Un email technique a t gnr : ${newUser.email}\\n   Les identifiants ont t envoys  votre adresse.\\n   Veuillez les communiquer par tlphone : ${newUser.phone}`\r\n                }\\n\\n` +\r\n                `${!hasPersonalEmail ? ` Email technique gnr automatiquement.\\n   L'utilisateur se connectera avec : ${newUser.email}\\n\\n` : ''}` +\r\n                `${isParent ? 'Les enfants seront lis lors de la cration des comptes lves.' : ''}`\r\n              );\r\n            }\r\n            \r\n            alert(successMessage);\r\n          } else if (emailResult.fallback) {\r\n            // Fallback: afficher les identifiants si l'email n'a pas pu tre envoy\r\n            const errorDetails = emailResult.technicalError \r\n              ? `\\n\\n Erreur technique : ${emailResult.technicalError}` \r\n              : '';\r\n            \r\n            const configMessage = !isEmailConfigured() \r\n              ? '\\n\\n Pour activer l\\'envoi automatique d\\'emails :\\n1. Crez un compte sur https://emailjs.com\\n2. Configurez un service email (Gmail, Outlook...)\\n3. Crez un template d\\'email\\n4. Ajoutez les cls dans le fichier .env'\r\n              : '\\n\\n EmailJS est configur mais l\\'envoi a chou.\\nVrifiez :\\n Votre connexion Internet\\n Que le Service ID et Template ID sont corrects\\n Que le template existe sur emailjs.com';\r\n            \r\n            let fallbackMessage;\r\n            \r\n            if (newUser.role === 'student') {\r\n              // lve : afficher les identifiants gnrs\r\n              const selectedParent = availableStudents.find(p => p.id === newUser.parentId);\r\n              fallbackMessage = (\r\n                ` Compte lve cr avec succs !\\n\\n` +\r\n                `lve : ${newUser.fullName}\\n` +\r\n                `Classe : ${availableClasses.find(c => c.value === newUser.classId)?.label || 'N/A'}\\n\\n` +\r\n                ` L'email n'a pas pu tre envoy au parent.\\n` +\r\n                `Raison : ${emailResult.error}\\n\\n` +\r\n                ` IDENTIFIANTS  COMMUNIQUER AU PARENT :\\n\\n` +\r\n                ` Email : ${newUser.generatedEmail}\\n` +\r\n                ` Mot de passe : ${newUser.generatedPassword}\\n` +\r\n                ` Matricule : ${newUser.generatedMatricule}\\n\\n` +\r\n                ` Contacter le parent :\\n` +\r\n                ` ${selectedParent?.full_name || 'N/A'}\\n` +\r\n                ` ${selectedParent?.email || 'Pas d\\'email'}\\n` +\r\n                ` ${selectedParent?.phone || 'Pas de tlphone'}\\n\\n` +\r\n                ` IMPORTANT :\\n` +\r\n                ` Notez ces identifiants\\n` +\r\n                ` Communiquez-les au parent/tuteur\\n` +\r\n                ` L'lve pourra se connecter avec ces identifiants` +\r\n                configMessage +\r\n                errorDetails\r\n              );\r\n            } else {\r\n              // Personnel\r\n              fallbackMessage = (\r\n                ` Compte cr avec succs !\\n\\n` +\r\n                `Utilisateur : ${newUser.fullName}\\n` +\r\n                `Email : ${newUser.email}\\n` +\r\n                `Rle : ${getRoleLabel(newUser.role)}\\n\\n` +\r\n                ` L'email n'a pas pu tre envoy automatiquement.\\n` +\r\n                `Raison : ${emailResult.error}\\n\\n` +\r\n                ` IDENTIFIANTS  COMMUNIQUER MANUELLEMENT :\\n\\n` +\r\n                `Email : ${newUser.email}\\n` +\r\n                `Mot de passe : ${newUser.password}\\n\\n` +\r\n                ` IMPORTANT :\\n` +\r\n                ` Notez ces identifiants en lieu sr\\n` +\r\n                ` Communiquez-les directement  ${newUser.fullName}\\n` +\r\n                ` L'utilisateur pourra se connecter avec ces identifiants\\n` +\r\n                ` Ces identifiants ne seront plus affichs aprs fermeture` +\r\n                configMessage +\r\n                errorDetails\r\n              );\r\n            }\r\n            \r\n            alert(fallbackMessage);\r\n          }\r\n        } else {\r\n          // Pour les directeurs/admins\r\n          alert(\r\n            ` Compte cr avec succs !\\n\\n` +\r\n            `Utilisateur : ${newUser.fullName}\\n` +\r\n            `Email : ${newUser.email}\\n` +\r\n            `Rle : ${getRoleLabel(newUser.role)}\\n\\n` +\r\n            ` Un email de confirmation a t envoy  ${newUser.email}`\r\n          );\r\n        }\r\n\r\n        // tape 3: Recharger la liste des comptes\r\n        console.log(' Rechargement de la liste des comptes...');\r\n        await loadAccountsFromSupabase();\r\n        console.log(' Liste des comptes recharge');\r\n\r\n        // Reset du formulaire\r\n        setNewUser({\r\n          fullName: '',\r\n          email: '',\r\n          phone: '',\r\n          role: 'student',\r\n          password: '',\r\n          status: 'active',\r\n          specialty: '',\r\n          hireDate: new Date().toISOString().split('T')[0],\r\n          selectedClasses: [],\r\n          selectedSubjects: [],\r\n          weeklyHours: '',\r\n          permissions: [],\r\n          department: '',\r\n          schoolLevel: 'primary',\r\n          matricule: '',\r\n          classId: '',\r\n          dateOfBirth: '',\r\n          parentId: '',\r\n          parentName: '',\r\n          parentPhone: '',\r\n          parentEmail: '',\r\n          selectedChildren: [],\r\n          profession: '',\r\n          address: ''\r\n        });\r\n\r\n        // Passer  l'onglet des comptes pour voir le nouveau compte\r\n        setActiveTab('accounts');\r\n    } catch (error) {\r\n      console.error(' Erreur cration compte:', error);\r\n      \r\n      let errorMessage = error.message;\r\n      \r\n      // Messages d'erreur personnaliss\r\n      if (errorMessage.includes('already registered')) {\r\n        errorMessage = 'Cet email est dj utilis par un autre compte.';\r\n      } else if (errorMessage.includes('invalid email')) {\r\n        errorMessage = 'L\\'adresse email n\\'est pas valide.';\r\n      } else if (errorMessage.includes('weak password')) {\r\n        errorMessage = 'Le mot de passe est trop faible. Utilisez au moins 8 caractres.';\r\n      }\r\n      \r\n      alert(` Erreur lors de la cration du compte :\\n\\n${errorMessage}`);\r\n      \r\n    } finally {\r\n      setLoadingAccounts(false);\r\n    }\r\n  };\r\n\r\n  // Fonction helper pour les labels de rles\r\n  const getRoleLabel = (role) => {\r\n    const labels = {\r\n      'secretary': 'Secrtaire',\r\n      'teacher': 'Enseignant',\r\n      'student': 'lve',\r\n      'parent': 'Parent',\r\n      'principal': 'Directeur',\r\n      'admin': 'Administrateur'\r\n    };\r\n    return labels[role] || role;\r\n  };\r\n\r\n  // Fonction pour gnrer un matricule unique pour un lve\r\n  const generateStudentMatricule = async (schoolId) => {\r\n    const year = new Date().getFullYear();\r\n\r\n    // Compter les lves existants pour cette cole cette anne\r\n    const { data, error } = await supabase\r\n      .from('students')\r\n      .select('matricule', { count: 'exact' })\r\n      .eq('school_id', schoolId)\r\n      .like('matricule', `STD${year}%`)\r\n      .order('created_at', { ascending: false })\r\n      .limit(1);\r\n\r\n    if (error) {\r\n      console.error('Erreur rcupration matricule:', error);\r\n      // Fallback\r\n      return `STD${year}001`;\r\n    }\r\n\r\n    // Extraire le dernier numro et incrmenter\r\n    let nextNumber = 1;\r\n    if (data && data.length > 0 && data[0].matricule) {\r\n      const lastMatricule = data[0].matricule;\r\n      const lastNumber = parseInt(lastMatricule.slice(-3));\r\n      nextNumber = lastNumber + 1;\r\n    }\r\n\r\n    return `STD${year}${nextNumber.toString().padStart(3, '0')}`;\r\n  };\r\n\r\n  // Fonction pour gnrer un email automatique  partir du matricule\r\n  const generateStudentEmail = (matricule, schoolName) => {\r\n    // Nettoyer le nom de l'cole (enlever espaces, accents, caractres spciaux)\r\n    const cleanSchoolName = schoolName\r\n      .toLowerCase()\r\n      .normalize('NFD')\r\n      .replace(/[\\u0300-\\u036f]/g, '') // Enlever les accents\r\n      .replace(/[^a-z0-9]/g, '') // Garder seulement lettres et chiffres\r\n      .slice(0, 15); // Limiter  15 caractres\r\n    \r\n    return `${matricule.toLowerCase()}@${cleanSchoolName}.edutrack.cm`;\r\n  };\r\n\r\n  // Fonction pour gnrer un mot de passe simple bas sur le prnom + anne\r\n  const generateStudentPassword = (firstName) => {\r\n    const year = new Date().getFullYear();\r\n    // Capitaliser la premire lettre du prnom\r\n    const capitalized = firstName.charAt(0).toUpperCase() + firstName.slice(1).toLowerCase();\r\n    return `${capitalized}${year}`;\r\n  };\r\n\r\n  // Fonction pour dterminer automatiquement le school_level selon le type d'cole et la classe\r\n  const determineSchoolLevel = (schoolType, className) => {\r\n    // Si le type d'cole est dfini clairement\r\n    if (schoolType === 'primary' || schoolType === 'Primaire') {\r\n      return 'primary';\r\n    }\r\n    if (schoolType === 'secondary' || schoolType === 'Collge' || schoolType === 'Lyce') {\r\n      return 'secondary';\r\n    }\r\n    \r\n    // Si cole mixte ou type non dfini, dtecter selon le nom de la classe\r\n    if (!className) return 'primary'; // Par dfaut\r\n    \r\n    const classNameLower = className.toLowerCase();\r\n    \r\n    // Classes du secondaire\r\n    const secondaryKeywords = ['6me', '6eme', '5me', '5eme', '4me', '4eme', '3me', '3eme',\r\n                                '2nde', '2de', 'seconde', '1re', '1ere', 'premire', 'premiere',\r\n                                'tle', 'terminale', 'terminal'];\r\n    \r\n    if (secondaryKeywords.some(keyword => classNameLower.includes(keyword))) {\r\n      return 'secondary';\r\n    }\r\n    \r\n    // Sinon, c'est du primaire (maternelle, CP, CE, CM)\r\n    return 'primary';\r\n  };\r\n\r\n  // Fonction pour charger les comptes depuis Supabase\r\n  const loadAccountsFromSupabase = async () => {\r\n    if (!user?.current_school_id) {\r\n      return;\r\n    }\r\n\r\n    setLoadingAccounts(true);\r\n\r\n    try {\r\n      // Rcuprer les enseignants\r\n      const { data: teachersData, error: teachersError } = await supabase\r\n        .from('teachers')\r\n        .select(`\r\n          id,\r\n          first_name,\r\n          last_name,\r\n          specialty,\r\n          hire_date,\r\n          is_active,\r\n          created_at,\r\n          users!inner (\r\n            id,\r\n            email,\r\n            full_name,\r\n            phone,\r\n            role\r\n          )\r\n        `)\r\n        .eq('school_id', user.current_school_id)\r\n        .eq('is_active', true);\r\n\r\n      if (teachersError) {\r\n        console.error('Erreur lors du chargement des enseignants:', teachersError);\r\n      }\r\n\r\n      // Rcuprer les secrtaires\r\n      const { data: secretariesData, error: secretariesError } = await supabase\r\n        .from('secretaries')\r\n        .select(`\r\n          id,\r\n          first_name,\r\n          last_name,\r\n          hire_date,\r\n          is_active,\r\n          created_at,\r\n          users!inner (\r\n            id,\r\n            email,\r\n            full_name,\r\n            phone,\r\n            role\r\n          )\r\n        `)\r\n        .eq('school_id', user.current_school_id)\r\n        .eq('is_active', true);\r\n\r\n      if (secretariesError) {\r\n        console.error('Erreur lors du chargement des secrtaires:', secretariesError);\r\n      }\r\n\r\n      // Rcuprer les parents (pas de school_id direct dans parents)\r\n      const { data: parentsData, error: parentsError } = await supabase\r\n        .from('parents')\r\n        .select(`\r\n          id,\r\n          first_name,\r\n          last_name,\r\n          profession,\r\n          address,\r\n          created_at,\r\n          users!inner (\r\n            id,\r\n            email,\r\n            full_name,\r\n            phone,\r\n            role\r\n          )\r\n        `);\r\n\r\n      if (parentsError) {\r\n        console.error('Erreur lors du chargement des parents:', parentsError);\r\n      }\r\n\r\n      // Rcuprer les lves\r\n      const { data: studentsData, error: studentsError } = await supabase\r\n        .from('students')\r\n        .select(`\r\n          id,\r\n          first_name,\r\n          last_name,\r\n          registration_number,\r\n          date_of_birth,\r\n          class_id,\r\n          user_id,\r\n          created_at,\r\n          users:user_id (\r\n            id,\r\n            email,\r\n            full_name,\r\n            phone,\r\n            role\r\n          ),\r\n          classes (\r\n            name,\r\n            level\r\n          )\r\n        `)\r\n        .eq('school_id', user.current_school_id)\r\n        .eq('is_active', true);\r\n\r\n      if (studentsError) {\r\n        console.error('Erreur lors du chargement des lves:', studentsError);\r\n      }\r\n\r\n      // Combiner et formater les donnes\r\n      const allPersonnel = [];\r\n      \r\n      // Ajouter les enseignants\r\n      if (teachersData) {\r\n        teachersData.forEach(teacher => {\r\n          allPersonnel.push({\r\n            id: teacher.users.id,\r\n            email: teacher.users.email,\r\n            full_name: teacher.users.full_name || `${teacher.first_name} ${teacher.last_name}`,\r\n            phone: teacher.users.phone,\r\n            role: 'teacher',\r\n            specialty: teacher.specialty,\r\n            is_active: teacher.is_active,\r\n            created_at: teacher.created_at,\r\n            hire_date: teacher.hire_date,\r\n            personnel_id: teacher.id\r\n          });\r\n        });\r\n      }\r\n\r\n      // Ajouter les secrtaires\r\n      if (secretariesData) {\r\n        secretariesData.forEach(secretary => {\r\n          allPersonnel.push({\r\n            id: secretary.users.id,\r\n            email: secretary.users.email,\r\n            full_name: secretary.users.full_name || `${secretary.first_name} ${secretary.last_name}`,\r\n            phone: secretary.users.phone,\r\n            role: 'secretary',\r\n            is_active: secretary.is_active,\r\n            created_at: secretary.created_at,\r\n            hire_date: secretary.hire_date,\r\n            personnel_id: secretary.id\r\n          });\r\n        });\r\n      }\r\n\r\n      // Ajouter les parents\r\n      if (parentsData) {\r\n        parentsData.forEach(parent => {\r\n          allPersonnel.push({\r\n            id: parent.users.id,\r\n            email: parent.users.email,\r\n            full_name: parent.users.full_name || `${parent.first_name} ${parent.last_name}`,\r\n            phone: parent.users.phone,\r\n            role: 'parent',\r\n            profession: parent.profession,\r\n            address: parent.address,\r\n            is_active: true,\r\n            created_at: parent.created_at,\r\n            personnel_id: parent.id\r\n          });\r\n        });\r\n      }\r\n\r\n      // Ajouter les lves\r\n      if (studentsData) {\r\n        studentsData.forEach(student => {\r\n          allPersonnel.push({\r\n            id: student.users?.id || student.id, // user_id peut tre null pour primaire\r\n            email: student.users?.email || 'N/A',\r\n            full_name: student.users?.full_name || `${student.first_name} ${student.last_name}`,\r\n            phone: student.users?.phone || 'N/A',\r\n            role: 'student',\r\n            registration_number: student.registration_number,\r\n            class_name: student.classes?.name,\r\n            class_level: student.classes?.level,\r\n            date_of_birth: student.date_of_birth,\r\n            has_account: !!student.users, // Indique si l'lve a un compte (secondaire)\r\n            is_active: true,\r\n            created_at: student.created_at,\r\n            personnel_id: student.id\r\n          });\r\n        });\r\n      }\r\n\r\n      // Trier par date de cration\r\n      const sortedPersonnel = allPersonnel.sort((a, b) => \r\n        new Date(b.created_at) - new Date(a.created_at)\r\n      );\r\n\r\n      console.log(' Comptes personnel chargs depuis Supabase:', sortedPersonnel.length);\r\n      console.log(' Dtail personnel:', {\r\n        teachers: teachersData?.length || 0,\r\n        secretaries: secretariesData?.length || 0,\r\n        parents: parentsData?.length || 0,\r\n        students: studentsData?.length || 0,\r\n        total: sortedPersonnel.length\r\n      });\r\n      \r\n      setAccounts(sortedPersonnel);\r\n      console.log(' State accounts mis  jour avec', sortedPersonnel.length, 'comptes');\r\n      \r\n    } catch (error) {\r\n      console.error(' Erreur chargement comptes:', error);\r\n      // Ne pas afficher d'alerte, juste logger\r\n    } finally {\r\n      setLoadingAccounts(false);\r\n    }\r\n  };\r\n\r\n  // Charger les comptes au montage du composant\r\n  useEffect(() => {\r\n    if (user?.current_school_id) {\r\n      loadAccountsFromSupabase();\r\n    }\r\n  }, [user?.current_school_id]);\r\n\r\n  // Fonction pour dsactiver un compte (pas supprimer)\r\n  const handleDeactivateAccount = async (accountId, accountName) => {\r\n    const confirmed = confirm(\r\n      ` Dsactiver le compte de ${accountName} ?\\n\\n` +\r\n      `Le compte sera dsactiv mais toutes les donnes cres par cette personne seront conserves.\\n\\n` +\r\n      `Cette action peut tre annule en ractivant le compte.`\r\n    );\r\n\r\n    if (!confirmed) {\r\n      return;\r\n    }\r\n\r\n    setLoadingAccounts(true);\r\n\r\n    try {\r\n      // Appeler la fonction RPC Supabase pour dsactiver\r\n      const { data, error } = await supabase.rpc('deactivate_user_account', {\r\n        p_user_id: accountId,\r\n        p_deactivated_by: user.id\r\n      });\r\n\r\n      if (error) {\r\n        throw error;\r\n      }\r\n\r\n      if (data && !data.success) {\r\n        throw new Error(data.error || 'Erreur lors de la dsactivation');\r\n      }\r\n\r\n      alert(` Compte de ${accountName} dsactiv avec succs !`);\r\n      \r\n      // Recharger la liste\r\n      await loadAccountsFromSupabase();\r\n      \r\n    } catch (error) {\r\n      console.error(' Erreur dsactivation compte:', error);\r\n      alert(` Erreur lors de la dsactivation :\\n\\n${error.message}`);\r\n    } finally {\r\n      setLoadingAccounts(false);\r\n    }\r\n  };\r\n\r\n  // Fonction pour ractiver un compte\r\n  const handleReactivateAccount = async (accountId, accountName) => {\r\n    const confirmed = confirm(\r\n      `Ractiver le compte de ${accountName} ?\\n\\n` +\r\n      `L'utilisateur pourra  nouveau se connecter.`\r\n    );\r\n\r\n    if (!confirmed) {\r\n      return;\r\n    }\r\n\r\n    setLoadingAccounts(true);\r\n\r\n    try {\r\n      const { data, error } = await supabase.rpc('reactivate_user_account', {\r\n        p_user_id: accountId,\r\n        p_reactivated_by: user.id\r\n      });\r\n\r\n      if (error) {\r\n        throw error;\r\n      }\r\n\r\n      if (data && !data.success) {\r\n        throw new Error(data.error || 'Erreur lors de la ractivation');\r\n      }\r\n\r\n      alert(` Compte de ${accountName} ractiv avec succs !`);\r\n      \r\n      // Recharger la liste\r\n      await loadAccountsFromSupabase();\r\n      \r\n    } catch (error) {\r\n      console.error(' Erreur ractivation compte:', error);\r\n      alert(` Erreur lors de la ractivation :\\n\\n${error.message}`);\r\n    } finally {\r\n      setLoadingAccounts(false);\r\n    }\r\n  };\r\n\r\n  // Fonction pour envoyer les identifiants par email\r\n  const sendCredentialsByEmail = (userData) => {\r\n    // Cette fonction serait connecte  un service d'email rel\r\n    console.log('Envoi email :', userData.email);\r\n    alert(`Email d'identifiants envoy  ${userData.email} avec succs !\\n\\nL'utilisateur recevra :\\n- Son email de connexion\\n- Son mot de passe temporaire\\n- Les instructions pour changer son mot de passe`);\r\n  };\r\n\r\n  // Gnration automatique d'un mot de passe scuris\r\n  const generateSecurePassword = () => {\r\n    const lowercase = 'abcdefghijklmnopqrstuvwxyz';\r\n    const uppercase = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';\r\n    const numbers = '0123456789';\r\n    const symbols = '!@#$%^&*()_+-=[]{}|;:,.<>?';\r\n    \r\n    const allChars = lowercase + uppercase + numbers + symbols;\r\n    let password = '';\r\n    \r\n    // Assurer au moins un caractre de chaque type\r\n    password += lowercase[Math.floor(Math.random() * lowercase.length)];\r\n    password += uppercase[Math.floor(Math.random() * uppercase.length)];\r\n    password += numbers[Math.floor(Math.random() * numbers.length)];\r\n    password += symbols[Math.floor(Math.random() * symbols.length)];\r\n    \r\n    // Complter jusqu' 12 caractres\r\n    for (let i = 4; i < 12; i++) {\r\n      password += allChars[Math.floor(Math.random() * allChars.length)];\r\n    }\r\n    \r\n    // Mlanger les caractres\r\n    return password.split('').sort(() => Math.random() - 0.5).join('');\r\n  };\r\n\r\n  const generatePassword = () => {\r\n    const password = generateSecurePassword();\r\n    setNewUser(prev => ({ ...prev, password }));\r\n  };\r\n\r\n  // Rendu du contenu selon l'onglet actif\r\n  const renderTabContent = () => {\r\n    switch (activeTab) {\r\n      case 'overview':\r\n        return renderOverview();\r\n      case 'accounts':\r\n        return renderAccountsList();\r\n      case 'security':\r\n        return renderSecurity();\r\n      case 'create':\r\n        return renderCreateForm();\r\n      default:\r\n        return renderOverview();\r\n    }\r\n  };\r\n\r\n  // Vue d'ensemble avec statistiques - Modernise\r\n  const renderOverview = () => (\r\n    <div className=\"space-y-6\">\r\n      {/* Statistiques gnrales - Modernises */}\r\n      <div className=\"grid grid-cols-1 md:grid-cols-4 gap-4\">\r\n        <div className=\"bg-gradient-to-br from-blue-50 to-indigo-50 border-2 border-blue-200 rounded-2xl p-6 shadow-lg hover:shadow-xl hover:scale-105 transition-all\">\r\n          <div className=\"flex items-center justify-between\">\r\n            <div>\r\n              <p className=\"text-sm font-semibold text-blue-700 mb-1\">Total Comptes</p>\r\n              <p className=\"text-3xl font-bold text-blue-900\">{accountStats.total}</p>\r\n            </div>\r\n            <div className=\"w-12 h-12 bg-gradient-to-br from-blue-600 to-indigo-600 rounded-xl flex items-center justify-center shadow-md\">\r\n              <Icon name=\"Users\" size={24} className=\"text-white\" />\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"bg-gradient-to-br from-green-50 to-emerald-50 border-2 border-green-200 rounded-2xl p-6 shadow-lg hover:shadow-xl hover:scale-105 transition-all\">\r\n          <div className=\"flex items-center justify-between\">\r\n            <div>\r\n              <p className=\"text-sm font-semibold text-green-700 mb-1\">Comptes Actifs</p>\r\n              <p className=\"text-3xl font-bold text-green-900\">{accountStats.active}</p>\r\n            </div>\r\n            <div className=\"w-12 h-12 bg-gradient-to-br from-green-600 to-emerald-600 rounded-xl flex items-center justify-center shadow-md\">\r\n              <Icon name=\"CheckCircle\" size={24} className=\"text-white\" />\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"bg-gradient-to-br from-red-50 to-pink-50 border-2 border-red-200 rounded-2xl p-6 shadow-lg hover:shadow-xl hover:scale-105 transition-all\">\r\n          <div className=\"flex items-center justify-between\">\r\n            <div>\r\n              <p className=\"text-sm font-semibold text-red-700 mb-1\">Comptes Inactifs</p>\r\n              <p className=\"text-3xl font-bold text-red-900\">{accountStats.inactive}</p>\r\n            </div>\r\n            <div className=\"w-12 h-12 bg-gradient-to-br from-red-500 to-pink-500 rounded-xl flex items-center justify-center shadow-md\">\r\n              <Icon name=\"XCircle\" size={24} className=\"text-white\" />\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"bg-gradient-to-br from-amber-50 to-orange-50 border-2 border-amber-200 rounded-2xl p-6 shadow-lg hover:shadow-xl hover:scale-105 transition-all\">\r\n          <div className=\"flex items-center justify-between\">\r\n            <div>\r\n              <p className=\"text-sm font-semibold text-amber-700 mb-1\">Comptes Bloqus</p>\r\n              <p className=\"text-3xl font-bold text-amber-900\">{accountStats.locked}</p>\r\n            </div>\r\n            <div className=\"w-12 h-12 bg-gradient-to-br from-amber-500 to-orange-500 rounded-xl flex items-center justify-center shadow-md\">\r\n              <Icon name=\"Lock\" size={24} className=\"text-white\" />\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Rpartition par rle - Modernise */}\r\n      <div className=\"bg-white border-2 border-gray-200 rounded-2xl p-6 shadow-lg hover:shadow-xl transition-shadow\">\r\n        <div className=\"flex items-center mb-6\">\r\n          <div className=\"w-10 h-10 bg-gradient-to-br from-purple-600 to-pink-600 rounded-xl flex items-center justify-center mr-3 shadow-md\">\r\n            <Icon name=\"BarChart3\" size={20} className=\"text-white\" />\r\n          </div>\r\n          <div>\r\n            <h3 className=\"text-lg font-semibold text-gray-900\">Rpartition par rle</h3>\r\n            <p className=\"text-xs text-gray-500\">Statistiques des diffrents types de comptes</p>\r\n          </div>\r\n        </div>\r\n        <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4\">\r\n          {Object.entries(accountStats.byRole)\r\n            .filter(([role]) => role !== 'principal') // Exclure les directeurs\r\n            .map(([role, count]) => (\r\n            <div key={role} className=\"text-center p-5 bg-gradient-to-br from-gray-50 to-white border-2 border-gray-200 rounded-xl hover:border-blue-400 hover:shadow-lg hover:scale-105 transition-all\">\r\n              <div className=\"w-10 h-10 bg-gradient-to-br from-blue-100 to-indigo-100 rounded-lg flex items-center justify-center mx-auto mb-3\">\r\n                <Icon name={\r\n                  role === 'teacher' ? 'GraduationCap' :\r\n                  role === 'secretary' ? 'UserCheck' :\r\n                  role === 'student' ? 'User' : 'Users'\r\n                } size={20} className=\"text-blue-600\" />\r\n              </div>\r\n              <p className=\"text-sm font-semibold text-gray-700 capitalize mb-1\">\r\n                {role === 'teacher' ? 'Enseignants' :\r\n                 role === 'secretary' ? 'Secrtaires' :\r\n                 role === 'student' ? 'lves' :\r\n                 role === 'parent' ? 'Parents' : role}\r\n              </p>\r\n              <p className=\"text-2xl font-bold text-gray-900\">{count}</p>\r\n            </div>\r\n          ))}\r\n        </div>\r\n      </div>\r\n\r\n      {/* Indicateur de configuration Email - Modernis */}\r\n      <div className={`rounded-2xl border-2 p-5 flex items-start space-x-4 shadow-md ${\r\n        isEmailConfigured() \r\n          ? 'bg-gradient-to-r from-green-50 to-emerald-50 border-green-200' \r\n          : 'bg-gradient-to-r from-amber-50 to-orange-50 border-amber-300'\r\n      }`}>\r\n        <div className={`w-12 h-12 rounded-xl flex items-center justify-center shadow-md ${\r\n          isEmailConfigured()\r\n            ? 'bg-gradient-to-br from-green-600 to-emerald-600'\r\n            : 'bg-gradient-to-br from-amber-500 to-orange-500'\r\n        }`}>\r\n          <Icon \r\n            name={isEmailConfigured() ? \"CheckCircle\" : \"AlertTriangle\"} \r\n            size={24} \r\n            className=\"text-white\"\r\n          />\r\n        </div>\r\n        <div className=\"flex-1\">\r\n          <div className=\"flex items-center space-x-2 mb-2\">\r\n            <Icon name=\"Mail\" size={16} className={isEmailConfigured() ? \"text-green-700\" : \"text-amber-700\"} />\r\n            <h4 className={`text-sm font-semibold ${isEmailConfigured() ? \"text-green-900\" : \"text-amber-900\"}`}>\r\n              {isEmailConfigured() ? ' Envoi automatique d\\'emails activ' : ' Envoi automatique d\\'emails dsactiv'}\r\n            </h4>\r\n          </div>\r\n          <p className={`text-sm ${isEmailConfigured() ? 'text-green-700' : 'text-amber-700'}`}>\r\n            {isEmailConfigured() \r\n              ? 'Les identifiants seront automatiquement envoys par email au personnel lors de la cration de leur compte.'\r\n              : 'Les identifiants seront affichs  l\\'cran pour communication manuelle. Pour activer l\\'envoi automatique, consultez docs/GUIDE_RAPIDE_EMAIL.md'\r\n            }\r\n          </p>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Actions rapides */}\r\n      <div className=\"bg-white rounded-lg border border-gray-200 p-6\">\r\n        <h3 className=\"text-lg font-semibold text-gray-900 mb-4\">Actions rapides</h3>\r\n        <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\r\n          <Button\r\n            onClick={() => setActiveTab('create')}\r\n            className=\"flex items-center justify-center p-4 bg-blue-600 hover:bg-blue-700\"\r\n          >\r\n            <Icon name=\"UserPlus\" size={16} className=\"mr-2\" />\r\n            Crer un compte\r\n          </Button>\r\n          \r\n          <Button\r\n            onClick={() => setActiveTab('security')}\r\n            variant=\"outline\"\r\n            className=\"flex items-center justify-center p-4\"\r\n          >\r\n            <Icon name=\"Shield\" size={16} className=\"mr-2\" />\r\n            Scurit\r\n          </Button>\r\n          \r\n          <Button\r\n            onClick={() => setActiveTab('accounts')}\r\n            variant=\"outline\"\r\n            className=\"flex items-center justify-center p-4\"\r\n          >\r\n            <Icon name=\"Users\" size={16} className=\"mr-2\" />\r\n            Grer comptes\r\n          </Button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n\r\n  // Liste des comptes avec filtres\r\n  const renderAccountsList = () => (\r\n    <div className=\"space-y-6\">\r\n      {/* Filtres et recherche */}\r\n      <div className=\"bg-white rounded-lg border border-gray-200 p-6\">\r\n        <div className=\"flex flex-col md:flex-row gap-4\">\r\n          <div className=\"flex-1\">\r\n            <Input\r\n              placeholder=\"Rechercher par nom ou email...\"\r\n              value={searchTerm}\r\n              onChange={(e) => setSearchTerm(e.target.value)}\r\n              icon=\"Search\"\r\n            />\r\n          </div>\r\n          <Select\r\n            value={selectedRole}\r\n            onChange={setSelectedRole}\r\n            options={roleOptions}\r\n            placeholder=\"Filtrer par rle\"\r\n          />\r\n          <Select\r\n            value={selectedStatus}\r\n            onChange={setSelectedStatus}\r\n            options={statusOptions}\r\n            placeholder=\"Filtrer par statut\"\r\n          />\r\n        </div>\r\n      </div>\r\n\r\n      {/* Liste des comptes */}\r\n      <div className=\"bg-white rounded-lg border border-gray-200 overflow-hidden\">\r\n        <div className=\"overflow-x-auto\">\r\n          <table className=\"min-w-full divide-y divide-gray-200\">\r\n            <thead className=\"bg-gray-50\">\r\n              <tr>\r\n                <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\r\n                  Utilisateur\r\n                </th>\r\n                <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\r\n                  Rle\r\n                </th>\r\n                <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\r\n                  Statut\r\n                </th>\r\n                <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\r\n                  Dernire connexion\r\n                </th>\r\n                <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\r\n                  Actions\r\n                </th>\r\n              </tr>\r\n            </thead>\r\n            <tbody className=\"bg-white divide-y divide-gray-200\">\r\n              {filteredAccounts.map((account) => (\r\n                <tr key={account.id} className=\"hover:bg-gray-50\">\r\n                  <td className=\"px-6 py-4 whitespace-nowrap\">\r\n                    <div className=\"flex items-center\">\r\n                      <div className=\"flex-shrink-0 h-10 w-10\">\r\n                        <div className=\"h-10 w-10 rounded-full bg-gray-300 flex items-center justify-center\">\r\n                          <Icon name=\"User\" size={16} className=\"text-gray-600\" />\r\n                        </div>\r\n                      </div>\r\n                      <div className=\"ml-4\">\r\n                        <div className=\"text-sm font-medium text-gray-900\">{account.full_name}</div>\r\n                        <div className=\"text-sm text-gray-500\">{account.email}</div>\r\n                      </div>\r\n                    </div>\r\n                  </td>\r\n                  <td className=\"px-6 py-4 whitespace-nowrap\">\r\n                    <span className={`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${\r\n                      account.role === 'principal' ? 'bg-purple-100 text-purple-800' :\r\n                      account.role === 'teacher' ? 'bg-blue-100 text-blue-800' :\r\n                      account.role === 'secretary' ? 'bg-green-100 text-green-800' :\r\n                      account.role === 'student' ? 'bg-yellow-100 text-yellow-800' :\r\n                      'bg-gray-100 text-gray-800'\r\n                    }`}>\r\n                      {account.role === 'principal' ? 'Directeur' :\r\n                       account.role === 'teacher' ? 'Enseignant' :\r\n                       account.role === 'secretary' ? 'Secrtaire' :\r\n                       account.role === 'student' ? 'lve' :\r\n                       account.role === 'parent' ? 'Parent' : account.role}\r\n                    </span>\r\n                  </td>\r\n                  <td className=\"px-6 py-4 whitespace-nowrap\">\r\n                    <div className=\"flex items-center\">\r\n                      {(() => {\r\n                        // Grer is_active (Supabase) ou status (dmo)\r\n                        const isActive = account.is_active !== undefined \r\n                          ? account.is_active \r\n                          : account.status === 'active';\r\n                        \r\n                        return (\r\n                          <>\r\n                            <span className={`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${\r\n                              isActive ? 'bg-green-100 text-green-800' : 'bg-red-100 text-red-800'\r\n                            }`}>\r\n                              {isActive ? 'Actif' : 'Inactif'}\r\n                            </span>\r\n                            {account.deactivated_at && (\r\n                              <span className=\"ml-2 text-xs text-gray-500\" title={`Dsactiv le ${new Date(account.deactivated_at).toLocaleDateString('fr-FR')}`}>\r\n                                \r\n                              </span>\r\n                            )}\r\n                          </>\r\n                        );\r\n                      })()}\r\n                      {account.is_locked && (\r\n                        <Icon name=\"Lock\" size={14} className=\"ml-2 text-red-500\" title=\"Compte bloqu\" />\r\n                      )}\r\n                      {account.login_attempts > 0 && (\r\n                        <span className=\"ml-2 text-xs text-orange-600\" title={`${account.login_attempts} tentative(s) choue(s)`}>\r\n                           {account.login_attempts}\r\n                        </span>\r\n                      )}\r\n                    </div>\r\n                  </td>\r\n                  <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-500\">\r\n                    {account.last_login ? new Date(account.last_login).toLocaleString('fr-FR') : 'Jamais'}\r\n                  </td>\r\n                  <td className=\"px-6 py-4 whitespace-nowrap text-sm font-medium\">\r\n                    <div className=\"flex space-x-1\">\r\n                      {/* Bouton Rinitialiser mot de passe */}\r\n                      <Button\r\n                        size=\"sm\"\r\n                        variant=\"outline\"\r\n                        onClick={() => handleResetPassword(account.id, account.full_name, account.email)}\r\n                        title=\"Rinitialiser mot de passe et envoyer par email\"\r\n                        className=\"text-blue-600 hover:text-blue-700\"\r\n                      >\r\n                        <Icon name=\"Key\" size={14} />\r\n                      </Button>\r\n                      \r\n                      {/* Bouton Renvoyer identifiants */}\r\n                      <Button\r\n                        size=\"sm\"\r\n                        variant=\"outline\"\r\n                        onClick={() => handleResendCredentials(account.id, account.full_name, account.email)}\r\n                        title=\"Renvoyer les identifiants par email\"\r\n                        className=\"text-green-600 hover:text-green-700\"\r\n                      >\r\n                        <Icon name=\"Mail\" size={14} />\r\n                      </Button>\r\n                      \r\n                      {/* Bouton Dsactiver/Ractiver */}\r\n                      {(() => {\r\n                        const isActive = account.is_active !== undefined \r\n                          ? account.is_active \r\n                          : account.status === 'active';\r\n                        \r\n                        return (\r\n                          <Button\r\n                            size=\"sm\"\r\n                            variant=\"outline\"\r\n                            onClick={() => {\r\n                              if (isActive) {\r\n                                handleDeactivateAccount(account.id, account.full_name);\r\n                              } else {\r\n                                handleReactivateAccount(account.id, account.full_name);\r\n                              }\r\n                            }}\r\n                            className={isActive ? 'text-red-600 hover:text-red-700' : 'text-green-600 hover:text-green-700'}\r\n                            title={isActive ? 'Dsactiver le compte' : 'Ractiver le compte'}\r\n                          >\r\n                            <Icon name={isActive ? 'UserX' : 'UserCheck'} size={14} />\r\n                          </Button>\r\n                        );\r\n                      })()}\r\n                      \r\n                      {account.is_locked && (\r\n                        <Button\r\n                          size=\"sm\"\r\n                          variant=\"outline\"\r\n                          onClick={() => handleUnlock(account.id, account.full_name)}\r\n                          className=\"text-orange-600 hover:text-orange-700\"\r\n                          title=\"Dbloquer compte\"\r\n                        >\r\n                          <Icon name=\"Unlock\" size={14} />\r\n                        </Button>\r\n                      )}\r\n                    </div>\r\n                  </td>\r\n                </tr>\r\n              ))}\r\n            </tbody>\r\n          </table>\r\n        </div>\r\n      </div>\r\n\r\n      {filteredAccounts.length === 0 && (\r\n        <div className=\"text-center py-8\">\r\n          <Icon name=\"Users\" size={48} className=\"mx-auto text-gray-400 mb-4\" />\r\n          <p className=\"text-gray-500\">Aucun compte trouv avec ces critres</p>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n\r\n  // Onglet scurit\r\n  const renderSecurity = () => (\r\n    <div className=\"space-y-6\">\r\n      {/* Alertes de scurit */}\r\n      <div className=\"bg-white rounded-lg border border-gray-200 p-6\">\r\n        <h3 className=\"text-lg font-semibold text-gray-900 mb-4\">Alertes de scurit</h3>\r\n        <div className=\"space-y-4\">\r\n          {accountStats.locked > 0 && (\r\n            <div className=\"flex items-center p-4 bg-red-50 border border-red-200 rounded-lg\">\r\n              <Icon name=\"AlertTriangle\" size={20} className=\"text-red-600 mr-3\" />\r\n              <div>\r\n                <p className=\"font-medium text-red-800\">\r\n                  {accountStats.locked} compte(s) bloqu(s)\r\n                </p>\r\n                <p className=\"text-sm text-red-700\">\r\n                  Des comptes ont t bloqus suite  des tentatives de connexion choues\r\n                </p>\r\n              </div>\r\n            </div>\r\n          )}\r\n          \r\n          {accounts.filter(acc => acc.login_attempts > 3).length > 0 && (\r\n            <div className=\"flex items-center p-4 bg-orange-50 border border-orange-200 rounded-lg\">\r\n              <Icon name=\"AlertCircle\" size={20} className=\"text-orange-600 mr-3\" />\r\n              <div>\r\n                <p className=\"font-medium text-orange-800\">\r\n                  {accounts.filter(acc => acc.login_attempts > 3).length} compte(s) avec tentatives suspectes\r\n                </p>\r\n                <p className=\"text-sm text-orange-700\">\r\n                  Plusieurs tentatives de connexion choues dtectes\r\n                </p>\r\n              </div>\r\n            </div>\r\n          )}\r\n          \r\n          {accountStats.locked === 0 && accounts.filter(acc => acc.login_attempts > 3).length === 0 && (\r\n            <div className=\"flex items-center p-4 bg-green-50 border border-green-200 rounded-lg\">\r\n              <Icon name=\"Shield\" size={20} className=\"text-green-600 mr-3\" />\r\n              <div>\r\n                <p className=\"font-medium text-green-800\">\r\n                  Aucune alerte de scurit\r\n                </p>\r\n                <p className=\"text-sm text-green-700\">\r\n                  Tous les comptes fonctionnent normalement\r\n                </p>\r\n              </div>\r\n            </div>\r\n          )}\r\n        </div>\r\n      </div>\r\n\r\n      {/* Politique de mots de passe */}\r\n      <div className=\"bg-white rounded-lg border border-gray-200 p-6\">\r\n        <h3 className=\"text-lg font-semibold text-gray-900 mb-4\">Politique de mots de passe</h3>\r\n        <div className=\"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-4\">\r\n          <div className=\"flex items-start space-x-3\">\r\n            <Icon name=\"Shield\" size={20} className=\"text-blue-600 mt-1\" />\r\n            <div>\r\n              <h4 className=\"font-medium text-blue-900\">Exigences de scurit</h4>\r\n              <ul className=\"text-sm text-blue-700 mt-2 space-y-1\">\r\n                <li> Minimum 8 caractres</li>\r\n                <li> Au moins une lettre majuscule et minuscule</li>\r\n                <li> Au moins un chiffre</li>\r\n                <li> Au moins un caractre spcial (!@#$%^&*)</li>\r\n                <li> Gnration automatique recommande</li>\r\n              </ul>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Paramtres de scurit */}\r\n      <div className=\"bg-white rounded-lg border border-gray-200 p-6\">\r\n        <h3 className=\"text-lg font-semibold text-gray-900 mb-4\">Paramtres de scurit</h3>\r\n        <div className=\"space-y-4\">\r\n          <div className=\"flex items-center justify-between p-4 bg-gray-50 rounded-lg\">\r\n            <div>\r\n              <p className=\"font-medium text-gray-900\">Blocage automatique</p>\r\n              <p className=\"text-sm text-gray-600\">Bloquer les comptes aprs 5 tentatives choues</p>\r\n            </div>\r\n            <Button variant=\"outline\" size=\"sm\">\r\n              <Icon name=\"Settings\" size={14} className=\"mr-2\" />\r\n              Configurer\r\n            </Button>\r\n          </div>\r\n          \r\n          <div className=\"flex items-center justify-between p-4 bg-gray-50 rounded-lg\">\r\n            <div>\r\n              <p className=\"font-medium text-gray-900\">Expiration des mots de passe</p>\r\n              <p className=\"text-sm text-gray-600\">Forcer le changement de mot de passe tous les 90 jours</p>\r\n            </div>\r\n            <Button variant=\"outline\" size=\"sm\">\r\n              <Icon name=\"Settings\" size={14} className=\"mr-2\" />\r\n              Configurer\r\n            </Button>\r\n          </div>\r\n          \r\n          <div className=\"flex items-center justify-between p-4 bg-gray-50 rounded-lg\">\r\n            <div>\r\n              <p className=\"font-medium text-gray-900\">Journalisation</p>\r\n              <p className=\"text-sm text-gray-600\">Enregistrer toutes les connexions et actions</p>\r\n            </div>\r\n            <Button variant=\"outline\" size=\"sm\">\r\n              <Icon name=\"FileText\" size={14} className=\"mr-2\" />\r\n              Voir logs\r\n            </Button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Actions de scurit globales */}\r\n      <div className=\"bg-white rounded-lg border border-gray-200 p-6\">\r\n        <h3 className=\"text-lg font-semibold text-gray-900 mb-4\">Actions globales</h3>\r\n        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n          <Button\r\n            variant=\"outline\"\r\n            className=\"flex items-center justify-center p-4 text-orange-600 border-orange-200 hover:bg-orange-50\"\r\n            onClick={() => {\r\n              alert('Fonction de dblocage global');\r\n            }}\r\n          >\r\n            <Icon name=\"Unlock\" size={16} className=\"mr-2\" />\r\n            Dbloquer tous les comptes\r\n          </Button>\r\n          \r\n          <Button\r\n            variant=\"outline\"\r\n            className=\"flex items-center justify-center p-4 text-blue-600 border-blue-200 hover:bg-blue-50\"\r\n            onClick={() => {\r\n              alert('Fonction de notification globale');\r\n            }}\r\n          >\r\n            <Icon name=\"Bell\" size={16} className=\"mr-2\" />\r\n            Forcer changement mot de passe\r\n          </Button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n\r\n  // Formulaire de cration de compte\r\n  const renderCreateForm = () => (\r\n    <div className=\"max-w-4xl mx-auto\">\r\n      <div className=\"bg-white rounded-lg border border-gray-200 p-6\">\r\n        <h3 className=\"text-lg font-semibold text-gray-900 mb-6\">Crer un nouveau compte</h3>\r\n        \r\n        <div className=\"space-y-6\">\r\n          {/* Informations de base - Communes  tous */}\r\n          <div>\r\n            <h4 className=\"text-sm font-medium text-gray-700 mb-4 flex items-center\">\r\n              <Icon name=\"User\" size={16} className=\"mr-2\" />\r\n              Informations gnrales\r\n            </h4>\r\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n              <Input\r\n                label=\"Nom complet *\"\r\n                value={newUser.fullName}\r\n                onChange={(e) => setNewUser(prev => ({ ...prev, fullName: e.target.value }))}\r\n                placeholder=\"Nom et prnom\"\r\n              />\r\n              \r\n              {/* Email et Tlphone uniquement pour le personnel (pas pour lve) */}\r\n              {newUser.role !== 'student' && (\r\n                <Input\r\n                  label={['parent', 'teacher', 'secretary'].includes(newUser.role) ? 'Email (optionnel)' : 'Email *'}\r\n                  type=\"email\"\r\n                  value={newUser.email}\r\n                  onChange={(e) => setNewUser(prev => ({ ...prev, email: e.target.value }))}\r\n                  placeholder={['parent', 'teacher', 'secretary'].includes(newUser.role) ? 'email@exemple.com (si disponible)' : 'email@exemple.com'}\r\n                />\r\n              )}\r\n              \r\n              {newUser.role === 'student' && (\r\n                <Select\r\n                  label=\"Rle *\"\r\n                  value={newUser.role}\r\n                  onChange={(value) => {\r\n                    // Rinitialiser les champs spcifiques au rle\r\n                    setNewUser(prev => ({\r\n                      ...prev,\r\n                      role: value,\r\n                      specialty: '',\r\n                      selectedClasses: [],\r\n                      selectedSubjects: [],\r\n                      weeklyHours: '',\r\n                      permissions: [],\r\n                      department: '',\r\n                      classId: '',\r\n                      dateOfBirth: '',\r\n                      parentName: '',\r\n                      parentPhone: '',\r\n                      parentEmail: '',\r\n                      selectedChildren: [],\r\n                      profession: ''\r\n                    }));\r\n                  }}\r\n                  options={newUserRoleOptions}\r\n                />\r\n              )}\r\n            </div>\r\n            \r\n            {newUser.role !== 'student' && (\r\n              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4 mt-4\">\r\n                <Input\r\n                  label=\"Tlphone *\"\r\n                  value={newUser.phone}\r\n                  onChange={(e) => setNewUser(prev => ({ ...prev, phone: e.target.value }))}\r\n                  placeholder=\"+237 6XX XXX XXX\"\r\n                  className={['parent', 'teacher', 'secretary'].includes(newUser.role) ? 'border-orange-300' : ''}\r\n                />\r\n                \r\n                <Select\r\n                  label=\"Rle *\"\r\n                  value={newUser.role}\r\n                  onChange={(value) => {\r\n                    // Rinitialiser les champs spcifiques au rle\r\n                    setNewUser(prev => ({\r\n                      ...prev,\r\n                      role: value,\r\n                      specialty: '',\r\n                      selectedClasses: [],\r\n                      selectedSubjects: [],\r\n                      weeklyHours: '',\r\n                      permissions: [],\r\n                      department: '',\r\n                      classId: '',\r\n                      dateOfBirth: '',\r\n                      parentName: '',\r\n                      parentPhone: '',\r\n                      parentEmail: '',\r\n                      selectedChildren: [],\r\n                      profession: '',\r\n                      address: ''\r\n                    }));\r\n                  }}\r\n                  options={newUserRoleOptions}\r\n                />\r\n              </div>\r\n            )}\r\n            \r\n            {/* Explication pour les lves */}\r\n            {newUser.role === 'student' && (\r\n              <div className=\"mt-4 p-4 bg-blue-50 border border-blue-200 rounded-lg\">\r\n                <div className=\"flex items-start space-x-2\">\r\n                  <Icon name=\"Info\" size={16} className=\"text-blue-600 mt-0.5\" />\r\n                  <div className=\"text-sm text-blue-800\">\r\n                    <strong>Pour les lves :</strong> L'email sera gnr automatiquement pour les lves du secondaire \r\n                    (format: matricule@ecole.edutrack.cm). Les lves du primaire n'auront pas de compte de connexion.\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            )}\r\n            \r\n            {/* Explication pour le personnel */}\r\n            {['teacher', 'secretary'].includes(newUser.role) && (\r\n              <div className=\"mt-4 p-4 bg-green-50 border border-green-200 rounded-lg\">\r\n                <div className=\"flex items-start space-x-2\">\r\n                  <Icon name=\"Info\" size={16} className=\"text-green-600 mt-0.5\" />\r\n                  <div className=\"text-sm text-green-800\">\r\n                    <strong>Email optionnel :</strong> Si l'{newUser.role === 'teacher' ? 'enseignant' : 'la secrtaire'} n'a pas d'email personnel, \r\n                    un email technique sera gnr automatiquement (format: {newUser.role === 'teacher' ? 'enseignant' : 'secretaire'}[tlphone]@edutrack.cm).\r\n                    <br/>\r\n                    <span className=\"text-xs\">Le tlphone est obligatoire pour gnrer l'email si ncessaire.</span>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            )}\r\n          </div>\r\n\r\n          {/* Champs spcifiques ENSEIGNANT */}\r\n          {newUser.role === 'teacher' && (\r\n            <div className=\"border-t pt-6\">\r\n              <h4 className=\"text-sm font-medium text-gray-700 mb-4 flex items-center\">\r\n                <Icon name=\"BookOpen\" size={16} className=\"mr-2 text-blue-600\" />\r\n                Informations professionnelles (Enseignant)\r\n              </h4>\r\n              <div className=\"space-y-4\">\r\n                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n                  <div>\r\n                    <label className=\"block text-sm font-medium text-gray-700 mb-2\">\r\n                      Spcialit / Matire principale *\r\n                    </label>\r\n                    <select\r\n                      value={newUser.specialty}\r\n                      onChange={(e) => {\r\n                        if (e.target.value === 'add_new') {\r\n                          setShowAddSubject(true);\r\n                        } else {\r\n                          setNewUser(prev => ({ ...prev, specialty: e.target.value }));\r\n                        }\r\n                      }}\r\n                      className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"\r\n                      disabled={loadingReference}\r\n                    >\r\n                      <option value=\"\">Slectionnez une matire</option>\r\n                      {availableSubjects.map(subj => (\r\n                        <option key={subj.value} value={subj.label}>\r\n                          {subj.label}\r\n                        </option>\r\n                      ))}\r\n                      <option value=\"add_new\" className=\"text-blue-600 font-semibold\">\r\n                         Ajouter une nouvelle matire...\r\n                      </option>\r\n                    </select>\r\n                    \r\n                    {/* Modal d'ajout de matire */}\r\n                    {showAddSubject && (\r\n                      <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\">\r\n                        <div className=\"bg-white rounded-lg p-6 max-w-md w-full mx-4\">\r\n                          <h3 className=\"text-lg font-semibold text-gray-900 mb-4\">\r\n                            Ajouter une nouvelle matire\r\n                          </h3>\r\n                          <Input\r\n                            label=\"Nom de la matire\"\r\n                            value={newSubjectName}\r\n                            onChange={(e) => setNewSubjectName(e.target.value)}\r\n                            placeholder=\"Ex: Philosophie, conomie...\"\r\n                            autoFocus\r\n                          />\r\n                          <div className=\"flex space-x-3 mt-6\">\r\n                            <Button\r\n                              variant=\"outline\"\r\n                              onClick={() => {\r\n                                setShowAddSubject(false);\r\n                                setNewSubjectName('');\r\n                              }}\r\n                              disabled={addingSubject}\r\n                              className=\"flex-1\"\r\n                            >\r\n                              Annuler\r\n                            </Button>\r\n                            <Button\r\n                              onClick={handleAddSubject}\r\n                              disabled={addingSubject || !newSubjectName.trim()}\r\n                              className=\"flex-1 bg-blue-600 hover:bg-blue-700\"\r\n                            >\r\n                              {addingSubject ? 'Ajout...' : 'Ajouter'}\r\n                            </Button>\r\n                          </div>\r\n                        </div>\r\n                      </div>\r\n                    )}\r\n                  </div>\r\n                  \r\n                  <Input\r\n                    label=\"Date d'embauche\"\r\n                    type=\"date\"\r\n                    value={newUser.hireDate}\r\n                    onChange={(e) => setNewUser(prev => ({ ...prev, hireDate: e.target.value }))}\r\n                  />\r\n                </div>\r\n\r\n                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n                  <div>\r\n                    <label className=\"block text-sm font-medium text-gray-700 mb-2\">\r\n                      Classes assignes\r\n                    </label>\r\n                    <select\r\n                      multiple\r\n                      value={newUser.selectedClasses}\r\n                      onChange={(e) => {\r\n                        const values = Array.from(e.target.selectedOptions, option => option.value);\r\n                        setNewUser(prev => ({ ...prev, selectedClasses: values }));\r\n                      }}\r\n                      className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"\r\n                      style={{ minHeight: '120px' }}\r\n                      disabled={loadingReference || availableClasses.length === 0}\r\n                    >\r\n                      {loadingReference ? (\r\n                        <option disabled>Chargement des classes...</option>\r\n                      ) : availableClasses.length === 0 ? (\r\n                        <option disabled>Aucune classe disponible. Crez des classes d'abord.</option>\r\n                      ) : (\r\n                        availableClasses.map(cls => (\r\n                          <option key={cls.value} value={cls.value}>\r\n                            {cls.label}\r\n                          </option>\r\n                        ))\r\n                      )}\r\n                    </select>\r\n                    <p className=\"text-xs text-gray-500 mt-1\">\r\n                      {availableClasses.length > 0 \r\n                        ? 'Maintenez Ctrl/Cmd pour slectionner plusieurs' \r\n                        : 'Crez des classes dans \"Gestion des classes\" d\\'abord'}\r\n                    </p>\r\n                  </div>\r\n\r\n                  <div>\r\n                    <div className=\"flex items-center justify-between mb-2\">\r\n                      <label className=\"block text-sm font-medium text-gray-700\">\r\n                        Matires enseignes\r\n                      </label>\r\n                      <button\r\n                        type=\"button\"\r\n                        onClick={() => setShowAddSubject(true)}\r\n                        className=\"text-xs text-blue-600 hover:text-blue-700 font-medium flex items-center\"\r\n                      >\r\n                        <Icon name=\"Plus\" size={14} className=\"mr-1\" />\r\n                        Ajouter\r\n                      </button>\r\n                    </div>\r\n                    <select\r\n                      multiple\r\n                      value={newUser.selectedSubjects}\r\n                      onChange={(e) => {\r\n                        const values = Array.from(e.target.selectedOptions, option => option.value);\r\n                        setNewUser(prev => ({ ...prev, selectedSubjects: values }));\r\n                      }}\r\n                      className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"\r\n                      style={{ minHeight: '120px' }}\r\n                      disabled={loadingReference || availableSubjects.length === 0}\r\n                    >\r\n                      {loadingReference ? (\r\n                        <option disabled>Chargement des matires...</option>\r\n                      ) : availableSubjects.length === 0 ? (\r\n                        <option disabled>Aucune matire disponible. Ajoutez-en une avec le bouton \"Ajouter\".</option>\r\n                      ) : (\r\n                        availableSubjects.map(subj => (\r\n                          <option key={subj.value} value={subj.value}>\r\n                            {subj.label}\r\n                          </option>\r\n                        ))\r\n                      )}\r\n                    </select>\r\n                    <p className=\"text-xs text-gray-500 mt-1\">\r\n                      {availableSubjects.length > 0 \r\n                        ? 'Maintenez Ctrl/Cmd pour slectionner plusieurs' \r\n                        : 'Cliquez sur \"Ajouter\" pour crer une matire'}\r\n                    </p>\r\n                  </div>\r\n                </div>\r\n\r\n                <Input\r\n                  label=\"Heures hebdomadaires\"\r\n                  type=\"number\"\r\n                  value={newUser.weeklyHours}\r\n                  onChange={(e) => setNewUser(prev => ({ ...prev, weeklyHours: e.target.value }))}\r\n                  placeholder=\"Ex: 18\"\r\n                  min=\"1\"\r\n                  max=\"40\"\r\n                />\r\n\r\n                {newUser.selectedClasses.length > 0 && (\r\n                  <div className=\"bg-blue-50 border border-blue-200 rounded-lg p-3\">\r\n                    <p className=\"text-sm text-blue-800\">\r\n                      <strong>Classes slectionnes ({newUser.selectedClasses.length}):</strong>\r\n                      {' '}\r\n                      {newUser.selectedClasses.map(id => \r\n                        availableClasses.find(c => c.value === id)?.label\r\n                      ).join(', ')}\r\n                    </p>\r\n                  </div>\r\n                )}\r\n\r\n                {newUser.selectedSubjects.length > 0 && (\r\n                  <div className=\"bg-blue-50 border border-blue-200 rounded-lg p-3\">\r\n                    <p className=\"text-sm text-blue-800\">\r\n                      <strong>Matires slectionnes ({newUser.selectedSubjects.length}):</strong>\r\n                      {' '}\r\n                      {newUser.selectedSubjects.map(id => \r\n                        availableSubjects.find(s => s.value === id)?.label\r\n                      ).join(', ')}\r\n                    </p>\r\n                  </div>\r\n                )}\r\n              </div>\r\n            </div>\r\n          )}\r\n\r\n          {/* Champs spcifiques SECRTAIRE */}\r\n          {newUser.role === 'secretary' && (\r\n            <div className=\"border-t pt-6\">\r\n              <h4 className=\"text-sm font-medium text-gray-700 mb-4 flex items-center\">\r\n                <Icon name=\"Briefcase\" size={16} className=\"mr-2 text-purple-600\" />\r\n                Informations professionnelles (Secrtaire)\r\n              </h4>\r\n              <div className=\"space-y-4\">\r\n                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n                  <Input\r\n                    label=\"Dpartement\"\r\n                    value={newUser.department}\r\n                    onChange={(e) => setNewUser(prev => ({ ...prev, department: e.target.value }))}\r\n                    placeholder=\"Ex: Administration, Pdagogie...\"\r\n                  />\r\n                  \r\n                  <Input\r\n                    label=\"Date d'embauche\"\r\n                    type=\"date\"\r\n                    value={newUser.hireDate}\r\n                    onChange={(e) => setNewUser(prev => ({ ...prev, hireDate: e.target.value }))}\r\n                  />\r\n                </div>\r\n\r\n                <div>\r\n                  <label className=\"block text-sm font-medium text-gray-700 mb-2\">\r\n                    Permissions accordes\r\n                  </label>\r\n                  <div className=\"space-y-2\">\r\n                    {permissionsOptions.map(perm => (\r\n                      <label key={perm.value} className=\"flex items-center space-x-2 p-2 hover:bg-gray-50 rounded-lg cursor-pointer\">\r\n                        <input\r\n                          type=\"checkbox\"\r\n                          checked={newUser.permissions.includes(perm.value)}\r\n                          onChange={(e) => {\r\n                            if (e.target.checked) {\r\n                              setNewUser(prev => ({\r\n                                ...prev,\r\n                                permissions: [...prev.permissions, perm.value]\r\n                              }));\r\n                            } else {\r\n                              setNewUser(prev => ({\r\n                                ...prev,\r\n                                permissions: prev.permissions.filter(p => p !== perm.value)\r\n                              }));\r\n                            }\r\n                          }}\r\n                          className=\"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500\"\r\n                        />\r\n                        <span className=\"text-sm text-gray-700\">{perm.label}</span>\r\n                      </label>\r\n                    ))}\r\n                  </div>\r\n                </div>\r\n\r\n                {newUser.permissions.length > 0 && (\r\n                  <div className=\"bg-purple-50 border border-purple-200 rounded-lg p-3\">\r\n                    <p className=\"text-sm text-purple-800\">\r\n                      <strong>Permissions accordes ({newUser.permissions.length}):</strong>\r\n                      {' '}\r\n                      {newUser.permissions.map(p => \r\n                        permissionsOptions.find(opt => opt.value === p)?.label\r\n                      ).join(', ')}\r\n                    </p>\r\n                  </div>\r\n                )}\r\n              </div>\r\n            </div>\r\n          )}\r\n\r\n          {/* Champs spcifiques LVE */}\r\n          {newUser.role === 'student' && (\r\n            <div className=\"border-t pt-6\">\r\n              <h4 className=\"text-sm font-medium text-gray-700 mb-4 flex items-center\">\r\n                <Icon name=\"GraduationCap\" size={16} className=\"mr-2 text-green-600\" />\r\n                Informations scolaires (lve)\r\n              </h4>\r\n              \r\n              <div className=\"space-y-4\">\r\n                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n                  <div>\r\n                    <Select\r\n                      label=\"Classe *\"\r\n                      value={newUser.classId}\r\n                      onChange={(value) => setNewUser(prev => ({ ...prev, classId: value }))}\r\n                      options={[\r\n                        { value: '', label: 'Slectionnez une classe' },\r\n                        ...availableClasses\r\n                      ]}\r\n                      disabled={loadingReference}\r\n                    />\r\n                    {newUser.classId && (\r\n                      <div className={`mt-2 inline-flex items-center px-3 py-1 rounded-full text-xs font-medium ${\r\n                        newUser.schoolLevel === 'secondary' \r\n                          ? 'bg-green-100 text-green-800' \r\n                          : 'bg-blue-100 text-blue-800'\r\n                      }`}>\r\n                        <Icon \r\n                          name={newUser.schoolLevel === 'secondary' ? 'CheckCircle' : 'Info'} \r\n                          size={14} \r\n                          className=\"mr-1\" \r\n                        />\r\n                        {newUser.schoolLevel === 'secondary' ? (\r\n                          <span>\r\n                            <strong>Secondaire</strong> - Compte personnel sera cr (matricule + email)\r\n                          </span>\r\n                        ) : (\r\n                          <span>\r\n                            <strong>Primaire</strong> - Pas de compte personnel (gr par le parent)\r\n                          </span>\r\n                        )}\r\n                      </div>\r\n                    )}\r\n                  </div>\r\n                  \r\n                  <Input\r\n                    label=\"Date de naissance\"\r\n                    type=\"date\"\r\n                    value={newUser.dateOfBirth}\r\n                    onChange={(e) => setNewUser(prev => ({ ...prev, dateOfBirth: e.target.value }))}\r\n                  />\r\n                </div>\r\n\r\n                <h5 className=\"text-sm font-medium text-gray-700 mt-6 mb-2 flex items-center\">\r\n                  <Icon name=\"Users\" size={14} className=\"mr-2 text-orange-600\" />\r\n                  Lier  un parent existant *\r\n                </h5>\r\n                <p className=\"text-xs text-gray-600 mb-3\">\r\n                  Slectionnez le parent ou tuteur responsable de cet lve. Le parent doit avoir t cr au pralable.\r\n                </p>\r\n                \r\n                {availableStudents.length === 0 && !loadingReference ? (\r\n                  <div className=\"p-4 bg-yellow-50 border border-yellow-200 rounded-lg\">\r\n                    <div className=\"flex items-start space-x-2\">\r\n                      <Icon name=\"AlertTriangle\" size={16} className=\"text-yellow-600 mt-0.5\" />\r\n                      <div className=\"text-sm text-yellow-800\">\r\n                        <strong>Aucun parent disponible</strong>\r\n                        <p className=\"mt-1\">\r\n                          Vous devez d'abord crer un compte PARENT avant de pouvoir inscrire un lve.\r\n                        </p>\r\n                        <p className=\"mt-2\">\r\n                          <strong>Comment faire :</strong><br/>\r\n                          1. Slectionnez le rle \"Parent\" ci-dessus<br/>\r\n                          2. Crez le compte du parent<br/>\r\n                          3. Revenez crer l'lve et slectionnez ce parent\r\n                        </p>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                ) : (\r\n                  <div>\r\n                    <Select\r\n                      label=\"Parent/Tuteur *\"\r\n                      value={newUser.parentId || ''}\r\n                      onChange={(value) => setNewUser(prev => ({ ...prev, parentId: value }))}\r\n                      options={[\r\n                        { value: '', label: 'Slectionnez un parent' },\r\n                        ...availableStudents.map(parent => ({\r\n                          value: parent.id,\r\n                          label: `${parent.full_name} - ${parent.email || parent.phone || 'Pas de contact'}`\r\n                        }))\r\n                      ]}\r\n                      disabled={loadingReference}\r\n                      helperText=\"Le parent recevra les informations de l'lve. Pour le secondaire, il recevra aussi les identifiants de connexion.\"\r\n                    />\r\n                    \r\n                    {!newUser.parentId && (\r\n                      <div className=\"mt-3 p-3 bg-blue-50 border border-blue-200 rounded-lg\">\r\n                        <div className=\"flex items-start space-x-2\">\r\n                          <Icon name=\"Info\" size={16} className=\"text-blue-600 mt-0.5\" />\r\n                          <div className=\"text-sm text-blue-800\">\r\n                            <strong>Conseil :</strong> Si le parent n'apparat pas dans la liste, crez d'abord son compte \r\n                            avec le rle \"Parent\", puis revenez crer l'lve.\r\n                          </div>\r\n                        </div>\r\n                      </div>\r\n                    )}\r\n                  </div>\r\n                )}\r\n              </div>\r\n            </div>\r\n          )}\r\n\r\n          {/* Champs spcifiques PARENT */}\r\n          {newUser.role === 'parent' && (\r\n            <div className=\"border-t pt-6\">\r\n              <h4 className=\"text-sm font-medium text-gray-700 mb-4 flex items-center\">\r\n                <Icon name=\"Users\" size={16} className=\"mr-2 text-orange-600\" />\r\n                Informations complmentaires (Parent)\r\n              </h4>\r\n              \r\n              {/* Message explicatif */}\r\n              <div className=\"mb-4 p-4 bg-blue-50 border border-blue-200 rounded-lg\">\r\n                <div className=\"flex items-start space-x-2\">\r\n                  <Icon name=\"Info\" size={16} className=\"text-blue-600 mt-0.5\" />\r\n                  <div className=\"text-sm text-blue-800\">\r\n                    <strong>Comment a fonctionne :</strong>\r\n                    <ol className=\"mt-2 ml-4 list-decimal space-y-1\">\r\n                      <li>Crez d'abord le compte du parent (nom, <strong className=\"text-orange-700\">tlphone obligatoire</strong>, email optionnel, mot de passe)</li>\r\n                      <li>Ensuite, crez les comptes des lves et slectionnez ce parent</li>\r\n                      <li>Le lien parent-enfant sera tabli automatiquement</li>\r\n                    </ol>\r\n                    <div className=\"mt-3 pt-3 border-t border-blue-300\">\r\n                      <p className=\"text-xs text-blue-700 font-medium mb-1\">\r\n                        <Icon name=\"Phone\" size={12} className=\"inline mr-1\" />\r\n                        Tlphone obligatoire - Email optionnel\r\n                      </p>\r\n                      <p className=\"text-xs text-blue-600 ml-4\">\r\n                         Le tlphone est le moyen de contact principal<br/>\r\n                         Si le parent n'a pas d'email, un email technique sera gnr automatiquement<br/>\r\n                         Format : parent[tlphone]@edutrack.cm<br/>\r\n                         Le parent utilisera cet email + son mot de passe pour se connecter\r\n                      </p>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n\r\n              <div className=\"space-y-4\">\r\n                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n                  <Input\r\n                    label=\"Profession (optionnel)\"\r\n                    value={newUser.profession}\r\n                    onChange={(e) => setNewUser(prev => ({ ...prev, profession: e.target.value }))}\r\n                    placeholder=\"Ex: Enseignant, Mdecin, Commerant...\"\r\n                  />\r\n                  \r\n                  <Input\r\n                    label=\"Adresse *\"\r\n                    value={newUser.address}\r\n                    onChange={(e) => setNewUser(prev => ({ ...prev, address: e.target.value }))}\r\n                    placeholder=\"Quartier, Ville\"\r\n                    required\r\n                  />\r\n                </div>\r\n              </div>\r\n            </div>\r\n          )}\r\n\r\n          {/* Informations de connexion - Uniquement pour le personnel (pas pour les lves) */}\r\n          {newUser.role !== 'student' && (\r\n            <div className=\"border-t pt-6\">\r\n              <h4 className=\"text-sm font-medium text-gray-700 mb-4 flex items-center\">\r\n                <Icon name=\"Lock\" size={16} className=\"mr-2\" />\r\n                Informations de connexion\r\n              </h4>\r\n              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n                <div>\r\n                  <div className=\"relative\">\r\n                    <Input\r\n                      label=\"Mot de passe *\"\r\n                      type={showPassword ? \"text\" : \"password\"}\r\n                      value={newUser.password}\r\n                      onChange={(e) => setNewUser(prev => ({ ...prev, password: e.target.value }))}\r\n                      placeholder=\"Minimum 8 caractres\"\r\n                      helperText=\"Lettres, chiffres et caractres spciaux recommands\"\r\n                    />\r\n                    <button\r\n                      type=\"button\"\r\n                      onClick={() => setShowPassword(!showPassword)}\r\n                      className=\"absolute right-3 top-9 text-gray-500 hover:text-gray-700 transition-colors\"\r\n                      title={showPassword ? \"Masquer le mot de passe\" : \"Afficher le mot de passe\"}\r\n                    >\r\n                      <Icon name={showPassword ? \"EyeOff\" : \"Eye\"} size={18} />\r\n                    </button>\r\n                  </div>\r\n                  <div className=\"flex space-x-2 mt-2\">\r\n                    <Button\r\n                      type=\"button\"\r\n                      variant=\"outline\"\r\n                      size=\"sm\"\r\n                      onClick={generatePassword}\r\n                    >\r\n                      <Icon name=\"Shuffle\" size={14} className=\"mr-2\" />\r\n                      Gnrer automatiquement\r\n                    </Button>\r\n                    <Button\r\n                      type=\"button\"\r\n                      variant=\"ghost\"\r\n                      size=\"sm\"\r\n                      onClick={() => {\r\n                        if (newUser.password) {\r\n                          navigator.clipboard.writeText(newUser.password);\r\n                          alert('Mot de passe copi dans le presse-papiers');\r\n                        }\r\n                      }}\r\n                      disabled={!newUser.password}\r\n                    >\r\n                      <Icon name=\"Copy\" size={14} className=\"mr-2\" />\r\n                      Copier\r\n                    </Button>\r\n                  </div>\r\n              </div>\r\n              \r\n              <Select\r\n                label=\"Statut\"\r\n                value={newUser.status}\r\n                onChange={(value) => setNewUser(prev => ({ ...prev, status: value }))}\r\n                options={[\r\n                  { value: 'active', label: 'Actif' },\r\n                  { value: 'inactive', label: 'Inactif' }\r\n                ]}\r\n              />\r\n            </div>\r\n          </div>\r\n          )}\r\n          \r\n          <div className=\"border-t pt-6 flex justify-end space-x-4\">\r\n            <Button\r\n              variant=\"outline\"\r\n              onClick={() => {\r\n                setNewUser({\r\n                  fullName: '',\r\n                  email: '',\r\n                  phone: '',\r\n                  role: 'student',\r\n                  password: '',\r\n                  status: 'active',\r\n                  specialty: '',\r\n                  hireDate: new Date().toISOString().split('T')[0],\r\n                  selectedClasses: [],\r\n                  selectedSubjects: [],\r\n                  weeklyHours: '',\r\n                  permissions: [],\r\n                  department: '',\r\n                  classId: '',\r\n                  dateOfBirth: '',\r\n                  parentName: '',\r\n                  parentPhone: '',\r\n                  parentEmail: '',\r\n                  selectedChildren: [],\r\n                  profession: ''\r\n                });\r\n                setActiveTab('overview');\r\n              }}\r\n            >\r\n              Annuler\r\n            </Button>\r\n            \r\n            <Button\r\n              onClick={handleCreateUser}\r\n              className=\"bg-blue-600 hover:bg-blue-700\"\r\n              disabled={loadingAccounts}\r\n            >\r\n              <Icon name=\"UserPlus\" size={16} className=\"mr-2\" />\r\n              {loadingAccounts ? 'Cration...' : 'Crer le compte'}\r\n            </Button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n\r\n  // Protection contre le rendu tant que les donnes ne sont pas charges\r\n  if (!userDataLoaded) {\r\n    return (\r\n      <div className=\"flex items-center justify-center h-64\">\r\n        <div className=\"text-center\">\r\n          <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4\"></div>\r\n          <p className=\"text-gray-600\">Chargement...</p>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      {/* Navigation par onglets - Style diffrent du menu principal */}\r\n      <div className=\"bg-white rounded-lg border border-gray-200 shadow-sm\">\r\n        <div className=\"border-b border-gray-200\">\r\n          <nav className=\"flex space-x-2 px-4\" aria-label=\"Sous-menu Gestion des comptes\">\r\n            {tabs.map((tab) => (\r\n              <button\r\n                key={tab.id}\r\n                onClick={() => setActiveTab(tab.id)}\r\n                className={`flex items-center space-x-2 px-4 py-3 text-sm border-b-2 transition-all duration-200 ${\r\n                  activeTab === tab.id\r\n                    ? 'border-blue-600 text-blue-600 font-semibold'\r\n                    : 'border-transparent text-gray-600 hover:text-gray-900 hover:border-gray-300'\r\n                }`}\r\n              >\r\n                <Icon name={tab.icon} size={18} />\r\n                <span>{tab.label}</span>\r\n              </button>\r\n            ))}\r\n          </nav>\r\n        </div>\r\n\r\n        {/* Contenu de l'onglet */}\r\n        <div className=\"p-6\">\r\n          {renderTabContent()}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default AccountsManagement;","import { supabase } from '../lib/supabase';\r\n\r\n/**\r\n * Service de diagnostic de la base de donnes\r\n * Permet d'identifier et de rsoudre les problmes de permissions\r\n */\r\nexport class DatabaseDiagnosticService {\r\n  /**\r\n   * Vrifier les permissions de l'utilisateur courant\r\n   */\r\n  static async checkUserPermissions() {\r\n    try {\r\n      console.log(' Diagnostic des permissions utilisateur...');\r\n      \r\n      // 1. Vrifier l'utilisateur authentifi\r\n      const { data: authUser, error: authError } = await supabase.auth.getUser();\r\n      if (authError || !authUser) {\r\n        return {\r\n          success: false,\r\n          error: 'Utilisateur non authentifi',\r\n          authUser: null,\r\n          userDetails: null\r\n        };\r\n      }\r\n      \r\n      console.log(' Utilisateur authentifi:', authUser.user.email);\r\n      \r\n      // 2. Vrifier si l'utilisateur existe dans la table users\r\n      const { data: tableUser, error: tableUserError } = await supabase\r\n        .from('users')\r\n        .select('*')\r\n        .eq('id', authUser.user.id)\r\n        .single();\r\n      \r\n      if (tableUserError) {\r\n        console.warn(' Erreur accs table users:', tableUserError);\r\n      }\r\n      \r\n      console.log(' Utilisateur dans table users:', tableUser ? ' Prsent' : ' Absent');\r\n      \r\n      // 3. Tester l'accs aux diffrentes tables\r\n      const tableAccessTests = [\r\n        { name: 'users', query: () => supabase.from('users').select('id').eq('id', authUser.user.id) },\r\n        { name: 'schools', query: () => supabase.from('schools').select('id').limit(1) },\r\n        { name: 'students', query: () => supabase.from('students').select('id').limit(1) },\r\n        { name: 'teachers', query: () => supabase.from('teachers').select('id').limit(1) },\r\n        { name: 'classes', query: () => supabase.from('classes').select('id').limit(1) }\r\n      ];\r\n      \r\n      const accessResults = {};\r\n      for (const test of tableAccessTests) {\r\n        try {\r\n          const { data, error } = await test.query();\r\n          accessResults[test.name] = {\r\n            accessible: !error,\r\n            error: error?.message || null\r\n          };\r\n          console.log(` ${test.name}: ${!error ? ' Accs OK' : ' Accs refus'}`);\r\n        } catch (err) {\r\n          accessResults[test.name] = {\r\n            accessible: false,\r\n            error: err.message\r\n          };\r\n          console.log(` ${test.name}:  Erreur - ${err.message}`);\r\n        }\r\n      }\r\n      \r\n      // 4. Vrifier les coles du directeur\r\n      let schoolData = null;\r\n      let schoolError = null;\r\n      try {\r\n        const { data, error } = await supabase\r\n          .from('schools')\r\n          .select('id, name, status, director_user_id')\r\n          .eq('director_user_id', authUser.user.id);\r\n        \r\n        schoolData = data;\r\n        schoolError = error;\r\n        \r\n        if (error) {\r\n          console.warn(' Erreur accs coles directeur:', error);\r\n        } else {\r\n          console.log(` coles du directeur: ${data?.length || 0} trouve(s)`);\r\n        }\r\n      } catch (err) {\r\n        schoolError = err;\r\n        console.warn(' Exception accs coles:', err);\r\n      }\r\n      \r\n      return {\r\n        success: true,\r\n        authUser: authUser.user,\r\n        tableUser,\r\n        tableAccess: accessResults,\r\n        schools: schoolData,\r\n        schoolError,\r\n        summary: {\r\n          authenticated: true,\r\n          userInTable: !!tableUser,\r\n          tablesAccessible: Object.values(accessResults).filter(t => t.accessible).length,\r\n          totalTables: tableAccessTests.length\r\n        }\r\n      };\r\n      \r\n    } catch (error) {\r\n      console.error(' Erreur diagnostic permissions:', error);\r\n      return {\r\n        success: false,\r\n        error: error.message,\r\n        authUser: null,\r\n        userDetails: null\r\n      };\r\n    }\r\n  }\r\n  \r\n  /**\r\n   * Rparer les permissions de l'utilisateur\r\n   */\r\n  static async repairUserPermissions(userId, userEmail, userMetadata = {}) {\r\n    try {\r\n      console.log(' Rparation des permissions pour:', userEmail);\r\n      \r\n      // 1. S'assurer que l'utilisateur existe dans la table users\r\n      const { data: userData, error: userError } = await supabase\r\n        .from('users')\r\n        .upsert({\r\n          id: userId,\r\n          email: userEmail,\r\n          full_name: userMetadata.full_name || userEmail.split('@')[0],\r\n          role: userMetadata.role || 'student',\r\n          phone: userMetadata.phone || '',\r\n          is_active: true,\r\n          active: true,\r\n          photo: '/assets/images/no_image.png',\r\n          created_at: new Date().toISOString(),\r\n          updated_at: new Date().toISOString()\r\n        })\r\n        .select()\r\n        .single();\r\n      \r\n      if (userError) {\r\n        console.error(' Erreur rparation utilisateur:', userError);\r\n        throw new Error(`Erreur cration utilisateur: ${userError.message}`);\r\n      }\r\n      \r\n      console.log(' Utilisateur rpar:', userData);\r\n      \r\n      // 2. Si c'est un directeur, vrifier/initialiser l'cole\r\n      if (userMetadata.role === 'principal') {\r\n        const { data: schools, error: schoolError } = await supabase\r\n          .from('schools')\r\n          .select('id, name')\r\n          .eq('director_user_id', userId);\r\n        \r\n        if (schoolError) {\r\n          console.warn(' Erreur vrification cole:', schoolError);\r\n        } else if (!schools || schools.length === 0) {\r\n          console.log(' Aucune cole trouve pour ce directeur');\r\n        } else {\r\n          console.log(' cole existante:', schools[0]?.name);\r\n        }\r\n      }\r\n      \r\n      return {\r\n        success: true,\r\n        user: userData\r\n      };\r\n      \r\n    } catch (error) {\r\n      console.error(' Erreur rparation permissions:', error);\r\n      return {\r\n        success: false,\r\n        error: error.message\r\n      };\r\n    }\r\n  }\r\n  \r\n  /**\r\n   * Excuter un diagnostic complet\r\n   */\r\n  static async runFullDiagnostic() {\r\n    console.log(' Lancement diagnostic complet base de donnes...');\r\n    \r\n    const results = {\r\n      timestamp: new Date().toISOString(),\r\n      steps: {}\r\n    };\r\n    \r\n    // 1. Vrifier les permissions\r\n    results.steps.permissions = await this.checkUserPermissions();\r\n    \r\n    // 2. Autres diagnostics...\r\n    console.log(' Diagnostic termin');\r\n    \r\n    return results;\r\n  }\r\n}\r\n\r\nexport default DatabaseDiagnosticService;","import React, { useState, useEffect } from 'react';\r\nimport DatabaseDiagnosticService from '../../../services/databaseDiagnosticService';\r\nimport Icon from '../../../components/AppIcon';\r\n\r\nconst DatabaseDiagnostic = () => {\r\n  const [diagnostic, setDiagnostic] = useState(null);\r\n  const [loading, setLoading] = useState(false);\r\n  const [repairing, setRepairing] = useState(false);\r\n\r\n  const runDiagnostic = async () => {\r\n    setLoading(true);\r\n    try {\r\n      const result = await DatabaseDiagnosticService.runFullDiagnostic();\r\n      setDiagnostic(result);\r\n    } catch (error) {\r\n      console.error('Erreur diagnostic:', error);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const repairPermissions = async () => {\r\n    setRepairing(true);\r\n    try {\r\n      if (diagnostic?.steps?.permissions?.authUser) {\r\n        const user = diagnostic.steps.permissions.authUser;\r\n        const result = await DatabaseDiagnosticService.repairUserPermissions(\r\n          user.id,\r\n          user.email,\r\n          user.user_metadata || {}\r\n        );\r\n        \r\n        if (result.success) {\r\n          // Re-run diagnostic after repair\r\n          await runDiagnostic();\r\n        }\r\n      }\r\n    } catch (error) {\r\n      console.error('Erreur rparation:', error);\r\n    } finally {\r\n      setRepairing(false);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    runDiagnostic();\r\n  }, []);\r\n\r\n  if (loading && !diagnostic) {\r\n    return (\r\n      <div className=\"flex items-center justify-center p-8\">\r\n        <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600\"></div>\r\n        <span className=\"ml-3\">Diagnostic en cours...</span>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  const permissions = diagnostic?.steps?.permissions;\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      {/* Header - Modernis */}\r\n      <div className=\"bg-gradient-to-r from-purple-600 via-pink-600 to-red-600 rounded-2xl shadow-xl p-6 text-white\">\r\n        <div className=\"flex items-center justify-between\">\r\n          <div className=\"flex items-center\">\r\n            <div className=\"w-12 h-12 bg-white/20 backdrop-blur-sm rounded-xl flex items-center justify-center mr-3 shadow-md\">\r\n              <Icon name=\"Activity\" size={24} className=\"text-white\" />\r\n            </div>\r\n            <div>\r\n              <h3 className=\"text-2xl font-bold\">Diagnostic Base de Donnes</h3>\r\n              <p className=\"text-purple-100 text-sm\">Vrification de l'intgrit du systme</p>\r\n            </div>\r\n          </div>\r\n          <div className=\"flex space-x-2\">\r\n            <button\r\n              onClick={runDiagnostic}\r\n              disabled={loading}\r\n              className=\"px-4 py-2 bg-white/20 backdrop-blur-sm text-white rounded-xl hover:bg-white/30 disabled:opacity-50 border border-white/30 transition-all shadow-md hover:shadow-lg flex items-center font-semibold\"\r\n            >\r\n              <Icon name=\"RefreshCw\" size={16} className=\"mr-2\" />\r\n              Actualiser\r\n            </button>\r\n            {permissions && !permissions?.summary?.userInTable && (\r\n              <button\r\n                onClick={repairPermissions}\r\n                disabled={repairing}\r\n                className=\"px-4 py-2 bg-green-500 text-white rounded-xl hover:bg-green-600 disabled:opacity-50 transition-all shadow-md hover:shadow-lg flex items-center font-semibold\"\r\n              >\r\n                <Icon name=\"Wrench\" size={16} className=\"mr-2\" />\r\n                {repairing ? 'Rparation...' : 'Rparer'}\r\n              </button>\r\n            )}\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Auth Status - Modernis */}\r\n      <div className=\"bg-white border-2 border-gray-200 rounded-2xl p-6 shadow-lg hover:shadow-xl transition-shadow\">\r\n        <div className=\"flex items-center mb-4\">\r\n          <div className=\"w-10 h-10 bg-gradient-to-br from-blue-600 to-indigo-600 rounded-xl flex items-center justify-center mr-3 shadow-md\">\r\n            <Icon name=\"User\" size={20} className=\"text-white\" />\r\n          </div>\r\n          <h4 className=\"text-lg font-semibold text-gray-900\">Statut Authentification</h4>\r\n        </div>\r\n        {permissions?.authUser ? (\r\n          <div className=\"space-y-2\">\r\n            <div className=\"flex items-center\">\r\n              <span className=\"text-sm text-gray-600 w-32\">Email:</span>\r\n              <span className=\"font-medium\">{permissions.authUser.email}</span>\r\n            </div>\r\n            <div className=\"flex items-center\">\r\n              <span className=\"text-sm text-gray-600 w-32\">ID:</span>\r\n              <span className=\"font-mono text-sm\">{permissions.authUser.id}</span>\r\n            </div>\r\n            <div className=\"flex items-center\">\r\n              <span className=\"text-sm text-gray-600 w-32\">Rle:</span>\r\n              <span className=\"font-medium\">{permissions.authUser.user_metadata?.role || 'Non dfini'}</span>\r\n            </div>\r\n            <div className=\"flex items-center text-green-600\">\r\n              <Icon name=\"CheckCircle\" size={16} className=\"mr-2\" />\r\n              <span>Authentifi avec succs</span>\r\n            </div>\r\n          </div>\r\n        ) : (\r\n          <div className=\"text-red-600 flex items-center\">\r\n            <Icon name=\"XCircle\" size={16} className=\"mr-2\" />\r\n            <span>Non authentifi</span>\r\n          </div>\r\n        )}\r\n      </div>\r\n\r\n      {/* User Table Status - Modernis */}\r\n      <div className=\"bg-white border-2 border-gray-200 rounded-2xl p-6 shadow-lg hover:shadow-xl transition-shadow\">\r\n        <div className=\"flex items-center mb-4\">\r\n          <div className=\"w-10 h-10 bg-gradient-to-br from-green-600 to-emerald-600 rounded-xl flex items-center justify-center mr-3 shadow-md\">\r\n            <Icon name=\"Database\" size={20} className=\"text-white\" />\r\n          </div>\r\n          <h4 className=\"text-lg font-semibold text-gray-900\">Table Utilisateurs</h4>\r\n        </div>\r\n        {permissions?.tableUser ? (\r\n          <div className=\"space-y-2 text-green-600\">\r\n            <div className=\"flex items-center\">\r\n              <Icon name=\"CheckCircle\" size={16} className=\"mr-2\" />\r\n              <span>Prsent dans la table users</span>\r\n            </div>\r\n            <div className=\"flex items-center\">\r\n              <span className=\"text-sm text-gray-600 w-32\">Nom:</span>\r\n              <span className=\"font-medium\">{permissions.tableUser.full_name}</span>\r\n            </div>\r\n            <div className=\"flex items-center\">\r\n              <span className=\"text-sm text-gray-600 w-32\">Rle:</span>\r\n              <span className=\"font-medium\">{permissions.tableUser.role}</span>\r\n            </div>\r\n          </div>\r\n        ) : (\r\n          <div className=\"space-y-2\">\r\n            <div className=\"flex items-center text-red-600\">\r\n              <Icon name=\"XCircle\" size={16} className=\"mr-2\" />\r\n              <span>Absent de la table users</span>\r\n            </div>\r\n            <p className=\"text-sm text-gray-600\">\r\n              Cela peut causer des problmes d'accs aux donnes. Utilisez le bouton \"Rparer\" pour corriger.\r\n            </p>\r\n          </div>\r\n        )}\r\n      </div>\r\n\r\n      {/* Table Access */}\r\n      <div className=\"bg-white rounded-lg border border-gray-200 p-4\">\r\n        <h4 className=\"font-medium text-gray-900 mb-3 flex items-center\">\r\n          <Icon name=\"Table\" size={16} className=\"mr-2\" />\r\n          Accs aux Tables\r\n        </h4>\r\n        <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3\">\r\n          {permissions?.tableAccess && Object.entries(permissions.tableAccess).map(([tableName, access]) => (\r\n            <div key={tableName} className={`p-3 rounded-lg border ${\r\n              access.accessible ? 'border-green-200 bg-green-50' : 'border-red-200 bg-red-50'\r\n            }`}>\r\n              <div className=\"flex items-center\">\r\n                <Icon \r\n                  name={access.accessible ? \"CheckCircle\" : \"XCircle\"} \r\n                  size={16} \r\n                  className={`mr-2 ${access.accessible ? 'text-green-600' : 'text-red-600'}`} \r\n                />\r\n                <span className=\"font-medium capitalize\">{tableName}</span>\r\n              </div>\r\n              {!access.accessible && access.error && (\r\n                <p className=\"text-xs text-gray-600 mt-1 truncate\">{access.error}</p>\r\n              )}\r\n            </div>\r\n          ))}\r\n        </div>\r\n      </div>\r\n\r\n      {/* Schools */}\r\n      <div className=\"bg-white rounded-lg border border-gray-200 p-4\">\r\n        <h4 className=\"font-medium text-gray-900 mb-3 flex items-center\">\r\n          <Icon name=\"School\" size={16} className=\"mr-2\" />\r\n          coles\r\n        </h4>\r\n        {permissions?.schoolError ? (\r\n          <div className=\"text-red-600\">\r\n            <div className=\"flex items-center\">\r\n              <Icon name=\"XCircle\" size={16} className=\"mr-2\" />\r\n              <span>Erreur d'accs: {permissions.schoolError.message}</span>\r\n            </div>\r\n            <p className=\"text-sm text-gray-600 mt-2\">\r\n              Cela est souvent d  des problmes de permissions RLS (Row Level Security).\r\n            </p>\r\n          </div>\r\n        ) : permissions?.schools ? (\r\n          <div>\r\n            <p className=\"text-sm text-gray-600\">\r\n              {permissions.schools.length} cole(s) trouve(s) pour ce directeur\r\n            </p>\r\n            {permissions.schools.map(school => (\r\n              <div key={school.id} className=\"mt-2 p-2 bg-blue-50 rounded\">\r\n                <div className=\"font-medium\">{school.name}</div>\r\n                <div className=\"text-sm text-gray-600\">ID: {school.id}</div>\r\n                <div className=\"text-sm text-gray-600\">Statut: {school.status}</div>\r\n              </div>\r\n            ))}\r\n          </div>\r\n        ) : (\r\n          <div className=\"text-gray-600\">\r\n            <Icon name=\"Info\" size={16} className=\"inline mr-2\" />\r\n            <span>Aucune cole trouve</span>\r\n          </div>\r\n        )}\r\n      </div>\r\n\r\n      {/* Summary */}\r\n      {permissions?.summary && (\r\n        <div className=\"bg-blue-50 border border-blue-200 rounded-lg p-4\">\r\n          <h4 className=\"font-medium text-blue-900 mb-2\">Rsum</h4>\r\n          <div className=\"grid grid-cols-1 md:grid-cols-3 gap-3 text-sm\">\r\n            <div className=\"bg-white p-3 rounded\">\r\n              <div className=\"text-blue-600 font-medium\">\r\n                {permissions.summary.authenticated ? ' Authentifi' : ' Non authentifi'}\r\n              </div>\r\n              <div className=\"text-gray-600 text-xs\">Statut</div>\r\n            </div>\r\n            <div className=\"bg-white p-3 rounded\">\r\n              <div className=\"text-blue-600 font-medium\">\r\n                {permissions.summary.userInTable ? ' Prsent' : ' Absent'}\r\n              </div>\r\n              <div className=\"text-gray-600 text-xs\">Table users</div>\r\n            </div>\r\n            <div className=\"bg-white p-3 rounded\">\r\n              <div className=\"text-blue-600 font-medium\">\r\n                {permissions.summary.tablesAccessible}/{permissions.summary.totalTables} tables\r\n              </div>\r\n              <div className=\"text-gray-600 text-xs\">Accs OK</div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default DatabaseDiagnostic;","import React, { useState, useEffect } from 'react';\r\nimport Icon from '../../../components/AppIcon';\r\nimport Button from '../../../components/ui/Button';\r\nimport Input from '../../../components/ui/Input';\r\nimport Select from '../../../components/ui/Select';\r\nimport useDashboardData from '../../../hooks/useDashboardData';\r\nimport productionDataService from '../../../services/productionDataService';\r\n\r\nconst SchoolYearValidationTab = () => {\r\n  const [activeSection, setActiveSection] = useState('pending');\r\n  const [currentSchoolYear] = useState('2024-2025');\r\n  const [nextSchoolYear] = useState('2025-2026');\r\n  const [loading, setLoading] = useState(true);\r\n  const [pendingRequests, setPendingRequests] = useState([]);\r\n  const [validationStats, setValidationStats] = useState({\r\n    totalDemandes: 0,\r\n    enAttente: 0,\r\n    approuvees: 0,\r\n    refusees: 0,\r\n    enRevision: 0\r\n  });\r\n  const [showCreateModal, setShowCreateModal] = useState(false);\r\n  const [newRequest, setNewRequest] = useState({\r\n    request_type: 'nouvelle_inscription',\r\n    student_first_name: '',\r\n    student_last_name: '',\r\n    parent_name: '',\r\n    parent_phone: '',\r\n    requested_class: '',\r\n    priority: 'normal'\r\n  });\r\n\r\n  const { data, user } = useDashboardData();\r\n\r\n  useEffect(() => {\r\n    const loadEnrollmentData = async () => {\r\n      if (user?.schoolData?.id) {\r\n        setLoading(true);\r\n\r\n        if (user.id && user.schoolData.id) {\r\n          productionDataService.setUserContext(user.id, user.schoolData.id);\r\n        }\r\n\r\n        try {\r\n          const { data: requests, error: requestsError } = await productionDataService.getEnrollmentRequests(\r\n            user.schoolData.id,\r\n            { status: 'en_attente' }\r\n          );\r\n\r\n          if (!requestsError) {\r\n            setPendingRequests(requests || []);\r\n          }\r\n\r\n          const { data: stats, error: statsError } = await productionDataService.getEnrollmentStats(user.schoolData.id);\r\n\r\n          if (!statsError) {\r\n            setValidationStats(stats || {\r\n              totalDemandes: 0,\r\n              enAttente: 0,\r\n              approuvees: 0,\r\n              refusees: 0,\r\n              enRevision: 0\r\n            });\r\n          }\r\n        } catch (error) {\r\n          console.error('Erreur lors du chargement des donnes d\\'inscription:', error);\r\n          setPendingRequests([]);\r\n          setValidationStats({\r\n            totalDemandes: 0,\r\n            enAttente: 0,\r\n            approuvees: 0,\r\n            refusees: 0,\r\n            enRevision: 0\r\n          });\r\n        }\r\n\r\n        setLoading(false);\r\n      }\r\n    };\r\n\r\n    loadEnrollmentData();\r\n  }, [user]);\r\n\r\n  // Passages de classe  valider (donnes fictives pour dmo)\r\n  const [classTransitions] = useState({\r\n    ce1_to_ce2: { total: 0, approved: 0, pending: 0 },\r\n    ce2_to_cm1: { total: 0, approved: 0, pending: 0 },\r\n    cm1_to_cm2: { total: 0, approved: 0, pending: 0 },\r\n    cm2_graduates: { total: 0, approved: 0, pending: 0 }\r\n  });\r\n\r\n  const getStatusBadge = (status) => {\r\n    const statusConfig = {\r\n      'en_attente': { label: 'En attente', className: 'bg-warning/10 text-warning' },\r\n      'approuve': { label: 'Approuv', className: 'bg-success/10 text-success' },\r\n      'refuse': { label: 'Refus', className: 'bg-error/10 text-error' },\r\n      'en_revision': { label: 'En rvision', className: 'bg-blue/10 text-blue' }\r\n    };\r\n    \r\n    const config = statusConfig[status] || statusConfig['en_attente'];\r\n    return (\r\n      <span className={`px-2 py-1 rounded-full text-xs font-caption font-caption-normal ${config.className}`}>\r\n        {config.label}\r\n      </span>\r\n    );\r\n  };\r\n\r\n  const getPriorityBadge = (priority) => {\r\n    const priorityConfig = {\r\n      'urgent': { label: 'Urgent', className: 'bg-error/10 text-error' },\r\n      'normal': { label: 'Normal', className: 'bg-muted text-muted-foreground' }\r\n    };\r\n    \r\n    const config = priorityConfig[priority] || priorityConfig['normal'];\r\n    return (\r\n      <span className={`px-2 py-1 rounded-full text-xs font-caption font-caption-normal ${config.className}`}>\r\n        {config.label}\r\n      </span>\r\n    );\r\n  };\r\n\r\n  const handleApproveRequest = async (requestId) => {\r\n    const { data, error } = await productionDataService.updateEnrollmentRequest(requestId, {\r\n      status: 'approuvee'\r\n    });\r\n\r\n    if (!error) {\r\n      setPendingRequests(prev => prev.filter(req => req.id !== requestId));\r\n      // Recharger les stats\r\n      const { data: stats } = await productionDataService.getEnrollmentStats(user?.schoolData?.id);\r\n      setValidationStats(stats || validationStats);\r\n    }\r\n  };\r\n\r\n  const handleRejectRequest = async (requestId) => {\r\n    const notes = prompt('Raison du refus (optionnel):');\r\n    \r\n    const { data, error } = await productionDataService.updateEnrollmentRequest(requestId, {\r\n      status: 'refusee',\r\n      validation_notes: notes\r\n    });\r\n\r\n    if (!error) {\r\n      setPendingRequests(prev => prev.filter(req => req.id !== requestId));\r\n      // Recharger les stats\r\n      const { data: stats } = await productionDataService.getEnrollmentStats(user?.schoolData?.id);\r\n      setValidationStats(stats || validationStats);\r\n    }\r\n  };\r\n\r\n  const handleCreateRequest = async () => {\r\n    if (!newRequest.student_first_name || !newRequest.student_last_name || !newRequest.requested_class) {\r\n      alert('Veuillez remplir tous les champs obligatoires');\r\n      return;\r\n    }\r\n\r\n    setLoading(true);\r\n    const { data, error } = await productionDataService.createEnrollmentRequest({\r\n      ...newRequest,\r\n      school_id: user?.schoolData?.id,\r\n      submitted_by: user?.id\r\n    });\r\n\r\n    if (!error && data) {\r\n      // Ajouter  la liste\r\n      setPendingRequests(prev => [data, ...prev]);\r\n      \r\n      // Recharger les stats\r\n      const { data: stats } = await productionDataService.getEnrollmentStats(user?.schoolData?.id);\r\n      setValidationStats(stats || validationStats);\r\n\r\n      // Rinitialiser le formulaire et fermer le modal\r\n      setNewRequest({\r\n        request_type: 'nouvelle_inscription',\r\n        student_first_name: '',\r\n        student_last_name: '',\r\n        parent_name: '',\r\n        parent_phone: '',\r\n        requested_class: '',\r\n        priority: 'normal'\r\n      });\r\n      setShowCreateModal(false);\r\n      alert('Demande cre avec succs !');\r\n    } else {\r\n      alert('Erreur lors de la cration: ' + (error?.message || 'Erreur inconnue'));\r\n    }\r\n    \r\n    setLoading(false);\r\n  };\r\n\r\n  const sections = [\r\n    { id: 'pending', label: 'Demandes en attente', icon: 'Clock' },\r\n    { id: 'transitions', label: 'Passages de classe', icon: 'TrendingUp' },\r\n    { id: 'approved', label: 'Valides', icon: 'CheckCircle' },\r\n    { id: 'settings', label: 'Configuration anne', icon: 'Settings' }\r\n  ];\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      {/* Header */}\r\n      <div className=\"bg-gradient-to-r from-blue-600 via-indigo-600 to-purple-600 rounded-2xl shadow-xl p-6 text-white\">\r\n        <div className=\"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4\">\r\n          <div>\r\n            <div className=\"flex items-center gap-3 mb-2\">\r\n              <div className=\"w-12 h-12 bg-white/20 backdrop-blur-sm rounded-xl flex items-center justify-center shadow-md\">\r\n                <Icon name=\"Calendar\" size={24} className=\"text-white\" />\r\n              </div>\r\n              <div>\r\n                <h2 className=\"text-2xl font-bold\">\r\n                  Validation Anne Scolaire\r\n                </h2>\r\n                  </div>\r\n            </div>\r\n            <p className=\"text-blue-100 text-sm ml-14\">\r\n              Dcisions et approbations pour {currentSchoolYear}  {nextSchoolYear}\r\n            </p>\r\n          </div>\r\n          <div className=\"flex items-center space-x-3\">\r\n            {validationStats.enAttente > 0 ? (\r\n              <div className=\"bg-white/20 backdrop-blur-sm px-4 py-2 rounded-xl border border-white/30 shadow-md\">\r\n                <span className=\"text-sm font-semibold text-white\">\r\n                   {validationStats.enAttente} demandes en attente\r\n                </span>\r\n              </div>\r\n            ) : (\r\n              <div className=\"bg-white/20 backdrop-blur-sm px-4 py-2 rounded-xl border border-white/30 shadow-md\">\r\n                <span className=\"text-sm font-semibold text-white\">\r\n                   Aucune demande en attente\r\n                </span>\r\n              </div>\r\n            )}\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Navigation - Modernise */}\r\n      <div className=\"bg-white rounded-2xl shadow-md border-2 border-gray-200 p-2\">\r\n        <nav className=\"flex flex-wrap gap-2\">\r\n          {sections.map((section) => (\r\n            <button\r\n              key={section.id}\r\n              onClick={() => setActiveSection(section.id)}\r\n              className={`flex items-center space-x-2 px-4 py-3 rounded-xl font-semibold text-sm transition-all duration-300 ${\r\n                activeSection === section.id\r\n                  ? 'bg-gradient-to-br from-blue-600 to-indigo-600 text-white shadow-lg scale-105'\r\n                  : 'bg-gray-50 text-gray-700 hover:bg-gray-100 border border-gray-200 hover:border-blue-300 hover:shadow-md'\r\n              }`}\r\n            >\r\n              <div className={`w-8 h-8 rounded-lg flex items-center justify-center ${\r\n                activeSection === section.id\r\n                  ? 'bg-white/20 backdrop-blur-sm'\r\n                  : 'bg-white shadow-sm'\r\n              }`}>\r\n                <Icon name={section.icon} size={16} className={activeSection === section.id ? 'text-white' : 'text-blue-600'} />\r\n              </div>\r\n              <span>{section.label}</span>\r\n              {section.id === 'pending' && validationStats.enAttente > 0 && (\r\n                <span className={`text-xs rounded-full px-2 py-1 font-bold ${\r\n                  activeSection === section.id\r\n                    ? 'bg-amber-500 text-white'\r\n                    : 'bg-amber-100 text-amber-800'\r\n                }`}>\r\n                  {validationStats.enAttente}\r\n                </span>\r\n              )}\r\n            </button>\r\n          ))}\r\n        </nav>\r\n      </div>\r\n\r\n      {/* Section Demandes en attente */}\r\n      {activeSection === 'pending' && (\r\n        <div className=\"space-y-6\">\r\n          {/* Statistiques rapides - Modernises */}\r\n          <div className=\"grid grid-cols-1 md:grid-cols-4 gap-4\">\r\n            <div className=\"bg-gradient-to-br from-amber-50 to-orange-50 border-2 border-amber-200 rounded-2xl p-5 shadow-lg hover:shadow-xl transition-shadow\">\r\n              <div className=\"flex items-center space-x-3\">\r\n                <div className=\"w-12 h-12 bg-gradient-to-br from-amber-500 to-orange-500 rounded-xl flex items-center justify-center shadow-md\">\r\n                  <Icon name=\"Clock\" size={20} className=\"text-white\" />\r\n                </div>\r\n                <div>\r\n                  <p className=\"text-3xl font-bold text-amber-900\">\r\n                    {validationStats.enAttente}\r\n                  </p>\r\n                  <p className=\"text-sm font-medium text-amber-700\">En attente</p>\r\n                </div>\r\n              </div>\r\n            </div>\r\n            \r\n            <div className=\"bg-gradient-to-br from-green-50 to-emerald-50 border-2 border-green-200 rounded-2xl p-5 shadow-lg hover:shadow-xl transition-shadow\">\r\n              <div className=\"flex items-center space-x-3\">\r\n                <div className=\"w-12 h-12 bg-gradient-to-br from-green-600 to-emerald-600 rounded-xl flex items-center justify-center shadow-md\">\r\n                  <Icon name=\"CheckCircle\" size={20} className=\"text-white\" />\r\n                </div>\r\n                <div>\r\n                  <p className=\"text-3xl font-bold text-green-900\">\r\n                    {validationStats.approuvees}\r\n                  </p>\r\n                  <p className=\"text-sm font-medium text-green-700\">Approuves</p>\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"bg-gradient-to-br from-blue-50 to-indigo-50 border-2 border-blue-200 rounded-2xl p-5 shadow-lg hover:shadow-xl transition-shadow\">\r\n              <div className=\"flex items-center space-x-3\">\r\n                <div className=\"w-12 h-12 bg-gradient-to-br from-blue-600 to-indigo-600 rounded-xl flex items-center justify-center shadow-md\">\r\n                  <Icon name=\"Eye\" size={20} className=\"text-white\" />\r\n                </div>\r\n                <div>\r\n                  <p className=\"text-3xl font-bold text-blue-900\">\r\n                    {validationStats.enRevision}\r\n                  </p>\r\n                  <p className=\"text-sm font-medium text-blue-700\">En rvision</p>\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"bg-gradient-to-br from-red-50 to-pink-50 border-2 border-red-200 rounded-2xl p-5 shadow-lg hover:shadow-xl transition-shadow\">\r\n              <div className=\"flex items-center space-x-3\">\r\n                <div className=\"w-12 h-12 bg-gradient-to-br from-red-500 to-pink-500 rounded-xl flex items-center justify-center shadow-md\">\r\n                  <Icon name=\"XCircle\" size={20} className=\"text-white\" />\r\n                </div>\r\n                <div>\r\n                  <p className=\"text-3xl font-bold text-red-900\">\r\n                    {validationStats.refusees}\r\n                  </p>\r\n                  <p className=\"text-sm font-medium text-red-700\">Refuses</p>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          {/* Liste des demandes */}\r\n          <div className=\"space-y-4\">\r\n            {pendingRequests.filter(req => req.status === 'en_attente').length === 0 ? (\r\n              <div className=\"bg-card border border-border rounded-lg p-8 text-center\">\r\n                <div className=\"flex flex-col items-center space-y-4\">\r\n                  <div className=\"w-16 h-16 bg-green-50 rounded-full flex items-center justify-center\">\r\n                    <Icon name=\"CheckCircle\" size={32} className=\"text-green-500\" />\r\n                  </div>\r\n                  <div>\r\n                    <h3 className=\"font-heading font-heading-medium text-lg text-text-primary mb-2\">\r\n                      Aucune demande en attente\r\n                    </h3>\r\n                    <p className=\"text-sm text-text-secondary max-w-md\">\r\n                      Il n'y a actuellement aucune demande de validation en attente. Les nouvelles demandes apparatront ici.\r\n                    </p>\r\n                  </div>\r\n                  {isProduction && (\r\n                    <Button variant=\"outline\" onClick={() => setShowCreateModal(true)}>\r\n                      <Icon name=\"Plus\" size={16} className=\"mr-2\" />\r\n                      Ajouter une demande manuelle\r\n                    </Button>\r\n                  )}\r\n                </div>\r\n              </div>\r\n            ) : (\r\n              pendingRequests.filter(req => req.status === 'en_attente').map((request) => (\r\n              <div key={request.id} className=\"bg-card border border-border rounded-lg p-6\">\r\n                <div className=\"flex items-start justify-between mb-4\">\r\n                  <div className=\"flex items-start space-x-4\">\r\n                    <div className=\"w-12 h-12 bg-primary/10 rounded-lg flex items-center justify-center\">\r\n                      <Icon \r\n                        name={request.request_type === 'nouvelle_inscription' ? 'UserPlus' : \r\n                              request.request_type === 'redoublement' ? 'RotateCcw' : 'ArrowRight'} \r\n                        size={20} \r\n                        className=\"text-primary\" \r\n                      />\r\n                    </div>\r\n                    <div>\r\n                      <h3 className=\"font-heading font-heading-semibold text-lg text-text-primary\">\r\n                        {request.student_first_name} {request.student_last_name}\r\n                        {request.student?.first_name && ` (${request.student.first_name} ${request.student.last_name})`}\r\n                      </h3>\r\n                      <p className=\"text-sm text-text-secondary\">\r\n                        Parent: {request.parent_name || 'Non renseign'}\r\n                      </p>\r\n                      <p className=\"text-sm text-text-secondary\">\r\n                        {request.request_type === 'nouvelle_inscription' \r\n                          ? `Demande d'inscription en ${request.requested_class}`\r\n                          : request.request_type === 'redoublement'\r\n                          ? `Redoublement ${request.current_class}  ${request.requested_class}`\r\n                          : `Transfert vers ${request.requested_class}`\r\n                        }\r\n                      </p>\r\n                    </div>\r\n                  </div>\r\n                  <div className=\"flex items-center space-x-2\">\r\n                    {getPriorityBadge(request.priority)}\r\n                    {getStatusBadge(request.status)}\r\n                  </div>\r\n                </div>\r\n\r\n                {/* Dtails de la demande */}\r\n                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4\">\r\n                  <div>\r\n                    <p className=\"text-sm font-medium text-text-primary mb-2\">Informations</p>\r\n                    <div className=\"space-y-1 text-sm text-text-secondary\">\r\n                      <p>Soumis par: {request.submitted_by_user?.full_name || 'Systme'}</p>\r\n                      <p>Date: {new Date(request.submitted_date).toLocaleDateString('fr-FR')}</p>\r\n                      {request.reason && <p>Motif: {request.reason}</p>}\r\n                      {request.teacher_recommendation && <p>Avis enseignant: {request.teacher_recommendation}</p>}\r\n                      {request.previous_school && <p>cole prcdente: {request.previous_school}</p>}\r\n                    </div>\r\n                  </div>\r\n                  {request.documents && Array.isArray(request.documents) && request.documents.length > 0 && (\r\n                    <div>\r\n                      <p className=\"text-sm font-medium text-text-primary mb-2\">Documents fournis</p>\r\n                      <div className=\"space-y-1\">\r\n                        {request.documents.map((doc, index) => (\r\n                          <div key={index} className=\"flex items-center space-x-2 text-sm text-text-secondary\">\r\n                            <Icon \r\n                              name={doc.uploaded ? \"FileCheck\" : \"FileX\"} \r\n                              size={14} \r\n                              className={doc.uploaded ? \"text-success\" : \"text-warning\"} \r\n                            />\r\n                            <span>{typeof doc === 'string' ? doc : doc.name}</span>\r\n                          </div>\r\n                        ))}\r\n                      </div>\r\n                    </div>\r\n                  )}\r\n                </div>\r\n\r\n                {/* Actions */}\r\n                <div className=\"flex items-center justify-between pt-4 border-t border-border\">\r\n                  <div className=\"flex items-center space-x-2\">\r\n                    <Button variant=\"outline\" size=\"sm\">\r\n                      <Icon name=\"Eye\" size={14} className=\"mr-1\" />\r\n                      Voir dossier complet\r\n                    </Button>\r\n                    <Button variant=\"outline\" size=\"sm\">\r\n                      <Icon name=\"MessageCircle\" size={14} className=\"mr-1\" />\r\n                      Demander info\r\n                    </Button>\r\n                  </div>\r\n                  <div className=\"flex items-center space-x-2\">\r\n                    <Button \r\n                      variant=\"outline\" \r\n                      size=\"sm\"\r\n                      onClick={() => handleRejectRequest(request.id)}\r\n                      className=\"text-error hover:text-error\"\r\n                    >\r\n                      <Icon name=\"X\" size={14} className=\"mr-1\" />\r\n                      Refuser\r\n                    </Button>\r\n                    <Button \r\n                      size=\"sm\"\r\n                      onClick={() => handleApproveRequest(request.id)}\r\n                    >\r\n                      <Icon name=\"Check\" size={14} className=\"mr-1\" />\r\n                      Approuver\r\n                    </Button>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n              ))\r\n            )}\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Section Passages de classe */}\r\n      {activeSection === 'transitions' && (\r\n        <div className=\"space-y-6\">\r\n          <div className=\"bg-card border border-border rounded-lg p-8\">\r\n            <div className=\"flex flex-col items-center text-center space-y-4\">\r\n              <div className=\"w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center\">\r\n                <Icon name=\"TrendingUp\" size={32} className=\"text-blue-600\" />\r\n              </div>\r\n              <div>\r\n                <h3 className=\"font-heading font-heading-semibold text-lg text-text-primary mb-2\">\r\n                  Passages de Classe - En Dveloppement\r\n                </h3>\r\n                <p className=\"text-sm text-text-secondary max-w-2xl\">\r\n                  Cette fonctionnalit permettra de grer automatiquement les passages de classe \r\n                  en fonction des rsultats scolaires et des recommandations des enseignants.\r\n                </p>\r\n                <div className=\"mt-4 text-xs text-gray-500\">\r\n                  <p> Fonctionnalits prvues :</p>\r\n                  <ul className=\"mt-2 space-y-1 text-left inline-block\">\r\n                    <li> Calcul automatique des passages selon les moyennes</li>\r\n                    <li> Validation des redoublements</li>\r\n                    <li> Gnration des listes de classes pour l'anne suivante</li>\r\n                    <li> Notifications aux parents</li>\r\n                  </ul>\r\n                </div>\r\n                <div className=\"mt-4 px-4 py-2 bg-blue-50 rounded-lg\">\r\n                  <p className=\"text-sm text-blue-700\">\r\n                     En attendant, utilisez l'onglet <strong>\"Demandes en attente\"</strong> pour grer\r\n                    les inscriptions et redoublements manuellement.\r\n                  </p>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Section Demandes approuves */}\r\n      {activeSection === 'approved' && (\r\n        <div className=\"space-y-6\">\r\n          <div className=\"bg-card border border-border rounded-lg p-8\">\r\n            <div className=\"flex flex-col items-center text-center space-y-4\">\r\n              <div className=\"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center\">\r\n                <Icon name=\"CheckCircle\" size={32} className=\"text-green-600\" />\r\n              </div>\r\n              <div>\r\n                <h3 className=\"font-heading font-heading-semibold text-lg text-text-primary mb-2\">\r\n                  Demandes Valides\r\n                </h3>\r\n                <p className=\"text-sm text-text-secondary max-w-2xl\">\r\n                  Vous avez <strong>{validationStats.approuvees || 0} demande(s) approuve(s)</strong>.\r\n                  <br />\r\n                  L'historique complet des validations sera bientt disponible ici.\r\n                </p>\r\n              </div>\r\n              {validationStats.approuvees > 0 && (\r\n                <Button variant=\"outline\">\r\n                  <Icon name=\"Download\" size={16} className=\"mr-2\" />\r\n                  Exporter la liste ({validationStats.approuvees})\r\n                </Button>\r\n              )}\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Section Configuration */}\r\n      {activeSection === 'settings' && (\r\n        <div className=\"space-y-6\">\r\n          <div className=\"bg-card border border-border rounded-lg p-8\">\r\n            <div className=\"flex flex-col items-center text-center space-y-4\">\r\n              <div className=\"w-16 h-16 bg-purple-100 rounded-full flex items-center justify-center\">\r\n                <Icon name=\"Settings\" size={32} className=\"text-purple-600\" />\r\n              </div>\r\n              <div>\r\n                <h3 className=\"font-heading font-heading-semibold text-lg text-text-primary mb-2\">\r\n                  Configuration Anne Scolaire - En Dveloppement\r\n                </h3>\r\n                <p className=\"text-sm text-text-secondary max-w-2xl\">\r\n                  Cette fonctionnalit permettra de configurer les paramtres de l'anne scolaire\r\n                  et de grer la transition entre les annes acadmiques.\r\n                </p>\r\n                <div className=\"mt-4 text-xs text-gray-500\">\r\n                  <p> Paramtres prvus :</p>\r\n                  <ul className=\"mt-2 space-y-1 text-left inline-block\">\r\n                    <li> Dates de dbut et fin d'anne scolaire</li>\r\n                    <li> Configuration des trimestres/semestres</li>\r\n                    <li> Gnration automatique des listes de classe</li>\r\n                    <li> Archivage de l'anne prcdente</li>\r\n                    <li> Migration des donnes lves</li>\r\n                  </ul>\r\n                </div>\r\n                <div className=\"mt-4 px-4 py-2 bg-purple-50 rounded-lg\">\r\n                  <p className=\"text-sm text-purple-700\">\r\n                     Pour l'instant, contactez l'administrateur systme pour modifier\r\n                    les paramtres de l'anne scolaire dans la base de donnes.\r\n                  </p>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Modal de cration de demande */}\r\n      {showCreateModal && (\r\n        <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4\">\r\n          <div className=\"bg-white rounded-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto\">\r\n            <div className=\"p-6 border-b border-gray-200\">\r\n              <div className=\"flex items-center justify-between\">\r\n                <h3 className=\"text-xl font-semibold text-gray-900\">\r\n                  Nouvelle demande d'inscription\r\n                </h3>\r\n                <button\r\n                  onClick={() => setShowCreateModal(false)}\r\n                  className=\"text-gray-400 hover:text-gray-600\"\r\n                >\r\n                  <Icon name=\"X\" size={24} />\r\n                </button>\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"p-6 space-y-4\">\r\n              {/* Type de demande */}\r\n              <div>\r\n                <label className=\"block text-sm font-medium text-gray-700 mb-2\">\r\n                  Type de demande *\r\n                </label>\r\n                <select\r\n                  value={newRequest.request_type}\r\n                  onChange={(e) => setNewRequest({ ...newRequest, request_type: e.target.value })}\r\n                  className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"\r\n                >\r\n                  <option value=\"nouvelle_inscription\">Nouvelle inscription</option>\r\n                  <option value=\"redoublement\">Redoublement</option>\r\n                  <option value=\"transfert\">Transfert</option>\r\n                </select>\r\n              </div>\r\n\r\n              {/* Informations lve */}\r\n              <div className=\"grid grid-cols-2 gap-4\">\r\n                <div>\r\n                  <label className=\"block text-sm font-medium text-gray-700 mb-2\">\r\n                    Prnom de l'lve *\r\n                  </label>\r\n                  <input\r\n                    type=\"text\"\r\n                    value={newRequest.student_first_name}\r\n                    onChange={(e) => setNewRequest({ ...newRequest, student_first_name: e.target.value })}\r\n                    className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"\r\n                    placeholder=\"Ex: Marie\"\r\n                  />\r\n                </div>\r\n                <div>\r\n                  <label className=\"block text-sm font-medium text-gray-700 mb-2\">\r\n                    Nom de l'lve *\r\n                  </label>\r\n                  <input\r\n                    type=\"text\"\r\n                    value={newRequest.student_last_name}\r\n                    onChange={(e) => setNewRequest({ ...newRequest, student_last_name: e.target.value })}\r\n                    className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"\r\n                    placeholder=\"Ex: Talla\"\r\n                  />\r\n                </div>\r\n              </div>\r\n\r\n              {/* Informations parent */}\r\n              <div className=\"grid grid-cols-2 gap-4\">\r\n                <div>\r\n                  <label className=\"block text-sm font-medium text-gray-700 mb-2\">\r\n                    Nom du parent/tuteur\r\n                  </label>\r\n                  <input\r\n                    type=\"text\"\r\n                    value={newRequest.parent_name}\r\n                    onChange={(e) => setNewRequest({ ...newRequest, parent_name: e.target.value })}\r\n                    className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"\r\n                    placeholder=\"Ex: Joseph Talla\"\r\n                  />\r\n                </div>\r\n                <div>\r\n                  <label className=\"block text-sm font-medium text-gray-700 mb-2\">\r\n                    Tlphone du parent\r\n                  </label>\r\n                  <input\r\n                    type=\"tel\"\r\n                    value={newRequest.parent_phone}\r\n                    onChange={(e) => setNewRequest({ ...newRequest, parent_phone: e.target.value })}\r\n                    className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"\r\n                    placeholder=\"Ex: 237 6XX XX XX XX\"\r\n                  />\r\n                </div>\r\n              </div>\r\n\r\n              {/* Classe demande */}\r\n              <div className=\"grid grid-cols-2 gap-4\">\r\n                <div>\r\n                  <label className=\"block text-sm font-medium text-gray-700 mb-2\">\r\n                    Classe demande *\r\n                  </label>\r\n                  <input\r\n                    type=\"text\"\r\n                    value={newRequest.requested_class}\r\n                    onChange={(e) => setNewRequest({ ...newRequest, requested_class: e.target.value })}\r\n                    className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"\r\n                    placeholder=\"Ex: CE1, 6me, 2nde...\"\r\n                  />\r\n                </div>\r\n                <div>\r\n                  <label className=\"block text-sm font-medium text-gray-700 mb-2\">\r\n                    Priorit\r\n                  </label>\r\n                  <select\r\n                    value={newRequest.priority}\r\n                    onChange={(e) => setNewRequest({ ...newRequest, priority: e.target.value })}\r\n                    className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"\r\n                  >\r\n                    <option value=\"normal\">Normale</option>\r\n                    <option value=\"urgent\">Urgente</option>\r\n                    <option value=\"faible\">Faible</option>\r\n                  </select>\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"p-6 border-t border-gray-200 flex justify-end space-x-3\">\r\n              <Button\r\n                variant=\"outline\"\r\n                onClick={() => setShowCreateModal(false)}\r\n                disabled={loading}\r\n              >\r\n                Annuler\r\n              </Button>\r\n              <Button\r\n                onClick={handleCreateRequest}\r\n                disabled={loading}\r\n              >\r\n                {loading ? 'Cration...' : 'Crer la demande'}\r\n              </Button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default SchoolYearValidationTab;","import React, { useState, useEffect } from 'react';\nimport { Helmet } from 'react-helmet';\nimport { useLocation, useNavigate } from 'react-router-dom';\nimport { supabase } from '../../lib/supabase';\nimport Header from '../../components/ui/Header';\nimport Sidebar from '../../components/ui/Sidebar';\nimport NotificationCenter from '../../components/ui/NotificationCenter';\nimport AccessibilityControls from '../../components/ui/AccessibilityControls';\nimport MetricCard from './components/MetricCard';\nimport ClassAverageChart from './components/ClassAverageChart';\nimport AttendanceChart from './components/AttendanceChart';\nimport PaymentStatusChart from './components/PaymentStatusChart';\nimport QuickActions from './components/QuickActions';\nimport SystemStatus from './components/SystemStatus';\nimport AccountsManagement from './components/AccountsManagement';\nimport DatabaseDiagnostic from './components/DatabaseDiagnostic';\nimport SchoolYearValidationTab from './components/SchoolYearValidationTab';\nimport ErrorBoundary from '../../components/ErrorBoundary';\nimport Icon from '../../components/AppIcon';\nimport Button from '../../components/ui/Button';\nimport useDashboardData from '../../hooks/useDashboardData';\nimport useRoleSession from '../../hooks/useRoleSession';\n\nconst PrincipalDashboard = () => {\n  const location = useLocation();\n  const navigate = useNavigate();\n  const [isSidebarCollapsed, setIsSidebarCollapsed] = useState(false);\n  const [activeTab, setActiveTab] = useState('overview');\n  const [currentTime, setCurrentTime] = useState(new Date());\n  const [showMobileMenu, setShowMobileMenu] = useState(false);\n\n  // Mode diagnostic secret (comme mode dveloppeur Android)\n  const [diagnosticClickCount, setDiagnosticClickCount] = useState(() => {\n    const saved = localStorage.getItem('edutrack_diagnostic_mode');\n    return saved ? parseInt(saved) : 0;\n  });\n  const [diagnosticModeEnabled, setDiagnosticModeEnabled] = useState(() => {\n    return localStorage.getItem('edutrack_diagnostic_mode') === '7';\n  });\n  const [showDiagnosticToast, setShowDiagnosticToast] = useState(false);\n\n  // tats pour la gestion des classes personnalises\n  const [newClassName, setNewClassName] = useState('');\n  const [addingClass, setAddingClass] = useState(false);\n  const [classError, setClassError] = useState('');\n  const [classSuccess, setClassSuccess] = useState('');\n  \n  // NOUVEAU : Charger la session spcifique au directeur\n  const { user: principalUser, loading: sessionLoading, error: sessionError } = useRoleSession('principal');\n  \n  // Hook pour les donnes\n  const {\n    data,\n    loading,\n    errors,\n    refresh,\n    user\n  } = useDashboardData();\n\n  // Utiliser prioritairement la session du directeur\n  const currentUser = principalUser || user;\n\n  // Rcuprer les donnes de l'cole - PRIORIT aux vraies donnes de la base de donnes\n  const schoolDataFromDatabase = data.schoolDetails; // Vraies donnes depuis Supabase\n  const schoolDataFromState = location.state?.school;\n  const schoolDataFromUser = currentUser?.schoolData;\n  const schoolData = schoolDataFromDatabase || schoolDataFromUser || schoolDataFromState;\n  \n  useEffect(() => {\n    console.log(' PrincipalDashboard - tat actuel:');\n    console.log('  - Session Principal:', principalUser?.email || 'Non trouve');\n    console.log('  - Utilisateur actif:', currentUser?.email);\n    console.log('  - Utilisateur:', user);\n\n    // Dtails d'authentification\n    if (user) {\n      console.log('   Dtails utilisateur:');\n      console.log('     Email:', user.email);\n      console.log('     ID:', user.id);\n      console.log('     Role:', user.role || 'Non dfini');\n      console.log('     Donnes cole:', user.schoolData ? ' Prsentes' : ' Absentes');\n      if (user.schoolData) {\n        console.log('      - Nom:', user.schoolData.name);\n        console.log('      - ID:', user.schoolData.id);\n        console.log('      - Directeur User ID:', user.schoolData.director_user_id);\n        console.log('      - Type:', user.schoolData.type);\n      }\n      console.log('     Auth Supabase:', user.auth ? ' Actif' : ' Inactif');\n      console.log('     DB User:', user.dbUser ? ' Prsent' : ' Absent');\n    } else {\n      console.log('   Aucun utilisateur dtect');\n    }\n\n    if (schoolDataFromDatabase) {\n      console.log(' Donnes cole depuis SUPABASE (PRIORIT):', schoolDataFromDatabase);\n    } else if (schoolDataFromUser) {\n      console.log(' Donnes cole depuis hook (FALLBACK 1):', schoolDataFromUser);\n    } else if (schoolDataFromState) {\n      console.log(' Donnes cole depuis location.state (FALLBACK 2):', schoolDataFromState);\n    } else {\n      console.log(' Aucune donne cole disponible');\n    }\n\n    if (schoolData) {\n      console.log(' cole active:', schoolData.name);\n      console.log(' Type:', schoolData.type);\n      console.log(' Classes disponibles:', schoolData.available_classes);\n      console.log(' Statut:', schoolData.status);\n      console.log(' Directeur User ID:', schoolData.director_user_id);\n    }\n  }, [schoolData, user]);\n\n  // Grer les paramtres URL pour la navigation directe vers un onglet\n  useEffect(() => {\n    const urlParams = new URLSearchParams(location.search);\n    const tabParam = urlParams.get('tab');\n    \n    // Rediriger 'analytics' vers 'overview' (onglet supprim pour viter redondance)\n    if (tabParam === 'analytics') {\n      navigate('/principal-dashboard?tab=overview', { replace: true });\n      return;\n    }\n    \n    if (tabParam && ['overview', 'school-year', 'school-info', 'actions', 'system', 'accounts', 'debug'].includes(tabParam)) {\n      setActiveTab(tabParam);\n    } else {\n      setActiveTab('overview'); // Par dfaut si pas de paramtre ou paramtre invalide\n    }\n  }, [location.search, navigate]); // Se dclenche  chaque changement d'URL\n\n  useEffect(() => {\n    const timer = setInterval(() => {\n      setCurrentTime(new Date());\n    }, 1000);\n\n    return () => clearInterval(timer);\n  }, []);\n\n  // Fermeture du menu mobile au clic  l'extrieur\n  useEffect(() => {\n    const handleClickOutside = (event) => {\n      if (!event.target.closest('[data-mobile-menu]')) {\n        setShowMobileMenu(false);\n      }\n    };\n\n    if (showMobileMenu) {\n      document.addEventListener('click', handleClickOutside);\n      return () => document.removeEventListener('click', handleClickOutside);\n    }\n  }, [showMobileMenu]);\n\n  const toggleSidebar = () => {\n    setIsSidebarCollapsed(!isSidebarCollapsed);\n  };\n\n  const handleTabChange = (tabId) => {\n    if (tabId === 'overview') {\n      navigate('/principal-dashboard');\n    } else {\n      navigate(`/principal-dashboard?tab=${tabId}`);\n    }\n  };\n\n  // Gestionnaire pour le mode diagnostic secret (7 clics comme Android)\n  const handleDiagnosticClick = () => {\n    const newCount = diagnosticClickCount + 1;\n\n    if (newCount === 7) {\n      // Activer le mode diagnostic\n      setDiagnosticModeEnabled(true);\n      localStorage.setItem('edutrack_diagnostic_mode', '7');\n      setShowDiagnosticToast(true);\n      setDiagnosticClickCount(7);\n\n      // Masquer le toast aprs 5 secondes\n      setTimeout(() => {\n        setShowDiagnosticToast(false);\n      }, 5000);\n\n      console.log(' Mode diagnostic activ');\n    } else if (newCount > 7) {\n      // Dsactiver le mode diagnostic si on continue  cliquer\n      setDiagnosticModeEnabled(false);\n      localStorage.removeItem('edutrack_diagnostic_mode');\n      setDiagnosticClickCount(0);\n      console.log(' Mode diagnostic dsactiv');\n    } else {\n      setDiagnosticClickCount(newCount);\n      console.log(` Clics vers mode diagnostic: ${newCount}/7`);\n    }\n  };\n\n  // Les mtriques proviennent maintenant du hook qui switch automatiquement\n  const keyMetrics = data.metrics || [];\n\n  // Onglets du dashboard - Organiss par catgorie\n  const tabOptions = [\n    { id: 'overview', label: 'Tableau de Bord', icon: 'LayoutDashboard', description: 'Vue d\\'ensemble' },\n    { id: 'actions', label: 'Actions Rapides', icon: 'Zap', description: 'Outils de gestion' },\n    { id: 'school-year', label: 'Validation Anne', icon: 'Calendar', description: 'Passage anne scolaire' },\n    { id: 'school-info', label: 'Mon tablissement', icon: 'School', description: 'Informations cole' },\n    { id: 'accounts', label: 'Gestion Comptes', icon: 'UserCheck', description: 'Personnel & accs' },\n    // tat Systme visible uniquement en mode diagnostic (comme mode dveloppeur Android)\n    ...(diagnosticModeEnabled ? [{ id: 'system', label: 'tat Systme', icon: 'Settings', description: 'Paramtres & statut' }] : []),\n    // Debug visible uniquement en dveloppement ou via URL directe\n    ...(import.meta.env.DEV || activeTab === 'debug' ? [{ id: 'debug', label: 'Diagnostic', icon: 'Bug', description: 'Outils techniques' }] : [])\n  ];\n\n  const formatDateTime = (date) => {\n    return date?.toLocaleDateString('fr-FR', {\n      weekday: 'long',\n      year: 'numeric',\n      month: 'long',\n      day: 'numeric',\n      hour: '2-digit',\n      minute: '2-digit'\n    });\n  };\n\n  // Fonction gnrique pour ajouter une classe\n  const handleAddClass = async (className) => {\n    const classNameTrimmed = className.trim();\n    \n    // Validation\n    if (!classNameTrimmed) {\n      setClassError('Nom de classe invalide');\n      return false;\n    }\n    \n    // Vrifier si la classe existe dj\n    const currentClasses = schoolData?.available_classes || [];\n    if (currentClasses.includes(classNameTrimmed)) {\n      setClassError('Cette classe existe dj dans votre tablissement');\n      return false;\n    }\n    \n    setAddingClass(true);\n    setClassError('');\n    setClassSuccess('');\n    \n    try {\n      // Importer supabase pour la mise  jour\n      const { supabase } = await import('../../lib/supabase');\n      \n      // 1. Ajouter la nouvelle classe au tableau existant (dans schools.available_classes)\n      const updatedClasses = [...currentClasses, classNameTrimmed];\n      \n      // Mettre  jour la table schools\n      const { error: schoolError } = await supabase\n        .from('schools')\n        .update({ available_classes: updatedClasses })\n        .eq('id', schoolData.id);\n      \n      if (schoolError) {\n        throw schoolError;\n      }\n      \n      console.log(` Classe \"${classNameTrimmed}\" ajoute  schools.available_classes`);\n      \n      // 2. Crer aussi l'entre dans la table classes (pour les assignations)\n      // Rcuprer l'anne acadmique courante\n      const { data: academicYearData, error: yearError } = await supabase\n        .from('academic_years')\n        .select('id')\n        .eq('school_id', schoolData.id)\n        .eq('is_current', true)\n        .maybeSingle();\n      \n      if (yearError) {\n        console.warn('Erreur rcupration anne acadmique:', yearError);\n      }\n      \n      if (academicYearData?.id) {\n        // Dtecter le niveau (primary/secondary) selon le nom de la classe\n        const determineLevel = (name) => {\n          const nameLower = name.toLowerCase();\n          const secondaryKeywords = ['6me', '6eme', '5me', '5eme', '4me', '4eme', '3me', '3eme',\n                                      '2nde', '2de', 'seconde', '1re', '1ere', 'premire', 'premiere',\n                                      'tle', 'terminale', 'terminal'];\n          \n          if (secondaryKeywords.some(keyword => nameLower.includes(keyword))) {\n            return 'secondary';\n          }\n          return 'primary';\n        };\n        \n        const detectedLevel = determineLevel(classNameTrimmed);\n        \n        // Crer l'entre dans la table classes\n        const { error: classError } = await supabase\n          .from('classes')\n          .insert({\n            school_id: schoolData.id,\n            academic_year_id: academicYearData.id,\n            name: classNameTrimmed,\n            level: detectedLevel\n          });\n        \n        if (classError) {\n          // Si la classe existe dj dans la table (contrainte unique), ce n'est pas grave\n          if (classError.code !== '23505') { // 23505 = violation de contrainte unique\n            console.warn('Erreur cration classe dans table classes:', classError);\n          }\n        } else {\n          console.log(` Classe \"${classNameTrimmed}\" cre dans la table classes (niveau: ${detectedLevel})`);\n        }\n      } else {\n        console.warn(' Aucune anne acadmique courante trouve - classe non cre dans la table classes');\n      }\n      \n      // Succs\n      setClassSuccess(`Classe \"${classNameTrimmed}\" ajoute avec succs !`);\n      \n      // Recharger les donnes pour mettre  jour l'affichage\n      setTimeout(() => {\n        refresh();\n        setClassSuccess('');\n      }, 2000);\n      \n      return true;\n      \n    } catch (error) {\n      console.error('Erreur lors de l\\'ajout de la classe:', error);\n      setClassError('Erreur lors de l\\'ajout de la classe. Veuillez ressayer.');\n      return false;\n    } finally {\n      setAddingClass(false);\n    }\n  };\n\n  // Fonction pour ajouter une classe personnalise\n  const handleAddCustomClass = async () => {\n    const className = newClassName.trim();\n    \n    // Validations spcifiques  la saisie personnalise\n    if (!className) {\n      setClassError('Veuillez saisir un nom de classe');\n      return;\n    }\n    \n    if (className.length < 2) {\n      setClassError('Le nom de classe doit contenir au moins 2 caractres');\n      return;\n    }\n    \n    if (className.length > 50) {\n      setClassError('Le nom de classe ne peut pas dpasser 50 caractres');\n      return;\n    }\n    \n    // Utiliser la fonction gnrique pour ajouter la classe\n    const success = await handleAddClass(className);\n    if (success) {\n      setNewClassName('');\n    }\n  };\n\n  // Fonction pour supprimer une classe\n  const handleRemoveClass = async (className) => {\n    // Confirmation avant suppression\n    const confirmDelete = window.confirm(\n      `tes-vous sr de vouloir supprimer la classe \"${className}\" ?\\n\\n` +\n      ` Attention : Cette action supprimera la classe de votre liste. ` +\n      `Si des lves sont dj inscrits dans cette classe, vrifiez qu'ils ont t raffects avant de continuer.`\n    );\n    \n    if (!confirmDelete) {\n      return;\n    }\n\n    try {\n      setAddingClass(true);\n      setClassError('');\n\n      // Vrifier que schoolData existe\n      if (!schoolData?.id) {\n        setClassError('Erreur : Donnes de l\\'cole non disponibles');\n        return;\n      }\n\n      // Rcuprer les classes actuelles\n      const currentClasses = schoolData.available_classes || [];\n      \n      // Vrifier que la classe existe\n      if (!currentClasses.includes(className)) {\n        setClassError('Cette classe n\\'existe pas dans votre liste');\n        return;\n      }\n\n      // Retirer la classe de la liste\n      const updatedClasses = currentClasses.filter(c => c !== className);\n\n      // Mettre  jour dans Supabase\n      const { error: updateError } = await supabase\n        .from('schools')\n        .update({ available_classes: updatedClasses })\n        .eq('id', schoolData.id);\n\n      if (updateError) {\n        console.error('Erreur Supabase lors de la suppression:', updateError);\n        setClassError('Erreur lors de la suppression de la classe. Veuillez ressayer.');\n        return;\n      }\n\n      // Rafrachir les donnes\n      await refresh();\n\n      // Message de succs\n      console.log(` Classe \"${className}\" supprime avec succs`);\n      \n    } catch (error) {\n      console.error('Erreur lors de la suppression de la classe:', error);\n      setClassError('Erreur lors de la suppression de la classe. Veuillez ressayer.');\n    } finally {\n      setAddingClass(false);\n    }\n  };\n\n  const renderTabContent = () => {\n    switch (activeTab) {\n      case 'overview':\n        return (\n          <div className=\"space-y-4 sm:space-y-6 lg:space-y-8\">\n            {/* Key Metrics - Responsive et prioritaires */}\n            <div className=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-3 sm:gap-4 lg:gap-6\">\n              {keyMetrics?.slice(0, 4).map((metric, index) => (\n                <MetricCard\n                  key={index}\n                  title={metric?.title}\n                  value={metric?.value}\n                  change={metric?.change}\n                  changeType={metric?.changeType}\n                  icon={metric?.icon}\n                  description={metric?.description}\n                  trend={metric?.trend}\n                />\n              ))}\n            </div>\n            \n            {/* Charts Section - Modernise */}\n            <div className=\"bg-white rounded-2xl border-2 border-gray-200 shadow-lg p-6 hover:shadow-xl transition-shadow\">\n              <div className=\"flex items-center justify-between mb-6\">\n                <div className=\"flex items-center\">\n                  <div className=\"w-10 h-10 bg-gradient-to-br from-blue-600 to-indigo-600 rounded-xl flex items-center justify-center mr-3 shadow-md\">\n                    <Icon name=\"TrendingUp\" size={20} className=\"text-white\" />\n                  </div>\n                  <div>\n                    <h3 className=\"text-lg font-semibold text-gray-900\">Performances Acadmiques</h3>\n                    <p className=\"text-xs text-gray-500\">Moyennes et prsences par classe</p>\n                  </div>\n                </div>\n                {/* Filtres rapides */}\n                <div className=\"hidden lg:flex items-center space-x-2\">\n                  <button className=\"px-3 py-1.5 text-xs font-medium bg-blue-100 text-blue-700 rounded-lg hover:bg-blue-200 transition-colors flex items-center space-x-1\">\n                    <Icon name=\"Filter\" size={14} />\n                    <span>Filtrer</span>\n                  </button>\n                  <button className=\"px-3 py-1.5 text-xs font-medium bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors flex items-center space-x-1\">\n                    <Icon name=\"Download\" size={14} />\n                    <span>Export</span>\n                  </button>\n                </div>\n              </div>\n              <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\n                <div className=\"bg-gradient-to-br from-blue-50 to-indigo-50 rounded-xl p-4 min-h-[250px] border border-blue-200\">\n                  <ClassAverageChart />\n                </div>\n                <div className=\"bg-gradient-to-br from-green-50 to-emerald-50 rounded-xl p-4 min-h-[250px] border border-green-200\">\n                  <AttendanceChart />\n                </div>\n              </div>\n            </div>\n            \n            {/* Payment Status - Modernis */}\n            <div className=\"bg-white rounded-2xl border-2 border-gray-200 shadow-lg p-6 hover:shadow-xl transition-shadow\">\n              <div className=\"flex items-center justify-between mb-6\">\n                <div className=\"flex items-center\">\n                  <div className=\"w-10 h-10 bg-gradient-to-br from-green-600 to-emerald-600 rounded-xl flex items-center justify-center mr-3 shadow-md\">\n                    <Icon name=\"CreditCard\" size={20} className=\"text-white\" />\n                  </div>\n                  <div>\n                    <h3 className=\"text-lg font-semibold text-gray-900\">Suivi des Paiements</h3>\n                    <p className=\"text-xs text-gray-500\">Frais scolaires & redevances</p>\n                  </div>\n                </div>\n                <div className=\"hidden lg:flex items-center space-x-2\">\n                  <span className=\"px-3 py-1.5 text-xs font-semibold bg-green-100 text-green-700 rounded-lg\">\n                    Mois en cours\n                  </span>\n                </div>\n              </div>\n              <div className=\"bg-gradient-to-br from-amber-50 to-orange-50 rounded-xl p-4 min-h-[200px] border border-amber-200\">\n                <PaymentStatusChart />\n              </div>\n            </div>\n          </div>\n        );\n      case 'school-year':\n        return <SchoolYearValidationTab />;\n      case 'actions':\n        return (\n          <div className=\"space-y-6\">\n            {/* Raccourcis directs - Moderniss */}\n            <div className=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4\">\n              <button\n                onClick={() => navigate('/principal-dashboard?tab=accounts&subtab=create')}\n                className=\"group p-5 bg-gradient-to-br from-blue-50 to-indigo-50 hover:from-blue-100 hover:to-indigo-100 border-2 border-blue-200 hover:border-blue-400 rounded-2xl transition-all duration-300 text-left hover:shadow-xl hover:scale-105\"\n              >\n                <div className=\"flex items-center space-x-4\">\n                  <div className=\"w-14 h-14 bg-gradient-to-br from-blue-600 to-indigo-600 rounded-xl flex items-center justify-center shadow-lg group-hover:scale-110 transition-transform\">\n                    <Icon name=\"UserPlus\" size={24} className=\"text-white\" />\n                  </div>\n                  <div className=\"flex-1 min-w-0\">\n                    <h3 className=\"font-bold text-blue-900 text-base mb-1\">Crer un Compte</h3>\n                    <p className=\"text-sm text-blue-700\">Ajouter enseignant ou secrtaire</p>\n                  </div>\n                </div>\n              </button>\n              \n              <button\n                onClick={() => navigate('/notification-management')}\n                className=\"group p-5 bg-gradient-to-br from-green-50 to-emerald-50 hover:from-green-100 hover:to-emerald-100 border-2 border-green-200 hover:border-green-400 rounded-2xl transition-all duration-300 text-left hover:shadow-xl hover:scale-105\"\n              >\n                <div className=\"flex items-center space-x-4\">\n                  <div className=\"w-14 h-14 bg-gradient-to-br from-green-600 to-emerald-600 rounded-xl flex items-center justify-center shadow-lg group-hover:scale-110 transition-transform\">\n                    <Icon name=\"Bell\" size={24} className=\"text-white\" />\n                  </div>\n                  <div className=\"flex-1 min-w-0\">\n                    <h3 className=\"font-bold text-green-900 text-base mb-1\">Envoyer Message</h3>\n                    <p className=\"text-sm text-green-700\">Notifier lves, parents ou personnel</p>\n                  </div>\n                </div>\n              </button>\n              \n              <button\n                onClick={() => navigate('/report-generation')}\n                className=\"group p-5 bg-gradient-to-br from-purple-50 to-pink-50 hover:from-purple-100 hover:to-pink-100 border-2 border-purple-200 hover:border-purple-400 rounded-2xl transition-all duration-300 text-left hover:shadow-xl hover:scale-105 sm:col-span-2 lg:col-span-1\"\n              >\n                <div className=\"flex items-center space-x-4\">\n                  <div className=\"w-14 h-14 bg-gradient-to-br from-purple-600 to-pink-600 rounded-xl flex items-center justify-center shadow-lg group-hover:scale-110 transition-transform\">\n                    <Icon name=\"FileBarChart\" size={24} className=\"text-white\" />\n                  </div>\n                  <div className=\"flex-1 min-w-0\">\n                    <h3 className=\"font-bold text-purple-900 text-base mb-1\">Gnrer Rapport</h3>\n                    <p className=\"text-sm text-purple-700\">Statistiques et analyses dtailles</p>\n                  </div>\n                </div>\n              </button>\n            </div>\n            \n            {/* Section complte */}\n            <QuickActions />\n          </div>\n        );\n      case 'system':\n        return (\n          <div className=\"bg-white rounded-2xl border-2 border-gray-200 shadow-lg p-6\">\n            <div className=\"flex items-center mb-6\">\n              <div className=\"w-10 h-10 bg-gradient-to-br from-purple-600 to-pink-600 rounded-xl flex items-center justify-center mr-3 shadow-md\">\n                <Icon name=\"Settings\" size={20} className=\"text-white\" />\n              </div>\n              <div>\n                <h3 className=\"text-lg font-semibold text-gray-900\">tat du Systme</h3>\n                <p className=\"text-xs text-gray-500\">Statut technique et paramtres</p>\n              </div>\n            </div>\n            <SystemStatus />\n          </div>\n        );\n      case 'accounts':\n        return <AccountsManagement />;\n      case 'school-info':\n        return (\n          <div className=\"space-y-6\">\n            {/* Informations gnrales de l'cole - Modernis */}\n            <div className=\"bg-white rounded-2xl border-2 border-gray-200 shadow-lg p-6\">\n              <div className=\"flex items-center mb-6\">\n                <div className=\"w-10 h-10 bg-gradient-to-br from-blue-600 to-indigo-600 rounded-xl flex items-center justify-center mr-3 shadow-md\">\n                  <Icon name=\"Building2\" size={20} className=\"text-white\" />\n                </div>\n                <h3 className=\"text-lg font-semibold text-gray-900\"> Informations de l'tablissement</h3>\n              </div>\n              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n                <div className=\"space-y-4\">\n                  <div className=\"flex items-center space-x-3\">\n                    <div className=\"w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center\"></div>\n                    <div>\n                      <div className=\"text-sm text-gray-500\">Nom de l'tablissement</div>\n                      <div className=\"font-medium\">{schoolData?.name || 'Non dfini'}</div>\n                    </div>\n                  </div>\n                  \n                  <div className=\"flex items-center space-x-3\">\n                    <div className=\"w-8 h-8 bg-green-100 rounded-lg flex items-center justify-center\"></div>\n                    <div>\n                      <div className=\"text-sm text-gray-500\">Type d'tablissement</div>\n                      <div className=\"font-medium\">{schoolData?.type || 'Non dfini'}</div>\n                    </div>\n                  </div>\n                  \n                  <div className=\"flex items-center space-x-3\">\n                    <div className=\"w-8 h-8 bg-purple-100 rounded-lg flex items-center justify-center\"></div>\n                    <div>\n                      <div className=\"text-sm text-gray-500\">Adresse</div>\n                      <div className=\"font-medium\">{schoolData?.address || 'Non dfinie'}</div>\n                    </div>\n                  </div>\n                  \n                  <div className=\"flex items-center space-x-3\">\n                    <div className=\"w-8 h-8 bg-orange-100 rounded-lg flex items-center justify-center\"></div>\n                    <div>\n                      <div className=\"text-sm text-gray-500\">Localisation</div>\n                      <div className=\"font-medium\">{schoolData?.city ? `${schoolData.city}, ${schoolData.country || ''}` : 'Non dfinie'}</div>\n                    </div>\n                  </div>\n                </div>\n                \n                <div className=\"space-y-4\">\n                  <div className=\"flex items-center space-x-3\">\n                    <div className=\"w-8 h-8 bg-indigo-100 rounded-lg flex items-center justify-center\"></div>\n                    <div>\n                      <div className=\"text-sm text-gray-500\">Directeur</div>\n                      <div className=\"font-medium\">{schoolData?.director_name || schoolData?.users?.full_name || 'Non dfini'}</div>\n                    </div>\n                  </div>\n                  \n                  <div className=\"flex items-center space-x-3\">\n                    <div className=\"w-8 h-8 bg-yellow-100 rounded-lg flex items-center justify-center\"></div>\n                    <div>\n                      <div className=\"text-sm text-gray-500\">Tlphone</div>\n                      <div className=\"font-medium\">{schoolData?.phone || 'Non dfini'}</div>\n                    </div>\n                  </div>\n                  \n                  <div className=\"flex items-center space-x-3\">\n                    <div className=\"w-8 h-8 bg-red-100 rounded-lg flex items-center justify-center\"></div>\n                    <div>\n                      <div className=\"text-sm text-gray-500\">Code tablissement</div>\n                      <div className=\"font-medium\">{schoolData?.code || 'Non dfini'}</div>\n                    </div>\n                  </div>\n                  \n                  <div className=\"flex items-center space-x-3\">\n                    <div className=\"w-8 h-8 bg-teal-100 rounded-lg flex items-center justify-center\"></div>\n                    <div>\n                      <div className=\"text-sm text-gray-500\">Statut</div>\n                      <div className={`font-medium px-2 py-1 rounded text-xs inline-block ${\n                        schoolData?.status === 'active' ? 'bg-green-100 text-green-800' :\n                        schoolData?.status === 'pending' ? 'bg-yellow-100 text-yellow-800' :\n                        'bg-gray-100 text-gray-800'\n                      }`}>\n                        {schoolData?.status === 'active' ? ' Actif' :\n                         schoolData?.status === 'pending' ? ' En attente' :\n                         schoolData?.status || 'Non dfini'}\n                      </div>\n                    </div>\n                  </div>\n                </div>\n              </div>\n            </div>\n            \n            {/* Gestion intelligente des classes - Modernise */}\n            <div className=\"bg-white rounded-2xl border-2 border-gray-200 shadow-lg p-6 hover:shadow-xl transition-shadow\">\n              <div className=\"flex items-center justify-between mb-6\">\n                <div className=\"flex items-center\">\n                  <div className=\"w-12 h-12 bg-gradient-to-br from-green-600 to-emerald-600 rounded-xl flex items-center justify-center mr-3 shadow-md\">\n                    <Icon name=\"BookOpen\" size={24} className=\"text-white\" />\n                  </div>\n                  <div>\n                    <h3 className=\"text-lg font-semibold text-gray-900\"> Classes de l'cole</h3>\n                    <p className=\"text-xs text-gray-500\">Grez les classes de votre tablissement</p>\n                  </div>\n                </div>\n                <button className=\"px-4 py-2 bg-gradient-to-r from-blue-600 to-indigo-600 text-white rounded-xl hover:from-blue-700 hover:to-indigo-700 hover:scale-105 transition-all shadow-md hover:shadow-lg text-sm font-semibold flex items-center space-x-2\">\n                  <Icon name=\"Plus\" size={16} />\n                  <span>Ajouter une classe</span>\n                </button>\n              </div>\n              \n              {/* Classes actives de l'cole */}\n              {schoolData?.available_classes && schoolData.available_classes.length > 0 ? (\n                <div className=\"mb-6\">\n                  <h4 className=\"text-md font-semibold text-gray-700 mb-4 flex items-center\">\n                    <span className=\"w-2 h-2 bg-green-500 rounded-full mr-2 animate-pulse\"></span>\n                     Vos Classes Actives ({schoolData.available_classes.length})\n                  </h4>\n                  <div className=\"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-3\">\n                    {schoolData.available_classes.map((classe, index) => (\n                      <div key={index} className=\"bg-gradient-to-br from-green-50 to-emerald-50 border-2 border-green-200 rounded-xl p-4 text-center hover:from-green-100 hover:to-emerald-100 hover:scale-105 hover:shadow-lg transition-all group relative\">\n                        <div className=\"text-green-900 font-bold text-lg mb-1\">{classe}</div>\n                        <div className=\"text-xs text-green-600 font-medium mb-2\">Prte  utiliser</div>\n                        <div className=\"mt-2 flex justify-center space-x-1\">\n                          <button \n                            className=\"p-2 text-green-600 hover:bg-green-200 rounded-lg transition-colors\"\n                            title=\"Voir les lves\"\n                          >\n                            <Icon name=\"Users\" size={14} />\n                          </button>\n                          <button \n                            className=\"p-2 text-green-600 hover:bg-green-200 rounded-lg transition-colors\"\n                            title=\"Paramtres de la classe\"\n                          >\n                            <Icon name=\"Settings\" size={14} />\n                          </button>\n                          <button \n                            onClick={() => handleRemoveClass(classe)}\n                            disabled={addingClass}\n                            className=\"p-2 text-red-600 hover:bg-red-100 rounded-lg disabled:opacity-50 disabled:cursor-not-allowed transition-colors\"\n                            title=\"Supprimer cette classe\"\n                          >\n                            <Icon name=\"Trash2\" size={14} />\n                          </button>\n                        </div>\n                      </div>\n                    ))}\n                  </div>\n                </div>\n              ) : (\n                <div className=\"mb-6 bg-gradient-to-r from-amber-50 via-yellow-50 to-orange-50 border-2 border-amber-300 rounded-2xl p-6 shadow-md\">\n                  <div className=\"text-center text-amber-900\">\n                    <div className=\"w-16 h-16 bg-gradient-to-br from-amber-500 to-orange-500 rounded-xl flex items-center justify-center mx-auto mb-3 shadow-md\">\n                      <Icon name=\"AlertTriangle\" size={32} className=\"text-white\" />\n                    </div>\n                    <div className=\"font-bold text-lg mb-1\">Aucune classe active</div>\n                    <div className=\"text-sm text-amber-700\">Configurez vos classes pour commencer</div>\n                  </div>\n                </div>\n              )}\n\n              {/* Suggestions de classes selon le type d'tablissement */}\n              {schoolData?.type && (\n                <div className=\"mb-6\">\n                  <h4 className=\"text-md font-medium text-gray-700 mb-3 flex items-center\">\n                     Classes Suggres pour votre {schoolData.type}\n                    <span className=\"ml-2 text-xs bg-blue-100 text-blue-700 px-2 py-1 rounded\">\n                      {schoolData.type}\n                    </span>\n                  </h4>\n                  \n                  {(() => {\n                    const currentClasses = schoolData.available_classes || [];\n                    let suggestions = [];\n                    let levelDescription = '';\n                    \n                    // Normaliser le type d'tablissement (grer accents, casse, variations)\n                    const normalizeType = (type) => {\n                      if (!type) return '';\n                      return type.toLowerCase()\n                        .normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\") // Enlever les accents\n                        .trim();\n                    };\n                    \n                    const schoolType = normalizeType(schoolData.type);\n                    \n                    // Suggestions STRICTEMENT selon le type d'tablissement\n                    if (schoolType === 'maternelle' || schoolType.includes('maternelle')) {\n                      levelDescription = 'Cycle prscolaire (3-6 ans)';\n                      suggestions = [\n                        'Petite Section', 'Moyenne Section', 'Grande Section',\n                        'PS A', 'PS B', 'MS A', 'MS B', 'GS A', 'GS B'\n                      ];\n                    } \n                    else if (schoolType === 'primaire' || schoolType.includes('primaire')) {\n                      levelDescription = 'Cycle primaire (6-11 ans)';\n                      suggestions = [\n                        'CP', 'CE1', 'CE2', 'CM1', 'CM2',\n                        'CP A', 'CP B', 'CE1 A', 'CE1 B', 'CE2 A', 'CE2 B',\n                        'CM1 A', 'CM1 B', 'CM2 A', 'CM2 B'\n                      ];\n                    } \n                    else if (schoolType === 'college' || schoolType.includes('college')) {\n                      levelDescription = 'Cycle secondaire 1er degr (11-15 ans)';\n                      suggestions = [\n                        '6me', '5me', '4me', '3me',\n                        '6me A', '6me B', '6me C', \n                        '5me A', '5me B', '5me C',\n                        '4me A', '4me B', '4me C',\n                        '3me A', '3me B', '3me C'\n                      ];\n                    }\n                    else if (schoolType === 'lycee' || schoolType.includes('lycee')) {\n                      levelDescription = 'Cycle secondaire 2nd degr (15-18 ans)';\n                      suggestions = [\n                        '2nde', '1re', 'Terminale',\n                        '2nde A', '2nde C', '2nde D',\n                        '1re A', '1re C', '1re D', '1re L', '1re S',\n                        'Terminale A', 'Terminale C', 'Terminale D', 'Terminale L', 'Terminale S', 'Terminale Ti'\n                      ];\n                    }\n                    else if (schoolType === 'college_lycee') {\n                      levelDescription = 'tablissement complet - Collge et Lyce (6me - Terminale)';\n                      suggestions = [\n                        // Collge\n                        '6me', '5me', '4me', '3me',\n                        '6me A', '6me B', '5me A', '5me B', '4me A', '4me B', '3me A', '3me B',\n                        // Lyce\n                        '2nde', '1re', 'Terminale',\n                        '2nde A', '2nde C', '1re A', '1re C', '1re D', '1re L', '1re S',\n                        'Terminale A', 'Terminale C', 'Terminale D', 'Terminale L', 'Terminale S'\n                      ];\n                    }\n                    else if (schoolType === 'formation_professionnelle' || schoolType.includes('technique') || schoolType.includes('professionnel')) {\n                      levelDescription = 'Enseignement technique et professionnel';\n                      suggestions = [\n                        'CAP 1re anne', 'CAP 2me anne',\n                        'BEP 1re anne', 'BEP 2me anne',\n                        'BAC Pro 1re', 'BAC Pro 2me', 'BAC Pro Terminale',\n                        'BTS 1re anne', 'BTS 2me anne',\n                        'CAP lectricit', 'CAP Mcanique', 'CAP Menuiserie', 'CAP Couture',\n                        'BEP lectronique', 'BEP Informatique', 'BEP Comptabilit',\n                        'BAC Pro lectricit', 'BAC Pro Mcanique Auto', 'BAC Pro Secrtariat'\n                      ];\n                    }\n                    else if (schoolType === 'universite' || schoolType.includes('universite') || schoolType.includes('superieur') || schoolType.includes('institut')) {\n                      levelDescription = 'Enseignement suprieur';\n                      suggestions = [\n                        'Licence 1', 'Licence 2', 'Licence 3',\n                        'Master 1', 'Master 2', 'Doctorat',\n                        'L1 Informatique', 'L1 Mathmatiques', 'L1 conomie', 'L1 Gestion',\n                        'L2 Informatique', 'L2 Mathmatiques', 'L2 conomie', 'L2 Gestion',\n                        'L3 Informatique', 'L3 Mathmatiques', 'L3 conomie', 'L3 Gestion',\n                        'M1 Informatique', 'M1 Finance', 'M2 Informatique', 'M2 Finance'\n                      ];\n                    }\n                    else {\n                      // Type d'tablissement non reconnu - suggestions gnriques appropries\n                      levelDescription = 'Classes gnrales';\n                      suggestions = [\n                        '6me', '5me', '4me', '3me', '2nde', '1re', 'Terminale'\n                      ];\n                    }\n                    \n                    // Filtrer les classes dj prsentes\n                    const availableSuggestions = suggestions.filter(\n                      suggestion => !currentClasses.includes(suggestion)\n                    );\n                    \n                    return (\n                      <div>\n                        <div className=\"mb-3 text-xs text-gray-600 italic\">\n                          {levelDescription}\n                        </div>\n                        {availableSuggestions.length > 0 ? (\n                          <div className=\"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-3\">\n                            {availableSuggestions.slice(0, 12).map((suggestion, index) => (\n                              <div key={index} className=\"bg-blue-50 border border-blue-200 rounded-lg p-3 text-center hover:bg-blue-100 transition-colors cursor-pointer group\">\n                                <div className=\"text-blue-800 font-medium\">{suggestion}</div>\n                                <div className=\"text-xs text-blue-600 mt-1\">Approprie</div>\n                                <div className=\"mt-2 opacity-0 group-hover:opacity-100 transition-opacity\">\n                                  <button \n                                    onClick={() => handleAddClass(suggestion)}\n                                    disabled={addingClass}\n                                    className=\"px-2 py-1 bg-blue-600 text-white text-xs rounded hover:bg-blue-700 disabled:bg-blue-400 disabled:cursor-not-allowed\"\n                                  >\n                                    + Ajouter\n                                  </button>\n                                </div>\n                              </div>\n                            ))}\n                          </div>\n                        ) : (\n                          <div className=\"text-center text-gray-500 py-4\">\n                            <Icon name=\"CheckCircle\" size={20} className=\"mx-auto mb-2 text-green-500\" />\n                            <div className=\"text-sm\">Toutes les classes appropries pour un {schoolData.type} sont configures !</div>\n                          </div>\n                        )}\n                      </div>\n                    );\n                  })()}\n                </div>\n              )}\n\n              {/* Option pour crer une classe personnalise - Modernise */}\n              <div className=\"bg-gradient-to-br from-blue-50 to-indigo-50 border-2 border-blue-200 rounded-2xl p-5 shadow-md\">\n                <div className=\"flex items-center mb-4\">\n                  <div className=\"w-10 h-10 bg-gradient-to-br from-blue-600 to-indigo-600 rounded-xl flex items-center justify-center mr-3 shadow-md\">\n                    <Icon name=\"Plus\" size={20} className=\"text-white\" />\n                  </div>\n                  <h4 className=\"text-md font-semibold text-blue-900\"> Classe Personnalise</h4>\n                </div>\n                <div className=\"flex items-center space-x-3\">\n                  <input\n                    type=\"text\"\n                    placeholder=\"Ex: Ti, 1re Anglophone, BTS Comptabilit...\"\n                    className=\"flex-1 px-4 py-3 border-2 border-blue-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white shadow-sm\"\n                    value={newClassName}\n                    onChange={(e) => setNewClassName(e.target.value)}\n                    onKeyPress={(e) => e.key === 'Enter' && handleAddCustomClass()}\n                  />\n                  <button \n                    onClick={handleAddCustomClass}\n                    disabled={!newClassName.trim() || addingClass}\n                    className=\"px-5 py-3 bg-gradient-to-r from-blue-600 to-indigo-600 text-white rounded-xl hover:from-blue-700 hover:to-indigo-700 hover:scale-105 transition-all shadow-md hover:shadow-lg disabled:from-gray-400 disabled:to-gray-500 disabled:cursor-not-allowed disabled:hover:scale-100 flex items-center space-x-2 font-semibold\"\n                  >\n                    {addingClass ? (\n                      <>\n                        <div className=\"animate-spin rounded-full h-4 w-4 border-b-2 border-white\"></div>\n                        <span>Ajout...</span>\n                      </>\n                    ) : (\n                      <>\n                        <Icon name=\"Plus\" size={16} />\n                        <span>Crer</span>\n                      </>\n                    )}\n                  </button>\n                </div>\n                <div className=\"text-xs text-blue-700 mt-2 font-medium\">\n                   Crez des classes avec des noms spcifiques  votre tablissement\n                </div>\n                {classError && (\n                  <div className=\"mt-3 text-sm text-red-700 bg-gradient-to-r from-red-50 to-pink-50 border-2 border-red-200 rounded-xl px-4 py-2 shadow-sm\">\n                     {classError}\n                  </div>\n                )}\n                {classSuccess && (\n                  <div className=\"mt-3 text-sm text-green-700 bg-gradient-to-r from-green-50 to-emerald-50 border-2 border-green-200 rounded-xl px-4 py-2 shadow-sm\">\n                     {classSuccess}\n                  </div>\n                )}\n              </div>\n            </div>\n            \n            {/* Statistiques rapides - Modernises */}\n            <div className=\"bg-white rounded-2xl border-2 border-gray-200 shadow-lg p-6 hover:shadow-xl transition-shadow\\n\">              <div className=\"flex items-center mb-6\">\n                <div className=\"w-10 h-10 bg-gradient-to-br from-purple-600 to-pink-600 rounded-xl flex items-center justify-center mr-3 shadow-md\">\n                  <Icon name=\"BarChart3\" size={20} className=\"text-white\" />\n                </div>\n                <div>\n                  <h3 className=\"text-lg font-semibold text-gray-900\"> Aperu Rapide</h3>\n                  <p className=\"text-xs text-gray-500\">Statistiques gnrales de l'tablissement</p>\n                </div>\n              </div>\n              <div className=\"grid grid-cols-1 md:grid-cols-4 gap-4\">\n                <div className=\"bg-gradient-to-br from-blue-50 to-indigo-50 p-5 rounded-xl border-2 border-blue-200 hover:shadow-lg hover:scale-105 transition-all\">\n                  <div className=\"text-3xl font-bold text-blue-800 mb-1\">\n                    {keyMetrics.find(m => m.title === 'lves')?.value || 0}\n                  </div>\n                  <div className=\"text-sm text-blue-600 font-medium\">lves inscrits</div>\n                </div>\n                <div className=\"bg-gradient-to-br from-green-50 to-emerald-50 p-5 rounded-xl border-2 border-green-200 hover:shadow-lg hover:scale-105 transition-all\">\n                  <div className=\"text-3xl font-bold text-green-800 mb-1\">\n                    {data?.schoolStats?.teachers || 0}\n                  </div>\n                  <div className=\"text-sm text-green-600 font-medium\">Enseignants</div>\n                </div>\n                <div className=\"bg-gradient-to-br from-purple-50 to-pink-50 p-5 rounded-xl border-2 border-purple-200 hover:shadow-lg hover:scale-105 transition-all\">\n                  <div className=\"text-3xl font-bold text-purple-800 mb-1\">\n                    {schoolData?.available_classes?.length || 0}\n                  </div>\n                  <div className=\"text-sm text-purple-600 font-medium\">Classes actives</div>\n                </div>\n                <div className=\"bg-gradient-to-br from-orange-50 to-red-50 p-5 rounded-xl border-2 border-orange-200 hover:shadow-lg hover:scale-105 transition-all\">\n                  <div className=\"text-2xl font-bold text-orange-800 mb-1\">\n                    {(() => {\n                      const schoolType = schoolData?.type?.toLowerCase().trim();\n                      const currentClasses = schoolData?.available_classes || [];\n                      let suggestions = [];\n                      \n                      // Mme logique que dans la section suggestions\n                      if (schoolType === 'primaire' || schoolType === 'cole primaire') {\n                        suggestions = [\n                          'CP', 'CE1', 'CE2', 'CM1', 'CM2',\n                          'CP A', 'CP B', 'CE1 A', 'CE1 B', 'CE2 A', 'CE2 B',\n                          'CM1 A', 'CM1 B', 'CM2 A', 'CM2 B'\n                        ];\n                      } else if (schoolType === 'collge' || schoolType === 'college') {\n                        suggestions = [\n                          '6me', '5me', '4me', '3me',\n                          '6me A', '6me B', '6me C', \n                          '5me A', '5me B', '5me C',\n                          '4me A', '4me B', '4me C',\n                          '3me A', '3me B', '3me C'\n                        ];\n                      } else if (schoolType === 'lyce' || schoolType === 'lycee') {\n                        suggestions = [\n                          '2nde', '1re', 'Terminale',\n                          '2nde A', '2nde C', '2nde D',\n                          '1re A', '1re C', '1re D', '1re L', '1re S',\n                          'Terminale A', 'Terminale C', 'Terminale D', 'Terminale L', 'Terminale S', 'Terminale Ti'\n                        ];\n                      } else if (schoolType?.includes('technique') || schoolType?.includes('professionnel')) {\n                        suggestions = [\n                          'CAP 1re anne', 'CAP 2me anne',\n                          'BEP 1re anne', 'BEP 2me anne',\n                          'BAC Pro 1re', 'BAC Pro 2me', 'BAC Pro Terminale',\n                          'BTS 1re anne', 'BTS 2me anne',\n                          'CAP lectricit', 'CAP Mcanique', 'CAP Menuiserie', 'CAP Couture',\n                          'BEP lectronique', 'BEP Informatique', 'BEP Comptabilit',\n                          'BAC Pro lectricit', 'BAC Pro Mcanique Auto', 'BAC Pro Secrtariat'\n                        ];\n                      } else if (schoolType?.includes('maternelle')) {\n                        suggestions = [\n                          'Petite Section', 'Moyenne Section', 'Grande Section',\n                          'PS A', 'PS B', 'MS A', 'MS B', 'GS A', 'GS B'\n                        ];\n                      } else if (schoolType?.includes('suprieur') || schoolType?.includes('universit')) {\n                        suggestions = [\n                          'Licence 1', 'Licence 2', 'Licence 3',\n                          'Master 1', 'Master 2',\n                          'L1 Informatique', 'L1 Mathmatiques', 'L1 conomie',\n                          'L2 Informatique', 'L2 Mathmatiques', 'L2 conomie',\n                          'L3 Informatique', 'L3 Mathmatiques', 'L3 conomie'\n                        ];\n                      } else {\n                        suggestions = [\n                          '6me', '5me', '4me', '3me', '2nde', '1re', 'Terminale'\n                        ];\n                      }\n                      \n                      // Filtrer les suggestions qui ne sont pas dj dans les classes actuelles\n                      const availableSuggestions = suggestions.filter(\n                        suggestion => !currentClasses.includes(suggestion)\n                      );\n                      \n                      return availableSuggestions.length;\n                    })()}\n                  </div>\n                  <div className=\"text-sm text-orange-600\">Classes suggres</div>\n                </div>\n              </div>\n            </div>\n          </div>\n        );\n      case 'debug':\n        return (\n          <div className=\"space-y-6\">\n            {/* Debug utilisateur */}\n            <div className=\"bg-white rounded-xl border border-gray-200 p-6\">\n              <h3 className=\"text-lg font-semibold text-gray-900 mb-6\"> Debug Utilisateur</h3>\n              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm\">\n                <div className=\"space-y-2\">\n                  <div><strong>Utilisateur connect:</strong> {user ? ' Oui' : ' Non'}</div>\n                  <div><strong>Email:</strong> {user?.email || 'N/A'}</div>\n                  <div><strong>ID utilisateur:</strong> {user?.id || 'N/A'}</div>\n                  <div><strong>cole dtecte:</strong> {user?.schoolData ? ' Oui' : ' Non'}</div>\n                </div>\n              </div>\n\n              {user?.schoolData && (\n                <div className=\"mt-4 p-3 bg-green-50 border border-green-200 rounded\">\n                  <h4 className=\"font-medium text-green-900 mb-2\"> Donnes cole</h4>\n                  <div className=\"text-sm text-green-800 space-y-1\">\n                    <div><strong>Nom:</strong> {user.schoolData.name}</div>\n                    <div><strong>ID:</strong> {user.schoolData.id}</div>\n                    <div><strong>Type:</strong> {user.schoolData.type || 'Non dfini'}</div>\n                    <div><strong>Statut:</strong> {user.schoolData.status}</div>\n                    <div><strong>Adresse:</strong> {user.schoolData.address || 'Non dfinie'}</div>\n                    <div><strong>Ville:</strong> {user.schoolData.city || 'Non dfinie'}</div>\n                    <div><strong>Pays:</strong> {user.schoolData.ceountry || 'Non dfini'}</div>\n                    <div><strong>Classes:</strong> {user.schoolData.available_classes ? user.schoolData.available_classes.join(', ') : 'Non dfinies'}</div>\n                    <div><strong>Code cole:</strong> {user.schoolData.code || 'Non dfini'}</div>\n                    <div><strong>Directeur User ID:</strong> {user.schoolData.director_user_id}</div>\n                  </div>\n                </div>\n              )}\n              \n              {schoolDataFromState && (\n                <div className=\"mt-4 p-3 bg-blue-50 border border-blue-200 rounded\">\n                  <h4 className=\"font-medium text-blue-900 mb-2\"> Donnes cole (location.state)</h4>\n                  <div className=\"text-sm text-blue-800 space-y-1\">\n                    <div><strong>Nom:</strong> {schoolDataFromState.name}</div>\n                    <div><strong>ID:</strong> {schoolDataFromState.id}</div>\n                    <div><strong>Statut:</strong> {schoolDataFromState.status}</div>\n                  </div>\n                </div>\n              )}\n            </div>\n            \n            {/* Debug de la base de donnes */}\n            <div className=\"bg-white rounded-xl border border-gray-200 p-6\">\n              <h3 className=\"text-lg font-semibold text-gray-900 mb-6\">Diagnostic de la Base de Donnes</h3>\n              <DatabaseDiagnostic />\n            </div>\n          </div>\n        );\n      default:\n        return null;\n    }\n  };\n\n  return (\n    <>\n      <Helmet>\n        <title>Tableau de bord Principal - EduTrack CM</title>\n        <meta name=\"description\" content=\"Tableau de bord principal pour la supervision et l'administration de l'cole avec analyses en temps rel\" />\n      </Helmet>\n      <div className=\"min-h-screen bg-gradient-to-br from-gray-50 via-blue-50/30 to-indigo-50/30\">\n        {/* Header */}\n        <Header\n          userRole=\"principal\"\n          userName={\n            schoolData?.director_name || \n            schoolData?.directorName || \n            schoolData?.users?.full_name ||\n            user?.schoolData?.users?.full_name ||\n            user?.full_name ||\n            user?.email?.split('@')[0] || \n            'Directeur'\n          }\n          isCollapsed={isSidebarCollapsed}\n          onToggleSidebar={toggleSidebar}\n        />\n\n        {/* Sidebar */}\n        <Sidebar\n          userRole=\"principal\"\n          isCollapsed={isSidebarCollapsed}\n          onToggle={toggleSidebar}\n        />\n\n        {/* Main Content */}\n        <main className={`pt-20 sm:pt-16 transition-all duration-300 ${\n          isSidebarCollapsed ? 'lg:ml-16' : 'lg:ml-64'\n        } overflow-x-hidden min-h-screen`}>\n          <div className=\"px-2 sm:px-4 lg:px-6 py-2 sm:py-3 space-y-2 sm:space-y-3 w-full\">\n            <div className=\"max-w-full w-full overflow-x-auto\">\n            {/* Page Header - Modernis */}\n            <div className=\"bg-gradient-to-r from-blue-600 via-indigo-600 to-purple-600 rounded-2xl shadow-xl p-8 text-white mb-8 animate-fadeIn\">\n              <div className=\"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4\">\n                <div>\n                  <div className=\"inline-flex items-center px-3 py-1 bg-white/20 backdrop-blur-sm rounded-full text-xs font-medium mb-3\">\n                    <span className=\"w-2 h-2 bg-green-400 rounded-full mr-2 animate-pulse\"></span>\n                    En ligne\n                  </div>\n                  <h1 className=\"font-heading font-heading-bold text-4xl mb-2\">\n                    Bienvenue, {schoolData?.director_name ||\n                    schoolData?.directorName ||\n                    schoolData?.users?.full_name ||\n                    user?.schoolData?.users?.full_name ||\n                    user?.full_name ||\n                    user?.email?.split('@')[0] ||\n                    'Directeur'} \n                  </h1>\n                  <p className=\"font-body font-body-normal text-blue-100 text-lg\">\n                    Tableau de Bord Principal  <span\n                      onClick={handleDiagnosticClick}\n                      className=\"cursor-pointer select-none\"\n                      title=\"Cliquez 7 fois pour activer le mode diagnostic\"\n                    >\n                      {schoolData?.name || 'tablissement'}\n                    </span>\n                  </p>\n                </div>\n                <div className=\"flex flex-col lg:flex-row items-start lg:items-center gap-3\">\n                  <div className=\"text-right bg-white/10 backdrop-blur-sm rounded-xl p-4 border border-white/20\">\n                    <p className=\"font-body font-body-semibold text-sm mb-1\">\n                      {new Date()?.toLocaleDateString('fr-FR', { \n                        weekday: 'long', \n                        year: 'numeric', \n                        month: 'long', \n                        day: 'numeric' \n                      })}\n                    </p>\n                    <p className=\"font-caption font-caption-normal text-xs text-blue-200 flex items-center justify-end\">\n                      <Icon name=\"Calendar\" size={14} className=\"mr-1\" />\n                      Anne scolaire 2025-2026\n                    </p>\n                  </div>\n                </div>\n              </div>\n            </div>\n\n            {/* Tab Navigation - Version desktop modernise */}\n            <div className=\"mb-8 hidden sm:block\">\n              <div className=\"bg-white rounded-2xl shadow-md border border-gray-200 p-6\">\n                <div className=\"flex items-center mb-4\">\n                  <div className=\"w-1 h-8 bg-gradient-to-b from-blue-600 to-indigo-600 rounded-full mr-3\"></div>\n                  <h2 className=\"font-heading font-heading-bold text-xl text-text-primary\">Modules de Gestion</h2>\n                </div>\n                <div className=\"flex flex-wrap gap-3\">\n                  {tabOptions?.map((tab) => {\n                    // Ajouter des indicateurs contextuels\n                    const getTabBadge = (tabId) => {\n                      switch (tabId) {\n                        case 'personnel':\n                          return <div className=\"w-2 h-2 bg-green-500 rounded-full ml-1 flex-shrink-0\" title=\"25 membres actifs\" />;\n                        case 'system':\n                          return <div className=\"w-2 h-2 bg-yellow-500 rounded-full ml-1 flex-shrink-0\" title=\"1 alerte mineure\" />;\n                        case 'school-year':\n                          return <div className=\"w-2 h-2 bg-warning rounded-full ml-1 flex-shrink-0\" title=\"3 demandes en attente\" />;\n                        default:\n                          return null;\n                      }\n                    };\n                    \n                    return (\n                      <button\n                        key={tab?.id}\n                        onClick={() => handleTabChange(tab?.id)}\n                        className={`group relative overflow-hidden rounded-xl px-5 py-3 transition-all duration-300 ${\n                          activeTab === tab?.id\n                            ? 'bg-gradient-to-br from-blue-600 to-indigo-600 text-white shadow-lg scale-105'\n                            : 'bg-gray-50 hover:bg-gray-100 border border-gray-200 hover:border-blue-300 hover:shadow-md hover:scale-102 text-gray-700'\n                        }`}\n                      >\n                        <div className=\"flex items-center space-x-3\">\n                          <div className={`w-10 h-10 rounded-xl flex items-center justify-center transition-all ${\n                            activeTab === tab?.id\n                              ? 'bg-white/20 backdrop-blur-sm'\n                              : 'bg-white group-hover:bg-blue-50 shadow-sm'\n                          }`}>\n                            <Icon \n                              name={tab?.icon} \n                              size={20} \n                              className={activeTab === tab?.id ? 'text-white' : 'text-blue-600'}\n                            />\n                          </div>\n                          <span className={`font-body font-body-semibold text-sm whitespace-nowrap ${\n                            activeTab === tab?.id ? 'text-white' : 'text-gray-900'\n                          }`}>\n                            {tab?.label}\n                          </span>\n                          {getTabBadge(tab?.id)}\n                        </div>\n                        {activeTab === tab?.id && (\n                          <div className=\"absolute bottom-0 left-0 right-0 h-1 bg-white rounded-full\"></div>\n                        )}\n                      </button>\n                    );\n                  })}\n                </div>\n              </div>\n            </div>\n\n            {/* Tab Navigation - Version mobile modernise */}\n            <div className=\"mb-6 sm:hidden\">\n              <div className=\"relative\" data-mobile-menu>\n                <div className=\"absolute left-4 top-1/2 transform -translate-y-1/2 pointer-events-none\">\n                  <Icon name=\"Layers\" size={18} className=\"text-blue-600\" />\n                </div>\n                <button\n                  onClick={() => setShowMobileMenu(!showMobileMenu)}\n                  className=\"w-full flex items-center justify-between pl-12 pr-4 py-3 bg-gradient-to-r from-blue-50 to-indigo-50 border-2 border-blue-200 rounded-xl text-sm font-semibold text-text-primary transition-all\"\n                >\n                  <div className=\"flex items-center space-x-2\">\n                    <span>{tabOptions?.find(t => t.id === activeTab)?.label}</span>\n                    {/* Indicateur d'alertes */}\n                    {((activeTab === 'system' && true) || \n                      (activeTab === 'school-year' && true)) && (\n                      <div className=\"w-2 h-2 bg-warning rounded-full\"></div>\n                    )}\n                  </div>\n                  <Icon \n                    name={showMobileMenu ? \"ChevronUp\" : \"ChevronDown\"} \n                    size={18} \n                    className=\"text-blue-600\"\n                  />\n                </button>\n                \n                {showMobileMenu && (\n                  <div className=\"absolute top-full left-0 right-0 mt-2 bg-white border-2 border-gray-200 rounded-2xl shadow-2xl z-50 animate-fadeIn\">\n                    <div className=\"py-2\">\n                      {tabOptions?.map((tab) => {\n                        const hasAlert = (tab.id === 'personnel') || (tab.id === 'system') || (tab.id === 'school-year');\n                        \n                        return (\n                          <button\n                            key={tab?.id}\n                            onClick={() => {\n                              handleTabChange(tab?.id);\n                              setShowMobileMenu(false);\n                            }}\n                            className={`w-full flex items-center justify-between px-4 py-3 mx-2 my-1 rounded-xl text-sm transition-all duration-300 ${\n                              activeTab === tab?.id\n                                ? 'bg-gradient-to-r from-blue-600 to-indigo-600 text-white shadow-md font-semibold' \n                                : 'text-gray-600 hover:bg-blue-50 hover:text-blue-700'\n                            }`}\n                          >\n                            <div className=\"flex items-center space-x-3\">\n                              <div className={`w-8 h-8 rounded-lg flex items-center justify-center ${\n                                activeTab === tab?.id ? 'bg-white/20' : 'bg-blue-100'\n                              }`}>\n                                <Icon name={tab?.icon} size={16} className={activeTab === tab?.id ? 'text-white' : 'text-blue-600'} />\n                              </div>\n                              <span className=\"font-body font-body-semibold\">{tab?.label}</span>\n                            </div>\n                            {hasAlert && (\n                              <div className=\"w-2 h-2 bg-amber-400 rounded-full flex-shrink-0 animate-pulse\"></div>\n                            )}\n                          </button>\n                        );\n                      })}\n                    </div>\n                  </div>\n                )}\n              </div>\n            </div>\n\n            {/* Toast Mode Diagnostic Activ */}\n            {showDiagnosticToast && (\n              <div className=\"mb-6 bg-gradient-to-r from-purple-50 via-indigo-50 to-blue-50 border-2 border-purple-300 p-5 rounded-2xl shadow-lg animate-fadeIn\">\n                <div className=\"flex items-center gap-4\">\n                  <div className=\"w-12 h-12 bg-gradient-to-br from-purple-600 to-indigo-600 rounded-xl flex items-center justify-center shadow-md flex-shrink-0\">\n                    <Icon name=\"Settings\" size={24} className=\"text-white\" />\n                  </div>\n                  <div className=\"flex-1\">\n                    <p className=\"text-sm font-semibold text-purple-900 mb-1\">\n                       Mode Diagnostic Activ\n                    </p>\n                    <p className=\"text-xs text-purple-700\">\n                      L'onglet \"tat Systme\" est maintenant accessible. Cliquez  nouveau sur le nom de l'cole pour dsactiver.\n                    </p>\n                  </div>\n                  <button\n                    onClick={() => setShowDiagnosticToast(false)}\n                    className=\"w-8 h-8 flex items-center justify-center rounded-lg hover:bg-purple-200 transition-colors flex-shrink-0\"\n                  >\n                    <Icon name=\"X\" size={16} className=\"text-purple-600\" />\n                  </button>\n                </div>\n              </div>\n            )}\n\n\n            {/* Tab Content */}\n            <div className=\"transition-all duration-state\">\n              {renderTabContent()}\n            </div>\n\n            {/* Footer Info - Modernis */}\n            <div className=\"mt-12 pt-6 border-t border-gray-200\">\n              <div className=\"bg-gradient-to-r from-blue-50 via-indigo-50 to-purple-50 rounded-2xl p-5 shadow-sm border border-blue-200\">\n                <div className=\"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 text-sm\">\n                  <div className=\"flex flex-wrap items-center gap-4\">\n                    <div className=\"flex items-center space-x-2 bg-white px-3 py-2 rounded-lg shadow-sm\">\n                      <div className=\"w-2 h-2 bg-green-500 rounded-full animate-pulse\" />\n                      <span className=\"font-semibold text-gray-900\">Systme Oprationnel</span>\n                    </div>\n                    <div className=\"text-xs text-gray-600\">\n                      EduTrack CM  {new Date().getFullYear()} - Tous droits rservs\n                    </div>\n                  </div>\n                  <div className=\"flex items-center gap-4\">\n                    <div className=\"flex items-center space-x-2 bg-white px-3 py-2 rounded-lg shadow-sm\">\n                      <Icon name=\"Activity\" size={14} className=\"text-green-500\" />\n                      <span className=\"font-medium text-gray-900\">Temps rel</span>\n                    </div>\n                    <div className=\"flex items-center space-x-2 bg-white px-3 py-2 rounded-lg shadow-sm\">\n                      <Icon name=\"Clock\" size={14} className=\"text-blue-600\" />\n                      <span className=\"font-medium text-gray-900\">{currentTime?.toLocaleTimeString('fr-FR', { hour: '2-digit', minute: '2-digit' })}</span>\n                    </div>\n                  </div>\n                </div>\n              </div>\n            </div>\n            </div>\n          </div>\n        </main>\n      </div>\n    </>\n  );\n};\n\nexport default PrincipalDashboard;"],"file":"assets/index-DSOPo4fZ.js"}