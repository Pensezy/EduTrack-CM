import{u as H,j as e}from"./contexts-fbpOeTmm.js";import{r as _,u as Q}from"./react-vendor-CFDIsUAY.js";import{d as F}from"./documentService-BNZuJcP9.js";import{s as X}from"./services-CdXttHtG.js";import{u as Y}from"./useDashboardData-CL9BpvNP.js";import{I as B,B as W}from"./index-BPV3rumr.js";import"./pdf-vendor-wz8qypYI.js";import"./supabase-CIvuJI4W.js";import"./productionDataService-T6uUAzM-.js";import"./ui-vendor-BrXTGbgA.js";const Z=({onUpload:c,uploading:j,teacherAssignments:l})=>{const{userProfile:w}=H(),[$,h]=_.useState(!1),[d,v]=_.useState({title:"",description:"",class_name:"",subject:"",document_type:"resource",is_public:!1}),[g,x]=_.useState(null),[S,N]=_.useState(""),k=_.useRef(null),T=[{value:"assignment",label:"Devoir"},{value:"lesson",label:"Cours"},{value:"exam",label:"Examen"},{value:"resource",label:"Ressource"},{value:"announcement",label:"Annonce"},{value:"other",label:"Autre"}],m=["application/pdf","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/vnd.ms-powerpoint","application/vnd.openxmlformats-officedocument.presentationml.presentation","image/jpeg","image/png","image/jpg","image/webp"],t=50*1024*1024,a=n=>{n==null||n.preventDefault(),n==null||n.stopPropagation(),(n==null?void 0:n.type)==="dragenter"||(n==null?void 0:n.type)==="dragover"?h(!0):(n==null?void 0:n.type)==="dragleave"&&h(!1)},r=n=>{var L,q,E,G,I;n==null||n.preventDefault(),n==null||n.stopPropagation(),h(!1),(L=n==null?void 0:n.dataTransfer)!=null&&L.files&&((E=(q=n==null?void 0:n.dataTransfer)==null?void 0:q.files)!=null&&E[0])&&b((I=(G=n==null?void 0:n.dataTransfer)==null?void 0:G.files)==null?void 0:I[0])},b=n=>{var L,q;if(n){if(!(m!=null&&m.includes(n==null?void 0:n.type))){N("Type de fichier non autorisÃ©. Formats acceptÃ©s: PDF, Word, PowerPoint, Images.");return}if((n==null?void 0:n.size)>t){N("Le fichier est trop volumineux. Taille maximale: 50MB.");return}if(x(n),N(""),!(d!=null&&d.title)){const E=(q=(L=n==null?void 0:n.name)==null?void 0:L.split("."))==null?void 0:q[0];v(G=>({...G,title:E==null?void 0:E.replace(/_/g," ")}))}}},A=n=>{const{name:L,value:q,type:E,checked:G}=n==null?void 0:n.target;v(I=>({...I,[L]:E==="checkbox"?G:q}))},i=async n=>{var G,I,R;if(n==null||n.preventDefault(),!g){N("Veuillez sÃ©lectionner un fichier.");return}if(!((G=d==null?void 0:d.title)!=null&&G.trim())){N("Le titre est requis.");return}if(!(d!=null&&d.class_name)||!(d!=null&&d.subject)){N("Veuillez sÃ©lectionner une classe et une matiÃ¨re.");return}const L=(w==null?void 0:w.current_school_id)||((R=(I=l==null?void 0:l[0])==null?void 0:I.school)==null?void 0:R.id);if(!L){N("Impossible de dÃ©terminer l'Ã©cole. Contactez l'administrateur.");return}const q={...d,school_id:L},E=await c({documentData:q,file:g});E!=null&&E.success?(v({title:"",description:"",class_name:"",subject:"",document_type:"resource",is_public:!1}),x(null),N("Document tÃ©lÃ©chargÃ© avec succÃ¨s!"),setTimeout(()=>N(""),3e3)):N((E==null?void 0:E.message)||"Erreur lors du tÃ©lÃ©chargement.")},C=()=>{var n;(n=k==null?void 0:k.current)==null||n.click()},f=()=>{x(null),N("")},D=[...new Set((l==null?void 0:l.map(n=>n.class_name))||[])],U=[...new Set((l==null?void 0:l.map(n=>n.subject))||[])];return e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"ðŸ“ TÃ©lÃ©charger un Document"}),e.jsxs("form",{onSubmit:i,className:"space-y-4",children:[e.jsx("div",{className:`border-2 border-dashed rounded-lg p-6 text-center transition-colors ${$?"border-blue-500 bg-blue-50":"border-gray-300 hover:border-gray-400"}`,onDragEnter:a,onDragLeave:a,onDragOver:a,onDrop:r,children:g?e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[e.jsx("span",{className:"text-2xl",children:"ðŸ“„"}),e.jsx("span",{className:"font-medium text-gray-900",children:g==null?void 0:g.name})]}),e.jsxs("p",{className:"text-sm text-gray-600",children:[((g==null?void 0:g.size)/1024/1024).toFixed(2)," MB"]}),e.jsx("button",{type:"button",onClick:f,className:"text-red-600 hover:text-red-700 text-sm font-medium",children:"âŒ Retirer le fichier"})]}):e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"text-4xl text-gray-400",children:"ðŸ“"}),e.jsx("p",{className:"text-lg font-medium text-gray-700",children:"Glissez-dÃ©posez votre fichier ici"}),e.jsx("p",{className:"text-sm text-gray-500",children:"ou"}),e.jsx("button",{type:"button",onClick:C,className:"bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 transition-colors",children:"Parcourir les fichiers"}),e.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Formats acceptÃ©s: PDF, Word, PowerPoint, Images â€¢ Max: 50MB"})]})}),e.jsx("input",{ref:k,type:"file",className:"hidden",onChange:n=>{var L,q;return b((q=(L=n==null?void 0:n.target)==null?void 0:L.files)==null?void 0:q[0])},accept:".pdf,.doc,.docx,.ppt,.pptx,.jpg,.jpeg,.png,.webp"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Titre *"}),e.jsx("input",{type:"text",name:"title",value:d==null?void 0:d.title,onChange:A,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Nom du document",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Type de document"}),e.jsx("select",{name:"document_type",value:d==null?void 0:d.document_type,onChange:A,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:T==null?void 0:T.map(n=>e.jsx("option",{value:n==null?void 0:n.value,children:n==null?void 0:n.label},n==null?void 0:n.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Classe *"}),e.jsxs("select",{name:"class_name",value:d==null?void 0:d.class_name,onChange:A,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0,children:[e.jsx("option",{value:"",children:"SÃ©lectionner une classe"}),D==null?void 0:D.map(n=>e.jsx("option",{value:n,children:n},n))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"MatiÃ¨re *"}),e.jsxs("select",{name:"subject",value:d==null?void 0:d.subject,onChange:A,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0,children:[e.jsx("option",{value:"",children:"SÃ©lectionner une matiÃ¨re"}),U==null?void 0:U.map(n=>e.jsx("option",{value:n,children:n},n))]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),e.jsx("textarea",{name:"description",value:d==null?void 0:d.description,onChange:A,rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Description du document (optionnel)"})]}),e.jsx("div",{className:"flex items-center space-x-4",children:e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",name:"is_public",checked:d==null?void 0:d.is_public,onChange:A,className:"form-checkbox text-blue-600"}),e.jsx("span",{className:"text-sm text-gray-700",children:"Document visible publiquement"})]})}),S&&e.jsx("div",{className:`p-3 rounded-md ${S!=null&&S.includes("succÃ¨s")?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:S}),e.jsx("div",{className:"flex justify-end",children:e.jsx("button",{type:"submit",disabled:j||!g,className:`px-6 py-2 rounded-md font-medium transition-colors ${j||!g?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-blue-600 text-white hover:bg-blue-700"}`,children:j?"â³ TÃ©lÃ©chargement...":"ðŸ“¤ TÃ©lÃ©charger le document"})})]})]})},ee=({documents:c,onDelete:j,onDownload:l,userRole:w,loading:$})=>{const[h,d]=_.useState(null),[v,g]=_.useState(null),x=t=>t!=null&&t.includes("pdf")?"ðŸ“„":t!=null&&t.includes("word")?"ðŸ“":t!=null&&t.includes("powerpoint")||t!=null&&t.includes("presentation")?"ðŸ“Š":t!=null&&t.includes("image")?"ðŸ–¼ï¸":"ðŸ“‹",S=t=>{const a={assignment:"Devoir",lesson:"Cours",exam:"Examen",resource:"Ressource",announcement:"Annonce",other:"Autre"};return(a==null?void 0:a[t])||t},N=t=>{if(!t)return"0 B";const a=["B","KB","MB","GB"],r=Math.floor(Math.log(t)/Math.log(1024));return`${(t/Math.pow(1024,r)).toFixed(2)} ${a==null?void 0:a[r]}`},k=t=>{const a=new Date(t);return a==null?void 0:a.toLocaleDateString("fr-FR",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})},T=async t=>{g(t);try{const a=await l(t);a!=null&&a.success||alert((a==null?void 0:a.message)||"Erreur lors du tÃ©lÃ©chargement")}finally{g(null)}},m=async t=>{g(t);try{const a=await j(t);a!=null&&a.success?d(null):alert((a==null?void 0:a.message)||"Erreur lors de la suppression")}finally{g(null)}};return $?e.jsx("div",{className:"bg-white rounded-lg shadow-md p-6",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[1,2,3,4,5,6].map(t=>e.jsx("div",{className:"animate-pulse",children:e.jsx("div",{className:"h-48 bg-gray-200 rounded-lg"})},t))})}):c!=null&&c.length?e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[e.jsxs("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:["ðŸ“š Documents (",c==null?void 0:c.length,")"]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:c==null?void 0:c.map(t=>{var a,r;return e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"text-2xl",children:x(t==null?void 0:t.mime_type)}),e.jsx("span",{className:"text-xs px-2 py-1 bg-blue-100 text-blue-800 rounded-full",children:S(t==null?void 0:t.document_type)})]}),(t==null?void 0:t.is_public)&&e.jsx("span",{className:"text-xs px-2 py-1 bg-green-100 text-green-800 rounded-full",children:"Public"})]}),e.jsx("h3",{className:"font-medium text-gray-900 mb-2 line-clamp-2",children:t==null?void 0:t.title}),e.jsxs("div",{className:"space-y-1 text-sm text-gray-600 mb-3",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{children:"ðŸ«"}),e.jsx("span",{children:t==null?void 0:t.class_name}),e.jsx("span",{children:"â€¢"}),e.jsx("span",{children:t==null?void 0:t.subject})]}),((a=t==null?void 0:t.uploader)==null?void 0:a.full_name)&&e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{children:"ðŸ‘¨â€ðŸ«"}),e.jsx("span",{children:(r=t==null?void 0:t.uploader)==null?void 0:r.full_name})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{children:"ðŸ“…"}),e.jsx("span",{children:k(t==null?void 0:t.created_at)})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{children:"ðŸ’¾"}),e.jsx("span",{children:N(t==null?void 0:t.file_size)})]})]}),(t==null?void 0:t.description)&&e.jsx("p",{className:"text-sm text-gray-600 mb-3 line-clamp-2",children:t==null?void 0:t.description}),e.jsxs("div",{className:"flex items-center justify-between pt-3 border-t border-gray-100",children:[e.jsx("button",{onClick:()=>T(t==null?void 0:t.id),disabled:v===(t==null?void 0:t.id),className:"flex items-center space-x-2 text-blue-600 hover:text-blue-700 text-sm font-medium disabled:opacity-50",children:v===(t==null?void 0:t.id)?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"animate-spin",children:"â³"}),e.jsx("span",{children:"TÃ©lÃ©chargement..."})]}):e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"ðŸ“¥"}),e.jsx("span",{children:"TÃ©lÃ©charger"})]})}),w==="teacher"&&(t==null?void 0:t.uploaded_by)&&e.jsxs("button",{onClick:()=>d(t==null?void 0:t.id),disabled:v===(t==null?void 0:t.id),className:"flex items-center space-x-2 text-red-600 hover:text-red-700 text-sm font-medium disabled:opacity-50",children:[e.jsx("span",{children:"ðŸ—‘ï¸"}),e.jsx("span",{children:"Supprimer"})]})]})]},t==null?void 0:t.id)})}),h&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-sm w-full mx-4",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Confirmer la suppression"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"ÃŠtes-vous sÃ»r de vouloir supprimer ce document ? Cette action est irrÃ©versible."}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsx("button",{onClick:()=>m(h),disabled:v===h,className:"flex-1 bg-red-600 text-white px-4 py-2 rounded-md hover:bg-red-700 disabled:opacity-50 font-medium",children:v===h?"Suppression...":"Supprimer"}),e.jsx("button",{onClick:()=>d(null),disabled:v===h,className:"flex-1 bg-gray-300 text-gray-700 px-4 py-2 rounded-md hover:bg-gray-400 disabled:opacity-50 font-medium",children:"Annuler"})]})]})})]}):e.jsx("div",{className:"bg-white rounded-lg shadow-md p-6",children:e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"text-6xl text-gray-400 mb-4",children:"ðŸ“‚"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Aucun document trouvÃ©"}),e.jsx("p",{className:"text-gray-600",children:w==="teacher"?"Commencez par tÃ©lÃ©charger votre premier document.":"Aucun document n'est disponible pour le moment."})]})})},se=({assignments:c,onAssignmentsUpdate:j})=>{const{userProfile:l}=H(),[w,$]=_.useState(!1),[h,d]=_.useState({teacher_id:"",school_id:"",class_name:"",subject:""}),[v,g]=_.useState([]),[x,S]=_.useState(!1),[N,k]=_.useState("");_.useEffect(()=>{((l==null?void 0:l.role)==="principal"||(l==null?void 0:l.role)==="secretary")&&T()},[l]);const T=async()=>{g([{id:"1",full_name:"Tchoukoua Rose",email:"ens.math@demo.cm"},{id:"2",full_name:"Mballa Jean",email:"ens.francais@demo.cm"}])},m=i=>{const{name:C,value:f}=i==null?void 0:i.target;d(D=>({...D,[C]:f}))},t=async i=>{var C;i==null||i.preventDefault(),S(!0),k("");try{const f={...h,school_id:l==null?void 0:l.current_school_id},D=await((C=F)==null?void 0:C.assignTeacherToClass(f));D!=null&&D.error?k(D==null?void 0:D.error):(k("Assignation crÃ©Ã©e avec succÃ¨s!"),d({teacher_id:"",school_id:"",class_name:"",subject:""}),$(!1),j==null||j())}catch(f){k("Erreur lors de l'assignation: "+(f==null?void 0:f.message))}S(!1)},a=async i=>{var C;if(confirm("ÃŠtes-vous sÃ»r de vouloir retirer cette assignation ?")){S(!0);try{const f=await((C=F)==null?void 0:C.removeTeacherAssignment(i));f!=null&&f.error?alert("Erreur: "+(f==null?void 0:f.error)):(k("Assignation retirÃ©e avec succÃ¨s!"),j==null||j())}catch(f){alert("Erreur lors de la suppression: "+(f==null?void 0:f.message))}S(!1)}},r=i=>{const C=new Date(i);return C==null?void 0:C.toLocaleDateString("fr-FR",{year:"numeric",month:"long",day:"numeric"})},b=["6Ã¨me A","6Ã¨me B","6Ã¨me C","5Ã¨me A","5Ã¨me B","5Ã¨me C","4Ã¨me A","4Ã¨me B","4Ã¨me C","3Ã¨me A","3Ã¨me B","3Ã¨me C","Seconde A","Seconde B","Seconde C","PremiÃ¨re A","PremiÃ¨re B","PremiÃ¨re C","Terminale A","Terminale B","Terminale C"],A=["MathÃ©matiques","FranÃ§ais","Anglais","Histoire-GÃ©ographie","Sciences Physiques","SVT","Philosophie","Ã‰conomie","Informatique","Arts Plastiques","Musique","EPS"];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h2",{className:"text-xl font-semibold text-gray-900",children:["ðŸ“‹ ",(l==null?void 0:l.role)==="teacher"?"Mes Assignations":"Gestion des Assignations"]}),((l==null?void 0:l.role)==="principal"||(l==null?void 0:l.role)==="secretary")&&e.jsx("button",{onClick:()=>$(!0),className:"bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 transition-colors",children:"âž• Nouvelle Assignation"})]}),N&&e.jsx("div",{className:`p-3 rounded-md mb-4 ${N!=null&&N.includes("succÃ¨s")?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:N})]}),w&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Nouvelle Assignation"}),e.jsxs("form",{onSubmit:t,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Professeur"}),e.jsxs("select",{name:"teacher_id",value:h==null?void 0:h.teacher_id,onChange:m,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:"SÃ©lectionner un professeur"}),v==null?void 0:v.map(i=>e.jsxs("option",{value:i==null?void 0:i.id,children:[i==null?void 0:i.full_name," (",i==null?void 0:i.email,")"]},i==null?void 0:i.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Classe"}),e.jsxs("select",{name:"class_name",value:h==null?void 0:h.class_name,onChange:m,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:"SÃ©lectionner une classe"}),b==null?void 0:b.map(i=>e.jsx("option",{value:i,children:i},i))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"MatiÃ¨re"}),e.jsxs("select",{name:"subject",value:h==null?void 0:h.subject,onChange:m,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:"SÃ©lectionner une matiÃ¨re"}),A==null?void 0:A.map(i=>e.jsx("option",{value:i,children:i},i))]})]}),e.jsxs("div",{className:"flex space-x-3 pt-4",children:[e.jsx("button",{type:"submit",disabled:x,className:"flex-1 bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 disabled:opacity-50",children:x?"CrÃ©ation...":"CrÃ©er l'assignation"}),e.jsx("button",{type:"button",onClick:()=>$(!1),disabled:x,className:"flex-1 bg-gray-300 text-gray-700 px-4 py-2 rounded-md hover:bg-gray-400 disabled:opacity-50",children:"Annuler"})]})]})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow-md p-6",children:c!=null&&c.length?e.jsx("div",{className:"space-y-4",children:c==null?void 0:c.map(i=>{var C,f,D,U;return e.jsx("div",{className:"border border-gray-200 rounded-lg p-4 hover:shadow-sm transition-shadow",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[e.jsxs("span",{className:"text-lg font-medium text-gray-900",children:["ðŸ“š ",i==null?void 0:i.class_name]}),e.jsx("span",{className:"text-sm px-2 py-1 bg-blue-100 text-blue-800 rounded-full",children:i==null?void 0:i.subject})]}),e.jsxs("div",{className:"text-sm text-gray-600 space-y-1",children:[((C=i==null?void 0:i.school)==null?void 0:C.name)&&e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{children:"ðŸ«"}),e.jsx("span",{children:(f=i==null?void 0:i.school)==null?void 0:f.name})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{children:"ðŸ“…"}),e.jsxs("span",{children:["AssignÃ© le ",r(i==null?void 0:i.assigned_at)]})]}),((D=i==null?void 0:i.assigned_by_user)==null?void 0:D.full_name)&&e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{children:"ðŸ‘¤"}),e.jsxs("span",{children:["Par ",(U=i==null?void 0:i.assigned_by_user)==null?void 0:U.full_name]})]})]})]}),((l==null?void 0:l.role)==="principal"||(l==null?void 0:l.role)==="secretary")&&e.jsx("button",{onClick:()=>a(i==null?void 0:i.id),disabled:x,className:"text-red-600 hover:text-red-700 p-2 rounded-md hover:bg-red-50 transition-colors disabled:opacity-50",title:"Retirer l'assignation",children:e.jsx("span",{children:"ðŸ—‘ï¸"})})]})},i==null?void 0:i.id)})}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"text-4xl text-gray-400 mb-4",children:"ðŸ“‹"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Aucune assignation"}),e.jsx("p",{className:"text-gray-600",children:(l==null?void 0:l.role)==="teacher"?"Vous n'avez aucune classe assignÃ©e pour le moment.":"Commencez par assigner des professeurs aux classes."})]})})]})},te=({filters:c,onFiltersChange:j,userRole:l})=>{var k,T,m,t;const[w,$]=_.useState({classes:[],subjects:[]}),[h,d]=_.useState(!1);_.useEffect(()=>{v()},[]);const v=async()=>{var a;try{const r=await((a=F)==null?void 0:a.getClassesAndSubjects());r!=null&&r.data&&$(r==null?void 0:r.data)}catch(r){console.error("Erreur chargement options:",r)}},g=[{value:"",label:"Tous les types"},{value:"assignment",label:"Devoirs"},{value:"lesson",label:"Cours"},{value:"exam",label:"Examens"},{value:"resource",label:"Ressources"},{value:"announcement",label:"Annonces"},{value:"other",label:"Autres"}],x=(a,r)=>{const b={...c,[a]:r};j(b)},S=()=>{j({class_name:"",subject:"",document_type:"",search:""})},N=(k=Object.values(c))==null?void 0:k.some(a=>a!=="");return e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"ðŸ” Filtres et Recherche"}),e.jsxs("div",{className:"flex items-center space-x-3",children:[N&&e.jsx("button",{onClick:S,className:"text-sm text-red-600 hover:text-red-700 font-medium",children:"Effacer les filtres"}),e.jsxs("button",{onClick:()=>d(!h),className:"text-sm text-blue-600 hover:text-blue-700 font-medium md:hidden",children:[h?"Masquer":"Afficher"," les filtres"]})]})]}),e.jsx("div",{className:"mb-4",children:e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx("span",{className:"text-gray-400",children:"ðŸ”"})}),e.jsx("input",{type:"text",placeholder:"Rechercher par titre, description, classe ou matiÃ¨re...",value:c==null?void 0:c.search,onChange:a=>{var r;return x("search",(r=a==null?void 0:a.target)==null?void 0:r.value)},className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"}),(c==null?void 0:c.search)&&e.jsx("button",{onClick:()=>x("search",""),className:"absolute inset-y-0 right-0 pr-3 flex items-center",children:e.jsx("span",{className:"text-gray-400 hover:text-gray-600",children:"âŒ"})})]})}),e.jsxs("div",{className:`grid grid-cols-1 md:grid-cols-4 gap-4 ${h?"block":"hidden md:grid"}`,children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Classe"}),e.jsxs("select",{value:c==null?void 0:c.class_name,onChange:a=>{var r;return x("class_name",(r=a==null?void 0:a.target)==null?void 0:r.value)},className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm",children:[e.jsx("option",{value:"",children:"Toutes les classes"}),(T=w==null?void 0:w.classes)==null?void 0:T.map(a=>e.jsx("option",{value:a,children:a},a))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"MatiÃ¨re"}),e.jsxs("select",{value:c==null?void 0:c.subject,onChange:a=>{var r;return x("subject",(r=a==null?void 0:a.target)==null?void 0:r.value)},className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm",children:[e.jsx("option",{value:"",children:"Toutes les matiÃ¨res"}),(m=w==null?void 0:w.subjects)==null?void 0:m.map(a=>e.jsx("option",{value:a,children:a},a))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Type de document"}),e.jsx("select",{value:c==null?void 0:c.document_type,onChange:a=>{var r;return x("document_type",(r=a==null?void 0:a.target)==null?void 0:r.value)},className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm",children:g==null?void 0:g.map(a=>e.jsx("option",{value:a==null?void 0:a.value,children:a==null?void 0:a.label},a==null?void 0:a.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Actions rapides"}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{onClick:()=>x("document_type","assignment"),className:`px-3 py-2 rounded-md text-sm font-medium transition-colors ${(c==null?void 0:c.document_type)==="assignment"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"ðŸ“‹ Devoirs"}),e.jsx("button",{onClick:()=>x("document_type","lesson"),className:`px-3 py-2 rounded-md text-sm font-medium transition-colors ${(c==null?void 0:c.document_type)==="lesson"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"ðŸ“š Cours"})]})]})]}),N&&e.jsx("div",{className:"mt-4 pt-4 border-t border-gray-200",children:e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("span",{className:"text-sm text-gray-600 font-medium",children:"Filtres actifs:"}),(c==null?void 0:c.search)&&e.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:['ðŸ” "',c==null?void 0:c.search,'"',e.jsx("button",{onClick:()=>x("search",""),className:"ml-1 text-blue-600 hover:text-blue-800",children:"âŒ"})]}),(c==null?void 0:c.class_name)&&e.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800",children:["ðŸ« ",c==null?void 0:c.class_name,e.jsx("button",{onClick:()=>x("class_name",""),className:"ml-1 text-green-600 hover:text-green-800",children:"âŒ"})]}),(c==null?void 0:c.subject)&&e.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-purple-100 text-purple-800",children:["ðŸ“– ",c==null?void 0:c.subject,e.jsx("button",{onClick:()=>x("subject",""),className:"ml-1 text-purple-600 hover:text-purple-800",children:"âŒ"})]}),(c==null?void 0:c.document_type)&&e.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800",children:["ðŸ“„ ",(t=g==null?void 0:g.find(a=>(a==null?void 0:a.value)===(c==null?void 0:c.document_type)))==null?void 0:t.label,e.jsx("button",{onClick:()=>x("document_type",""),className:"ml-1 text-yellow-600 hover:text-yellow-800",children:"âŒ"})]})]})})]})},ae=({stats:c,documents:j})=>{var S,N,k,T,m,t,a;if(!c)return e.jsx("div",{className:"bg-white rounded-lg shadow-md p-6",children:e.jsxs("div",{className:"animate-pulse",children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded mb-4"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[1,2,3].map(r=>e.jsx("div",{className:"h-24 bg-gray-200 rounded"},r))})]})});const l=r=>{const b={assignment:"ðŸ“‹",lesson:"ðŸ“š",exam:"ðŸ“",resource:"ðŸ“„",announcement:"ðŸ“¢",other:"ðŸ“"};return(b==null?void 0:b[r])||"ðŸ“„"},w=r=>{const b={assignment:"Devoirs",lesson:"Cours",exam:"Examens",resource:"Ressources",announcement:"Annonces",other:"Autres"};return(b==null?void 0:b[r])||r},$=(j==null?void 0:j.reduce((r,b)=>r+((b==null?void 0:b.file_size)||0),0))||0,h=r=>{if(r===0)return"0 B";const b=1024,A=["B","KB","MB","GB"],i=Math.floor(Math.log(r)/Math.log(b));return parseFloat((r/Math.pow(b,i)).toFixed(2))+" "+(A==null?void 0:A[i])},d={},v={};j==null||j.forEach(r=>{d[r.class_name]=((d==null?void 0:d[r==null?void 0:r.class_name])||0)+1,v[r.subject]=((v==null?void 0:v[r==null?void 0:r.subject])||0)+1});const g=(N=(S=Object.entries(d))==null?void 0:S.sort(([,r],[,b])=>b-r))==null?void 0:N.slice(0,5),x=(T=(k=Object.entries(v))==null?void 0:k.sort(([,r],[,b])=>b-r))==null?void 0:T.slice(0,5);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx("div",{className:"bg-white rounded-lg shadow-md p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Documents"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:c==null?void 0:c.total})]}),e.jsx("div",{className:"text-3xl text-blue-500",children:"ðŸ“š"})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow-md p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Ce mois"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:c==null?void 0:c.thisMonth})]}),e.jsx("div",{className:"text-3xl text-green-500",children:"ðŸ“…"})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow-md p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Taille totale"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:h($)})]}),e.jsx("div",{className:"text-3xl text-purple-500",children:"ðŸ’¾"})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow-md p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Classes"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:(m=Object.keys(d))==null?void 0:m.length})]}),e.jsx("div",{className:"text-3xl text-orange-500",children:"ðŸ«"})]})})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"ðŸ“Š RÃ©partition par type de document"}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4",children:(t=Object.entries((c==null?void 0:c.byType)||{}))==null?void 0:t.map(([r,b])=>e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-3xl mb-2",children:l(r)}),e.jsx("div",{className:"text-xl font-bold text-gray-900",children:b}),e.jsx("div",{className:"text-sm text-gray-600",children:w(r)})]},r))})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"ðŸ« Documents par classe"}),(g==null?void 0:g.length)>0?e.jsx("div",{className:"space-y-3",children:g==null?void 0:g.map(([r,b])=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-700",children:r}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"bg-blue-200 rounded-full h-2 flex-1 min-w-[60px]",children:e.jsx("div",{className:"bg-blue-600 h-2 rounded-full",style:{width:`${b/Math.max(...g==null?void 0:g.map(([,A])=>A))*100}%`}})}),e.jsx("span",{className:"text-sm font-medium text-gray-900 w-8 text-right",children:b})]})]},r))}):e.jsx("p",{className:"text-gray-500 text-center py-4",children:"Aucune donnÃ©e disponible"})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"ðŸ“– Documents par matiÃ¨re"}),(x==null?void 0:x.length)>0?e.jsx("div",{className:"space-y-3",children:x==null?void 0:x.map(([r,b])=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-700",children:r}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"bg-green-200 rounded-full h-2 flex-1 min-w-[60px]",children:e.jsx("div",{className:"bg-green-600 h-2 rounded-full",style:{width:`${b/Math.max(...x==null?void 0:x.map(([,A])=>A))*100}%`}})}),e.jsx("span",{className:"text-sm font-medium text-gray-900 w-8 text-right",children:b})]})]},r))}):e.jsx("p",{className:"text-gray-500 text-center py-4",children:"Aucune donnÃ©e disponible"})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"â° ActivitÃ© rÃ©cente"}),(j==null?void 0:j.length)>0?e.jsx("div",{className:"space-y-3",children:(a=j==null?void 0:j.slice(0,5))==null?void 0:a.map(r=>{var b;return e.jsxs("div",{className:"flex items-center space-x-3 py-2 border-b border-gray-100 last:border-b-0",children:[e.jsx("span",{className:"text-2xl",children:l(r==null?void 0:r.document_type)}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",children:r==null?void 0:r.title}),e.jsxs("p",{className:"text-sm text-gray-500",children:[r==null?void 0:r.class_name," â€¢ ",r==null?void 0:r.subject]})]}),e.jsx("div",{className:"text-sm text-gray-400",children:(b=new Date(r.created_at))==null?void 0:b.toLocaleDateString("fr-FR")})]},r==null?void 0:r.id)})}):e.jsx("p",{className:"text-gray-500 text-center py-4",children:"Aucun document rÃ©cent"})]})]})},re=({userRole:c,isPrincipalMode:j=!1,selectedAccount:l=null})=>{var g;const[w,$]=_.useState(!1),d=(x=>{if(j&&x==="principal")return{icon:"ðŸ‘¨â€ðŸ’¼",title:"Principal - Mode Supervision",permissions:["âœ… Voir tous les comptes personnel avec accÃ¨s documents","âœ… Consulter les documents de chaque compte individuellement","âœ… Analyser les statistiques d'utilisation par compte","âœ… ContrÃ´ler les accÃ¨s et permissions","âœ… Superviser l'activitÃ© documentaire du personnel","âœ… TraÃ§abilitÃ© complÃ¨te des actions utilisateurs","âŒ Modifier ou supprimer les documents d'autrui"],description:"Mode supervision permettant le contrÃ´le centralisÃ© des documents par compte personnel."};switch(x){case"secretary":return{icon:"ðŸ‘©â€ðŸ’¼",title:"SecrÃ©taire",permissions:["âœ… CrÃ©er des comptes professeurs","âœ… Assigner des professeurs aux classes","âœ… Voir tous les documents de l'Ã©cole","âœ… GÃ©rer les assignations de classes","âŒ TÃ©lÃ©charger des documents (rÃ©servÃ© aux professeurs)","âŒ Modifier les documents existants"],description:"Les secrÃ©taires gÃ¨rent les comptes et assignations aprÃ¨s validation du MinistÃ¨re."};case"principal":return{icon:"ðŸ‘¨â€ðŸ’¼",title:"Principal - Mode Standard",permissions:["âœ… Assigner des professeurs aux classes et matiÃ¨res","âœ… Voir tous les documents de l'Ã©cole","âœ… Approuver les transferts d'Ã©lÃ¨ves","âœ… GÃ©rer toutes les assignations","âœ… AccÃ©der aux statistiques globales","âŒ TÃ©lÃ©charger des documents directement"],description:"Les principaux supervisent les assignations et valident les processus administratifs."};case"teacher":return{icon:"ðŸ‘©â€ðŸ«",title:"Professeur",permissions:["âœ… TÃ©lÃ©charger des documents pour ses classes assignÃ©es","âœ… Voir ses assignations de classes/matiÃ¨res","âœ… Supprimer ses propres documents","âœ… Organiser les documents par classe et matiÃ¨re","âœ… Suivre les statistiques de ses documents","âŒ Voir les documents des autres professeurs"],description:"Les professeurs ne peuvent gÃ©rer que les documents de leurs classes assignÃ©es."};case"student":return{icon:"ðŸŽ“",title:"Ã‰tudiant",permissions:["âœ… Voir les documents de ses classes actuelles","âœ… TÃ©lÃ©charger les documents autorisÃ©s","âœ… AccÃ©der aux cours et devoirs de ses matiÃ¨res","âŒ TÃ©lÃ©charger des documents","âŒ Voir les documents d'autres classes","âŒ Modifier ou supprimer des documents"],description:"Les Ã©tudiants ont un accÃ¨s lecture seule aux documents de leurs classes."};case"parent":return{icon:"ðŸ‘¨â€ðŸ‘©â€ðŸ‘§â€ðŸ‘¦",title:"Parent",permissions:["âœ… Voir les documents des classes de ses enfants","âœ… TÃ©lÃ©charger certains documents (devoirs corrigÃ©s, bulletins)","âœ… AccÃ©der aux annonces importantes","âŒ Voir tous les cours et ressources","âŒ TÃ©lÃ©charger des documents","âŒ AccÃ©der aux documents d'autres Ã©lÃ¨ves"],description:"Les parents ont un accÃ¨s limitÃ© aux documents concernant directement leurs enfants."};default:return{icon:"ðŸ‘¤",title:"Utilisateur",permissions:["âŒ AccÃ¨s restreint selon le rÃ´le","âŒ Contactez l'administrateur pour plus d'informations"],description:"RÃ´le non reconnu ou permissions non dÃ©finies."}}})(c),v=[{icon:"ðŸ”’",title:"Stockage PrivÃ©",description:"Tous les documents sont stockÃ©s dans un bucket privÃ© sÃ©curisÃ©"},{icon:"ðŸ‘¥",title:"ContrÃ´le d'AccÃ¨s BasÃ© sur les RÃ´les",description:"Chaque utilisateur ne voit que les documents autorisÃ©s selon son rÃ´le"},{icon:"ðŸ“‹",title:"Assignations Officielles",description:"Les professeurs sont assignÃ©s officiellement par le MinistÃ¨re"},{icon:"ðŸ«",title:"Isolation par Ã‰cole",description:"Les documents sont isolÃ©s par Ã©tablissement scolaire"},{icon:"ðŸ“",title:"TraÃ§abilitÃ©",description:"Tous les accÃ¨s aux documents sont enregistrÃ©s et traÃ§ables"},{icon:"ðŸ”",title:"URLs SignÃ©es",description:"Les tÃ©lÃ©chargements utilisent des URLs temporaires sÃ©curisÃ©es"}];return e.jsxs("div",{className:"mt-8 bg-gradient-to-r from-blue-50 to-indigo-50 border border-blue-200 rounded-lg p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h3",{className:"text-lg font-medium text-gray-900 flex items-center space-x-2",children:[e.jsx("span",{children:"ðŸ›¡ï¸"}),e.jsx("span",{children:"SÃ©curitÃ© et ContrÃ´le d'AccÃ¨s"})]}),e.jsxs("button",{onClick:()=>$(!w),className:"text-blue-600 hover:text-blue-700 text-sm font-medium",children:[w?"Masquer":"Afficher"," les dÃ©tails"]})]}),e.jsxs("div",{className:"bg-white rounded-lg p-4 mb-4 border border-blue-100",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[e.jsx("span",{className:"text-2xl",children:d==null?void 0:d.icon}),e.jsxs("div",{children:[e.jsxs("h4",{className:"font-medium text-gray-900",children:["Votre rÃ´le: ",d==null?void 0:d.title]}),e.jsx("p",{className:"text-sm text-gray-600",children:d==null?void 0:d.description})]})]}),j&&l&&e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3 mb-3",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("span",{className:"text-lg",children:l.role==="teacher"?"ðŸ‘©â€ðŸ«":"ðŸ‘©â€ðŸ’¼"}),e.jsxs("div",{children:[e.jsxs("h5",{className:"font-medium text-blue-900",children:["Supervision de: ",l.full_name]}),e.jsxs("p",{className:"text-sm text-blue-700",children:[l.role==="teacher"?`Enseignant en ${l.subject}`:"SecrÃ©taire",l.classes&&l.classes.length>0&&` - Classes: ${l.classes.join(", ")}`]})]})]})}),w&&e.jsxs("div",{className:"border-t border-gray-100 pt-3",children:[e.jsx("h5",{className:"font-medium text-gray-900 mb-2",children:j?"Permissions de supervision:":"Vos permissions:"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:(g=d==null?void 0:d.permissions)==null?void 0:g.map((x,S)=>e.jsxs("div",{className:"text-sm flex items-start space-x-2",children:[e.jsx("span",{className:"mt-0.5",children:x!=null&&x.startsWith("âœ…")?"âœ…":"âŒ"}),e.jsx("span",{className:x!=null&&x.startsWith("âœ…")?"text-green-700":"text-red-700",children:x==null?void 0:x.substring(2)})]},S))})]})]}),w&&e.jsxs("div",{className:"bg-white rounded-lg p-4 border border-blue-100",children:[e.jsx("h5",{className:"font-medium text-gray-900 mb-3",children:"FonctionnalitÃ©s de SÃ©curitÃ©:"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:v==null?void 0:v.map((x,S)=>e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("span",{className:"text-xl mt-0.5",children:x==null?void 0:x.icon}),e.jsxs("div",{children:[e.jsx("h6",{className:"text-sm font-medium text-gray-900",children:x==null?void 0:x.title}),e.jsx("p",{className:"text-xs text-gray-600",children:x==null?void 0:x.description})]})]},S))}),e.jsxs("div",{className:"mt-6 pt-6 border-t border-gray-100",children:[e.jsx("h5",{className:"font-medium text-gray-900 mb-3",children:"Processus d'Assignation:"}),e.jsxs("div",{className:"flex flex-col md:flex-row items-start md:items-center space-y-2 md:space-y-0 md:space-x-4 text-sm",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"w-6 h-6 bg-blue-100 text-blue-800 rounded-full flex items-center justify-center text-xs font-medium",children:"1"}),e.jsx("span",{children:"MinistÃ¨re assigne le professeur"})]}),e.jsx("span",{className:"hidden md:block",children:"â†’"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"w-6 h-6 bg-blue-100 text-blue-800 rounded-full flex items-center justify-center text-xs font-medium",children:"2"}),e.jsx("span",{children:"SecrÃ©taire crÃ©e le compte"})]}),e.jsx("span",{className:"hidden md:block",children:"â†’"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"w-6 h-6 bg-blue-100 text-blue-800 rounded-full flex items-center justify-center text-xs font-medium",children:"3"}),e.jsx("span",{children:"Principal assigne aux classes"})]}),e.jsx("span",{className:"hidden md:block",children:"â†’"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"w-6 h-6 bg-blue-100 text-blue-800 rounded-full flex items-center justify-center text-xs font-medium",children:"4"}),e.jsx("span",{children:"Professeur gÃ¨re ses documents"})]})]})]})]})]})},ge=()=>{var R;const c=Q(),{user:j,userProfile:l}=H(),{data:w}=Y(),h=new URLSearchParams(c.search).get("mode")==="principal"||(l==null?void 0:l.role)==="principal",[d,v]=_.useState([]),[g,x]=_.useState([]),[S,N]=_.useState(!0),[k,T]=_.useState(!1),[m,t]=_.useState(null),[a,r]=_.useState({class_name:"",subject:"",document_type:"",search:"",account_id:""}),[b,A]=_.useState(null),[i,C]=_.useState(h?"overview":"documents");_.useEffect(()=>{D(),U()},[j]);const f=()=>{var p,M;const s=((p=w==null?void 0:w.personnel)==null?void 0:p.filter(y=>y.type==="teacher"))||[],u=((M=w==null?void 0:w.personnel)==null?void 0:M.filter(y=>y.type==="secretary"))||[];return[...s,...u].map(y=>({id:y.id,full_name:y.name,email:y.email,role:y.type,subject:y.subject,classes:y.classes||[],status:y.status,document_count:0,last_upload:null,created_at:y.created_at}))},D=async()=>{var s,u,p,M,y,O;if(j){N(!0);try{if(h){const o=await((s=F)==null?void 0:s.getAllSchoolDocuments());o!=null&&o.error?console.error("Erreur chargement documents Ã©cole:",o==null?void 0:o.error):v((o==null?void 0:o.data)||[])}else if((l==null?void 0:l.role)==="teacher"){const[o,z,V]=await Promise.all([(u=F)==null?void 0:u.getTeacherDocuments(),(p=F)==null?void 0:p.getTeacherAssignments(),(M=F)==null?void 0:M.getDocumentStats()]);o!=null&&o.error?console.error("Erreur chargement documents:",o==null?void 0:o.error):v((o==null?void 0:o.data)||[]),z!=null&&z.error?console.error("Erreur chargement assignations:",z==null?void 0:z.error):x((z==null?void 0:z.data)||[]),V!=null&&V.error?console.error("Erreur chargement statistiques:",V==null?void 0:V.error):A(V==null?void 0:V.data)}else if((l==null?void 0:l.role)==="student"){const o=await((y=F)==null?void 0:y.getStudentDocuments());o!=null&&o.error?console.error("Erreur chargement documents Ã©tudiant:",o==null?void 0:o.error):v((o==null?void 0:o.data)||[])}else{const o=await((O=F)==null?void 0:O.getDocuments(a));o!=null&&o.error?console.error("Erreur chargement documents:",o==null?void 0:o.error):v((o==null?void 0:o.data)||[])}}catch(o){console.error("Erreur chargement donnÃ©es:",o)}N(!1)}},U=()=>{var u,p,M;const s=(M=(p=(u=X)==null?void 0:u.channel("documents_changes"))==null?void 0:p.on("postgres_changes",{event:"*",schema:"public",table:"documents"},y=>{console.log("Document change:",y),D()}))==null?void 0:M.subscribe();return()=>{var y;(y=X)==null||y.removeChannel(s)}},n=async s=>{var u;T(!0);try{const p=await((u=F)==null?void 0:u.uploadDocument(s==null?void 0:s.documentData,s==null?void 0:s.file));if(p!=null&&p.error)throw new Error(p.error);return await D(),{success:!0,message:"Document uploaded successfully!"}}catch(p){return console.error("Erreur upload:",p),{success:!1,message:p==null?void 0:p.message}}finally{T(!1)}},L=async s=>{var u;try{const p=await((u=F)==null?void 0:u.deleteDocument(s));if(p!=null&&p.error)throw new Error(p.error);return v(M=>M==null?void 0:M.filter(y=>(y==null?void 0:y.id)!==s)),{success:!0,message:"Document supprimÃ© avec succÃ¨s!"}}catch(p){return console.error("Erreur suppression:",p),{success:!1,message:p==null?void 0:p.message}}},q=async s=>{var u,p,M,y,O;try{const o=await((u=F)==null?void 0:u.downloadDocument(s,"download"));if(o!=null&&o.error)throw new Error(o.error);const z=document.createElement("a");return z.href=(p=o==null?void 0:o.data)==null?void 0:p.url,z.download=(M=o==null?void 0:o.data)==null?void 0:M.fileName,(y=document.body)==null||y.appendChild(z),z==null||z.click(),(O=document.body)==null||O.removeChild(z),{success:!0,message:"TÃ©lÃ©chargement initialisÃ©!"}}catch(o){return console.error("Erreur tÃ©lÃ©chargement:",o),{success:!1,message:o==null?void 0:o.message}}},E=s=>{t(s),r(u=>({...u,account_id:s.id})),D()},G=async s=>{var p;r(s),N(!0);const u=await((p=F)==null?void 0:p.getDocuments(s));u!=null&&u.error?console.error("Erreur filtrage:",u==null?void 0:u.error):v((u==null?void 0:u.data)||[]),N(!1)},I=(d==null?void 0:d.filter(s=>{var u,p,M,y,O,o,z,V,J,K;if(a.class_name&&s.class_name!==a.class_name||a.subject&&s.subject!==a.subject||a.document_type&&s.document_type!==a.document_type||m&&s.uploader_id!==m.id)return!1;if(a.search){const P=a.search.toLowerCase();if(!(((p=(u=s==null?void 0:s.title)==null?void 0:u.toLowerCase())==null?void 0:p.includes(P))||((y=(M=s==null?void 0:s.description)==null?void 0:M.toLowerCase())==null?void 0:y.includes(P))||((o=(O=s==null?void 0:s.class_name)==null?void 0:O.toLowerCase())==null?void 0:o.includes(P))||((V=(z=s==null?void 0:s.subject)==null?void 0:z.toLowerCase())==null?void 0:V.includes(P))||((K=(J=s==null?void 0:s.uploaded_by)==null?void 0:J.toLowerCase())==null?void 0:K.includes(P))))return!1}return!0}))||[];return S&&(d==null?void 0:d.length)===0?e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),e.jsx("p",{className:"mt-4 text-gray-600",children:"Chargement des documents..."})]})}):e.jsx("div",{className:"min-h-screen bg-gray-50",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:h?"Supervision des Documents Personnel":"Centre de Gestion des Documents"}),e.jsx("p",{className:"text-gray-600",children:h?"ContrÃ´lez et supervisez les documents par compte personnel":(l==null?void 0:l.role)==="teacher"?"GÃ©rez et partagez vos documents pÃ©dagogiques":(l==null?void 0:l.role)==="student"?"AccÃ©dez aux documents de vos cours":"Consultez les documents partagÃ©s"})]})}),h&&m&&e.jsx("div",{className:"mt-4 bg-blue-50 border border-blue-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center",children:e.jsx(B,{name:m.role==="teacher"?"GraduationCap":"UserCheck",size:20,className:"text-blue-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-blue-900",children:m.full_name}),e.jsx("p",{className:"text-sm text-blue-700",children:m.role==="teacher"?`${m.subject} - ${(R=m.classes)==null?void 0:R.join(", ")}`:"SecrÃ©taire"})]})]}),e.jsxs("div",{className:"flex items-center space-x-4 text-sm text-blue-700",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"font-semibold",children:m.document_count||0}),e.jsx("div",{children:"Documents"})]}),e.jsx(W,{variant:"ghost",size:"sm",onClick:()=>t(null),className:"text-blue-600 hover:text-blue-800",children:e.jsx(B,{name:"X",size:16})})]})]})})]}),e.jsx("div",{className:"mb-6",children:e.jsx("div",{className:"border-b border-gray-200",children:e.jsxs("nav",{className:"-mb-px flex space-x-8",children:[h&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>C("overview"),className:`py-2 px-1 border-b-2 font-medium text-sm ${i==="overview"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"ï¿½ Vue d'Ensemble"}),e.jsx("button",{onClick:()=>C("documents"),className:`py-2 px-1 border-b-2 font-medium text-sm ${i==="documents"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"ðŸ“„ Tous les Documents"}),e.jsx("button",{onClick:()=>C("accounts"),className:`py-2 px-1 border-b-2 font-medium text-sm ${i==="accounts"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"ðŸ‘¥ Par Personnel"})]}),!h&&e.jsx("button",{onClick:()=>C("documents"),className:`py-2 px-1 border-b-2 font-medium text-sm ${i==="documents"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"ðŸ“„ Documents"}),(l==null?void 0:l.role)==="teacher"&&!h&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>C("assignments"),className:`py-2 px-1 border-b-2 font-medium text-sm ${i==="assignments"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"ðŸ“‹ Mes Classes"}),e.jsx("button",{onClick:()=>C("stats"),className:`py-2 px-1 border-b-2 font-medium text-sm ${i==="stats"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"ðŸ“Š Statistiques"})]}),h&&m&&e.jsx("button",{onClick:()=>C("account-stats"),className:`py-2 px-1 border-b-2 font-medium text-sm ${i==="account-stats"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"ðŸ“Š Statistiques du Compte"})]})})}),e.jsxs("div",{className:"space-y-6",children:[i==="overview"&&h&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[e.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center",children:e.jsx(B,{name:"FileText",size:24,className:"text-blue-600"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-gray-900",children:d.length}),e.jsx("div",{className:"text-sm text-gray-500",children:"Documents Total"})]})]})}),e.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center",children:e.jsx(B,{name:"Users",size:24,className:"text-green-600"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-gray-900",children:f().length}),e.jsx("div",{className:"text-sm text-gray-500",children:"Personnel Actif"})]})]})}),e.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-12 h-12 bg-purple-100 rounded-lg flex items-center justify-center",children:e.jsx(B,{name:"BookOpen",size:24,className:"text-purple-600"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-gray-900",children:[...new Set(d.map(s=>s.class_name))].length}),e.jsx("div",{className:"text-sm text-gray-500",children:"Classes ConcernÃ©es"})]})]})}),e.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-12 h-12 bg-orange-100 rounded-lg flex items-center justify-center",children:e.jsx(B,{name:"Download",size:24,className:"text-orange-600"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-gray-900",children:d.reduce((s,u)=>s+(u.download_count||0),0)}),e.jsx("div",{className:"text-sm text-gray-500",children:"TÃ©lÃ©chargements"})]})]})})]}),e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"ðŸ“ˆ ActivitÃ© RÃ©cente"}),e.jsx("div",{className:"space-y-3",children:d.sort((s,u)=>new Date(u.created_at)-new Date(s.created_at)).slice(0,5).map(s=>e.jsxs("div",{className:"flex items-center justify-between p-3 border border-gray-100 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-50 rounded-lg flex items-center justify-center",children:e.jsx(B,{name:"FileText",size:20,className:"text-blue-600"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900",children:s.title}),e.jsxs("p",{className:"text-sm text-gray-500",children:[s.class_name," â€¢ ",s.subject," â€¢ par ",s.uploaded_by]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-sm text-gray-900",children:[s.download_count||0," tÃ©lÃ©chargements"]}),e.jsx("div",{className:"text-xs text-gray-500",children:new Date(s.created_at).toLocaleDateString("fr-FR")})]})]},s.id))})]}),e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"ðŸ“š RÃ©partition par Classe"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[...new Set(d.map(s=>s.class_name))].filter(s=>s&&s!=="Toutes").map(s=>{const u=d.filter(p=>p.class_name===s);return e.jsxs("div",{className:"p-4 border border-gray-200 rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h4",{className:"font-medium text-gray-900",children:s}),e.jsx("span",{className:"text-sm bg-blue-100 text-blue-800 px-2 py-1 rounded-full",children:u.length})]}),e.jsx("div",{className:"text-sm text-gray-500",children:[...new Set(u.map(p=>p.subject))].join(", ")})]},s)})})]})]}),i==="accounts"&&h&&e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Personnel avec AccÃ¨s aux Documents"}),e.jsxs("div",{className:"text-sm text-gray-500",children:[f().length," comptes actifs"]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:f().map(s=>e.jsxs("div",{onClick:()=>E(s),className:`p-4 border rounded-lg cursor-pointer transition-all hover:shadow-md ${(m==null?void 0:m.id)===s.id?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"}`,children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[e.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center ${s.role==="teacher"?"bg-green-100":"bg-purple-100"}`,children:e.jsx(B,{name:s.role==="teacher"?"GraduationCap":"UserCheck",size:20,className:s.role==="teacher"?"text-green-600":"text-purple-600"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h4",{className:"font-medium text-gray-900 truncate",children:s.full_name}),e.jsx("p",{className:"text-sm text-gray-500 truncate",children:s.email})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"RÃ´le:"}),e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${s.role==="teacher"?"bg-green-100 text-green-800":"bg-purple-100 text-purple-800"}`,children:s.role==="teacher"?"Enseignant":"SecrÃ©taire"})]}),s.subject&&e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"MatiÃ¨re:"}),e.jsx("span",{className:"font-medium",children:s.subject})]}),s.classes&&s.classes.length>0&&e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Classes:"}),e.jsx("span",{className:"font-medium",children:s.classes.join(", ")})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Documents:"}),e.jsx("span",{className:"font-semibold text-blue-600",children:s.document_count||0})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Statut:"}),e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${s.status==="active"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:s.status==="active"?"Actif":"Inactif"})]}),s.last_upload&&e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Dernier upload:"}),e.jsx("span",{className:"text-gray-500",children:new Date(s.last_upload).toLocaleDateString("fr-FR")})]})]}),e.jsx("div",{className:"mt-3 pt-3 border-t border-gray-100",children:e.jsxs(W,{variant:"outline",size:"sm",className:"w-full",onClick:u=>{u.stopPropagation(),E(s),C("documents")},children:[e.jsx(B,{name:"FileText",size:16,className:"mr-2"}),"Voir les documents"]})})]},s.id))}),f().length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx(B,{name:"Users",size:64,className:"text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Aucun personnel trouvÃ©"}),e.jsx("p",{className:"text-gray-500",children:"Aucun compte personnel n'a encore Ã©tÃ© crÃ©Ã©."})]})]})}),i==="documents"&&e.jsxs(e.Fragment,{children:[h&&e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6",children:[e.jsx("h3",{className:"font-medium text-blue-900 mb-3",children:"ðŸ” Recherche AvancÃ©e"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-blue-800 mb-1",children:"Par Classe"}),e.jsxs("select",{className:"w-full border border-blue-300 rounded-md px-3 py-2 text-sm",value:a.class_name,onChange:s=>r(u=>({...u,class_name:s.target.value})),children:[e.jsx("option",{value:"",children:"Toutes les classes"}),[...new Set(d.map(s=>s.class_name))].filter(s=>s&&s!=="Toutes").map(s=>e.jsx("option",{value:s,children:s},s))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-blue-800 mb-1",children:"Par MatiÃ¨re"}),e.jsxs("select",{className:"w-full border border-blue-300 rounded-md px-3 py-2 text-sm",value:a.subject,onChange:s=>r(u=>({...u,subject:s.target.value})),children:[e.jsx("option",{value:"",children:"Toutes les matiÃ¨res"}),[...new Set(d.map(s=>s.subject))].filter(s=>s).map(s=>e.jsx("option",{value:s,children:s},s))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-blue-800 mb-1",children:"Par Enseignant"}),e.jsxs("select",{className:"w-full border border-blue-300 rounded-md px-3 py-2 text-sm",value:(m==null?void 0:m.id)||"",onChange:s=>{const u=f().find(p=>p.id===s.target.value);t(u||null)},children:[e.jsx("option",{value:"",children:"Tous les enseignants"}),f().map(s=>e.jsx("option",{value:s.id,children:s.full_name},s.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-blue-800 mb-1",children:"Type"}),e.jsxs("select",{className:"w-full border border-blue-300 rounded-md px-3 py-2 text-sm",value:a.document_type,onChange:s=>r(u=>({...u,document_type:s.target.value})),children:[e.jsx("option",{value:"",children:"Tous les types"}),e.jsx("option",{value:"cours",children:"Cours"}),e.jsx("option",{value:"exercice",children:"Exercices"}),e.jsx("option",{value:"evaluation",children:"Ã‰valuations"}),e.jsx("option",{value:"correction",children:"Corrections"}),e.jsx("option",{value:"administratif",children:"Administratif"}),e.jsx("option",{value:"planning",children:"Planning"})]})]})]}),e.jsx("div",{className:"mt-4",children:e.jsx("input",{type:"text",placeholder:"Rechercher dans les titres et descriptions...",className:"w-full border border-blue-300 rounded-md px-3 py-2 text-sm",value:a.search,onChange:s=>r(u=>({...u,search:s.target.value}))})}),(a.class_name||a.subject||a.document_type||a.search||m)&&e.jsxs("div",{className:"mt-3 flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm text-blue-700",children:[I.length," document(s) trouvÃ©(s)",m&&` pour ${m.full_name}`]}),e.jsxs(W,{variant:"ghost",size:"sm",onClick:()=>{r({class_name:"",subject:"",document_type:"",search:"",account_id:""}),t(null)},className:"text-blue-600 hover:text-blue-800",children:[e.jsx(B,{name:"X",size:16,className:"mr-1"}),"RÃ©initialiser"]})]})]}),(l==null?void 0:l.role)==="teacher"&&!h&&e.jsx(Z,{onUpload:n,uploading:k,teacherAssignments:g}),!h&&e.jsx(te,{filters:a,onFiltersChange:G,userRole:l==null?void 0:l.role}),e.jsx(ee,{documents:I,onDelete:L,onDownload:q,userRole:h?"principal":l==null?void 0:l.role,loading:S,selectedAccount:m,showUploaderInfo:h})]}),i==="assignments"&&(l==null?void 0:l.role)==="teacher"&&!h&&e.jsx(se,{assignments:g,onAssignmentsUpdate:D}),i==="stats"&&(l==null?void 0:l.role)==="teacher"&&!h&&e.jsx(ae,{stats:b,documents:d}),i==="account-stats"&&h&&m&&e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:["Statistiques de ",m.full_name]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-6",children:[e.jsx("div",{className:"bg-blue-50 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(B,{name:"FileText",size:24,className:"text-blue-600"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-blue-900",children:m.document_count||0}),e.jsx("div",{className:"text-sm text-blue-600",children:"Documents uploadÃ©s"})]})]})}),e.jsx("div",{className:"bg-green-50 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(B,{name:"Download",size:24,className:"text-green-600"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-green-900",children:"0"}),e.jsx("div",{className:"text-sm text-green-600",children:"TÃ©lÃ©chargements"})]})]})}),e.jsx("div",{className:"bg-purple-50 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(B,{name:"Calendar",size:24,className:"text-purple-600"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-purple-900",children:m.last_upload?Math.floor((new Date-new Date(m.last_upload))/(1e3*60*60*24)):"--"}),e.jsx("div",{className:"text-sm text-purple-600",children:"Jours depuis dernier upload"})]})]})})]}),e.jsxs("div",{className:"border-t border-gray-200 pt-6",children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-4",children:"Informations du compte"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Email :"}),e.jsx("span",{className:"ml-2 font-medium",children:m.email})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"RÃ´le :"}),e.jsx("span",{className:"ml-2 font-medium capitalize",children:m.role})]}),m.subject&&e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"MatiÃ¨re :"}),e.jsx("span",{className:"ml-2 font-medium",children:m.subject})]}),m.classes&&m.classes.length>0&&e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Classes :"}),e.jsx("span",{className:"ml-2 font-medium",children:m.classes.join(", ")})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"CrÃ©Ã© le :"}),e.jsx("span",{className:"ml-2 font-medium",children:new Date(m.created_at).toLocaleDateString("fr-FR")})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Statut :"}),e.jsx("span",{className:`ml-2 px-2 py-1 rounded-full text-xs font-medium ${m.status==="active"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:m.status==="active"?"Actif":"Inactif"})]})]})]})]})})]}),e.jsx(re,{userRole:h?"principal":l==null?void 0:l.role,isPrincipalMode:h,selectedAccount:m})]})})};export{ge as default};
//# sourceMappingURL=index-BOZ54uBi.js.map
