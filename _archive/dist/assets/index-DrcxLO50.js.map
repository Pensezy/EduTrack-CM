{"version":3,"file":"index-DrcxLO50.js","sources":["../../src/services/parentMultiSchoolService.js","../../src/pages/secretary-dashboard/components/ParentSearchSelector.jsx","../../src/pages/secretary-dashboard/components/StudentManagementTab.jsx","../../src/pages/secretary-dashboard/components/TeacherSearchSelector.jsx","../../src/components/ui/Checkbox.jsx","../../src/pages/secretary-dashboard/components/TeacherAssignmentManager.jsx","../../src/pages/secretary-dashboard/components/TeacherManagementTab.jsx","../../src/services/cardService.js","../../src/pages/secretary-dashboard/components/CardGenerationModal.jsx","../../src/pages/secretary-dashboard/components/StudentCardTab.jsx","../../src/services/absenceService.js","../../src/pages/secretary-dashboard/components/AbsenceJustificationModal.jsx","../../src/pages/secretary-dashboard/components/NewAbsenceModal.jsx","../../src/pages/secretary-dashboard/components/NotificationHistoryModal.jsx","../../src/pages/secretary-dashboard/components/JustificationTab.jsx","../../src/components/ui/Toast.jsx","../../src/services/paymentService.js","../../src/pages/secretary-dashboard/components/PaymentRegistrationModal.jsx","../../src/pages/secretary-dashboard/components/ReceiptModal.jsx","../../src/pages/secretary-dashboard/components/PaymentHistoryModal.jsx","../../src/pages/secretary-dashboard/components/PaymentCalendarModal.jsx","../../src/pages/secretary-dashboard/components/PaymentAnalyticsModal.jsx","../../src/pages/secretary-dashboard/components/PaymentTab.jsx","../../src/services/communicationService.js","../../src/pages/secretary-dashboard/components/NotificationCenter.jsx","../../src/pages/secretary-dashboard/components/TransferWorkflow.jsx","../../src/pages/secretary-dashboard/components/DocumentsTab.jsx","../../src/services/planningService.js","../../src/pages/secretary-dashboard/components/EventModal.jsx","../../src/pages/secretary-dashboard/components/PlanningCalendarModal.jsx","../../src/pages/secretary-dashboard/components/PlanningAnalyticsModal.jsx","../../src/pages/secretary-dashboard/components/PlanningTab.jsx","../../src/pages/secretary-dashboard/components/TasksTab.jsx","../../src/services/schoolYearService.js","../../src/pages/secretary-dashboard/components/SchoolYearTab.jsx","../../src/pages/secretary-dashboard/index.jsx"],"sourcesContent":["/**\n * Service de gestion multi-√©tablissements pour les parents (Production)\n * G√®re la recherche et la v√©rification des parents √† travers plusieurs √©tablissements\n */\n\nimport { supabase } from '../lib/supabase';\n\nconst parentMultiSchoolService = {\n  /**\n   * Recherche les parents existants par terme (nom, email, t√©l√©phone)\n   * @param {string} term - Terme de recherche\n   * @returns {Promise<Array>} Liste des parents trouv√©s avec leurs relations\n   */\n  async searchExistingParents(term) {\n    try {\n      const searchLower = term.toLowerCase();\n\n      // Rechercher les parents dans la base de donn√©es\n      const { data: parents, error } = await supabase\n        .from('parents')\n        .select(`\n          id,\n          first_name,\n          last_name,\n          email,\n          phone,\n          address,\n          profession,\n          user_id,\n          created_at\n        `)\n        .or(`first_name.ilike.%${term}%,last_name.ilike.%${term}%,email.ilike.%${term}%,phone.ilike.%${term}%`)\n        .limit(10);\n\n      if (error) {\n        console.error('Erreur recherche Supabase parents:', error);\n        return [];\n      }\n\n      // Charger les relations enfants pour chaque parent\n      const parentsWithRelations = await Promise.all(\n        (parents || []).map(async (parent) => {\n          // Charger les √©l√®ves de ce parent\n          const { data: students, error: studentsError } = await supabase\n            .from('students')\n            .select(`\n              id,\n              first_name,\n              last_name,\n              current_class,\n              school_id,\n              schools (\n                id,\n                name,\n                city,\n                type\n              )\n            `)\n            .eq('parent_id', parent.id)\n            .eq('is_active', true);\n\n          if (studentsError) {\n            console.error('Erreur chargement √©l√®ves:', studentsError);\n          }\n\n          // Formater les relations\n          const relations = (students || []).map(student => ({\n            student: {\n              id: student.id,\n              firstName: student.first_name,\n              lastName: student.last_name,\n              className: student.current_class\n            },\n            school: student.schools ? {\n              id: student.schools.id,\n              name: student.schools.name,\n              city: student.schools.city || 'Non renseign√©',\n              type: student.schools.type\n            } : null\n          }));\n\n          return {\n            id: parent.id,\n            globalParentId: parent.id,\n            firstName: parent.first_name,\n            lastName: parent.last_name,\n            email: parent.email,\n            phone: parent.phone,\n            address: parent.address,\n            profession: parent.profession,\n            userId: parent.user_id,\n            createdAt: parent.created_at,\n            studentRelations: relations\n          };\n        })\n      );\n\n      return parentsWithRelations;\n    } catch (error) {\n      console.error('Erreur lors de la recherche de parents:', error);\n      return [];\n    }\n  },\n\n  /**\n   * V√©rifie si un parent existe d√©j√† selon l'email ou le t√©l√©phone\n   * @param {string} email - Email du parent\n   * @param {string} phone - T√©l√©phone du parent\n   * @returns {Promise<Object|null>} Parent trouv√© ou null\n   */\n  async checkExistingParent(email, phone) {\n    try {\n      let query = supabase.from('parents').select(`\n        id,\n        first_name,\n        last_name,\n        email,\n        phone,\n        address,\n        profession,\n        user_id,\n        created_at\n      `);\n\n      // Construire la condition OR pour email ou phone\n      const conditions = [];\n      if (email) {\n        conditions.push(`email.eq.${email}`);\n      }\n      if (phone) {\n        conditions.push(`phone.eq.${phone}`);\n      }\n\n      if (conditions.length === 0) {\n        return null;\n      }\n\n      const { data: parents, error } = await query.or(conditions.join(','));\n\n      if (error) {\n        console.error('Erreur v√©rification parent:', error);\n        return null;\n      }\n\n      if (!parents || parents.length === 0) {\n        return null;\n      }\n\n      // R√©cup√©rer le premier parent trouv√© avec ses relations\n      const parent = parents[0];\n      const { data: students } = await supabase\n        .from('students')\n        .select(`\n          id,\n          first_name,\n          last_name,\n          current_class,\n          school_id,\n          schools (\n            id,\n            name,\n            city,\n            type\n          )\n        `)\n        .eq('parent_id', parent.id)\n        .eq('is_active', true);\n\n      const relations = (students || []).map(student => ({\n        student: {\n          id: student.id,\n          firstName: student.first_name,\n          lastName: student.last_name,\n          className: student.current_class\n        },\n        school: student.schools ? {\n          id: student.schools.id,\n          name: student.schools.name,\n          city: student.schools.city || 'Non renseign√©',\n          type: student.schools.type\n        } : null\n      }));\n\n      return {\n        id: parent.id,\n        globalParentId: parent.id,\n        firstName: parent.first_name,\n        lastName: parent.last_name,\n        email: parent.email,\n        phone: parent.phone,\n        address: parent.address,\n        profession: parent.profession,\n        userId: parent.user_id,\n        createdAt: parent.created_at,\n        studentRelations: relations\n      };\n    } catch (error) {\n      console.error('Exception lors de la v√©rification du parent:', error);\n      return null;\n    }\n  }\n};\n\nexport { parentMultiSchoolService };\n","import React, { useState, useEffect } from 'react';\r\nimport { supabase } from '../../../lib/supabase';\r\nimport { parentMultiSchoolService } from '../../../services/parentMultiSchoolService.js';\r\nimport Icon from '../../../components/AppIcon';\r\nimport Button from '../../../components/ui/Button';\r\nimport Input from '../../../components/ui/Input';\r\n\r\nconst ParentSearchSelector = ({\r\n  onParentSelect,\r\n  onCreateNew,\r\n  selectedParent,\r\n  searchTerm,\r\n  onSearchChange\r\n}) => {\r\n  const [searchResults, setSearchResults] = useState([]);\r\n  const [loading, setLoading] = useState(false);\r\n  const [showResults, setShowResults] = useState(false);\r\n\r\n  useEffect(() => {\r\n    if (searchTerm && searchTerm.length >= 2) {\r\n      searchParents(searchTerm);\r\n    } else {\r\n      setSearchResults([]);\r\n      setShowResults(false);\r\n    }\r\n  }, [searchTerm]);\r\n\r\n  const searchParents = async (term) => {\r\n    setLoading(true);\r\n    try {\r\n      // Utiliser le service de production pour rechercher les parents\r\n      const results = await parentMultiSchoolService.searchExistingParents(term);\r\n      setSearchResults(results);\r\n      setShowResults(true);\r\n    } catch (error) {\r\n      console.error('Erreur lors de la recherche:', error);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const checkForDuplicate = async (email, phone) => {\r\n    try {\r\n      const existing = await parentMultiSchoolService.checkExistingParent(email, phone);\r\n      if (existing) {\r\n        return {\r\n          isDuplicate: true,\r\n          parent: existing,\r\n          message: `Un parent existe d√©j√† avec ces informations:\\n${existing.firstName} ${existing.lastName}\\nEmail: ${existing.email}\\nT√©l√©phone: ${existing.phone}\\n\\nEnfants dans ${existing.studentRelations.length} √©tablissement(s)`\r\n        };\r\n      }\r\n      return { isDuplicate: false };\r\n    } catch (error) {\r\n      console.error('Erreur lors de la v√©rification:', error);\r\n      return { isDuplicate: false };\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"space-y-4\">\r\n      {/* Recherche de parent existant */}\r\n      <div className=\"relative\">\r\n        <div className=\"flex items-center space-x-2\">\r\n          <div className=\"flex-1\">\r\n            <Input\r\n              placeholder=\"Rechercher un parent existant (nom, email, t√©l√©phone)...\"\r\n              value={searchTerm}\r\n              onChange={(e) => onSearchChange(e.target.value)}\r\n              className=\"w-full\"\r\n            />\r\n          </div>\r\n          {loading && (\r\n            <div className=\"flex items-center text-blue-600\">\r\n              <div className=\"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-600 mr-2\"></div>\r\n              <span className=\"text-sm\">Recherche...</span>\r\n            </div>\r\n          )}\r\n        </div>\r\n\r\n        {/* R√©sultats de recherche */}\r\n        {showResults && searchResults.length > 0 && (\r\n          <div className=\"absolute z-10 w-full mt-1 bg-white border border-gray-300 rounded-lg shadow-lg max-h-60 overflow-y-auto\">\r\n            <div className=\"p-3 bg-blue-50 border-b border-blue-200\">\r\n              <p className=\"text-sm font-medium text-blue-800\">\r\n                {searchResults.length} parent(s) trouv√©(s)\r\n              </p>\r\n            </div>\r\n            {searchResults.map((parent) => (\r\n              <div\r\n                key={parent.id}\r\n                onClick={() => {\r\n                  onParentSelect(parent);\r\n                  setShowResults(false);\r\n                }}\r\n                className=\"p-3 hover:bg-gray-50 cursor-pointer border-b border-gray-100 last:border-b-0\"\r\n              >\r\n                <div className=\"flex justify-between items-start\">\r\n                  <div className=\"flex-1\">\r\n                    <h4 className=\"font-medium text-gray-900\">\r\n                      {parent.firstName} {parent.lastName}\r\n                    </h4>\r\n                    <p className=\"text-sm text-gray-600\">{parent.email}</p>\r\n                    <p className=\"text-sm text-gray-600\">{parent.phone}</p>\r\n                    <p className=\"text-sm text-blue-600 mt-1\">\r\n                      <Icon name=\"School\" size={12} className=\"inline mr-1\" />\r\n                      {parent.studentRelations.length} relation(s) √©cole\r\n                    </p>\r\n                  </div>\r\n                  <div className=\"text-xs text-gray-400\">\r\n                    ID: {parent.globalParentId.slice(0, 8)}...\r\n                  </div>\r\n                </div>\r\n                {parent.studentRelations.length > 0 && (\r\n                  <div className=\"mt-2 pt-2 border-t border-gray-100\">\r\n                    <p className=\"text-xs text-gray-500 mb-1\">Enfants actuels:</p>\r\n                    {parent.studentRelations.map((relation, idx) => (\r\n                      <div key={idx} className=\"text-xs text-gray-600\">\r\n                        ‚Ä¢ {relation.student.firstName} {relation.student.lastName}\r\n                        {relation.student.className && ` - ${relation.student.className}`}\r\n                        {relation.school && ` - ${relation.school.name} (${relation.school.city})`}\r\n                      </div>\r\n                    ))}\r\n                  </div>\r\n                )}\r\n              </div>\r\n            ))}\r\n          </div>\r\n        )}\r\n\r\n        {/* Aucun r√©sultat */}\r\n        {showResults && searchResults.length === 0 && searchTerm.length >= 2 && !loading && (\r\n          <div className=\"absolute z-10 w-full mt-1 bg-white border border-gray-300 rounded-lg shadow-lg p-4\">\r\n            <div className=\"text-center\">\r\n              <Icon name=\"Search\" size={24} className=\"text-gray-400 mx-auto mb-2\" />\r\n              <p className=\"text-sm text-gray-600\">Aucun parent trouv√©</p>\r\n              <p className=\"text-xs text-gray-500 mt-1\">\r\n                Vous pouvez cr√©er un nouveau parent\r\n              </p>\r\n            </div>\r\n          </div>\r\n        )}\r\n      </div>\r\n\r\n      {/* Parent s√©lectionn√© */}\r\n      {selectedParent && (\r\n        <div className=\"bg-green-50 border border-green-200 rounded-lg p-4\">\r\n          <div className=\"flex items-start justify-between\">\r\n            <div>\r\n              <h4 className=\"font-medium text-green-800\">\r\n                Parent s√©lectionn√©: {selectedParent.firstName} {selectedParent.lastName}\r\n              </h4>\r\n              <p className=\"text-sm text-green-700\">{selectedParent.email}</p>\r\n              <p className=\"text-sm text-green-700\">{selectedParent.phone}</p>\r\n              <p className=\"text-sm text-green-600 mt-1\">\r\n                <Icon name=\"Globe\" size={12} className=\"inline mr-1\" />\r\n                ID Global: {selectedParent.globalParentId}\r\n              </p>\r\n              \r\n              {selectedParent.studentRelations && selectedParent.studentRelations.length > 0 && (\r\n                <div className=\"mt-2\">\r\n                  <p className=\"text-xs text-green-700 font-medium\">\r\n                    Enfants inscrits ({selectedParent.studentRelations.length}) :\r\n                  </p>\r\n                  {selectedParent.studentRelations.map((relation, idx) => (\r\n                    <div key={idx} className=\"text-xs text-green-600\">\r\n                      ‚Ä¢ {relation.student.firstName} {relation.student.lastName}\r\n                      {relation.student.className && ` - ${relation.student.className}`}\r\n                      {relation.school && ` √† ${relation.school.name} (${relation.school.city})`}\r\n                    </div>\r\n                  ))}\r\n                </div>\r\n              )}\r\n              \r\n              {selectedParent.studentRelations && selectedParent.studentRelations.length === 0 && (\r\n                <div className=\"mt-2\">\r\n                  <p className=\"text-xs text-green-600\">\r\n                    <Icon name=\"Info\" size={12} className=\"inline mr-1\" />\r\n                    Aucun enfant inscrit actuellement\r\n                  </p>\r\n                </div>\r\n              )}\r\n            </div>\r\n            <Button\r\n              variant=\"ghost\"\r\n              size=\"sm\"\r\n              onClick={() => {\r\n                onParentSelect(null);\r\n                onSearchChange('');\r\n                setShowResults(false);\r\n              }}\r\n              className=\"text-green-700 hover:text-green-800\"\r\n            >\r\n              <Icon name=\"X\" size={16} />\r\n            </Button>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Options d'action */}\r\n      <div className=\"flex space-x-3\">\r\n        <Button\r\n          variant=\"outline\"\r\n          onClick={() => onCreateNew()}\r\n          className=\"flex-1\"\r\n        >\r\n          <Icon name=\"UserPlus\" size={16} className=\"mr-2\" />\r\n          Cr√©er Nouveau Parent\r\n        </Button>\r\n        \r\n        {searchTerm && searchTerm.length >= 2 && (\r\n          <Button\r\n            variant=\"ghost\"\r\n            onClick={async () => {\r\n              const result = await checkForDuplicate(searchTerm, '');\r\n              if (result.isDuplicate) {\r\n                alert(`‚ö†Ô∏è ATTENTION - DOUBLON D√âTECT√â!\\n\\n${result.message}\\n\\nVoulez-vous utiliser ce parent existant?`);\r\n                onParentSelect(result.parent);\r\n              } else {\r\n                alert('‚úÖ Aucun doublon d√©tect√© pour cette information');\r\n              }\r\n            }}\r\n            className=\"text-orange-600 hover:text-orange-700\"\r\n          >\r\n            <Icon name=\"AlertTriangle\" size={16} className=\"mr-2\" />\r\n            V√©rifier Doublon\r\n          </Button>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ParentSearchSelector;","import React, { useState, useEffect } from 'react';\r\nimport { supabase } from '../../../lib/supabase';\r\nimport Icon from '../../../components/AppIcon';\r\nimport Button from '../../../components/ui/Button';\r\nimport Input from '../../../components/ui/Input';\r\nimport Select from '../../../components/ui/Select';\r\nimport Image from '../../../components/AppImage';\r\nimport ParentSearchSelector from './ParentSearchSelector';\r\n\r\nconst StudentManagementTab = () => {\r\n  const [searchTerm, setSearchTerm] = useState('');\r\n  const [filterClass, setFilterClass] = useState('');\r\n  const [filterStatus, setFilterStatus] = useState('');\r\n  const [showAddModal, setShowAddModal] = useState(false);\r\n  const [showProfileModal, setShowProfileModal] = useState(false);\r\n  const [showTransferModal, setShowTransferModal] = useState(false);\r\n  const [selectedStudent, setSelectedStudent] = useState(null);\r\n  const [loading, setLoading] = useState(true);\r\n  \r\n  // Donn√©es de l'√©cole\r\n  const [currentSchool, setCurrentSchool] = useState(null);\r\n  const [schoolClasses, setSchoolClasses] = useState([]);\r\n  \r\n  // √âtats pour le nouveau workflow multi-√©tapes\r\n  const [currentStep, setCurrentStep] = useState(1);\r\n  const [inscriptionMode, setInscriptionMode] = useState('new'); // 'new' ou 'existing'\r\n  const [selectedExistingParent, setSelectedExistingParent] = useState(null);\r\n  const [parentSearchTerm, setParentSearchTerm] = useState('');\r\n  const [familyData, setFamilyData] = useState({\r\n    parent: {\r\n      firstName: '',\r\n      lastName: '',\r\n      email: '',\r\n      phone: '',\r\n      address: '',\r\n      occupation: '',\r\n      // Identifiants g√©n√©r√©s automatiquement\r\n      username: '',\r\n      password: '',\r\n      userId: ''\r\n    },\r\n    students: [{\r\n      firstName: '',\r\n      lastName: '',\r\n      class: '',\r\n      dateOfBirth: '',\r\n      placeOfBirth: '',\r\n      photo: '/public/assets/images/no_image.png',\r\n      // Identifiants g√©n√©r√©s automatiquement\r\n      username: '',\r\n      password: '',\r\n      studentId: ''\r\n    }]\r\n  });\r\n\r\n  const [newStudent, setNewStudent] = useState({\r\n    name: '',\r\n    class: '',\r\n    parentName: '',\r\n    parentPhone: '',\r\n    parentEmail: '',\r\n    photo: '/public/assets/images/no_image.png'\r\n  });\r\n\r\n  const initialStudents = [\r\n    {\r\n      id: 1,\r\n      name: \"Amina Nkomo\",\r\n      class: \"CM2\",\r\n      enrollmentStatus: \"active\",\r\n      photo: \"/public/assets/images/no_image.png\",\r\n      parentName: \"Paul Nkomo\",\r\n      parentPhone: \"+237 6 78 90 12 34\",\r\n      parentEmail: \"p.nkomo@gmail.com\",\r\n      enrollmentDate: \"15/09/2024\",\r\n      studentId: \"STU001\"\r\n    },\r\n    {\r\n      id: 2,\r\n      name: \"Junior Mbarga\",\r\n      class: \"CM1\",\r\n      enrollmentStatus: \"active\",\r\n      photo: \"/public/assets/images/no_image.png\",\r\n      parentName: \"Marie Mbarga\",\r\n      parentPhone: \"+237 6 89 01 23 45\",\r\n      parentEmail: \"marie.mbarga@yahoo.fr\",\r\n      enrollmentDate: \"12/09/2024\",\r\n      studentId: \"STU002\"\r\n    },\r\n    {\r\n      id: 3,\r\n      name: \"Grace Fouda\",\r\n      class: \"CE2\",\r\n      enrollmentStatus: \"pending\",\r\n      photo: \"/public/assets/images/no_image.png\",\r\n      parentName: \"Jean Fouda\",\r\n      parentPhone: \"+237 6 90 12 34 56\",\r\n      parentEmail: \"j.fouda@outlook.com\",\r\n      enrollmentDate: \"10/09/2024\",\r\n      studentId: \"STU003\"\r\n    },\r\n    {\r\n      id: 4,\r\n      name: \"Kevin Biya\",\r\n      class: \"CM2\",\r\n      enrollmentStatus: \"active\",\r\n      photo: \"/public/assets/images/no_image.png\",\r\n      parentName: \"Esther Biya\",\r\n      parentPhone: \"+237 6 01 23 45 67\",\r\n      parentEmail: \"esther.biya@hotmail.com\",\r\n      enrollmentDate: \"08/09/2024\",\r\n      studentId: \"STU004\"\r\n    },\r\n    {\r\n      id: 5,\r\n      name: \"Sarah Atangana\",\r\n      class: \"CE1\",\r\n      enrollmentStatus: \"transferred\",\r\n      photo: \"/public/assets/images/no_image.png\",\r\n      parentName: \"Michel Atangana\",\r\n      parentPhone: \"+237 6 12 34 56 78\",\r\n      parentEmail: \"m.atangana@gmail.com\",\r\n      enrollmentDate: \"05/09/2024\",\r\n      studentId: \"STU005\"\r\n    }\r\n  ];\r\n\r\n  const [students, setStudents] = useState([]);\r\n\r\n  // Load data on mount\r\n  useEffect(() => {\r\n    loadSchoolData();\r\n    loadStudents();\r\n  }, []);\r\n\r\n  const loadSchoolData = async () => {\r\n    try {\r\n      const savedUser = localStorage.getItem('edutrack-user');\r\n      const userData = savedUser ? JSON.parse(savedUser) : null;\r\n      const schoolId = userData?.current_school_id;\r\n\r\n      if (!schoolId) {\r\n        console.warn('‚ö†Ô∏è Pas d\\'√©cole associ√©e');\r\n        return;\r\n      }\r\n\r\n      // Charger les informations de l'√©cole\r\n      const { data: schoolData, error: schoolError } = await supabase\r\n        .from('schools')\r\n        .select('id, name, type, available_classes')\r\n        .eq('id', schoolId)\r\n        .single();\r\n\r\n      if (schoolError) {\r\n        console.error('‚ùå Erreur chargement √©cole:', schoolError);\r\n        return;\r\n      }\r\n\r\n      setCurrentSchool({\r\n        id: schoolData.id,\r\n        name: schoolData.name,\r\n        type: schoolData.type\r\n      });\r\n\r\n      console.log('‚úÖ √âcole charg√©e pour les √©l√®ves:', schoolData.name);\r\n      console.log('üìã Classes disponibles:', schoolData.available_classes);\r\n\r\n      // Utiliser les classes choisies lors de la cr√©ation de l'√©cole\r\n      if (schoolData.available_classes && Array.isArray(schoolData.available_classes) && schoolData.available_classes.length > 0) {\r\n        const schoolClassesList = schoolData.available_classes.map((className, index) => ({\r\n          id: `class-${index}`,\r\n          name: className,\r\n          level: className\r\n        }));\r\n        setSchoolClasses(schoolClassesList);\r\n        console.log(`‚úÖ ${schoolClassesList.length} classe(s) charg√©e(s) depuis available_classes pour les √©l√®ves`);\r\n      } else {\r\n        console.warn('‚ö†Ô∏è Aucune classe dans available_classes, utilisation des classes par d√©faut');\r\n        const defaultClasses = getDefaultClassesBySchoolType(schoolData.type);\r\n        setSchoolClasses(defaultClasses);\r\n      }\r\n    } catch (error) {\r\n      console.error('Exception chargement donn√©es √©cole:', error);\r\n    }\r\n  };\r\n\r\n  // Fonction pour obtenir les classes par d√©faut selon le type d'√©cole\r\n  const getDefaultClassesBySchoolType = (schoolType) => {\r\n    if (schoolType === 'Maternelle') {\r\n      return [\r\n        { id: 'default-ps', name: 'Petite Section', level: 'PS' },\r\n        { id: 'default-ms', name: 'Moyenne Section', level: 'MS' },\r\n        { id: 'default-gs', name: 'Grande Section', level: 'GS' }\r\n      ];\r\n    } else if (schoolType === 'Primaire') {\r\n      return [\r\n        { id: 'default-cp', name: 'CP', level: 'CP' },\r\n        { id: 'default-ce1', name: 'CE1', level: 'CE1' },\r\n        { id: 'default-ce2', name: 'CE2', level: 'CE2' },\r\n        { id: 'default-cm1', name: 'CM1', level: 'CM1' },\r\n        { id: 'default-cm2', name: 'CM2', level: 'CM2' }\r\n      ];\r\n    } else if (schoolType === 'Coll√®ge') {\r\n      return [\r\n        { id: 'default-6eme', name: '6√®me', level: '6√®me' },\r\n        { id: 'default-5eme', name: '5√®me', level: '5√®me' },\r\n        { id: 'default-4eme', name: '4√®me', level: '4√®me' },\r\n        { id: 'default-3eme', name: '3√®me', level: '3√®me' }\r\n      ];\r\n    } else if (schoolType === 'Lyc√©e') {\r\n      return [\r\n        { id: 'default-2nde', name: '2nde', level: '2nde' },\r\n        { id: 'default-1ere', name: '1√®re', level: '1√®re' },\r\n        { id: 'default-tle', name: 'Terminale', level: 'Terminale' }\r\n      ];\r\n    } else {\r\n      return [];\r\n    }\r\n  };\r\n\r\n  const loadStudents = async () => {\r\n    try {\r\n      setLoading(true);\r\n      const savedUser = localStorage.getItem('edutrack-user');\r\n      const userData = savedUser ? JSON.parse(savedUser) : null;\r\n      const schoolId = userData?.current_school_id;\r\n\r\n      if (!schoolId) {\r\n        console.warn('‚ö†Ô∏è Pas d\\'√©cole associ√©e');\r\n        setStudents([]);\r\n        setLoading(false);\r\n        return;\r\n      }\r\n\r\n      console.log('üîç Chargement des √©l√®ves pour l\\'√©cole:', schoolId);\r\n\r\n      // Charger d'abord les √©l√®ves sans les relations (pour √©viter les erreurs de foreign key)\r\n      const { data: studentsData, error: studentsError } = await supabase\r\n        .from('students')\r\n        .select('*')\r\n        .eq('school_id', schoolId)\r\n        .order('created_at', { ascending: false });\r\n\r\n      if (studentsError) {\r\n        console.error('‚ùå Erreur chargement √©l√®ves:', studentsError);\r\n        console.error('‚ùå D√©tails:', studentsError.message, studentsError.details, studentsError.hint);\r\n        setStudents([]);\r\n      } else {\r\n        console.log('üìä Donn√©es brutes √©l√®ves re√ßues:', studentsData);\r\n        console.log(`üìà Nombre d'√©l√®ves trouv√©s: ${studentsData?.length || 0}`);\r\n        \r\n        if (!studentsData || studentsData.length === 0) {\r\n          console.warn('‚ö†Ô∏è Aucune donn√©e d\\'√©l√®ve trouv√©e dans la base pour school_id:', schoolId);\r\n          setStudents([]);\r\n        } else {\r\n          // R√©cup√©rer les IDs des parents pour une requ√™te s√©par√©e\r\n          const parentIds = studentsData\r\n            .map(s => s.parent_id)\r\n            .filter(id => id != null);\r\n          \r\n          console.log('üîç Parent IDs √† charger:', parentIds);\r\n          \r\n          // Charger les informations des parents s√©par√©ment\r\n          let parentsMap = {};\r\n          if (parentIds.length > 0) {\r\n            const { data: parentsData, error: parentsError } = await supabase\r\n              .from('parents')\r\n              .select('id, user_id, first_name, last_name, email, phone')\r\n              .in('id', parentIds);\r\n            \r\n            if (parentsError) {\r\n              console.error('‚ö†Ô∏è Erreur chargement parents:', parentsError);\r\n            } else if (parentsData) {\r\n              console.log('üìä Donn√©es parents re√ßues:', parentsData);\r\n              // Cr√©er un map pour un acc√®s rapide\r\n              parentsMap = parentsData.reduce((acc, parent) => {\r\n                acc[parent.id] = parent;\r\n                return acc;\r\n              }, {});\r\n            }\r\n          }\r\n          \r\n          // Transformer les donn√©es Supabase au format attendu\r\n          const formattedStudents = studentsData.map(student => {\r\n            console.log('üîÑ Formatage √©l√®ve:', student.first_name, student.last_name);\r\n            const parentInfo = parentsMap[student.parent_id];\r\n            \r\n            return {\r\n              id: student.id,\r\n              name: `${student.first_name} ${student.last_name}`,\r\n              class: student.current_class || student.class_name || 'Non assign√©',\r\n              enrollmentStatus: student.is_active ? 'active' : 'transferred',\r\n              photo: student.photo_url || student.photo || '/public/assets/images/no_image.png',\r\n              parentName: parentInfo ? `${parentInfo.first_name} ${parentInfo.last_name}` : 'Non renseign√©',\r\n              parentPhone: parentInfo?.phone || 'Non renseign√©',\r\n              parentEmail: parentInfo?.email || 'Non renseign√©',\r\n              enrollmentDate: student.enrollment_date ? new Date(student.enrollment_date).toLocaleDateString('fr-FR') : 'Non renseign√©e',\r\n              studentId: student.user_id || `STU${student.id.substring(0, 6)}`\r\n            };\r\n          });\r\n          setStudents(formattedStudents);\r\n          console.log(`‚úÖ ${formattedStudents.length} √©l√®ve(s) charg√©(s) et format√©(s)`);\r\n          console.log('üë• Liste finale:', formattedStudents);\r\n        }\r\n      }\r\n    } catch (error) {\r\n      console.error('Exception chargement √©l√®ves:', error);\r\n      setStudents([]);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  // Options dynamiques bas√©es sur les donn√©es de l'√©cole\r\n  const classOptions = [\r\n    { value: '', label: 'Toutes les classes' },\r\n    ...schoolClasses.map(cls => ({\r\n      value: cls.name,\r\n      label: cls.name\r\n    }))\r\n  ];\r\n\r\n  const statusOptions = [\r\n    { value: '', label: 'Tous les statuts' },\r\n    { value: 'active', label: 'Actif' },\r\n    { value: 'pending', label: 'En attente' },\r\n    { value: 'transferred', label: 'Transf√©r√©' }\r\n  ];\r\n\r\n  // Base de donn√©es simul√©e des parents existants (extraite des √©l√®ves actuels)\r\n  const existingParents = [\r\n    {\r\n      id: 'PAR001',\r\n      firstName: 'Paul',\r\n      lastName: 'Nkomo',\r\n      email: 'p.nkomo@gmail.com',\r\n      phone: '+237 6 78 90 12 34',\r\n      address: 'Douala, Cameroun',\r\n      occupation: 'Ing√©nieur',\r\n      primaryLogin: 'p.nkomo@gmail.com',\r\n      secondaryLogin: '237678901234',\r\n      customUsername: 'parentpnkomo123',\r\n      userId: 'PAR001',\r\n      canLoginWithEmail: true,\r\n      canLoginWithPhone: true,\r\n      children: ['Amina Nkomo']\r\n    },\r\n    {\r\n      id: 'PAR002',\r\n      firstName: 'Marie',\r\n      lastName: 'Mbarga',\r\n      email: 'marie.mbarga@yahoo.fr',\r\n      phone: '+237 6 89 01 23 45',\r\n      address: 'Yaound√©, Cameroun',\r\n      occupation: 'Commer√ßante',\r\n      primaryLogin: 'marie.mbarga@yahoo.fr',\r\n      secondaryLogin: '237689012345',\r\n      customUsername: 'parentmmbarga456',\r\n      userId: 'PAR002',\r\n      canLoginWithEmail: true,\r\n      canLoginWithPhone: true,\r\n      children: ['Junior Mbarga']\r\n    },\r\n    {\r\n      id: 'PAR003',\r\n      firstName: 'Jean',\r\n      lastName: 'Fouda',\r\n      email: 'j.fouda@outlook.com',\r\n      phone: '+237 6 90 12 34 56',\r\n      address: 'Bafoussam, Cameroun',\r\n      occupation: 'Professeur',\r\n      primaryLogin: 'j.fouda@outlook.com',\r\n      secondaryLogin: '237690123456',\r\n      customUsername: 'parentjfouda789',\r\n      userId: 'PAR003',\r\n      canLoginWithEmail: true,\r\n      canLoginWithPhone: true,\r\n      children: ['Grace Fouda']\r\n    },\r\n    {\r\n      id: 'PAR004',\r\n      firstName: 'Esther',\r\n      lastName: 'Biya',\r\n      email: 'esther.biya@hotmail.com',\r\n      phone: '+237 6 01 23 45 67',\r\n      address: 'Garoua, Cameroun',\r\n      occupation: 'Infirmi√®re',\r\n      primaryLogin: 'esther.biya@hotmail.com',\r\n      secondaryLogin: '237601234567',\r\n      customUsername: 'parentebiya321',\r\n      userId: 'PAR004',\r\n      canLoginWithEmail: true,\r\n      canLoginWithPhone: true,\r\n      children: ['Kevin Biya']\r\n    },\r\n    {\r\n      id: 'PAR005',\r\n      firstName: 'Michel',\r\n      lastName: 'Atangana',\r\n      email: 'm.atangana@gmail.com',\r\n      phone: '+237 6 12 34 56 78',\r\n      address: 'Bamenda, Cameroun',\r\n      occupation: 'M√©decin',\r\n      primaryLogin: 'm.atangana@gmail.com',\r\n      secondaryLogin: '237612345678',\r\n      customUsername: 'parentmatangana654',\r\n      userId: 'PAR005',\r\n      canLoginWithEmail: true,\r\n      canLoginWithPhone: true,\r\n      children: ['Sarah Atangana']\r\n    }\r\n  ];\r\n\r\n  // Fonctions utilitaires pour le nouveau workflow\r\n  const generateSecurePassword = () => {\r\n    const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789@$!%*?&';\r\n    let password = '';\r\n    // Au moins une majuscule, une minuscule, un chiffre et un caract√®re sp√©cial\r\n    password += 'ABCDEFGHIJKLMNOPQRSTUVWXYZ'[Math.floor(Math.random() * 26)];\r\n    password += 'abcdefghijklmnopqrstuvwxyz'[Math.floor(Math.random() * 26)];\r\n    password += '0123456789'[Math.floor(Math.random() * 10)];\r\n    password += '@$!%*?&'[Math.floor(Math.random() * 7)];\r\n    \r\n    for (let i = 4; i < 8; i++) {\r\n      password += chars[Math.floor(Math.random() * chars.length)];\r\n    }\r\n    \r\n    return password.split('').sort(() => 0.5 - Math.random()).join('');\r\n  };\r\n\r\n  const generateLoginCredentials = (firstName, lastName, email, phone, type = 'parent') => {\r\n    const clean = (str) => str.toLowerCase().replace(/[^a-z0-9]/g, '');\r\n    \r\n    // D√©termine l'identifiant de connexion principal\r\n    let primaryLogin = '';\r\n    let secondaryLogin = '';\r\n    let customUsername = '';\r\n    \r\n    // Si email disponible, utiliser l'email comme identifiant principal\r\n    if (email && email.includes('@')) {\r\n      primaryLogin = email.toLowerCase();\r\n    }\r\n    \r\n    // Si t√©l√©phone disponible, utiliser le t√©l√©phone comme identifiant secondaire\r\n    if (phone && phone.includes('+237')) {\r\n      // Nettoyer le num√©ro : +237 6 78 90 12 34 ‚Üí 237678901234\r\n      secondaryLogin = phone.replace(/\\D/g, '');\r\n    }\r\n    \r\n    // Cr√©er un nom d'utilisateur personnalis√© comme alternative\r\n    const prefix = type === 'parent' ? 'parent' : 'eleve';\r\n    const baseFirstName = clean(firstName);\r\n    const baseLastName = clean(lastName);\r\n    const random = Math.floor(100 + Math.random() * 900);\r\n    \r\n    // Format: parent/eleve + premi√®re lettre pr√©nom + nom + nombre\r\n    customUsername = `${prefix}${baseFirstName.charAt(0)}${baseLastName}${random}`;\r\n    \r\n    return {\r\n      primaryLogin,      // Email si disponible\r\n      secondaryLogin,    // T√©l√©phone si disponible  \r\n      customUsername,    // Nom d'utilisateur personnalis√©\r\n      canLoginWithEmail: !!primaryLogin,\r\n      canLoginWithPhone: !!secondaryLogin\r\n    };\r\n  };\r\n\r\n  const generateUserId = (type = 'parent') => {\r\n    const prefix = type === 'parent' ? 'PAR' : 'STU';\r\n    const number = String(Math.floor(1000 + Math.random() * 9000));\r\n    return `${prefix}${number}`;\r\n  };\r\n\r\n  // Fonctions de navigation du workflow\r\n  const nextStep = () => {\r\n    if (currentStep < 3) setCurrentStep(currentStep + 1);\r\n  };\r\n\r\n  const prevStep = () => {\r\n    if (currentStep > 1) setCurrentStep(currentStep - 1);\r\n  };\r\n\r\n  const resetWorkflow = () => {\r\n    setCurrentStep(1);\r\n    setInscriptionMode('new');\r\n    setSelectedExistingParent(null);\r\n    setParentSearchTerm('');\r\n    setFamilyData({\r\n      parent: {\r\n        firstName: '',\r\n        lastName: '',\r\n        email: '',\r\n        phone: '',\r\n        address: '',\r\n        occupation: '',\r\n        username: '',\r\n        password: '',\r\n        userId: ''\r\n      },\r\n      students: [{\r\n        firstName: '',\r\n        lastName: '',\r\n        class: '',\r\n        dateOfBirth: '',\r\n        placeOfBirth: '',\r\n        photo: '/public/assets/images/no_image.png',\r\n        username: '',\r\n        password: '',\r\n        studentId: ''\r\n      }]\r\n    });\r\n  };\r\n\r\n  // Fonctions pour la gestion des parents existants\r\n  const searchParents = (searchTerm) => {\r\n    if (!searchTerm) return existingParents;\r\n    \r\n    return existingParents.filter(parent => \r\n      parent.firstName.toLowerCase().includes(searchTerm.toLowerCase()) ||\r\n      parent.lastName.toLowerCase().includes(searchTerm.toLowerCase()) ||\r\n      parent.email.toLowerCase().includes(searchTerm.toLowerCase()) ||\r\n      parent.phone.includes(searchTerm)\r\n    );\r\n  };\r\n\r\n  const selectExistingParent = (parent) => {\r\n    setSelectedExistingParent(parent);\r\n    setFamilyData(prev => ({\r\n      ...prev,\r\n      parent: {\r\n        firstName: parent.firstName,\r\n        lastName: parent.lastName,\r\n        email: parent.email,\r\n        phone: parent.phone,\r\n        address: parent.address,\r\n        occupation: parent.occupation,\r\n        primaryLogin: parent.primaryLogin,\r\n        secondaryLogin: parent.secondaryLogin,\r\n        customUsername: parent.customUsername,\r\n        userId: parent.userId,\r\n        canLoginWithEmail: parent.canLoginWithEmail,\r\n        canLoginWithPhone: parent.canLoginWithPhone,\r\n        password: '' // Pas de mot de passe car le compte existe d√©j√†\r\n      }\r\n    }));\r\n  };\r\n\r\n  const addStudent = () => {\r\n    setFamilyData(prev => ({\r\n      ...prev,\r\n      students: [...prev.students, {\r\n        firstName: '',\r\n        lastName: '',\r\n        class: '',\r\n        dateOfBirth: '',\r\n        placeOfBirth: '',\r\n        photo: '/public/assets/images/no_image.png',\r\n        username: '',\r\n        password: '',\r\n        studentId: ''\r\n      }]\r\n    }));\r\n  };\r\n\r\n  const removeStudent = (index) => {\r\n    if (familyData.students.length > 1) {\r\n      setFamilyData(prev => ({\r\n        ...prev,\r\n        students: prev.students.filter((_, i) => i !== index)\r\n      }));\r\n    }\r\n  };\r\n\r\n  const generateAccountsData = () => {\r\n    // Si c'est un nouveau parent sans email, g√©n√©rer un email automatique\r\n    if (inscriptionMode === 'new' && !familyData.parent.email) {\r\n      const cleanPhone = familyData.parent.phone.replace(/\\s+/g, '').replace(/\\+/g, '');\r\n      familyData.parent.email = `parent${cleanPhone}@edutrack.cm`;\r\n      console.log('üìß Email g√©n√©r√© automatiquement pour parent:', familyData.parent.email);\r\n    }\r\n\r\n    // G√©n√©rer les identifiants des √©l√®ves\r\n    const studentsWithAccounts = familyData.students.map(student => {\r\n      const loginCreds = generateLoginCredentials(\r\n        student.firstName, \r\n        student.lastName, \r\n        '', // Les √©l√®ves n'ont g√©n√©ralement pas d'email personnel\r\n        '', // Les √©l√®ves n'ont g√©n√©ralement pas de t√©l√©phone personnel\r\n        'student'\r\n      );\r\n      \r\n      return {\r\n        ...student,\r\n        primaryLogin: loginCreds.primaryLogin || loginCreds.customUsername,\r\n        secondaryLogin: loginCreds.secondaryLogin,\r\n        customUsername: loginCreds.customUsername,\r\n        password: generateSecurePassword(),\r\n        studentId: generateUserId('student'),\r\n        canLoginWithEmail: loginCreds.canLoginWithEmail,\r\n        canLoginWithPhone: loginCreds.canLoginWithPhone\r\n      };\r\n    });\r\n\r\n    // Si c'est un nouveau parent, g√©n√©rer ses identifiants aussi\r\n    if (inscriptionMode === 'new') {\r\n      const parentLoginCreds = generateLoginCredentials(\r\n        familyData.parent.firstName,\r\n        familyData.parent.lastName,\r\n        familyData.parent.email,\r\n        familyData.parent.phone,\r\n        'parent'\r\n      );\r\n      \r\n      const parentPassword = generateSecurePassword();\r\n      const parentUserId = generateUserId('parent');\r\n\r\n      setFamilyData(prev => ({\r\n        ...prev,\r\n        parent: {\r\n          ...prev.parent,\r\n          email: familyData.parent.email, // Utiliser l'email g√©n√©r√© si applicable\r\n          primaryLogin: parentLoginCreds.primaryLogin || parentLoginCreds.customUsername,\r\n          secondaryLogin: parentLoginCreds.secondaryLogin,\r\n          customUsername: parentLoginCreds.customUsername,\r\n          password: parentPassword,\r\n          userId: parentUserId,\r\n          canLoginWithEmail: parentLoginCreds.canLoginWithEmail,\r\n          canLoginWithPhone: parentLoginCreds.canLoginWithPhone\r\n        },\r\n        students: studentsWithAccounts\r\n      }));\r\n    } else {\r\n      // Parent existant : conserver ses identifiants, g√©n√©rer seulement ceux des √©l√®ves\r\n      setFamilyData(prev => ({\r\n        ...prev,\r\n        students: studentsWithAccounts\r\n      }));\r\n    }\r\n  };\r\n\r\n  const getStatusBadge = (status) => {\r\n    const statusConfig = {\r\n      active: { label: 'Actif', className: 'bg-success/10 text-success' },\r\n      pending: { label: 'En attente', className: 'bg-warning/10 text-warning' },\r\n      transferred: { label: 'Transf√©r√©', className: 'bg-muted text-muted-foreground' }\r\n    };\r\n    \r\n    const config = statusConfig?.[status] || statusConfig?.active;\r\n    return (\r\n      <span className={`px-2 py-1 rounded-full text-xs font-caption font-caption-normal ${config?.className}`}>\r\n        {config?.label}\r\n      </span>\r\n    );\r\n  };\r\n\r\n  const filteredStudents = students?.filter(student => {\r\n    const matchesSearch = student?.name?.toLowerCase()?.includes(searchTerm?.toLowerCase()) ||\r\n                         student?.parentName?.toLowerCase()?.includes(searchTerm?.toLowerCase()) ||\r\n                         student?.studentId?.toLowerCase()?.includes(searchTerm?.toLowerCase());\r\n    const matchesClass = !filterClass || student?.class === filterClass;\r\n    const matchesStatus = !filterStatus || student?.enrollmentStatus === filterStatus;\r\n    \r\n    return matchesSearch && matchesClass && matchesStatus;\r\n  });\r\n\r\n  const handleTransferStudent = (studentId) => {\r\n    const student = students.find(s => s.id === studentId);\r\n    if (student) {\r\n      setSelectedStudent(student);\r\n      setShowTransferModal(true);\r\n    }\r\n  };\r\n\r\n  const handleViewProfile = (studentId) => {\r\n    const student = students.find(s => s.id === studentId);\r\n    if (student) {\r\n      setSelectedStudent(student);\r\n      setShowProfileModal(true);\r\n    }\r\n  };\r\n\r\n  const handleAddStudent = () => {\r\n    resetWorkflow();\r\n    setShowAddModal(true);\r\n  };\r\n\r\n  const handleSaveNewStudent = () => {\r\n    if (newStudent.name && newStudent.class && newStudent.parentName) {\r\n      const student = {\r\n        id: students.length + 1,\r\n        name: newStudent.name,\r\n        class: newStudent.class,\r\n        enrollmentStatus: \"pending\",\r\n        photo: newStudent.photo,\r\n        parentName: newStudent.parentName,\r\n        parentPhone: newStudent.parentPhone,\r\n        parentEmail: newStudent.parentEmail,\r\n        enrollmentDate: new Date().toLocaleDateString('fr-FR'),\r\n        studentId: `STU${String(students.length + 1).padStart(3, '0')}`\r\n      };\r\n      setStudents([...students, student]);\r\n      setNewStudent({\r\n        name: '',\r\n        class: '',\r\n        parentName: '',\r\n        parentPhone: '',\r\n        parentEmail: '',\r\n        photo: '/public/assets/images/no_image.png'\r\n      });\r\n      setShowAddModal(false);\r\n    }\r\n  };\r\n\r\n  const handleUpdateStudentStatus = (studentId, newStatus) => {\r\n    setStudents(students.map(student => \r\n      student.id === studentId \r\n        ? { ...student, enrollmentStatus: newStatus }\r\n        : student\r\n    ));\r\n  };\r\n\r\n  const handleConfirmTransfer = () => {\r\n    if (selectedStudent) {\r\n      handleUpdateStudentStatus(selectedStudent.id, 'transferred');\r\n      setShowTransferModal(false);\r\n      setSelectedStudent(null);\r\n    }\r\n  };\r\n\r\n  // Indicateur de chargement\r\n  if (loading) {\r\n    return (\r\n      <div className=\"flex items-center justify-center py-12\">\r\n        <div className=\"text-center\">\r\n          <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4\"></div>\r\n          <p className=\"text-text-secondary\">Chargement des √©l√®ves...</p>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      {/* No students indicator */}\r\n      {students.length === 0 && (\r\n        <div className=\"bg-blue-50 border border-blue-200 rounded-lg p-4\">\r\n          <div className=\"flex items-start space-x-3\">\r\n            <Icon name=\"Info\" size={20} className=\"text-blue-600 mt-0.5\" />\r\n            <div>\r\n              <h4 className=\"font-body font-body-semibold text-blue-900 mb-1\">\r\n                Aucun √©l√®ve enregistr√©\r\n              </h4>\r\n              <p className=\"text-sm text-blue-700\">\r\n                Aucun √©l√®ve n'a encore √©t√© inscrit. Cliquez sur \"Nouvel √âl√®ve\" pour commencer les inscriptions.\r\n              </p>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Header with Actions */}\r\n      <div className=\"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4\">\r\n        <div>\r\n          <h2 className=\"font-heading font-heading-bold text-xl text-text-primary\">\r\n            Gestion des √âl√®ves\r\n          </h2>\r\n          <p className=\"font-body font-body-normal text-sm text-text-secondary mt-1\">\r\n            G√©rez les inscriptions et profils des √©l√®ves\r\n          </p>\r\n        </div>\r\n        <Button\r\n          variant=\"default\"\r\n          iconName=\"UserPlus\"\r\n          iconPosition=\"left\"\r\n          onClick={handleAddStudent}\r\n        >\r\n          Nouvel √âl√®ve\r\n        </Button>\r\n      </div>\r\n      {/* Filters */}\r\n      <div className=\"bg-card rounded-lg border border-border p-4\">\r\n        <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\r\n          <Input\r\n            type=\"search\"\r\n            placeholder=\"Rechercher par nom, parent ou ID...\"\r\n            value={searchTerm}\r\n            onChange={(e) => setSearchTerm(e?.target?.value)}\r\n            className=\"w-full\"\r\n          />\r\n          <Select\r\n            placeholder=\"Filtrer par classe\"\r\n            options={classOptions}\r\n            value={filterClass}\r\n            onChange={setFilterClass}\r\n          />\r\n          <Select\r\n            placeholder=\"Filtrer par statut\"\r\n            options={statusOptions}\r\n            value={filterStatus}\r\n            onChange={setFilterStatus}\r\n          />\r\n        </div>\r\n      </div>\r\n      {/* Students Table */}\r\n      <div className=\"bg-card rounded-lg border border-border overflow-hidden\">\r\n        <div className=\"overflow-x-auto\">\r\n          <table className=\"w-full\">\r\n            <thead className=\"bg-muted\">\r\n              <tr>\r\n                <th className=\"text-left p-4 font-heading font-heading-semibold text-sm text-text-primary\">\r\n                  √âl√®ve\r\n                </th>\r\n                <th className=\"text-left p-4 font-heading font-heading-semibold text-sm text-text-primary\">\r\n                  Classe\r\n                </th>\r\n                <th className=\"text-left p-4 font-heading font-heading-semibold text-sm text-text-primary\">\r\n                  Parent/Tuteur\r\n                </th>\r\n                <th className=\"text-left p-4 font-heading font-heading-semibold text-sm text-text-primary\">\r\n                  Statut\r\n                </th>\r\n                <th className=\"text-left p-4 font-heading font-heading-semibold text-sm text-text-primary\">\r\n                  Date d'inscription\r\n                </th>\r\n                <th className=\"text-right p-4 font-heading font-heading-semibold text-sm text-text-primary\">\r\n                  Actions\r\n                </th>\r\n              </tr>\r\n            </thead>\r\n            <tbody>\r\n              {filteredStudents?.map((student) => (\r\n                <tr key={student?.id} className=\"border-t border-border hover:bg-muted/50 transition-micro\">\r\n                  <td className=\"p-4\">\r\n                    <div className=\"flex items-center space-x-3\">\r\n                      <div className=\"w-10 h-10 rounded-full overflow-hidden bg-muted\">\r\n                        <Image\r\n                          src={student?.photo}\r\n                          alt={student?.name}\r\n                          className=\"w-full h-full object-cover\"\r\n                        />\r\n                      </div>\r\n                      <div>\r\n                        <p className=\"font-body font-body-semibold text-sm text-text-primary\">\r\n                          {student?.name}\r\n                        </p>\r\n                        <p className=\"font-caption font-caption-normal text-xs text-text-secondary\">\r\n                          ID: {student?.studentId}\r\n                        </p>\r\n                      </div>\r\n                    </div>\r\n                  </td>\r\n                  <td className=\"p-4\">\r\n                    <span className=\"font-body font-body-normal text-sm text-text-primary\">\r\n                      {student?.class}\r\n                    </span>\r\n                  </td>\r\n                  <td className=\"p-4\">\r\n                    <div>\r\n                      <p className=\"font-body font-body-semibold text-sm text-text-primary\">\r\n                        {student?.parentName}\r\n                      </p>\r\n                      <p className=\"font-caption font-caption-normal text-xs text-text-secondary\">\r\n                        {student?.parentPhone}\r\n                      </p>\r\n                      <p className=\"font-caption font-caption-normal text-xs text-text-secondary\">\r\n                        {student?.parentEmail}\r\n                      </p>\r\n                    </div>\r\n                  </td>\r\n                  <td className=\"p-4\">\r\n                    {getStatusBadge(student?.enrollmentStatus)}\r\n                  </td>\r\n                  <td className=\"p-4\">\r\n                    <span className=\"font-body font-body-normal text-sm text-text-primary\">\r\n                      {student?.enrollmentDate}\r\n                    </span>\r\n                  </td>\r\n                  <td className=\"p-4\">\r\n                    <div className=\"flex items-center justify-end space-x-2\">\r\n                      <Button\r\n                        variant=\"ghost\"\r\n                        size=\"icon\"\r\n                        onClick={() => handleViewProfile(student?.id)}\r\n                        title=\"Voir le profil\"\r\n                        iconName=\"Eye\"\r\n                      />\r\n                      <Button\r\n                        variant=\"ghost\"\r\n                        size=\"icon\"\r\n                        onClick={() => handleTransferStudent(student?.id)}\r\n                        title=\"Transf√©rer l'√©l√®ve\"\r\n                        iconName=\"ArrowRightLeft\"\r\n                      />\r\n                    </div>\r\n                  </td>\r\n                </tr>\r\n              ))}\r\n            </tbody>\r\n          </table>\r\n        </div>\r\n\r\n        {filteredStudents?.length === 0 && (\r\n          <div className=\"p-8 text-center\">\r\n            <Icon name=\"Users\" size={48} className=\"text-muted-foreground mx-auto mb-4\" />\r\n            <p className=\"font-body font-body-normal text-text-secondary\">\r\n              Aucun √©l√®ve trouv√© avec les crit√®res de recherche\r\n            </p>\r\n          </div>\r\n        )}\r\n      </div>\r\n      {/* Summary Stats */}\r\n      <div className=\"grid grid-cols-1 sm:grid-cols-3 gap-4\">\r\n        <div className=\"bg-card rounded-lg border border-border p-4\">\r\n          <div className=\"flex items-center space-x-3\">\r\n            <div className=\"w-10 h-10 bg-success/10 rounded-lg flex items-center justify-center\">\r\n              <Icon name=\"UserCheck\" size={20} className=\"text-success\" />\r\n            </div>\r\n            <div>\r\n              <p className=\"font-heading font-heading-semibold text-lg text-text-primary\">\r\n                {students?.filter(s => s?.enrollmentStatus === 'active')?.length}\r\n              </p>\r\n              <p className=\"font-caption font-caption-normal text-xs text-text-secondary\">\r\n                √âl√®ves actifs\r\n              </p>\r\n            </div>\r\n          </div>\r\n        </div>\r\n        \r\n        <div className=\"bg-card rounded-lg border border-border p-4\">\r\n          <div className=\"flex items-center space-x-3\">\r\n            <div className=\"w-10 h-10 bg-warning/10 rounded-lg flex items-center justify-center\">\r\n              <Icon name=\"Clock\" size={20} className=\"text-warning\" />\r\n            </div>\r\n            <div>\r\n              <p className=\"font-heading font-heading-semibold text-lg text-text-primary\">\r\n                {students?.filter(s => s?.enrollmentStatus === 'pending')?.length}\r\n              </p>\r\n              <p className=\"font-caption font-caption-normal text-xs text-text-secondary\">\r\n                En attente\r\n              </p>\r\n            </div>\r\n          </div>\r\n        </div>\r\n        \r\n        <div className=\"bg-card rounded-lg border border-border p-4\">\r\n          <div className=\"flex items-center space-x-3\">\r\n            <div className=\"w-10 h-10 bg-primary/10 rounded-lg flex items-center justify-center\">\r\n              <Icon name=\"Users\" size={20} className=\"text-primary\" />\r\n            </div>\r\n            <div>\r\n              <p className=\"font-heading font-heading-semibold text-lg text-text-primary\">\r\n                {students?.length}\r\n              </p>\r\n              <p className=\"font-caption font-caption-normal text-xs text-text-secondary\">\r\n                Total √©l√®ves\r\n              </p>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Modal Inscription Famille Compl√®te - Version Am√©lior√©e */}\r\n      {showAddModal && (\r\n        <div className=\"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50 p-4 animate-fadeIn\">\r\n          <div className=\"bg-white rounded-xl shadow-2xl max-w-5xl w-full max-h-[95vh] overflow-hidden flex flex-col\">\r\n            {/* En-t√™te moderne avec gradient */}\r\n            <div className=\"bg-gradient-to-r from-blue-600 to-indigo-600 text-white p-6\">\r\n              <div className=\"flex items-center justify-between\">\r\n                <div className=\"flex items-center space-x-4\">\r\n                  <div className=\"w-12 h-12 bg-white/20 rounded-lg flex items-center justify-center backdrop-blur-sm\">\r\n                    <Icon name=\"UserPlus\" size={24} className=\"text-white\" />\r\n                  </div>\r\n                  <div>\r\n                    <h3 className=\"text-xl font-bold\">\r\n                      Nouvelle Inscription √âl√®ve\r\n                    </h3>\r\n                    <p className=\"text-blue-100 text-sm mt-1\">\r\n                      {currentStep === 1 && 'Informations du parent/tuteur'}\r\n                      {currentStep === 2 && 'Informations de l\\'√©l√®ve'}\r\n                      {currentStep === 3 && 'V√©rification et cr√©ation des comptes'}\r\n                    </p>\r\n                  </div>\r\n                </div>\r\n                <button\r\n                  onClick={() => {\r\n                    setShowAddModal(false);\r\n                    resetWorkflow();\r\n                  }}\r\n                  className=\"w-10 h-10 rounded-lg bg-white/10 hover:bg-white/20 flex items-center justify-center transition-colors\"\r\n                >\r\n                  <Icon name=\"X\" size={20} className=\"text-white\" />\r\n                </button>\r\n              </div>\r\n            </div>\r\n\r\n            {/* Indicateur de progression moderne */}\r\n            <div className=\"px-6 py-6 bg-gray-50 border-b border-gray-200\">\r\n              <div className=\"flex items-center justify-between max-w-2xl mx-auto\">\r\n                {[\r\n                  { num: 1, label: 'Parent', icon: 'User' },\r\n                  { num: 2, label: '√âl√®ve', icon: 'GraduationCap' },\r\n                  { num: 3, label: 'Validation', icon: 'CheckCircle' }\r\n                ].map((step, idx) => (\r\n                  <React.Fragment key={step.num}>\r\n                    <div className=\"flex flex-col items-center\">\r\n                      <div className={`relative w-14 h-14 rounded-full flex items-center justify-center transition-all duration-300 ${\r\n                        step.num === currentStep \r\n                          ? 'bg-blue-600 text-white shadow-lg shadow-blue-300 scale-110' \r\n                          : step.num < currentStep \r\n                          ? 'bg-green-500 text-white shadow-md' \r\n                          : 'bg-gray-200 text-gray-400'\r\n                      }`}>\r\n                        {step.num < currentStep ? (\r\n                          <Icon name=\"Check\" size={24} className=\"animate-scaleIn\" />\r\n                        ) : (\r\n                          <Icon name={step.icon} size={24} />\r\n                        )}\r\n                        {step.num === currentStep && (\r\n                          <div className=\"absolute inset-0 rounded-full bg-blue-600 animate-ping opacity-20\"></div>\r\n                        )}\r\n                      </div>\r\n                      <span className={`mt-2 text-sm font-medium transition-colors ${\r\n                        step.num === currentStep \r\n                          ? 'text-blue-600' \r\n                          : step.num < currentStep \r\n                          ? 'text-green-600' \r\n                          : 'text-gray-400'\r\n                      }`}>\r\n                        {step.label}\r\n                      </span>\r\n                    </div>\r\n                    {idx < 2 && (\r\n                      <div className=\"flex-1 h-1 mx-4 mb-8 rounded-full overflow-hidden bg-gray-200\">\r\n                        <div \r\n                          className={`h-full transition-all duration-500 ${\r\n                            step.num < currentStep ? 'bg-green-500 w-full' : 'bg-gray-200 w-0'\r\n                          }`}\r\n                        />\r\n                      </div>\r\n                    )}\r\n                  </React.Fragment>\r\n                ))}\r\n              </div>\r\n            </div>\r\n            \r\n            {/* Contenu des √©tapes avec scroll */}\r\n            <div className=\"flex-1 overflow-y-auto\">\r\n              <div className=\"p-8\">\r\n                {currentStep === 1 && (\r\n                  <div className=\"space-y-8 max-w-4xl mx-auto\">\r\n                    {/* Choix du mode d'inscription - Design am√©lior√© */}\r\n                    <div>\r\n                      <h4 className=\"text-lg font-semibold text-gray-900 mb-2\">\r\n                        Type d'inscription\r\n                      </h4>\r\n                      <p className=\"text-gray-600 text-sm mb-6\">\r\n                        S√©lectionnez le type de parent pour cette inscription\r\n                      </p>\r\n                      \r\n                      <div className=\"grid grid-cols-1 md:grid-cols-2 gap-5\">\r\n                        <button\r\n                          onClick={() => setInscriptionMode('new')}\r\n                          className={`group relative overflow-hidden rounded-xl p-6 text-left transition-all duration-300 ${\r\n                            inscriptionMode === 'new'\r\n                              ? 'bg-gradient-to-br from-blue-50 to-indigo-50 border-2 border-blue-500 shadow-lg shadow-blue-200'\r\n                              : 'bg-white border-2 border-gray-200 hover:border-blue-300 hover:shadow-md'\r\n                          }`}\r\n                        >\r\n                          <div className=\"flex items-start space-x-4\">\r\n                            <div className={`w-12 h-12 rounded-lg flex items-center justify-center transition-colors ${\r\n                              inscriptionMode === 'new'\r\n                                ? 'bg-blue-600 text-white shadow-md'\r\n                                : 'bg-gray-100 text-gray-600 group-hover:bg-blue-100 group-hover:text-blue-600'\r\n                            }`}>\r\n                              <Icon name=\"UserPlus\" size={24} />\r\n                            </div>\r\n                            <div className=\"flex-1\">\r\n                              <h5 className=\"font-semibold text-gray-900 mb-1 flex items-center\">\r\n                                Nouveau Parent\r\n                                {inscriptionMode === 'new' && (\r\n                                  <Icon name=\"CheckCircle\" size={18} className=\"ml-2 text-blue-600\" />\r\n                                )}\r\n                              </h5>\r\n                              <p className=\"text-sm text-gray-600\">\r\n                                Cr√©er un nouveau compte parent pour cette famille\r\n                              </p>\r\n                              <div className=\"mt-3 text-xs text-gray-500 flex items-center\">\r\n                                <Icon name=\"Info\" size={14} className=\"mr-1\" />\r\n                                Premier enfant de la famille\r\n                              </div>\r\n                            </div>\r\n                          </div>\r\n                        </button>\r\n\r\n                        <button\r\n                          onClick={() => setInscriptionMode('existing')}\r\n                          className={`group relative overflow-hidden rounded-xl p-6 text-left transition-all duration-300 ${\r\n                            inscriptionMode === 'existing'\r\n                              ? 'bg-gradient-to-br from-green-50 to-emerald-50 border-2 border-green-500 shadow-lg shadow-green-200'\r\n                              : 'bg-white border-2 border-gray-200 hover:border-green-300 hover:shadow-md'\r\n                          }`}\r\n                        >\r\n                          <div className=\"flex items-start space-x-4\">\r\n                            <div className={`w-12 h-12 rounded-lg flex items-center justify-center transition-colors ${\r\n                              inscriptionMode === 'existing'\r\n                                ? 'bg-green-600 text-white shadow-md'\r\n                                : 'bg-gray-100 text-gray-600 group-hover:bg-green-100 group-hover:text-green-600'\r\n                            }`}>\r\n                              <Icon name=\"Users\" size={24} />\r\n                            </div>\r\n                            <div className=\"flex-1\">\r\n                              <h5 className=\"font-semibold text-gray-900 mb-1 flex items-center\">\r\n                                Parent Existant\r\n                                {inscriptionMode === 'existing' && (\r\n                                  <Icon name=\"CheckCircle\" size={18} className=\"ml-2 text-green-600\" />\r\n                                )}\r\n                              </h5>\r\n                              <p className=\"text-sm text-gray-600\">\r\n                                Associer l'√©l√®ve √† un parent d√©j√† inscrit\r\n                              </p>\r\n                              <div className=\"mt-3 text-xs text-gray-500 flex items-center\">\r\n                                <Icon name=\"Info\" size={14} className=\"mr-1\" />\r\n                                Fr√®re/s≈ìur d'un √©l√®ve existant\r\n                              </div>\r\n                            </div>\r\n                          </div>\r\n                        </button>\r\n                      </div>\r\n                    </div>\r\n\r\n                    {/* Formulaire nouveau parent - Design modernis√© */}\r\n                    {inscriptionMode === 'new' && (\r\n                      <div className=\"space-y-6 animate-fadeIn\">\r\n                        <div className=\"bg-gradient-to-r from-blue-50 to-indigo-50 rounded-xl p-6 border border-blue-200\">\r\n                          <div className=\"flex items-start space-x-3\">\r\n                            <div className=\"w-10 h-10 bg-blue-600 rounded-lg flex items-center justify-center flex-shrink-0\">\r\n                              <Icon name=\"User\" size={20} className=\"text-white\" />\r\n                            </div>\r\n                            <div className=\"flex-1\">\r\n                              <h5 className=\"font-semibold text-gray-900 mb-1\">\r\n                                Informations du Parent/Tuteur\r\n                              </h5>\r\n                              <p className=\"text-sm text-gray-600 mb-3\">\r\n                                Ces informations seront utilis√©es pour cr√©er le compte parent. Le parent pourra se connecter avec son email ou son t√©l√©phone.\r\n                              </p>\r\n                              <div className=\"bg-white/60 rounded-lg p-3 border border-blue-200\">\r\n                                <div className=\"flex items-start space-x-2\">\r\n                                  <Icon name=\"Info\" size={16} className=\"text-blue-600 mt-0.5 flex-shrink-0\" />\r\n                                  <div className=\"text-xs text-gray-700\">\r\n                                    <strong>üìß Email optionnel :</strong> Si le parent n'a pas d'email, un email technique sera g√©n√©r√© automatiquement au format <span className=\"font-mono bg-blue-100 px-1 rounded\">parent[t√©l√©phone]@edutrack.cm</span>\r\n                                  </div>\r\n                                </div>\r\n                              </div>\r\n                            </div>\r\n                          </div>\r\n                        </div>\r\n                        \r\n                        <div className=\"bg-white rounded-xl border-2 border-gray-200 p-6\">\r\n                          <div className=\"grid grid-cols-1 md:grid-cols-2 gap-5\">\r\n                            <div>\r\n                              <label className=\"block text-sm font-medium text-gray-700 mb-2\">\r\n                                Pr√©nom du parent <span className=\"text-red-500\">*</span>\r\n                              </label>\r\n                              <Input\r\n                                placeholder=\"Ex: Jean\"\r\n                                value={familyData.parent.firstName}\r\n                                onChange={(e) => setFamilyData(prev => ({\r\n                                  ...prev,\r\n                                  parent: { ...prev.parent, firstName: e.target.value }\r\n                                }))}\r\n                                className=\"h-11\"\r\n                                required\r\n                              />\r\n                            </div>\r\n                            \r\n                            <div>\r\n                              <label className=\"block text-sm font-medium text-gray-700 mb-2\">\r\n                                Nom de famille <span className=\"text-red-500\">*</span>\r\n                              </label>\r\n                              <Input\r\n                                placeholder=\"Ex: Mbarga\"\r\n                                value={familyData.parent.lastName}\r\n                                onChange={(e) => setFamilyData(prev => ({\r\n                                  ...prev,\r\n                                  parent: { ...prev.parent, lastName: e.target.value }\r\n                                }))}\r\n                                className=\"h-11\"\r\n                                required\r\n                              />\r\n                            </div>\r\n                            \r\n                            <div>\r\n                              <label className=\"block text-sm font-medium text-gray-700 mb-2\">\r\n                                Email\r\n                              </label>\r\n                              <div className=\"relative\">\r\n                                <div className=\"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none\">\r\n                                  <Icon name=\"Mail\" size={18} className=\"text-gray-400\" />\r\n                                </div>\r\n                                <Input\r\n                                  type=\"email\"\r\n                                  placeholder=\"jean.mbarga@email.com (optionnel)\"\r\n                                  value={familyData.parent.email}\r\n                                  onChange={(e) => setFamilyData(prev => ({\r\n                                    ...prev,\r\n                                    parent: { ...prev.parent, email: e.target.value }\r\n                                  }))}\r\n                                  className=\"h-11 pl-10\"\r\n                                />\r\n                              </div>\r\n                              <p className=\"text-xs text-gray-500 mt-1\">\r\n                                üí° Si non fourni, un email technique sera g√©n√©r√© automatiquement\r\n                              </p>\r\n                            </div>\r\n                            \r\n                            <div>\r\n                              <label className=\"block text-sm font-medium text-gray-700 mb-2\">\r\n                                T√©l√©phone <span className=\"text-red-500\">*</span>\r\n                              </label>\r\n                              <div className=\"relative\">\r\n                                <div className=\"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none\">\r\n                                  <Icon name=\"Phone\" size={18} className=\"text-gray-400\" />\r\n                                </div>\r\n                                <Input\r\n                                  placeholder=\"+237 6XX XX XX XX\"\r\n                                  value={familyData.parent.phone}\r\n                                  onChange={(e) => setFamilyData(prev => ({\r\n                                    ...prev,\r\n                                    parent: { ...prev.parent, phone: e.target.value }\r\n                                  }))}\r\n                                  className=\"h-11 pl-10\"\r\n                                  required\r\n                                />\r\n                              </div>\r\n                            </div>\r\n                            \r\n                            <div>\r\n                              <label className=\"block text-sm font-medium text-gray-700 mb-2\">\r\n                                Adresse\r\n                              </label>\r\n                              <div className=\"relative\">\r\n                                <div className=\"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none\">\r\n                                  <Icon name=\"MapPin\" size={18} className=\"text-gray-400\" />\r\n                                </div>\r\n                                <Input\r\n                                  placeholder=\"Quartier, Ville\"\r\n                                  value={familyData.parent.address}\r\n                                  onChange={(e) => setFamilyData(prev => ({\r\n                                    ...prev,\r\n                                    parent: { ...prev.parent, address: e.target.value }\r\n                                  }))}\r\n                                  className=\"h-11 pl-10\"\r\n                                />\r\n                              </div>\r\n                            </div>\r\n                            \r\n                            <div>\r\n                              <label className=\"block text-sm font-medium text-gray-700 mb-2\">\r\n                                Profession\r\n                              </label>\r\n                              <div className=\"relative\">\r\n                                <div className=\"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none\">\r\n                                  <Icon name=\"Briefcase\" size={18} className=\"text-gray-400\" />\r\n                                </div>\r\n                                <Input\r\n                                  placeholder=\"Ex: Enseignant, Commer√ßant...\"\r\n                                  value={familyData.parent.occupation}\r\n                                  onChange={(e) => setFamilyData(prev => ({\r\n                                    ...prev,\r\n                                    parent: { ...prev.parent, occupation: e.target.value }\r\n                                  }))}\r\n                                  className=\"h-11 pl-10\"\r\n                                />\r\n                              </div>\r\n                            </div>\r\n                          </div>\r\n                        </div>\r\n                      </div>\r\n                    )}\r\n\r\n                    {/* Recherche parent existant - Design modernis√© */}\r\n                    {inscriptionMode === 'existing' && (\r\n                      <div className=\"space-y-6 animate-fadeIn\">\r\n                        <div className=\"bg-gradient-to-r from-green-50 to-emerald-50 rounded-xl p-6 border border-green-200\">\r\n                          <div className=\"flex items-start space-x-3\">\r\n                            <div className=\"w-10 h-10 bg-green-600 rounded-lg flex items-center justify-center flex-shrink-0\">\r\n                              <Icon name=\"Search\" size={20} className=\"text-white\" />\r\n                            </div>\r\n                            <div>\r\n                              <h5 className=\"font-semibold text-gray-900 mb-1\">\r\n                                Syst√®me Multi-√âtablissements\r\n                              </h5>\r\n                              <p className=\"text-sm text-gray-600 mb-3\">\r\n                                Recherchez si le parent existe d√©j√† dans le syst√®me global pour √©viter les doublons.\r\n                              </p>\r\n                              <div className=\"flex flex-wrap gap-2 text-xs\">\r\n                                <span className=\"inline-flex items-center px-2.5 py-1 rounded-full bg-green-100 text-green-700 font-medium\">\r\n                                  <Icon name=\"CheckCircle\" size={14} className=\"mr-1\" />\r\n                                  Un parent = Un compte\r\n                                </span>\r\n                                <span className=\"inline-flex items-center px-2.5 py-1 rounded-full bg-blue-100 text-blue-700 font-medium\">\r\n                                  <Icon name=\"Building\" size={14} className=\"mr-1\" />\r\n                                  Plusieurs √©tablissements\r\n                                </span>\r\n                                <span className=\"inline-flex items-center px-2.5 py-1 rounded-full bg-purple-100 text-purple-700 font-medium\">\r\n                                  <Icon name=\"Users\" size={14} className=\"mr-1\" />\r\n                                  Plusieurs enfants\r\n                                </span>\r\n                              </div>\r\n                            </div>\r\n                          </div>\r\n                        </div>\r\n\r\n                        <div className=\"bg-white rounded-xl border-2 border-gray-200 p-6\">\r\n                          <ParentSearchSelector\r\n                            onParentSelect={(parent) => {\r\n                              setSelectedExistingParent(parent);\r\n                              if (parent) {\r\n                                setFamilyData(prev => ({\r\n                                  ...prev,\r\n                                  parent: {\r\n                                    firstName: parent.firstName,\r\n                                    lastName: parent.lastName,\r\n                                    email: parent.email,\r\n                                    phone: parent.phone,\r\n                                    address: parent.address || '',\r\n                                    occupation: parent.profession || '',\r\n                                    username: '',\r\n                                    password: '',\r\n                                    userId: parent.id\r\n                                  }\r\n                                }));\r\n                              }\r\n                            }}\r\n                            onCreateNew={() => {\r\n                              setInscriptionMode('new');\r\n                              setSelectedExistingParent(null);\r\n                              setParentSearchTerm('');\r\n                            }}\r\n                            selectedParent={selectedExistingParent}\r\n                            searchTerm={parentSearchTerm}\r\n                            onSearchChange={setParentSearchTerm}\r\n                          />\r\n                        </div>\r\n                      </div>\r\n                    )}\r\n                  </div>\r\n                )}\r\n\r\n              {currentStep === 2 && (\r\n                <div className=\"space-y-6 animate-fadeIn\">\r\n                  {/* En-t√™te de l'√©tape 2 - Modern design */}\r\n                  <div className=\"bg-gradient-to-br from-blue-50 to-indigo-50 rounded-xl p-6 text-center border border-blue-200\">\r\n                    <div className=\"w-16 h-16 bg-gradient-to-br from-blue-600 to-indigo-600 rounded-2xl flex items-center justify-center mx-auto mb-3 shadow-lg shadow-blue-200\">\r\n                      <Icon name=\"GraduationCap\" size={32} className=\"text-white\" />\r\n                    </div>\r\n                    <h4 className=\"font-heading font-heading-semibold text-xl text-gray-900 mb-1\">\r\n                      Informations des √âl√®ves\r\n                    </h4>\r\n                    <p className=\"text-sm text-gray-600\">\r\n                      Ajoutez un ou plusieurs enfants √† inscrire dans cet √©tablissement\r\n                      {currentSchool && (\r\n                        <span className=\"block mt-1 font-medium text-blue-700\">\r\n                          üìç {currentSchool.name}\r\n                        </span>\r\n                      )}\r\n                    </p>\r\n                  </div>\r\n\r\n                  {/* Avertissement si aucune classe disponible */}\r\n                  {schoolClasses.length === 0 && (\r\n                    <div className=\"bg-yellow-50 border border-yellow-200 rounded-xl p-4\">\r\n                      <div className=\"flex items-start space-x-3\">\r\n                        <Icon name=\"AlertTriangle\" size={20} className=\"text-yellow-600 mt-0.5\" />\r\n                        <div>\r\n                          <h5 className=\"font-semibold text-yellow-900 mb-1\">Aucune classe disponible</h5>\r\n                          <p className=\"text-sm text-yellow-700\">\r\n                            Aucune classe n'a √©t√© configur√©e pour cet √©tablissement. Contactez l'administrateur pour configurer les classes disponibles.\r\n                          </p>\r\n                        </div>\r\n                      </div>\r\n                    </div>\r\n                  )}\r\n\r\n                  {familyData.students.map((student, index) => (\r\n                    <div key={`student-${index}-${student.firstName || 'new'}`} className=\"bg-white border-2 border-gray-200 rounded-xl p-6 space-y-5 shadow-sm hover:shadow-md transition-shadow duration-200\">\r\n                      <div className=\"flex items-center justify-between pb-4 border-b border-gray-200\">\r\n                        <div className=\"flex items-center space-x-3\">\r\n                          <div className=\"w-10 h-10 bg-gradient-to-br from-blue-500 to-indigo-500 rounded-lg flex items-center justify-center\">\r\n                            <Icon name=\"User\" size={20} className=\"text-white\" />\r\n                          </div>\r\n                          <div>\r\n                            <h5 className=\"font-heading font-heading-semibold text-base text-gray-900\">\r\n                              √âl√®ve {index + 1}\r\n                            </h5>\r\n                            <p className=\"text-xs text-gray-500\">Informations scolaires</p>\r\n                          </div>\r\n                        </div>\r\n                        {familyData.students.length > 1 && (\r\n                          <button\r\n                            onClick={() => removeStudent(index)}\r\n                            className=\"inline-flex items-center px-3 py-1.5 text-xs font-medium text-red-600 hover:text-red-700 hover:bg-red-50 rounded-lg transition-colors\"\r\n                          >\r\n                            <Icon name=\"Trash2\" size={14} className=\"mr-1\" />\r\n                            Supprimer\r\n                          </button>\r\n                        )}\r\n                      </div>\r\n                      \r\n                      <div className=\"grid grid-cols-1 md:grid-cols-2 gap-5\">\r\n                        <div>\r\n                          <label className=\"block text-sm font-medium text-gray-700 mb-2\">\r\n                            Pr√©nom de l'√©l√®ve <span className=\"text-red-500\">*</span>\r\n                          </label>\r\n                          <div className=\"relative\">\r\n                            <div className=\"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none\">\r\n                              <Icon name=\"User\" size={18} className=\"text-gray-400\" />\r\n                            </div>\r\n                            <Input\r\n                              placeholder=\"Ex: Marie\"\r\n                              value={student.firstName}\r\n                              onChange={(e) => {\r\n                                const updatedStudents = [...familyData.students];\r\n                                updatedStudents[index].firstName = e.target.value;\r\n                                setFamilyData(prev => ({ ...prev, students: updatedStudents }));\r\n                              }}\r\n                              className=\"h-11 pl-10\"\r\n                              required\r\n                            />\r\n                          </div>\r\n                        </div>\r\n                        \r\n                        <div>\r\n                          <label className=\"block text-sm font-medium text-gray-700 mb-2\">\r\n                            Nom de famille <span className=\"text-red-500\">*</span>\r\n                          </label>\r\n                          <div className=\"relative\">\r\n                            <div className=\"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none\">\r\n                              <Icon name=\"User\" size={18} className=\"text-gray-400\" />\r\n                            </div>\r\n                            <Input\r\n                              placeholder=\"Ex: Mbarga\"\r\n                              value={student.lastName}\r\n                              onChange={(e) => {\r\n                                const updatedStudents = [...familyData.students];\r\n                                updatedStudents[index].lastName = e.target.value;\r\n                                setFamilyData(prev => ({ ...prev, students: updatedStudents }));\r\n                              }}\r\n                              className=\"h-11 pl-10\"\r\n                              required\r\n                            />\r\n                          </div>\r\n                        </div>\r\n                        \r\n                        <div>\r\n                          <label className=\"block text-sm font-medium text-gray-700 mb-2\">\r\n                            Classe <span className=\"text-red-500\">*</span>\r\n                          </label>\r\n                          <div className=\"relative\">\r\n                            <div className=\"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none z-10\">\r\n                              <Icon name=\"BookOpen\" size={18} className=\"text-gray-400\" />\r\n                            </div>\r\n                            <Select\r\n                              options={schoolClasses.map(cls => ({\r\n                                value: cls.name,\r\n                                label: cls.name\r\n                              }))}\r\n                              value={student.class}\r\n                              onChange={(value) => {\r\n                                const updatedStudents = [...familyData.students];\r\n                                updatedStudents[index].class = value;\r\n                                setFamilyData(prev => ({ ...prev, students: updatedStudents }));\r\n                              }}\r\n                              className=\"h-11 pl-10\"\r\n                              required\r\n                            />\r\n                          </div>\r\n                        </div>\r\n                        \r\n                        <div>\r\n                          <label className=\"block text-sm font-medium text-gray-700 mb-2\">\r\n                            Date de naissance <span className=\"text-red-500\">*</span>\r\n                          </label>\r\n                          <div className=\"relative\">\r\n                            <div className=\"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none\">\r\n                              <Icon name=\"Calendar\" size={18} className=\"text-gray-400\" />\r\n                            </div>\r\n                            <Input\r\n                              type=\"date\"\r\n                              value={student.dateOfBirth}\r\n                              onChange={(e) => {\r\n                                const updatedStudents = [...familyData.students];\r\n                                updatedStudents[index].dateOfBirth = e.target.value;\r\n                                setFamilyData(prev => ({ ...prev, students: updatedStudents }));\r\n                              }}\r\n                              className=\"h-11 pl-10\"\r\n                              required\r\n                            />\r\n                          </div>\r\n                        </div>\r\n                        \r\n                        <div>\r\n                          <label className=\"block text-sm font-medium text-gray-700 mb-2\">\r\n                            Lieu de naissance <span className=\"text-red-500\">*</span>\r\n                          </label>\r\n                          <div className=\"relative\">\r\n                            <div className=\"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none\">\r\n                              <Icon name=\"MapPin\" size={18} className=\"text-gray-400\" />\r\n                            </div>\r\n                            <Input\r\n                              type=\"text\"\r\n                              value={student.placeOfBirth || ''}\r\n                              onChange={(e) => {\r\n                                const updatedStudents = [...familyData.students];\r\n                                updatedStudents[index].placeOfBirth = e.target.value;\r\n                                setFamilyData(prev => ({ ...prev, students: updatedStudents }));\r\n                              }}\r\n                              placeholder=\"Ex: Douala, Yaound√©...\"\r\n                              className=\"h-11 pl-10\"\r\n                              required\r\n                            />\r\n                          </div>\r\n                        </div>\r\n                      </div>\r\n                    </div>\r\n                  ))}\r\n\r\n                  <button\r\n                    onClick={addStudent}\r\n                    className=\"w-full inline-flex items-center justify-center px-6 py-3.5 text-sm font-semibold text-blue-600 bg-blue-50 border-2 border-blue-200 border-dashed rounded-xl hover:bg-blue-100 hover:border-blue-300 transition-all duration-200\"\r\n                  >\r\n                    <Icon name=\"Plus\" size={18} className=\"mr-2\" />\r\n                    Ajouter un autre √©l√®ve\r\n                  </button>\r\n                </div>\r\n              )}\r\n\r\n              {currentStep === 3 && (\r\n                <div className=\"space-y-6\">\r\n                  <div className=\"text-center mb-6\">\r\n                    <Icon name=\"Shield\" size={48} className=\"text-success mx-auto mb-2\" />\r\n                    <h4 className=\"font-heading font-heading-semibold text-lg text-text-primary\">\r\n                      R√©capitulatif et Cr√©ation des Comptes\r\n                    </h4>\r\n                    <p className=\"text-sm text-text-secondary\">\r\n                      V√©rifiez les informations et g√©n√©rez les comptes d'acc√®s\r\n                    </p>\r\n                  </div>\r\n\r\n                  {(!familyData.students[0]?.customUsername) && (\r\n                    <div className=\"text-center\">\r\n                      <Button \r\n                        onClick={generateAccountsData} \r\n                        size=\"lg\" \r\n                        className=\"mb-6\"\r\n                        iconName=\"Key\"\r\n                        iconPosition=\"left\"\r\n                      >\r\n                        {inscriptionMode === 'new' ? 'G√©n√©rer les Identifiants de Connexion' : 'G√©n√©rer les Identifiants des √âl√®ves'}\r\n                      </Button>\r\n                    </div>\r\n                  )}\r\n\r\n                  {familyData.students[0]?.customUsername && (\r\n                    <div className=\"space-y-6\">\r\n                      {/* Compte Parent */}\r\n                      <div className={`border rounded-lg p-4 ${\r\n                        inscriptionMode === 'new' \r\n                          ? 'bg-success/5 border-success/20' \r\n                          : 'bg-blue/5 border-blue/20'\r\n                      }`}>\r\n                        <div className=\"flex items-center space-x-3 mb-4\">\r\n                          <div className={`w-10 h-10 rounded-lg flex items-center justify-center ${\r\n                            inscriptionMode === 'new'\r\n                              ? 'bg-success/10'\r\n                              : 'bg-blue/10'\r\n                          }`}>\r\n                            <Icon name=\"User\" size={20} className={inscriptionMode === 'new' ? 'text-success' : 'text-blue'} />\r\n                          </div>\r\n                          <div>\r\n                            <h5 className=\"font-heading font-heading-medium text-base text-text-primary\">\r\n                              {inscriptionMode === 'new' ? 'Nouveau Compte Parent' : 'Parent Existant'}\r\n                            </h5>\r\n                            <p className=\"text-sm text-text-secondary\">\r\n                              {familyData.parent.firstName} {familyData.parent.lastName}\r\n                              {inscriptionMode === 'existing' && selectedExistingParent && (\r\n                                <span className=\"ml-2 text-xs bg-blue/10 text-blue px-2 py-1 rounded\">\r\n                                  D√©j√† inscrit ‚Ä¢ {selectedExistingParent.children.length} enfant(s)\r\n                                </span>\r\n                              )}\r\n                            </p>\r\n                          </div>\r\n                        </div>\r\n                        <div className=\"space-y-4\">\r\n                          {/* Options de connexion */}\r\n                          <div className=\"bg-background/50 rounded-lg p-3\">\r\n                            <h6 className=\"font-medium text-text-primary mb-2 flex items-center\">\r\n                              <Icon name=\"Key\" size={16} className=\"mr-2\" />\r\n                              Options de Connexion\r\n                            </h6>\r\n                            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-3 text-sm\">\r\n                              {familyData.parent.canLoginWithEmail && (\r\n                                <div className=\"flex items-center space-x-2 text-success\">\r\n                                  <Icon name=\"Mail\" size={14} />\r\n                                  <span>Email: {familyData.parent.primaryLogin}</span>\r\n                                </div>\r\n                              )}\r\n                              {familyData.parent.canLoginWithPhone && (\r\n                                <div className=\"flex items-center space-x-2 text-success\">\r\n                                  <Icon name=\"Phone\" size={14} />\r\n                                  <span>T√©l: {familyData.parent.phone}</span>\r\n                                </div>\r\n                              )}\r\n                              <div className=\"flex items-center space-x-2 text-primary\">\r\n                                <Icon name=\"User\" size={14} />\r\n                                <span>Username: {familyData.parent.customUsername}</span>\r\n                              </div>\r\n                            </div>\r\n                          </div>\r\n\r\n                          {/* Informations du compte */}\r\n                          <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm\">\r\n                            <div>\r\n                              <span className=\"font-medium text-text-secondary\">ID Utilisateur:</span>\r\n                              <p className=\"font-mono bg-background p-2 rounded border mt-1\">{familyData.parent.userId}</p>\r\n                            </div>\r\n                            <div>\r\n                              <span className=\"font-medium text-text-secondary\">\r\n                                {inscriptionMode === 'new' ? 'Nouveau mot de passe:' : 'Mot de passe:'}\r\n                              </span>\r\n                              <p className=\"font-mono bg-background p-2 rounded border mt-1\">\r\n                                {inscriptionMode === 'new' ? familyData.parent.password : '‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢'}\r\n                              </p>\r\n                              {inscriptionMode === 'existing' && (\r\n                                <p className=\"text-xs text-text-secondary mt-1\">\r\n                                  Le parent utilisera son mot de passe existant\r\n                                </p>\r\n                              )}\r\n                            </div>\r\n                          </div>\r\n\r\n                          {/* Instructions de connexion */}\r\n                          <div className=\"bg-info/5 border border-info/20 rounded-lg p-3\">\r\n                            <p className=\"text-sm text-text-primary font-medium mb-1\">üí° Comment se connecter :</p>\r\n                            <ul className=\"text-xs text-text-secondary space-y-1\">\r\n                              {familyData.parent.canLoginWithEmail && (\r\n                                <li>‚Ä¢ Peut utiliser son <strong>email</strong> + mot de passe</li>\r\n                              )}\r\n                              {familyData.parent.canLoginWithPhone && (\r\n                                <li>‚Ä¢ Peut utiliser son <strong>num√©ro de t√©l√©phone</strong> + mot de passe</li>\r\n                              )}\r\n                              <li>‚Ä¢ Peut utiliser le <strong>nom d'utilisateur</strong> personnalis√© + mot de passe</li>\r\n                            </ul>\r\n                          </div>\r\n                        </div>\r\n                      </div>\r\n\r\n                      {/* Comptes √âl√®ves */}\r\n                      {familyData.students.map((student, index) => (\r\n                        <div key={index} className=\"bg-primary/5 border border-primary/20 rounded-lg p-4\">\r\n                          <div className=\"flex items-center space-x-3 mb-4\">\r\n                            <div className=\"w-10 h-10 bg-primary/10 rounded-lg flex items-center justify-center\">\r\n                              <Icon name=\"User\" size={20} className=\"text-primary\" />\r\n                            </div>\r\n                            <div>\r\n                              <h5 className=\"font-heading font-heading-medium text-base text-text-primary\">\r\n                                Compte √âl√®ve {index + 1}\r\n                              </h5>\r\n                              <p className=\"text-sm text-text-secondary\">\r\n                                {student.firstName} {student.lastName} - {student.class}\r\n                              </p>\r\n                              {(student.dateOfBirth || student.placeOfBirth) && (\r\n                                <p className=\"text-xs text-text-secondary mt-1\">\r\n                                  {student.dateOfBirth && `N√©(e) le ${new Date(student.dateOfBirth).toLocaleDateString('fr-FR')}`}\r\n                                  {student.dateOfBirth && student.placeOfBirth && ' √† '}\r\n                                  {student.placeOfBirth}\r\n                                </p>\r\n                              )}\r\n                            </div>\r\n                          </div>\r\n                          <div className=\"space-y-4\">\r\n                            {/* Identifiant de connexion personnalis√© */}\r\n                            <div className=\"bg-background/50 rounded-lg p-3\">\r\n                              <h6 className=\"font-medium text-text-primary mb-2 flex items-center\">\r\n                                <Icon name=\"Key\" size={16} className=\"mr-2\" />\r\n                                Identifiant de Connexion\r\n                              </h6>\r\n                              <div className=\"flex items-center space-x-2 text-primary text-sm\">\r\n                                <Icon name=\"User\" size={14} />\r\n                                <span className=\"font-mono\">{student.customUsername}</span>\r\n                              </div>\r\n                            </div>\r\n\r\n                            {/* Informations du compte */}\r\n                            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm\">\r\n                              <div>\r\n                                <span className=\"font-medium text-text-secondary\">ID √âl√®ve:</span>\r\n                                <p className=\"font-mono bg-background p-2 rounded border mt-1\">{student.studentId}</p>\r\n                              </div>\r\n                              <div>\r\n                                <span className=\"font-medium text-text-secondary\">Mot de passe:</span>\r\n                                <p className=\"font-mono bg-background p-2 rounded border mt-1\">{student.password}</p>\r\n                              </div>\r\n                            </div>\r\n\r\n                            {/* Instructions de connexion pour √©l√®ve */}\r\n                            <div className=\"bg-info/5 border border-info/20 rounded-lg p-3\">\r\n                              <p className=\"text-sm text-text-primary font-medium mb-1\">üéí Comment l'√©l√®ve se connecte :</p>\r\n                              <p className=\"text-xs text-text-secondary\">\r\n                                Utiliser le <strong>nom d'utilisateur personnalis√©</strong> ci-dessus + le mot de passe\r\n                              </p>\r\n                            </div>\r\n                          </div>\r\n                        </div>\r\n                      ))}\r\n\r\n                      <div className=\"bg-warning/5 border border-warning/20 rounded-lg p-4\">\r\n                        <div className=\"flex items-start space-x-3\">\r\n                          <Icon name=\"AlertTriangle\" size={20} className=\"text-warning mt-0.5\" />\r\n                          <div>\r\n                            <p className=\"font-medium text-text-primary mb-2\">üìã Instructions Importantes :</p>\r\n                            <div className=\"text-sm text-text-secondary space-y-2\">\r\n                              <div>\r\n                                <p className=\"font-medium text-text-primary\">Pour le Parent :</p>\r\n                                <ul className=\"text-xs space-y-1 ml-4\">\r\n                                  {familyData.parent.canLoginWithEmail && (\r\n                                    <li>‚Ä¢ Peut se connecter avec son <strong>email</strong> + mot de passe</li>\r\n                                  )}\r\n                                  {familyData.parent.canLoginWithPhone && (\r\n                                    <li>‚Ä¢ Peut se connecter avec son <strong>num√©ro de t√©l√©phone</strong> + mot de passe</li>\r\n                                  )}\r\n                                  <li>‚Ä¢ Peut utiliser le <strong>nom d'utilisateur personnalis√©</strong> + mot de passe</li>\r\n                                </ul>\r\n                              </div>\r\n                              <div>\r\n                                <p className=\"font-medium text-text-primary\">Pour l'√âl√®ve :</p>\r\n                                <ul className=\"text-xs space-y-1 ml-4\">\r\n                                  <li>‚Ä¢ Utilise uniquement le <strong>nom d'utilisateur personnalis√©</strong> + mot de passe</li>\r\n                                  <li>‚Ä¢ Identifiants sp√©cialement cr√©√©s pour les enfants</li>\r\n                                </ul>\r\n                              </div>\r\n                              <p className=\"bg-background p-2 rounded border text-xs\">\r\n                                üí° <strong>Conseil :</strong> Imprimez ou envoyez ces identifiants par email au parent. \r\n                                Les parents ont plusieurs options de connexion, les √©l√®ves utilisent leur nom d'utilisateur personnalis√©.\r\n                              </p>\r\n                            </div>\r\n                          </div>\r\n                        </div>\r\n                      </div>\r\n                    </div>\r\n                  )}\r\n                </div>\r\n              )}\r\n            </div>\r\n            </div>\r\n            \r\n            {/* Barre de navigation inf√©rieure - Design am√©lior√© */}\r\n            <div className=\"bg-gray-50 border-t border-gray-200 px-8 py-5\">\r\n              <div className=\"flex items-center justify-between\">\r\n                <div>\r\n                  {currentStep > 1 ? (\r\n                    <button\r\n                      onClick={prevStep}\r\n                      className=\"inline-flex items-center px-5 py-2.5 text-sm font-medium text-gray-700 bg-white border-2 border-gray-300 rounded-lg hover:bg-gray-50 hover:border-gray-400 transition-all duration-200\"\r\n                    >\r\n                      <Icon name=\"ChevronLeft\" size={18} className=\"mr-2\" />\r\n                      Pr√©c√©dent\r\n                    </button>\r\n                  ) : (\r\n                    <button\r\n                      onClick={() => {\r\n                        setShowAddModal(false);\r\n                        resetWorkflow();\r\n                      }}\r\n                      className=\"inline-flex items-center px-5 py-2.5 text-sm font-medium text-gray-600 hover:text-gray-800 transition-colors\"\r\n                    >\r\n                      <Icon name=\"X\" size={18} className=\"mr-2\" />\r\n                      Annuler\r\n                    </button>\r\n                  )}\r\n                </div>\r\n                \r\n                <div className=\"flex items-center space-x-3\">\r\n                  {currentStep > 1 && (\r\n                    <button\r\n                      onClick={() => {\r\n                        setShowAddModal(false);\r\n                        resetWorkflow();\r\n                      }}\r\n                      className=\"px-5 py-2.5 text-sm font-medium text-gray-600 hover:text-gray-800 transition-colors\"\r\n                    >\r\n                      Annuler\r\n                    </button>\r\n                  )}\r\n                  \r\n                  {currentStep < 3 ? (\r\n                    <button\r\n                      onClick={nextStep}\r\n                      disabled={\r\n                        (currentStep === 1 && (\r\n                          (inscriptionMode === 'new' && (!familyData.parent.firstName || !familyData.parent.lastName || !familyData.parent.phone)) ||\r\n                          (inscriptionMode === 'existing' && !selectedExistingParent)\r\n                        )) ||\r\n                        (currentStep === 2 && familyData.students.some(s => !s.firstName || !s.lastName || !s.class))\r\n                      }\r\n                      className=\"inline-flex items-center px-6 py-2.5 text-sm font-semibold text-white bg-gradient-to-r from-blue-600 to-indigo-600 rounded-lg hover:from-blue-700 hover:to-indigo-700 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200 shadow-lg shadow-blue-200 hover:shadow-xl disabled:shadow-none\"\r\n                    >\r\n                      Continuer\r\n                      <Icon name=\"ChevronRight\" size={18} className=\"ml-2\" />\r\n                    </button>\r\n                  ) : (\r\n                    <button\r\n                      onClick={() => {\r\n                        // Ici on sauvegarderait en base de donn√©es\r\n                        alert('Famille inscrite avec succ√®s ! Les comptes ont √©t√© cr√©√©s.');\r\n                        setShowAddModal(false);\r\n                        resetWorkflow();\r\n                      }}\r\n                      disabled={!familyData.students[0]?.customUsername}\r\n                      className=\"inline-flex items-center px-6 py-2.5 text-sm font-semibold text-white bg-gradient-to-r from-green-600 to-emerald-600 rounded-lg hover:from-green-700 hover:to-emerald-700 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200 shadow-lg shadow-green-200 hover:shadow-xl disabled:shadow-none\"\r\n                    >\r\n                      <Icon name=\"CheckCircle\" size={18} className=\"mr-2\" />\r\n                      Finaliser l'Inscription\r\n                    </button>\r\n                  )}\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Modal Profil √âl√®ve */}\r\n      {showProfileModal && selectedStudent && (\r\n        <div className=\"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4\">\r\n          <div className=\"bg-card rounded-lg border border-border max-w-2xl w-full max-h-[90vh] overflow-y-auto\">\r\n            <div className=\"flex items-center justify-between p-6 border-b border-border\">\r\n              <h3 className=\"font-heading font-heading-semibold text-lg text-text-primary\">\r\n                Profil de {selectedStudent.name}\r\n              </h3>\r\n              <Button\r\n                variant=\"ghost\"\r\n                size=\"icon\"\r\n                onClick={() => setShowProfileModal(false)}\r\n                iconName=\"X\"\r\n              />\r\n            </div>\r\n            \r\n            <div className=\"p-6 space-y-6\">\r\n              {/* Informations √©l√®ve */}\r\n              <div className=\"flex items-center space-x-4 p-4 bg-muted/30 rounded-lg\">\r\n                <Image\r\n                  src={selectedStudent.photo}\r\n                  alt={selectedStudent.name}\r\n                  className=\"w-16 h-16 rounded-full object-cover\"\r\n                  fallback=\"/public/assets/images/no_image.png\"\r\n                />\r\n                <div className=\"flex-1\">\r\n                  <h4 className=\"font-heading font-heading-semibold text-lg text-text-primary\">\r\n                    {selectedStudent.name}\r\n                  </h4>\r\n                  <p className=\"font-body font-body-normal text-sm text-text-secondary\">\r\n                    ID: {selectedStudent.studentId} ‚Ä¢ Classe: {selectedStudent.class}\r\n                  </p>\r\n                  <div className=\"mt-2\">\r\n                    {getStatusBadge(selectedStudent.enrollmentStatus)}\r\n                  </div>\r\n                </div>\r\n              </div>\r\n\r\n              {/* Informations parent */}\r\n              <div className=\"space-y-3\">\r\n                <h5 className=\"font-heading font-heading-semibold text-md text-text-primary\">\r\n                  Informations Parent/Tuteur\r\n                </h5>\r\n                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n                  <div className=\"p-3 bg-muted/20 rounded-lg\">\r\n                    <p className=\"font-caption font-caption-normal text-xs text-text-secondary mb-1\">Nom</p>\r\n                    <p className=\"font-body font-body-medium text-sm text-text-primary\">{selectedStudent.parentName}</p>\r\n                  </div>\r\n                  <div className=\"p-3 bg-muted/20 rounded-lg\">\r\n                    <p className=\"font-caption font-caption-normal text-xs text-text-secondary mb-1\">T√©l√©phone</p>\r\n                    <p className=\"font-body font-body-medium text-sm text-text-primary\">{selectedStudent.parentPhone}</p>\r\n                  </div>\r\n                  <div className=\"md:col-span-2 p-3 bg-muted/20 rounded-lg\">\r\n                    <p className=\"font-caption font-caption-normal text-xs text-text-secondary mb-1\">Email</p>\r\n                    <p className=\"font-body font-body-medium text-sm text-text-primary\">{selectedStudent.parentEmail}</p>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n\r\n              {/* Actions rapides */}\r\n              <div className=\"space-y-3\">\r\n                <h5 className=\"font-heading font-heading-semibold text-md text-text-primary\">\r\n                  Actions rapides\r\n                </h5>\r\n                <div className=\"flex flex-wrap gap-2\">\r\n                  {selectedStudent.enrollmentStatus === 'pending' && (\r\n                    <Button\r\n                      variant=\"outline\"\r\n                      size=\"sm\"\r\n                      iconName=\"CheckCircle\"\r\n                      onClick={() => {\r\n                        handleUpdateStudentStatus(selectedStudent.id, 'active');\r\n                        setSelectedStudent({...selectedStudent, enrollmentStatus: 'active'});\r\n                      }}\r\n                    >\r\n                      Valider inscription\r\n                    </Button>\r\n                  )}\r\n                  <Button\r\n                    variant=\"outline\"\r\n                    size=\"sm\"\r\n                    iconName=\"Phone\"\r\n                    onClick={() => window.open(`tel:${selectedStudent.parentPhone}`, '_self')}\r\n                  >\r\n                    Appeler parent\r\n                  </Button>\r\n                  <Button\r\n                    variant=\"outline\"\r\n                    size=\"sm\"\r\n                    iconName=\"Mail\"\r\n                    onClick={() => window.open(`mailto:${selectedStudent.parentEmail}`, '_self')}\r\n                  >\r\n                    Envoyer email\r\n                  </Button>\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"flex gap-3 p-6 border-t border-border\">\r\n              <Button variant=\"outline\" onClick={() => setShowProfileModal(false)}>\r\n                Fermer\r\n              </Button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Modal Transfert */}\r\n      {showTransferModal && selectedStudent && (\r\n        <div className=\"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4\">\r\n          <div className=\"bg-card rounded-lg border border-border max-w-md w-full\">\r\n            <div className=\"flex items-center justify-between p-6 border-b border-border\">\r\n              <h3 className=\"font-heading font-heading-semibold text-lg text-text-primary\">\r\n                Confirmer le transfert\r\n              </h3>\r\n              <Button\r\n                variant=\"ghost\"\r\n                size=\"icon\"\r\n                onClick={() => setShowTransferModal(false)}\r\n                iconName=\"X\"\r\n              />\r\n            </div>\r\n            \r\n            <div className=\"p-6\">\r\n              <div className=\"flex items-center space-x-3 mb-4\">\r\n                <div className=\"w-12 h-12 bg-warning/10 rounded-lg flex items-center justify-center\">\r\n                  <Icon name=\"AlertTriangle\" size={24} className=\"text-warning\" />\r\n                </div>\r\n                <div>\r\n                  <p className=\"font-body font-body-medium text-sm text-text-primary\">\r\n                    Transf√©rer {selectedStudent.name} ?\r\n                  </p>\r\n                  <p className=\"font-caption font-caption-normal text-xs text-text-secondary\">\r\n                    L'√©l√®ve sera marqu√© comme \"Transf√©r√©\"\r\n                  </p>\r\n                </div>\r\n              </div>\r\n              \r\n              <div className=\"bg-muted/30 rounded-lg p-4\">\r\n                <p className=\"font-caption font-caption-normal text-xs text-text-secondary\">\r\n                  ‚ö†Ô∏è Cette action marquera l'√©l√®ve comme transf√©r√© vers une autre √©cole. \r\n                  L'√©l√®ve n'appara√Ætra plus dans les listes actives.\r\n                </p>\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"flex gap-3 p-6 border-t border-border\">\r\n              <Button variant=\"default\" onClick={handleConfirmTransfer}>\r\n                Confirmer le transfert\r\n              </Button>\r\n              <Button variant=\"outline\" onClick={() => setShowTransferModal(false)}>\r\n                Annuler\r\n              </Button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default StudentManagementTab;","import React, { useState, useEffect } from 'react';\r\nimport Icon from '../../../components/AppIcon';\r\nimport Button from '../../../components/ui/Button';\r\nimport { supabase } from '../../../lib/supabase';\r\n\r\nconst TeacherSearchSelector = ({ \r\n  onTeacherSelect, \r\n  onCreateNew, \r\n  selectedTeacher\r\n}) => {\r\n  const [allTeachers, setAllTeachers] = useState([]);\r\n  const [isLoading, setIsLoading] = useState(true);\r\n\r\n  // Charger tous les enseignants au montage du composant\r\n  useEffect(() => {\r\n    const loadAllTeachers = async () => {\r\n      setIsLoading(true);\r\n      try {\r\n        const { data: teachers, error } = await supabase\r\n          .from('users')\r\n          .select(`\r\n            id,\r\n            full_name,\r\n            email,\r\n            phone,\r\n            role\r\n          `)\r\n          .eq('role', 'teacher')\r\n          .order('full_name', { ascending: true });\r\n\r\n        if (error) {\r\n          console.error('Erreur chargement enseignants:', error);\r\n          setAllTeachers([]);\r\n          return;\r\n        }\r\n\r\n        const formattedResults = (teachers || []).map(teacher => ({\r\n          id: teacher.id,\r\n          fullName: teacher.full_name || 'Nom inconnu',\r\n          firstName: teacher.full_name?.split(' ')[0] || '',\r\n          lastName: teacher.full_name?.split(' ').slice(1).join(' ') || '',\r\n          email: teacher.email || '',\r\n          phone: teacher.phone || '',\r\n          specializations: [],\r\n          assignments: [],\r\n          totalSchools: 0,\r\n          totalWeeklyHours: 0,\r\n          availableHours: 40\r\n        }));\r\n\r\n        setAllTeachers(formattedResults);\r\n        console.log(`‚úÖ ${formattedResults.length} enseignant(s) charg√©(s)`);\r\n      } catch (error) {\r\n        console.error('Exception chargement enseignants:', error);\r\n        setAllTeachers([]);\r\n      } finally {\r\n        setIsLoading(false);\r\n      }\r\n    };\r\n\r\n    loadAllTeachers();\r\n  }, []);\r\n\r\n  const handleSelectChange = (e) => {\r\n    const selectedId = e.target.value;\r\n    if (!selectedId) {\r\n      onTeacherSelect(null);\r\n      return;\r\n    }\r\n    const teacher = allTeachers.find(t => t.id === selectedId);\r\n    if (teacher) {\r\n      onTeacherSelect(teacher);\r\n    }\r\n  };\r\n\r\n  const getSpecializationsBadges = (specializations) => {\r\n    if (!specializations || specializations.length === 0) return null;\r\n    return specializations.map((spec, index) => (\r\n      <span \r\n        key={index}\r\n        className=\"inline-block px-2 py-1 bg-primary/10 text-primary text-xs rounded-full mr-1 mb-1\"\r\n      >\r\n        {spec}\r\n      </span>\r\n    ));\r\n  };\r\n\r\n  const getAssignmentSummary = (teacher) => {\r\n    if (!teacher.assignments || teacher.assignments.length === 0) {\r\n      return \"Aucune assignation active\";\r\n    }\r\n\r\n    const schoolNames = teacher.assignments.map(a => a.school.name).join(', ');\r\n    return `${teacher.assignments.length} √©tablissement(s) ‚Ä¢ ${teacher.totalWeeklyHours}h/semaine`;\r\n  };\r\n\r\n  return (\r\n    <div className=\"space-y-4\">\r\n      {/* Liste d√©roulante des enseignants */}\r\n      <div className=\"space-y-2\">\r\n        <label className=\"block font-body font-body-semibold text-sm text-text-primary mb-2\">\r\n          S√©lectionner un enseignant\r\n        </label>\r\n        <div className=\"relative\">\r\n          <select\r\n            value={selectedTeacher?.id || ''}\r\n            onChange={handleSelectChange}\r\n            disabled={isLoading}\r\n            className=\"w-full px-4 py-3 pr-10 border border-border rounded-xl bg-background text-text-primary focus:outline-none focus:ring-2 focus:ring-primary/50 focus:border-primary transition-all appearance-none cursor-pointer disabled:opacity-50 disabled:cursor-not-allowed\"\r\n          >\r\n            <option value=\"\">\r\n              {isLoading ? 'Chargement des enseignants...' : '-- Choisir un enseignant --'}\r\n            </option>\r\n            {allTeachers.map((teacher) => (\r\n              <option key={teacher.id} value={teacher.id}>\r\n                {teacher.fullName} {teacher.email ? `(${teacher.email})` : ''}\r\n              </option>\r\n            ))}\r\n          </select>\r\n          <div className=\"absolute right-3 top-1/2 transform -translate-y-1/2 pointer-events-none\">\r\n            {isLoading ? (\r\n              <div className=\"animate-spin h-5 w-5 border-2 border-primary border-t-transparent rounded-full\" />\r\n            ) : (\r\n              <Icon name=\"ChevronDown\" size={20} className=\"text-muted-foreground\" />\r\n            )}\r\n          </div>\r\n        </div>\r\n        \r\n        {/* Compteur d'enseignants disponibles */}\r\n        {!isLoading && (\r\n          <p className=\"text-xs text-text-tertiary flex items-center gap-1\">\r\n            <Icon name=\"Users\" size={12} />\r\n            {allTeachers.length} enseignant(s) disponible(s)\r\n          </p>\r\n        )}\r\n      </div>\r\n\r\n      {/* Enseignant s√©lectionn√© */}\r\n      {selectedTeacher && (\r\n        <div className=\"bg-success/5 border border-success/20 rounded-lg p-4\">\r\n          <div className=\"flex items-start justify-between\">\r\n            <div className=\"flex items-center space-x-3\">\r\n              <div className=\"w-12 h-12 bg-success/10 rounded-lg flex items-center justify-center\">\r\n                <Icon name=\"UserCheck\" size={24} className=\"text-success\" />\r\n              </div>\r\n              <div className=\"flex-1\">\r\n                <h4 className=\"font-heading font-heading-semibold text-base text-text-primary\">\r\n                  {selectedTeacher.fullName || `${selectedTeacher.firstName} ${selectedTeacher.lastName}`}\r\n                </h4>\r\n                <p className=\"text-sm text-text-secondary\">\r\n                  {selectedTeacher.email} {selectedTeacher.phone && `‚Ä¢ ${selectedTeacher.phone}`}\r\n                </p>\r\n                {selectedTeacher.specializations && selectedTeacher.specializations.length > 0 && (\r\n                  <div className=\"mt-2\">\r\n                    {getSpecializationsBadges(selectedTeacher.specializations)}\r\n                  </div>\r\n                )}\r\n                <p className=\"text-xs text-text-secondary mt-1\">\r\n                  {getAssignmentSummary(selectedTeacher)}\r\n                </p>\r\n              </div>\r\n            </div>\r\n            <Button\r\n              variant=\"ghost\"\r\n              size=\"sm\"\r\n              onClick={() => onTeacherSelect(null)}\r\n              className=\"text-muted-foreground hover:text-text-primary\"\r\n            >\r\n              <Icon name=\"X\" size={16} />\r\n            </Button>\r\n          </div>\r\n\r\n          {/* D√©tails des assignations actuelles */}\r\n          {selectedTeacher.assignments && selectedTeacher.assignments.length > 0 && (\r\n            <div className=\"mt-4 pt-4 border-t border-success/20\">\r\n              <h5 className=\"font-medium text-sm text-text-primary mb-2\">\r\n                Assignations actuelles :\r\n              </h5>\r\n              <div className=\"space-y-2\">\r\n                {selectedTeacher.assignments.map((assignment, index) => (\r\n                  <div key={index} className=\"flex items-center justify-between text-xs\">\r\n                    <div>\r\n                      <span className=\"font-medium\">{assignment.school.name}</span>\r\n                      <span className=\"text-text-secondary ml-2\">\r\n                        ({assignment.classes.join(', ')})\r\n                      </span>\r\n                    </div>\r\n                    <span className=\"bg-background px-2 py-1 rounded text-text-secondary\">\r\n                      {assignment.weeklyHours}h/sem\r\n                    </span>\r\n                  </div>\r\n                ))}\r\n              </div>\r\n\r\n              {/* Disponibilit√© */}\r\n              <div className=\"mt-3 p-2 bg-background/50 rounded\">\r\n                <div className=\"flex items-center justify-between text-xs\">\r\n                  <span className=\"text-text-secondary\">Disponibilit√© restante :</span>\r\n                  <span className={`font-medium ${selectedTeacher.availableHours > 10 ? 'text-success' : selectedTeacher.availableHours > 5 ? 'text-warning' : 'text-error'}`}>\r\n                    {selectedTeacher.availableHours}h/semaine\r\n                  </span>\r\n                </div>\r\n                <div className=\"w-full bg-border rounded-full h-2 mt-1\">\r\n                  <div \r\n                    className={`h-2 rounded-full ${selectedTeacher.availableHours > 10 ? 'bg-success' : selectedTeacher.availableHours > 5 ? 'bg-warning' : 'bg-error'}`}\r\n                    style={{ width: `${(selectedTeacher.availableHours / 40) * 100}%` }}\r\n                  />\r\n                </div>\r\n              </div>\r\n            </div>\r\n          )}\r\n        </div>\r\n      )}\r\n\r\n      {/* Aucun enseignant disponible */}\r\n      {!isLoading && allTeachers.length === 0 && (\r\n        <div className=\"bg-card border border-border rounded-lg p-6 text-center\">\r\n          <Icon name=\"UserX\" size={48} className=\"text-muted-foreground mx-auto mb-3\" />\r\n          <h4 className=\"font-heading font-heading-semibold text-base text-text-primary mb-2\">\r\n            Aucun enseignant disponible\r\n          </h4>\r\n          <p className=\"text-sm text-text-secondary mb-4\">\r\n            Il n'y a pas encore d'enseignant enregistr√© dans le syst√®me\r\n          </p>\r\n          \r\n          <Button\r\n            variant=\"outline\"\r\n            onClick={onCreateNew}\r\n            className=\"w-full\"\r\n            iconName=\"UserPlus\"\r\n            iconPosition=\"left\"\r\n          >\r\n            Cr√©er un nouveau compte enseignant\r\n          </Button>\r\n        </div>\r\n      )}\r\n\r\n      {/* Message d'information */}\r\n      <div className=\"bg-blue/5 border border-blue/20 rounded-lg p-3\">\r\n        <div className=\"flex items-start space-x-2\">\r\n          <Icon name=\"Info\" size={16} className=\"text-blue mt-0.5\" />\r\n          <div className=\"text-left\">\r\n            <p className=\"text-sm font-medium text-text-primary mb-1\">\r\n              üè´ Syst√®me Multi-√âtablissements\r\n            </p>\r\n            <p className=\"text-xs text-text-secondary\">\r\n              Un enseignant peut travailler dans plusieurs √©tablissements avec un seul compte. \r\n              S√©lectionnez un enseignant existant pour l'assigner √† votre √©tablissement.\r\n            </p>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default TeacherSearchSelector;","import React from \"react\";\nimport { Check, Minus } from \"lucide-react\";\nimport { cn } from \"../../utils/cn\";\n\nconst Checkbox = React.forwardRef(({\n    className,\n    id,\n    checked,\n    indeterminate = false,\n    disabled = false,\n    required = false,\n    label,\n    description,\n    error,\n    size = \"default\",\n    ...props\n}, ref) => {\n    // Generate unique ID if not provided\n    const checkboxId = id || `checkbox-${Math.random()?.toString(36)?.substr(2, 9)}`;\n\n    // Size variants\n    const sizeClasses = {\n        sm: \"h-4 w-4\",\n        default: \"h-4 w-4\",\n        lg: \"h-5 w-5\"\n    };\n\n    return (\n        <div className={cn(\"flex items-start space-x-2\", className)}>\n            <div className=\"relative flex items-center\">\n                <input\n                    type=\"checkbox\"\n                    ref={ref}\n                    id={checkboxId}\n                    checked={checked}\n                    disabled={disabled}\n                    required={required}\n                    className=\"sr-only\"\n                    {...props}\n                />\n\n                <label\n                    htmlFor={checkboxId}\n                    className={cn(\n                        \"peer shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground cursor-pointer transition-colors\",\n                        sizeClasses?.[size],\n                        checked && \"bg-primary text-primary-foreground border-primary\",\n                        indeterminate && \"bg-primary text-primary-foreground border-primary\",\n                        error && \"border-destructive\",\n                        disabled && \"cursor-not-allowed opacity-50\"\n                    )}\n                >\n                    {checked && !indeterminate && (\n                        <Check className=\"h-3 w-3 text-current flex items-center justify-center\" />\n                    )}\n                    {indeterminate && (\n                        <Minus className=\"h-3 w-3 text-current flex items-center justify-center\" />\n                    )}\n                </label>\n            </div>\n            {(label || description || error) && (\n                <div className=\"flex-1 space-y-1\">\n                    {label && (\n                        <label\n                            htmlFor={checkboxId}\n                            className={cn(\n                                \"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70 cursor-pointer\",\n                                error ? \"text-destructive\" : \"text-foreground\"\n                            )}\n                        >\n                            {label}\n                            {required && <span className=\"text-destructive ml-1\">*</span>}\n                        </label>\n                    )}\n\n                    {description && !error && (\n                        <p className=\"text-sm text-muted-foreground\">\n                            {description}\n                        </p>\n                    )}\n\n                    {error && (\n                        <p className=\"text-sm text-destructive\">\n                            {error}\n                        </p>\n                    )}\n                </div>\n            )}\n        </div>\n    );\n});\n\nCheckbox.displayName = \"Checkbox\";\n\n// Checkbox Group component\nconst CheckboxGroup = React.forwardRef(({\n    className,\n    children,\n    label,\n    description,\n    error,\n    required = false,\n    disabled = false,\n    ...props\n}, ref) => {\n    return (\n        <fieldset\n            ref={ref}\n            disabled={disabled}\n            className={cn(\"space-y-3\", className)}\n            {...props}\n        >\n            {label && (\n                <legend className={cn(\n                    \"text-sm font-medium\",\n                    error ? \"text-destructive\" : \"text-foreground\"\n                )}>\n                    {label}\n                    {required && <span className=\"text-destructive ml-1\">*</span>}\n                </legend>\n            )}\n\n            {description && !error && (\n                <p className=\"text-sm text-muted-foreground\">\n                    {description}\n                </p>\n            )}\n\n            <div className=\"space-y-2\">\n                {children}\n            </div>\n\n            {error && (\n                <p className=\"text-sm text-destructive\">\n                    {error}\n                </p>\n            )}\n        </fieldset>\n    );\n});\n\nCheckboxGroup.displayName = \"CheckboxGroup\";\n\nexport { Checkbox, CheckboxGroup };","import React, { useState, useEffect } from 'react';\r\nimport Icon from '../../../components/AppIcon';\r\nimport Button from '../../../components/ui/Button';\r\nimport Input from '../../../components/ui/Input';\r\nimport Select from '../../../components/ui/Select';\r\nimport { Checkbox } from '../../../components/ui/Checkbox';\r\nimport { supabase } from '../../../lib/supabase';\r\n\r\nconst TeacherAssignmentManager = ({ \r\n  teacher, \r\n  currentSchool, // L'√©tablissement de la secr√©taire connect√©e\r\n  onAssignmentComplete,\r\n  onCancel \r\n}) => {\r\n  const [availableClasses, setAvailableClasses] = useState([]);\r\n  const [availableSubjects, setAvailableSubjects] = useState([]);\r\n  const [showAddSubjectModal, setShowAddSubjectModal] = useState(false);\r\n  const [newSubject, setNewSubject] = useState('');\r\n  const [assignmentData, setAssignmentData] = useState({\r\n    subjects: [],\r\n    classes: [],\r\n    weeklyHours: 0,\r\n    startDate: new Date().toISOString().split('T')[0],\r\n    endDate: '2025-06-30'\r\n  });\r\n  const [hoursPerSubject, setHoursPerSubject] = useState({}); // Heures par mati√®re\r\n  const [isLoading, setIsLoading] = useState(false);\r\n\r\n  // Charger les classes et mati√®res disponibles pour l'√©tablissement\r\n  useEffect(() => {\r\n    const loadSchoolData = async () => {\r\n      if (currentSchool?.id) {\r\n        try {\r\n          const { data: schoolData, error } = await supabase\r\n            .from('schools')\r\n            .select('available_classes, type, custom_subjects')\r\n            .eq('id', currentSchool.id)\r\n            .single();\r\n\r\n          if (error) {\r\n            console.error('Erreur chargement donn√©es √©cole:', error);\r\n            return;\r\n          }\r\n\r\n          // Charger les classes avec le comptage des √©l√®ves\r\n          if (schoolData?.available_classes && Array.isArray(schoolData.available_classes)) {\r\n            // R√©cup√©rer tous les √©l√®ves de l'√©cole\r\n            const { data: students, error: studentsError } = await supabase\r\n              .from('students')\r\n              .select('current_class, class_name')\r\n              .eq('school_id', currentSchool.id)\r\n              .eq('is_active', true);\r\n\r\n            if (studentsError) {\r\n              console.error('Erreur chargement √©l√®ves:', studentsError);\r\n            }\r\n\r\n            // Compter les √©l√®ves par classe\r\n            const studentCountsByClass = {};\r\n            if (students) {\r\n              students.forEach(student => {\r\n                // Utiliser class_name en priorit√©, sinon current_class\r\n                const className = student.class_name || student.current_class;\r\n                if (className) {\r\n                  studentCountsByClass[className] = (studentCountsByClass[className] || 0) + 1;\r\n                }\r\n              });\r\n            }\r\n\r\n            // Formatter les classes avec le nombre r√©el d'√©l√®ves\r\n            const formattedClasses = schoolData.available_classes.map((className, index) => ({\r\n              id: `class-${index}`,\r\n              name: className,\r\n              studentsCount: studentCountsByClass[className] || 0\r\n            }));\r\n            \r\n            setAvailableClasses(formattedClasses);\r\n            console.log(`‚úÖ ${formattedClasses.length} classe(s) charg√©e(s)`);\r\n            console.log('üìä Comptage √©l√®ves par classe:', studentCountsByClass);\r\n          }\r\n\r\n          // Charger les mati√®res (par d√©faut + personnalis√©es, sans doublons)\r\n          const defaultSubjects = getDefaultSubjectsBySchoolType(schoolData.type);\r\n          const customSubjects = (schoolData.custom_subjects || []).map(name => ({ id: `custom-${name}`, name }));\r\n          \r\n          // Utiliser un Set pour √©liminer les doublons par nom\r\n          const allSubjectsMap = new Map();\r\n          [...defaultSubjects, ...customSubjects].forEach(subject => {\r\n            if (!allSubjectsMap.has(subject.name)) {\r\n              allSubjectsMap.set(subject.name, subject);\r\n            }\r\n          });\r\n          \r\n          const allSubjects = Array.from(allSubjectsMap.values());\r\n          setAvailableSubjects(allSubjects);\r\n          console.log(`‚úÖ ${allSubjects.length} mati√®re(s) disponible(s) (sans doublons)`);\r\n        } catch (error) {\r\n          console.error('Exception chargement donn√©es √©cole:', error);\r\n        }\r\n      }\r\n    };\r\n\r\n    loadSchoolData();\r\n  }, [currentSchool?.id]);\r\n\r\n  // Fonction pour obtenir les mati√®res par d√©faut selon le type d'√©cole\r\n  const getDefaultSubjectsBySchoolType = (schoolType) => {\r\n    const subjectsByType = {\r\n      'Maternelle': ['√âveil', 'Psychomotricit√©', 'Langage', 'Arts plastiques', 'Musique', 'Jeux √©ducatifs'],\r\n      'Primaire': ['Math√©matiques', 'Fran√ßais', 'Lecture', '√âcriture', 'Histoire', 'G√©ographie', 'Sciences', '√âducation Civique et Morale', 'Arts Plastiques', 'Musique', '√âducation Physique et Sportive', 'Anglais', 'Informatique', 'Travaux Manuels', 'Hygi√®ne et Sant√©', 'Biblioth√®que'],\r\n      'Coll√®ge': ['Math√©matiques', 'Fran√ßais', 'Anglais', 'Histoire-G√©ographie', 'Sciences de la Vie et de la Terre', 'Physique-Chimie', 'Technologie', '√âducation Physique et Sportive', 'Arts Plastiques', 'Musique', '√âducation Civique', 'Espagnol', 'Allemand', 'Informatique'],\r\n      'Lyc√©e G√©n√©ral': ['Math√©matiques', 'Fran√ßais', 'Philosophie', 'Histoire-G√©ographie', 'Anglais', 'Espagnol', 'Allemand', 'Physique-Chimie', 'Sciences de la Vie et de la Terre', 'Sciences √âconomiques et Sociales', '√âducation Physique et Sportive', 'Arts Plastiques', 'Musique', 'NSI (Num√©rique et Sciences Informatiques)', 'SI (Sciences de l\\'Ing√©nieur)', 'HGGSP', 'HLP', 'LLCER', 'Biologie-√âcologie', 'Math√©matiques Expertes'],\r\n      'Lyc√©e Technique': ['Math√©matiques', 'Fran√ßais', 'Anglais', 'Histoire-G√©ographie', 'Physique-Chimie', '√âlectrotechnique', 'M√©canique', 'G√©nie Civil', 'Informatique', '√âconomie-Gestion', 'Construction', 'CAO/DAO', 'Automatisme', 'Sciences de l\\'Ing√©nieur', 'T√©l√©communications', 'Maintenance', '√ânergie', '√âducation Physique et Sportive'],\r\n      'Lyc√©e Professionnel': ['Math√©matiques', 'Fran√ßais', 'Anglais', 'Histoire-G√©ographie', 'Commerce', 'Vente', 'Comptabilit√©', 'Secr√©tariat', 'Cuisine', 'H√¥tellerie', 'Coiffure', 'Esth√©tique', 'M√©canique Auto', '√âlectricit√©', 'Menuiserie', 'Soudure', 'Mode', 'Agriculture']\r\n    };\r\n\r\n    const subjects = subjectsByType[schoolType] || subjectsByType['Coll√®ge'];\r\n    return subjects.map((name, index) => ({ id: `default-${index}`, name }));\r\n  };\r\n\r\n  // Calculer automatiquement les heures en fonction des classes, mati√®res et heures personnalis√©es\r\n  useEffect(() => {\r\n    const calculateWeeklyHours = () => {\r\n      let totalHours = 0;\r\n      \r\n      // Parcourir chaque mati√®re et calculer selon ses heures sp√©cifiques\r\n      assignmentData.subjects.forEach(subject => {\r\n        const hoursForThisSubject = hoursPerSubject[subject] || 2; // Par d√©faut 2h si non d√©fini\r\n        totalHours += assignmentData.classes.length * hoursForThisSubject;\r\n      });\r\n      \r\n      setAssignmentData(prev => ({\r\n        ...prev,\r\n        weeklyHours: totalHours\r\n      }));\r\n    };\r\n\r\n    calculateWeeklyHours();\r\n  }, [assignmentData.subjects, assignmentData.classes, hoursPerSubject]);\r\n\r\n  const handleSubjectChange = (subjectName, isChecked) => {\r\n    setAssignmentData(prev => ({\r\n      ...prev,\r\n      subjects: isChecked \r\n        ? [...prev.subjects, subjectName]\r\n        : prev.subjects.filter(s => s !== subjectName)\r\n    }));\r\n    \r\n    // Initialiser avec 2h par d√©faut quand une mati√®re est s√©lectionn√©e\r\n    if (isChecked && !hoursPerSubject[subjectName]) {\r\n      setHoursPerSubject(prev => ({\r\n        ...prev,\r\n        [subjectName]: 2\r\n      }));\r\n    }\r\n  };\r\n\r\n  const handleHoursChange = (subjectName, hours) => {\r\n    const numHours = parseInt(hours) || 0;\r\n    setHoursPerSubject(prev => ({\r\n      ...prev,\r\n      [subjectName]: numHours\r\n    }));\r\n  };\r\n\r\n  const handleClassChange = (className, isChecked) => {\r\n    setAssignmentData(prev => ({\r\n      ...prev,\r\n      classes: isChecked \r\n        ? [...prev.classes, className]\r\n        : prev.classes.filter(c => c !== className)\r\n    }));\r\n  };\r\n\r\n  // Ajouter une nouvelle mati√®re personnalis√©e\r\n  const handleAddSubject = async () => {\r\n    if (!newSubject.trim()) {\r\n      alert('Veuillez entrer le nom de la mati√®re');\r\n      return;\r\n    }\r\n\r\n    // V√©rifier si la mati√®re existe d√©j√†\r\n    if (availableSubjects.some(s => s.name.toLowerCase() === newSubject.trim().toLowerCase())) {\r\n      alert('Cette mati√®re existe d√©j√†');\r\n      return;\r\n    }\r\n\r\n    try {\r\n      // R√©cup√©rer les mati√®res personnalis√©es actuelles\r\n      const { data: schoolData, error: fetchError } = await supabase\r\n        .from('schools')\r\n        .select('custom_subjects')\r\n        .eq('id', currentSchool.id)\r\n        .single();\r\n\r\n      if (fetchError) {\r\n        console.error('‚ùå Erreur r√©cup√©ration mati√®res:', fetchError);\r\n        alert('Erreur lors de la r√©cup√©ration des mati√®res');\r\n        return;\r\n      }\r\n\r\n      // Ajouter la nouvelle mati√®re √† la liste\r\n      const currentCustomSubjects = schoolData.custom_subjects || [];\r\n      const updatedCustomSubjects = [...currentCustomSubjects, newSubject.trim()];\r\n\r\n      // Sauvegarder dans la base de donn√©es\r\n      const { error: updateError } = await supabase\r\n        .from('schools')\r\n        .update({ custom_subjects: updatedCustomSubjects })\r\n        .eq('id', currentSchool.id);\r\n\r\n      if (updateError) {\r\n        console.error('‚ùå Erreur sauvegarde mati√®re:', updateError);\r\n        alert('Erreur lors de la sauvegarde de la mati√®re');\r\n        return;\r\n      }\r\n\r\n      // Ajouter la nouvelle mati√®re √† l'√©tat local\r\n      const newSubjectObj = {\r\n        id: `custom-${Date.now()}`,\r\n        name: newSubject.trim()\r\n      };\r\n\r\n      setAvailableSubjects([...availableSubjects, newSubjectObj]);\r\n      setNewSubject('');\r\n      setShowAddSubjectModal(false);\r\n      \r\n      console.log('‚úÖ Mati√®re ajout√©e et sauvegard√©e:', newSubjectObj.name);\r\n    } catch (error) {\r\n      console.error('Exception ajout mati√®re:', error);\r\n      alert('Erreur lors de l\\'ajout de la mati√®re');\r\n    }\r\n  };\r\n\r\n  const handleSubmit = async () => {\r\n    if (assignmentData.subjects.length === 0 || assignmentData.classes.length === 0) {\r\n      alert('Veuillez s√©lectionner au moins une mati√®re et une classe.');\r\n      return;\r\n    }\r\n\r\n    setIsLoading(true);\r\n    try {\r\n      // Si c'est un nouvel enseignant (isNew = true), cr√©er d'abord le compte\r\n      let teacherId = teacher.id;\r\n      \r\n      if (teacher.isNew) {\r\n        // Cr√©er le compte utilisateur dans Supabase Auth\r\n        const { data: authData, error: authError } = await supabase.auth.signUp({\r\n          email: teacher.email,\r\n          password: teacher.password || 'TempPass123!', // Mot de passe temporaire\r\n          options: {\r\n            data: {\r\n              full_name: teacher.fullName,\r\n              role: 'teacher'\r\n            }\r\n          }\r\n        });\r\n\r\n        if (authError) {\r\n          console.error('Erreur cr√©ation compte Auth:', authError);\r\n          alert('Erreur lors de la cr√©ation du compte: ' + authError.message);\r\n          setIsLoading(false);\r\n          return;\r\n        }\r\n\r\n        teacherId = authData.user.id;\r\n\r\n        // Cr√©er l'entr√©e dans la table users\r\n        const { error: userError } = await supabase\r\n          .from('users')\r\n          .insert({\r\n            id: teacherId,\r\n            email: teacher.email,\r\n            full_name: teacher.fullName,\r\n            phone: teacher.phone,\r\n            role: 'teacher',\r\n            created_at: new Date().toISOString()\r\n          });\r\n\r\n        if (userError) {\r\n          console.error('Erreur cr√©ation utilisateur:', userError);\r\n          alert('Erreur lors de la cr√©ation de l\\'utilisateur: ' + userError.message);\r\n          setIsLoading(false);\r\n          return;\r\n        }\r\n\r\n        // Cr√©er l'entr√©e dans la table teachers et r√©cup√©rer son ID\r\n        const { data: teacherData, error: teacherError } = await supabase\r\n          .from('teachers')\r\n          .insert({\r\n            user_id: teacherId,\r\n            school_id: currentSchool.id,\r\n            first_name: teacher.fullName.split(' ')[0],\r\n            last_name: teacher.fullName.split(' ').slice(1).join(' ') || teacher.fullName.split(' ')[0],\r\n            is_active: true,\r\n            hire_date: assignmentData.startDate\r\n          })\r\n          .select('id')\r\n          .single();\r\n\r\n        if (teacherError) {\r\n          console.error('Erreur cr√©ation enseignant dans teachers:', teacherError);\r\n          alert('Erreur lors de la cr√©ation de l\\'enseignant: ' + teacherError.message);\r\n          setIsLoading(false);\r\n          return;\r\n        }\r\n\r\n        // Utiliser l'ID de la table teachers (pas le user_id) pour les assignations\r\n        teacherId = teacherData.id;\r\n        console.log('‚úÖ Enseignant cr√©√© dans teachers avec ID:', teacherId);\r\n\r\n        console.log('‚úÖ Nouvel enseignant cr√©√© avec l\\'ID:', teacherId);\r\n      }\r\n\r\n      // R√©cup√©rer l'ann√©e acad√©mique actuelle de l'√©cole\r\n      const { data: academicYears, error: yearError } = await supabase\r\n        .from('academic_years')\r\n        .select('id')\r\n        .eq('school_id', currentSchool.id)\r\n        .eq('is_current', true)\r\n        .single();\r\n\r\n      if (yearError || !academicYears) {\r\n        console.warn('‚ö†Ô∏è Aucune ann√©e acad√©mique active trouv√©e, cr√©ation sans ann√©e acad√©mique');\r\n        // Si pas d'ann√©e acad√©mique, on doit soit en cr√©er une, soit rendre le champ nullable\r\n        alert('Aucune ann√©e acad√©mique active trouv√©e pour cet √©tablissement. Veuillez d\\'abord configurer l\\'ann√©e acad√©mique.');\r\n        setIsLoading(false);\r\n        return;\r\n      }\r\n\r\n      const academicYearId = academicYears.id;\r\n      console.log('‚úÖ Ann√©e acad√©mique:', academicYearId);\r\n\r\n      // V√©rifier si l'enseignant existe dans la table teachers (pour les enseignants existants)\r\n      if (!teacher.isNew) {\r\n        // R√©cup√©rer l'ID de la table teachers (pas le user_id)\r\n        const { data: existingTeacher, error: checkError } = await supabase\r\n          .from('teachers')\r\n          .select('id')\r\n          .eq('user_id', teacherId)\r\n          .maybeSingle();\r\n\r\n        // Si l'enseignant n'existe pas dans la table teachers, le cr√©er\r\n        if (!existingTeacher && !checkError) {\r\n          console.log('‚ö†Ô∏è Enseignant existant mais pas dans la table teachers, cr√©ation...');\r\n          const { data: newTeacherData, error: teacherCreateError } = await supabase\r\n            .from('teachers')\r\n            .insert({\r\n              user_id: teacherId,\r\n              school_id: currentSchool.id,\r\n              first_name: teacher.fullName?.split(' ')[0] || 'Pr√©nom',\r\n              last_name: teacher.fullName?.split(' ').slice(1).join(' ') || 'Nom',\r\n              is_active: true,\r\n              hire_date: assignmentData.startDate\r\n            })\r\n            .single();\r\n\r\n          if (teacherCreateError) {\r\n            console.error('Erreur cr√©ation enseignant:', teacherCreateError);\r\n            alert('Erreur: Cet enseignant doit d\\'abord √™tre enregistr√© dans la table teachers.');\r\n            setIsLoading(false);\r\n            return;\r\n          }\r\n          teacherId = newTeacherData.id;\r\n          console.log('‚úÖ Enseignant ajout√© √† la table teachers avec ID:', teacherId);\r\n        } else if (existingTeacher) {\r\n          // Utiliser l'ID de la table teachers (pas le user_id)\r\n          teacherId = existingTeacher.id;\r\n          console.log('‚úÖ Enseignant trouv√© dans teachers avec ID:', teacherId);\r\n        }\r\n      }\r\n\r\n      // Cr√©er les assignations dans teacher_assignments\r\n      // Une entr√©e par combinaison classe-mati√®re\r\n      const assignments = [];\r\n      \r\n      // Fonction pour obtenir les heures d'une mati√®re sp√©cifique\r\n      const getHoursForSubject = (subject) => hoursPerSubject[subject] || 2;\r\n      \r\n      for (const className of assignmentData.classes) {\r\n        for (const subject of assignmentData.subjects) {\r\n          assignments.push({\r\n            teacher_id: teacherId,\r\n            school_id: currentSchool.id,\r\n            academic_year_id: academicYearId,\r\n            class_id: null, // Pas d'ID de classe pour l'instant, on utilise class_name\r\n            subject_id: null, // Pas d'ID de mati√®re pour l'instant, on utilise subject_name\r\n            class_name: className,\r\n            subject_name: subject,\r\n            is_active: true,\r\n            start_date: assignmentData.startDate,\r\n            end_date: assignmentData.endDate,\r\n            schedule: {\r\n              weekly_hours: getHoursForSubject(subject) // Utiliser les heures sp√©cifiques de la mati√®re\r\n            }\r\n          });\r\n        }\r\n      }\r\n\r\n      const { data, error } = await supabase\r\n        .from('teacher_assignments')\r\n        .insert(assignments)\r\n        .select();\r\n\r\n      if (error) {\r\n        console.error('Erreur cr√©ation assignation:', error);\r\n        alert('Erreur lors de la cr√©ation de l\\'assignation: ' + error.message);\r\n        setIsLoading(false);\r\n        return;\r\n      }\r\n\r\n      console.log('‚úÖ Assignation(s) cr√©√©e(s):', data.length);\r\n      onAssignmentComplete({\r\n        ...assignmentData,\r\n        teacher_id: teacherId,\r\n        school_id: currentSchool.id,\r\n        assignments: data\r\n      });\r\n    } catch (error) {\r\n      console.error('Exception:', error);\r\n      alert('Une erreur est survenue: ' + error.message);\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  const getSelectedClassesInfo = () => {\r\n    const selectedClasses = availableClasses.filter(c => assignmentData.classes.includes(c.name));\r\n    const totalStudents = selectedClasses.reduce((sum, c) => sum + c.studentsCount, 0);\r\n    return { selectedClasses, totalStudents };\r\n  };\r\n\r\n  const { selectedClasses, totalStudents } = getSelectedClassesInfo();\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      {/* En-t√™te avec informations enseignant */}\r\n      <div className=\"bg-primary/5 border border-primary/20 rounded-lg p-4\">\r\n        <div className=\"flex items-center space-x-3\">\r\n          <div className=\"w-12 h-12 bg-primary/10 rounded-lg flex items-center justify-center\">\r\n            <Icon name=\"User\" size={24} className=\"text-primary\" />\r\n          </div>\r\n          <div>\r\n            <h4 className=\"font-heading font-heading-semibold text-base text-text-primary\">\r\n              {teacher.fullName || `${teacher.firstName || ''} ${teacher.lastName || ''}`.trim()}\r\n            </h4>\r\n            <p className=\"text-sm text-text-secondary\">\r\n              {teacher.email} {teacher.phone && `‚Ä¢ ${teacher.phone}`}\r\n            </p>\r\n            {(teacher.subjects || teacher.specializations) && (teacher.subjects || teacher.specializations).length > 0 && (\r\n              <div className=\"flex flex-wrap gap-1 mt-2\">\r\n                {(teacher.subjects || teacher.specializations || []).map((spec, index) => (\r\n                  <span \r\n                    key={index}\r\n                    className=\"bg-primary/10 text-primary text-xs px-2 py-1 rounded-full\"\r\n                  >\r\n                    {spec}\r\n                  </span>\r\n                ))}\r\n              </div>\r\n            )}\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* √âtablissement de rattachement */}\r\n      <div className=\"bg-background-secondary border border-border rounded-lg p-4\">\r\n        <div className=\"flex items-center space-x-3\">\r\n          <div className=\"w-10 h-10 bg-secondary/10 rounded-lg flex items-center justify-center\">\r\n            <Icon name=\"Building\" size={20} className=\"text-secondary\" />\r\n          </div>\r\n          <div>\r\n            <h5 className=\"font-heading font-heading-semibold text-sm text-text-primary\">\r\n              √âtablissement de rattachement\r\n            </h5>\r\n            <p className=\"text-sm text-text-secondary\">\r\n              {currentSchool?.name || '√âtablissement non d√©fini'}\r\n            </p>\r\n            <p className=\"text-xs text-text-tertiary\">\r\n              L'enseignant sera assign√© √† votre √©tablissement\r\n            </p>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Formulaire d'assignation */}\r\n      <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\r\n        {/* P√©riode d'assignation */}\r\n        <div className=\"space-y-4\">\r\n          <h5 className=\"font-heading font-heading-semibold text-md text-text-primary\">\r\n            P√©riode d'assignation\r\n          </h5>\r\n\r\n          <div className=\"grid grid-cols-2 gap-4\">\r\n            <Input\r\n              label=\"Date de d√©but\"\r\n              type=\"date\"\r\n              value={assignmentData.startDate}\r\n              onChange={(e) => setAssignmentData(prev => ({ ...prev, startDate: e.target.value }))}\r\n              required\r\n            />\r\n            <Input\r\n              label=\"Date de fin\"\r\n              type=\"date\"\r\n              value={assignmentData.endDate}\r\n              onChange={(e) => setAssignmentData(prev => ({ ...prev, endDate: e.target.value }))}\r\n              required\r\n            />\r\n          </div>\r\n        </div>\r\n\r\n        {/* R√©sum√© de la charge */}\r\n        <div className=\"space-y-4\">\r\n          <h5 className=\"font-heading font-heading-semibold text-md text-text-primary\">\r\n            R√©sum√© de la charge\r\n          </h5>\r\n\r\n          <div className=\"bg-muted/30 rounded-lg p-4 space-y-3\">\r\n            <div className=\"flex justify-between text-sm\">\r\n              <span className=\"text-text-secondary\">Classes assign√©es:</span>\r\n              <span className=\"font-medium text-text-primary\">{assignmentData.classes.length}</span>\r\n            </div>\r\n            <div className=\"flex justify-between text-sm\">\r\n              <span className=\"text-text-secondary\">Mati√®res enseign√©es:</span>\r\n              <span className=\"font-medium text-text-primary\">{assignmentData.subjects.length}</span>\r\n            </div>\r\n            \r\n            {/* D√©tail des heures par mati√®re */}\r\n            {assignmentData.subjects.length > 0 && (\r\n              <div className=\"border-t border-border pt-2\">\r\n                <p className=\"text-xs text-text-secondary mb-2\">Heures par mati√®re (par classe):</p>\r\n                <div className=\"space-y-1\">\r\n                  {assignmentData.subjects.map((subject, idx) => (\r\n                    <div key={idx} className=\"flex justify-between text-xs\">\r\n                      <span className=\"text-text-secondary\">{subject}:</span>\r\n                      <span className=\"font-medium text-text-primary\">\r\n                        {hoursPerSubject[subject] || 2}h √ó {assignmentData.classes.length} classe(s) = {(hoursPerSubject[subject] || 2) * assignmentData.classes.length}h\r\n                      </span>\r\n                    </div>\r\n                  ))}\r\n                </div>\r\n              </div>\r\n            )}\r\n            \r\n            <div className=\"flex justify-between text-sm\">\r\n              <span className=\"text-text-secondary\">Total √©l√®ves:</span>\r\n              <span className=\"font-medium text-text-primary\">{totalStudents}</span>\r\n            </div>\r\n            <div className=\"border-t border-border pt-2\">\r\n              <div className=\"flex justify-between text-base\">\r\n                <span className=\"font-medium text-text-primary\">Total heures/semaine:</span>\r\n                <span className=\"font-bold text-primary\">{assignmentData.weeklyHours}h</span>\r\n              </div>\r\n            </div>\r\n\r\n            {/* Indicateur de charge */}\r\n            <div className=\"mt-3\">\r\n              <div className=\"flex justify-between text-xs mb-1\">\r\n                <span className=\"text-text-secondary\">Charge de travail</span>\r\n                <span className={`${assignmentData.weeklyHours > 25 ? 'text-error' : assignmentData.weeklyHours > 15 ? 'text-warning' : 'text-success'}`}>\r\n                  {assignmentData.weeklyHours > 25 ? '√âlev√©e' : assignmentData.weeklyHours > 15 ? 'Mod√©r√©e' : 'L√©g√®re'}\r\n                </span>\r\n              </div>\r\n              <div className=\"w-full bg-border rounded-full h-2\">\r\n                <div \r\n                  className={`h-2 rounded-full ${assignmentData.weeklyHours > 25 ? 'bg-error' : assignmentData.weeklyHours > 15 ? 'bg-warning' : 'bg-success'}`}\r\n                  style={{ width: `${Math.min((assignmentData.weeklyHours / 40) * 100, 100)}%` }}\r\n                />\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* S√©lection des mati√®res avec heures personnalisables */}\r\n      <div>\r\n        <h5 className=\"font-heading font-heading-semibold text-md text-text-primary mb-3 flex items-center gap-2\">\r\n          <Icon name=\"BookOpen\" size={18} className=\"text-primary\" />\r\n          Mati√®res √† enseigner\r\n        </h5>\r\n        <p className=\"text-xs text-text-tertiary mb-3\">\r\n          S√©lectionnez les mati√®res et d√©finissez le nombre d'heures par semaine pour chaque mati√®re\r\n        </p>\r\n        <div className=\"space-y-2\">\r\n          {availableSubjects.map((subject, index) => (\r\n            <div \r\n              key={subject.id || index} \r\n              className={`flex items-center gap-3 p-3 rounded-lg border transition-all ${\r\n                assignmentData.subjects.includes(subject.name)\r\n                  ? 'bg-primary/5 border-primary/30'\r\n                  : 'bg-muted/20 border-border hover:border-primary/20'\r\n              }`}\r\n            >\r\n              <Checkbox\r\n                id={`subject-${subject.id || index}`}\r\n                checked={assignmentData.subjects.includes(subject.name)}\r\n                onChange={(e) => handleSubjectChange(subject.name, e.target.checked)}\r\n              />\r\n              <label \r\n                htmlFor={`subject-${subject.id || index}`}\r\n                className=\"flex-1 text-sm font-medium text-text-primary cursor-pointer\"\r\n              >\r\n                {subject.name}\r\n              </label>\r\n              \r\n              {/* Champ de saisie des heures */}\r\n              {assignmentData.subjects.includes(subject.name) && (\r\n                <div className=\"flex items-center gap-2\">\r\n                  <Input\r\n                    type=\"number\"\r\n                    min=\"1\"\r\n                    max=\"10\"\r\n                    value={hoursPerSubject[subject.name] || 2}\r\n                    onChange={(e) => handleHoursChange(subject.name, e.target.value)}\r\n                    className=\"w-16 text-center text-sm\"\r\n                    placeholder=\"2\"\r\n                  />\r\n                  <span className=\"text-xs text-text-secondary whitespace-nowrap\">h/sem</span>\r\n                </div>\r\n              )}\r\n            </div>\r\n          ))}\r\n        </div>\r\n        \r\n        {/* R√©sum√© des heures par mati√®re */}\r\n        {assignmentData.subjects.length > 0 && (\r\n          <div className=\"mt-3 p-3 bg-blue-50 border border-blue-200 rounded-lg\">\r\n            <div className=\"flex items-start gap-2\">\r\n              <Icon name=\"Info\" size={14} className=\"text-blue-600 mt-0.5\" />\r\n              <div className=\"text-xs text-blue-700\">\r\n                <p className=\"font-semibold mb-1\">Heures configur√©es :</p>\r\n                <div className=\"flex flex-wrap gap-2\">\r\n                  {assignmentData.subjects.map((subject, idx) => (\r\n                    <span key={idx} className=\"bg-blue-100 px-2 py-0.5 rounded\">\r\n                      {subject}: {hoursPerSubject[subject] || 2}h\r\n                    </span>\r\n                  ))}\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        )}\r\n        \r\n        {availableSubjects.length === 0 && (\r\n          <div className=\"text-center py-4\">\r\n            <p className=\"text-sm text-text-secondary\">\r\n              Aucune mati√®re disponible pour cet √©tablissement\r\n            </p>\r\n          </div>\r\n        )}\r\n      </div>\r\n\r\n      {/* S√©lection des classes */}\r\n      <div>\r\n        <h5 className=\"font-heading font-heading-semibold text-md text-text-primary mb-3\">\r\n          Classes √† enseigner\r\n        </h5>\r\n        <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3\">\r\n          {availableClasses.map((classInfo, index) => (\r\n            <div \r\n              key={index} \r\n              className={`border border-border rounded-lg p-3 cursor-pointer transition-colors ${\r\n                assignmentData.classes.includes(classInfo.name) \r\n                  ? 'bg-primary/5 border-primary/30' \r\n                  : 'hover:bg-muted/30'\r\n              }`}\r\n              onClick={() => handleClassChange(classInfo.name, !assignmentData.classes.includes(classInfo.name))}\r\n            >\r\n              <div className=\"flex items-center justify-between\">\r\n                <div className=\"flex items-center space-x-2\">\r\n                  <Checkbox\r\n                    id={`class-${index}`}\r\n                    checked={assignmentData.classes.includes(classInfo.name)}\r\n                    onChange={(e) => handleClassChange(classInfo.name, e.target.checked)}\r\n                  />\r\n                  <div>\r\n                    <p className=\"font-medium text-sm text-text-primary\">\r\n                      {classInfo.name}\r\n                    </p>\r\n                    <p className=\"text-xs text-text-secondary\">\r\n                      {classInfo.studentsCount} √©l√®ves\r\n                    </p>\r\n                  </div>\r\n                </div>\r\n                {assignmentData.classes.includes(classInfo.name) && (\r\n                  <Icon name=\"Check\" size={16} className=\"text-primary\" />\r\n                )}\r\n              </div>\r\n            </div>\r\n          ))}\r\n        </div>\r\n\r\n        {availableClasses.length === 0 && (\r\n          <div className=\"text-center py-8\">\r\n            <Icon name=\"School\" size={48} className=\"text-muted-foreground mx-auto mb-2\" />\r\n            <p className=\"text-sm text-text-secondary\">\r\n              Aucune classe disponible pour cet √©tablissement\r\n            </p>\r\n          </div>\r\n        )}\r\n      </div>\r\n\r\n      {/* Classes s√©lectionn√©es - R√©capitulatif */}\r\n      {selectedClasses.length > 0 && (\r\n        <div className=\"bg-success/5 border border-success/20 rounded-lg p-4\">\r\n          <h5 className=\"font-medium text-sm text-text-primary mb-3 flex items-center\">\r\n            <Icon name=\"CheckCircle\" size={16} className=\"text-success mr-2\" />\r\n            Classes s√©lectionn√©es ({selectedClasses.length})\r\n          </h5>\r\n          <div className=\"grid grid-cols-2 md:grid-cols-4 gap-2\">\r\n            {selectedClasses.map((classInfo, index) => (\r\n              <div key={index} className=\"bg-background/50 rounded p-2 text-center\">\r\n                <p className=\"font-medium text-xs text-text-primary\">{classInfo.name}</p>\r\n                <p className=\"text-xs text-text-secondary\">{classInfo.studentsCount} √©l√®ves</p>\r\n              </div>\r\n            ))}\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Actions */}\r\n      <div className=\"flex gap-3 pt-4 border-t border-border\">\r\n        <Button \r\n          onClick={handleSubmit}\r\n          disabled={isLoading || assignmentData.subjects.length === 0 || assignmentData.classes.length === 0}\r\n          iconName=\"Check\"\r\n          iconPosition=\"left\"\r\n        >\r\n          {isLoading ? 'Cr√©ation en cours...' : 'Cr√©er l\\'assignation'}\r\n        </Button>\r\n        <Button \r\n          variant=\"outline\" \r\n          onClick={onCancel}\r\n          disabled={isLoading}\r\n        >\r\n          Annuler\r\n        </Button>\r\n      </div>\r\n\r\n      {/* Avertissements */}\r\n      {assignmentData.weeklyHours > 25 && (\r\n        <div className=\"bg-warning/5 border border-warning/20 rounded-lg p-3\">\r\n          <div className=\"flex items-start space-x-2\">\r\n            <Icon name=\"AlertTriangle\" size={16} className=\"text-warning mt-0.5\" />\r\n            <div>\r\n              <p className=\"text-sm font-medium text-text-primary\">\r\n                ‚ö†Ô∏è Charge de travail √©lev√©e\r\n              </p>\r\n              <p className=\"text-xs text-text-secondary\">\r\n                Cette assignation repr√©sente {assignmentData.weeklyHours}h/semaine, ce qui peut √™tre consid√©r√© comme une charge √©lev√©e.\r\n              </p>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Modal Ajouter une mati√®re */}\r\n      {showAddSubjectModal && (\r\n        <div className=\"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4\">\r\n          <div className=\"bg-card rounded-lg border border-border w-full max-w-md\">\r\n            <div className=\"p-6\">\r\n              <div className=\"flex items-center justify-between mb-6\">\r\n                <h3 className=\"font-heading font-heading-semibold text-xl text-text-primary\">\r\n                  Ajouter une mati√®re\r\n                </h3>\r\n                <button\r\n                  onClick={() => {\r\n                    setShowAddSubjectModal(false);\r\n                    setNewSubject('');\r\n                  }}\r\n                  className=\"text-text-secondary hover:text-text-primary\"\r\n                >\r\n                  <Icon name=\"X\" size={20} />\r\n                </button>\r\n              </div>\r\n\r\n              <div className=\"space-y-4\">\r\n                <div>\r\n                  <label className=\"block text-sm font-body font-body-medium text-text-secondary mb-2\">\r\n                    Nom de la mati√®re *\r\n                  </label>\r\n                  <Input\r\n                    type=\"text\"\r\n                    placeholder=\"Ex: Informatique, Biologie, etc.\"\r\n                    value={newSubject}\r\n                    onChange={(e) => setNewSubject(e.target.value)}\r\n                    onKeyPress={(e) => {\r\n                      if (e.key === 'Enter') {\r\n                        handleAddSubject();\r\n                      }\r\n                    }}\r\n                  />\r\n                  <p className=\"text-xs text-text-tertiary mt-1\">\r\n                    Cette mati√®re sera ajout√©e √† la liste des mati√®res disponibles\r\n                  </p>\r\n                </div>\r\n\r\n                <div className=\"bg-blue-50 border border-blue-200 rounded-lg p-3\">\r\n                  <div className=\"flex items-start space-x-2\">\r\n                    <Icon name=\"Info\" size={16} className=\"text-blue-600 mt-0.5\" />\r\n                    <p className=\"text-xs text-blue-700\">\r\n                      <strong>Note :</strong> Cette mati√®re sera disponible pour tous les enseignants de votre √©tablissement.\r\n                    </p>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n\r\n              <div className=\"flex gap-3 mt-6\">\r\n                <Button\r\n                  variant=\"outline\"\r\n                  onClick={() => {\r\n                    setShowAddSubjectModal(false);\r\n                    setNewSubject('');\r\n                  }}\r\n                  className=\"flex-1\"\r\n                >\r\n                  Annuler\r\n                </Button>\r\n                <Button\r\n                  onClick={handleAddSubject}\r\n                  className=\"flex-1\"\r\n                  iconName=\"Plus\"\r\n                  iconPosition=\"left\"\r\n                >\r\n                  Ajouter\r\n                </Button>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default TeacherAssignmentManager;","import React, { useState, useEffect } from 'react';\r\nimport { supabase } from '../../../lib/supabase';\r\nimport Icon from '../../../components/AppIcon';\r\nimport Button from '../../../components/ui/Button';\r\nimport Input from '../../../components/ui/Input';\r\nimport Select from '../../../components/ui/Select';\r\nimport Image from '../../../components/AppImage';\r\nimport TeacherSearchSelector from './TeacherSearchSelector';\r\nimport TeacherAssignmentManager from './TeacherAssignmentManager';\r\nimport { teacherMultiSchoolService } from '../../../services/teacherMultiSchoolService';\r\n\r\nconst TeacherManagementTab = () => {\r\n  const [searchTerm, setSearchTerm] = useState('');\r\n  const [filterSubject, setFilterSubject] = useState('');\r\n  const [filterStatus, setFilterStatus] = useState('');\r\n  const [loading, setLoading] = useState(true);\r\n\r\n  const [showEditModal, setShowEditModal] = useState(false);\r\n  const [showDeleteModal, setShowDeleteModal] = useState(false);\r\n  const [selectedTeacher, setSelectedTeacher] = useState(null);\r\n  \r\n  // √âtats pour le syst√®me multi-√©tablissements\r\n  const [showMultiSchoolAssignment, setShowMultiSchoolAssignment] = useState(false);\r\n  const [currentStep, setCurrentStep] = useState(1);\r\n  const [assignationMode, setAssignationMode] = useState('existing'); // 'new' ou 'existing'\r\n  const [selectedExistingTeacher, setSelectedExistingTeacher] = useState(null);\r\n  const [teacherSearchTerm, setTeacherSearchTerm] = useState('');\r\n\r\n  // √âtablissement de la secr√©taire connect√©e\r\n  const [currentSchool, setCurrentSchool] = useState(null);\r\n  const [schoolClasses, setSchoolClasses] = useState([]);\r\n  const [schoolSubjects, setSchoolSubjects] = useState([]);\r\n  \r\n  // Modal pour ajouter une mati√®re\r\n  const [showAddSubjectModal, setShowAddSubjectModal] = useState(false);\r\n  const [newSubject, setNewSubject] = useState('');\r\n\r\n  const [newTeacher, setNewTeacher] = useState({\r\n    fullName: '',\r\n    email: '',\r\n    phone: '',\r\n    subjects: [], // Chang√© en tableau pour plusieurs mati√®res\r\n    classes: [], // Chang√© en tableau pour plusieurs classes\r\n    password: '',\r\n    confirmPassword: ''\r\n  });\r\n\r\n  const initialTeachers = [\r\n    {\r\n      id: 1,\r\n      fullName: \"Marie Nguema\",\r\n      email: \"marie.nguema@school.cm\",\r\n      phone: \"+237 6 78 90 12 34\",\r\n      subject: \"Fran√ßais\",\r\n      className: \"CM2\",\r\n      status: \"active\",\r\n      joinDate: \"15/09/2024\",\r\n      teacherId: \"PROF001\",\r\n      avatar: \"/public/assets/images/no_image.png\"\r\n    },\r\n    {\r\n      id: 2,\r\n      fullName: \"Paul Mbarga\",\r\n      email: \"paul.mbarga@school.cm\",\r\n      phone: \"+237 6 89 01 23 45\",\r\n      subject: \"Math√©matiques\",\r\n      className: \"CM1\",\r\n      status: \"active\",\r\n      joinDate: \"12/09/2024\",\r\n      teacherId: \"PROF002\",\r\n      avatar: \"/public/assets/images/no_image.png\"\r\n    },\r\n    {\r\n      id: 3,\r\n      fullName: \"Sophie Fouda\",\r\n      email: \"sophie.fouda@school.cm\",\r\n      phone: \"+237 6 90 12 34 56\",\r\n      subject: \"Sciences\",\r\n      className: \"CE2\",\r\n      status: \"active\",\r\n      joinDate: \"10/09/2024\",\r\n      teacherId: \"PROF003\",\r\n      avatar: \"/public/assets/images/no_image.png\"\r\n    },\r\n    {\r\n      id: 4,\r\n      fullName: \"Jean Biya\",\r\n      email: \"jean.biya@school.cm\",\r\n      phone: \"+237 6 01 23 45 67\",\r\n      subject: \"Histoire-G√©ographie\",\r\n      className: \"CE1\",\r\n      status: \"inactive\",\r\n      joinDate: \"08/09/2024\",\r\n      teacherId: \"PROF004\",\r\n      avatar: \"/public/assets/images/no_image.png\"\r\n    }\r\n  ];\r\n\r\n  const [teachers, setTeachers] = useState([]);\r\n\r\n  // Charger les donn√©es au montage\r\n  useEffect(() => {\r\n    loadSchoolData();\r\n    loadTeachers();\r\n  }, []);\r\n\r\n  const loadSchoolData = async () => {\r\n    try {\r\n      const savedUser = localStorage.getItem('edutrack-user');\r\n      const userData = savedUser ? JSON.parse(savedUser) : null;\r\n      const schoolId = userData?.current_school_id;\r\n\r\n      if (!schoolId) {\r\n        console.warn('‚ö†Ô∏è Pas d\\'√©cole associ√©e');\r\n        return;\r\n      }\r\n\r\n      // Charger les informations de l'√©cole\r\n      const { data: schoolData, error: schoolError } = await supabase\r\n        .from('schools')\r\n        .select('id, name, type, available_classes, custom_subjects')\r\n        .eq('id', schoolId)\r\n        .single();\r\n\r\n      if (schoolError) {\r\n        console.error('‚ùå Erreur chargement √©cole:', schoolError);\r\n        return;\r\n      }\r\n\r\n      setCurrentSchool({\r\n        id: schoolData.id,\r\n        name: schoolData.name,\r\n        type: schoolData.type\r\n      });\r\n\r\n      console.log('‚úÖ √âcole charg√©e:', schoolData.name);\r\n      console.log('üìã Classes disponibles dans l\\'√©cole:', schoolData.available_classes);\r\n\r\n      // Utiliser les classes choisies lors de la cr√©ation de l'√©cole\r\n      if (schoolData.available_classes && Array.isArray(schoolData.available_classes) && schoolData.available_classes.length > 0) {\r\n        const schoolClassesList = schoolData.available_classes.map((className, index) => ({\r\n          id: `class-${index}`,\r\n          name: className,\r\n          level: className\r\n        }));\r\n        setSchoolClasses(schoolClassesList);\r\n        console.log(`‚úÖ ${schoolClassesList.length} classe(s) charg√©e(s) depuis available_classes`);\r\n      } else {\r\n        console.warn('‚ö†Ô∏è Aucune classe dans available_classes, utilisation des classes par d√©faut');\r\n        const defaultClasses = getDefaultClassesBySchoolType(schoolData.type);\r\n        setSchoolClasses(defaultClasses);\r\n      }\r\n\r\n      // Charger les mati√®res: mati√®res par d√©faut + mati√®res personnalis√©es\r\n      console.log('üìö Chargement des mati√®res pour le type:', schoolData.type);\r\n      const defaultSubjects = getDefaultSubjectsBySchoolType(schoolData.type);\r\n      \r\n      // Ajouter les mati√®res personnalis√©es sauvegard√©es\r\n      let customSubjects = [];\r\n      if (schoolData.custom_subjects && Array.isArray(schoolData.custom_subjects) && schoolData.custom_subjects.length > 0) {\r\n        customSubjects = schoolData.custom_subjects.map((subjectName, index) => ({\r\n          id: `custom-${index}`,\r\n          name: subjectName\r\n        }));\r\n        console.log(`‚úÖ ${customSubjects.length} mati√®re(s) personnalis√©e(s) charg√©e(s)`);\r\n      }\r\n      \r\n      const allSubjects = [...defaultSubjects, ...customSubjects];\r\n      setSchoolSubjects(allSubjects);\r\n      console.log(`‚úÖ Total: ${allSubjects.length} mati√®re(s) disponibles (${defaultSubjects.length} par d√©faut + ${customSubjects.length} personnalis√©es)`);\r\n    } catch (error) {\r\n      console.error('Exception chargement donn√©es √©cole:', error);\r\n    }\r\n  };\r\n\r\n  // Fonction pour obtenir les classes par d√©faut selon le type d'√©cole\r\n  const getDefaultClassesBySchoolType = (schoolType) => {\r\n    if (schoolType === 'Maternelle') {\r\n      return [\r\n        { id: 'default-ps', name: 'Petite Section', level: 'PS' },\r\n        { id: 'default-ms', name: 'Moyenne Section', level: 'MS' },\r\n        { id: 'default-gs', name: 'Grande Section', level: 'GS' }\r\n      ];\r\n    } else if (schoolType === 'Primaire') {\r\n      return [\r\n        { id: 'default-cp', name: 'CP', level: 'CP' },\r\n        { id: 'default-ce1', name: 'CE1', level: 'CE1' },\r\n        { id: 'default-ce2', name: 'CE2', level: 'CE2' },\r\n        { id: 'default-cm1', name: 'CM1', level: 'CM1' },\r\n        { id: 'default-cm2', name: 'CM2', level: 'CM2' }\r\n      ];\r\n    } else if (schoolType === 'Coll√®ge') {\r\n      return [\r\n        { id: 'default-6eme', name: '6√®me', level: '6√®me' },\r\n        { id: 'default-5eme', name: '5√®me', level: '5√®me' },\r\n        { id: 'default-4eme', name: '4√®me', level: '4√®me' },\r\n        { id: 'default-3eme', name: '3√®me', level: '3√®me' }\r\n      ];\r\n    } else if (schoolType === 'Lyc√©e') {\r\n      return [\r\n        { id: 'default-2nde', name: '2nde', level: '2nde' },\r\n        { id: 'default-1ere', name: '1√®re', level: '1√®re' },\r\n        { id: 'default-tle', name: 'Terminale', level: 'Terminale' }\r\n      ];\r\n    } else {\r\n      return [];\r\n    }\r\n  };\r\n\r\n  // Fonction pour obtenir les mati√®res par d√©faut selon le type d'√©cole\r\n  const getDefaultSubjectsBySchoolType = (schoolType) => {\r\n    if (schoolType === 'Primaire' || schoolType === 'Maternelle') {\r\n      return [\r\n        { id: 'default-math', name: 'Math√©matiques' },\r\n        { id: 'default-french', name: 'Fran√ßais' },\r\n        { id: 'default-reading', name: 'Lecture' },\r\n        { id: 'default-writing', name: '√âcriture' },\r\n        { id: 'default-oral', name: 'Expression Orale' },\r\n        { id: 'default-grammar', name: 'Grammaire' },\r\n        { id: 'default-vocabulary', name: 'Vocabulaire' },\r\n        { id: 'default-english', name: 'Anglais' },\r\n        { id: 'default-science', name: 'D√©couverte du Monde' },\r\n        { id: 'default-history', name: 'Histoire' },\r\n        { id: 'default-geography', name: 'G√©ographie' },\r\n        { id: 'default-civics', name: '√âducation Civique et Morale' },\r\n        { id: 'default-arts', name: 'Arts Plastiques' },\r\n        { id: 'default-music', name: '√âducation Musicale' },\r\n        { id: 'default-pe', name: '√âducation Physique et Sportive' },\r\n        { id: 'default-ict', name: 'Informatique' }\r\n      ];\r\n    } else if (schoolType === 'Coll√®ge') {\r\n      return [\r\n        { id: 'default-math', name: 'Math√©matiques' },\r\n        { id: 'default-french', name: 'Fran√ßais' },\r\n        { id: 'default-english', name: 'Anglais LV1' },\r\n        { id: 'default-german', name: 'Allemand LV2' },\r\n        { id: 'default-spanish', name: 'Espagnol LV2' },\r\n        { id: 'default-hg', name: 'Histoire-G√©ographie' },\r\n        { id: 'default-emc', name: 'Enseignement Moral et Civique (EMC)' },\r\n        { id: 'default-svt', name: 'Sciences de la Vie et de la Terre (SVT)' },\r\n        { id: 'default-pc', name: 'Physique-Chimie' },\r\n        { id: 'default-tech', name: 'Technologie' },\r\n        { id: 'default-arts', name: 'Arts Plastiques' },\r\n        { id: 'default-music', name: '√âducation Musicale' },\r\n        { id: 'default-pe', name: '√âducation Physique et Sportive (EPS)' },\r\n        { id: 'default-ict', name: 'Informatique et Num√©rique' }\r\n      ];\r\n    } else if (schoolType === 'Lyc√©e G√©n√©ral') {\r\n      return [\r\n        { id: 'default-math', name: 'Math√©matiques' },\r\n        { id: 'default-french', name: 'Fran√ßais' },\r\n        { id: 'default-literature', name: 'Litt√©rature' },\r\n        { id: 'default-english', name: 'Anglais LV1' },\r\n        { id: 'default-german', name: 'Allemand LV2' },\r\n        { id: 'default-spanish', name: 'Espagnol LV2' },\r\n        { id: 'default-hg', name: 'Histoire-G√©ographie' },\r\n        { id: 'default-emc', name: 'Enseignement Moral et Civique (EMC)' },\r\n        { id: 'default-svt', name: 'Sciences de la Vie et de la Terre (SVT)' },\r\n        { id: 'default-pc', name: 'Physique-Chimie' },\r\n        { id: 'default-philo', name: 'Philosophie' },\r\n        { id: 'default-ses', name: 'Sciences √âconomiques et Sociales (SES)' },\r\n        { id: 'default-nsi', name: 'Num√©rique et Sciences Informatiques (NSI)' },\r\n        { id: 'default-si', name: 'Sciences de l\\'Ing√©nieur (SI)' },\r\n        { id: 'default-hggsp', name: 'Histoire-G√©ographie, G√©opolitique et Sciences Politiques' },\r\n        { id: 'default-hlp', name: 'Humanit√©s, Litt√©rature et Philosophie' },\r\n        { id: 'default-llcer', name: 'Langues, Litt√©ratures et Cultures √âtrang√®res' },\r\n        { id: 'default-arts', name: 'Arts Plastiques' },\r\n        { id: 'default-music', name: 'Musique' },\r\n        { id: 'default-pe', name: '√âducation Physique et Sportive (EPS)' }\r\n      ];\r\n    } else if (schoolType === 'Lyc√©e Technique') {\r\n      return [\r\n        { id: 'default-math', name: 'Math√©matiques' },\r\n        { id: 'default-french', name: 'Fran√ßais' },\r\n        { id: 'default-english', name: 'Anglais' },\r\n        { id: 'default-hg', name: 'Histoire-G√©ographie' },\r\n        { id: 'default-pc', name: 'Physique-Chimie' },\r\n        { id: 'default-tech-draw', name: 'Dessin Technique' },\r\n        { id: 'default-cao', name: 'Conception Assist√©e par Ordinateur (CAO)' },\r\n        { id: 'default-elec', name: '√âlectrotechnique' },\r\n        { id: 'default-electronics', name: '√âlectronique' },\r\n        { id: 'default-meca', name: 'M√©canique' },\r\n        { id: 'default-auto', name: 'M√©canique Automobile' },\r\n        { id: 'default-info', name: 'Informatique' },\r\n        { id: 'default-network', name: 'R√©seaux et T√©l√©communications' },\r\n        { id: 'default-construction', name: 'Construction et B√¢timent' },\r\n        { id: 'default-industrial', name: 'G√©nie Industriel' },\r\n        { id: 'default-energy', name: '√ânergies et Environnement' },\r\n        { id: 'default-si', name: 'Sciences de l\\'Ing√©nieur' },\r\n        { id: 'default-pe', name: '√âducation Physique et Sportive (EPS)' }\r\n      ];\r\n    } else if (schoolType === 'Lyc√©e Professionnel') {\r\n      return [\r\n        { id: 'default-math', name: 'Math√©matiques' },\r\n        { id: 'default-french', name: 'Fran√ßais' },\r\n        { id: 'default-english', name: 'Anglais Professionnel' },\r\n        { id: 'default-hg', name: 'Histoire-G√©ographie' },\r\n        { id: 'default-pro-tech', name: 'Enseignement Professionnel' },\r\n        { id: 'default-eco-gestion', name: '√âconomie-Gestion' },\r\n        { id: 'default-eco-droit', name: '√âconomie-Droit' },\r\n        { id: 'default-commerce', name: 'Techniques de Vente et Commerce' },\r\n        { id: 'default-comptability', name: 'Comptabilit√©' },\r\n        { id: 'default-secretariat', name: 'Secr√©tariat et Bureautique' },\r\n        { id: 'default-cuisine', name: 'Arts Culinaires et Restauration' },\r\n        { id: 'default-hotellerie', name: 'H√¥tellerie et Tourisme' },\r\n        { id: 'default-coiffure', name: 'Coiffure et Esth√©tique' },\r\n        { id: 'default-mode', name: 'Mode et Couture' },\r\n        { id: 'default-menuiserie', name: 'Menuiserie et √âb√©nisterie' },\r\n        { id: 'default-pse', name: 'Pr√©vention Sant√© Environnement (PSE)' },\r\n        { id: 'default-arts-appliques', name: 'Arts Appliqu√©s' },\r\n        { id: 'default-pe', name: '√âducation Physique et Sportive (EPS)' }\r\n      ];\r\n    } else {\r\n      return [\r\n        { id: 'default-math', name: 'Math√©matiques' },\r\n        { id: 'default-french', name: 'Fran√ßais' },\r\n        { id: 'default-english', name: 'Anglais' },\r\n        { id: 'default-science', name: 'Sciences' },\r\n        { id: 'default-history', name: 'Histoire' },\r\n        { id: 'default-geography', name: 'G√©ographie' },\r\n        { id: 'default-arts', name: 'Arts' },\r\n        { id: 'default-pe', name: '√âducation Physique et Sportive' }\r\n      ];\r\n    }\r\n  };\r\n\r\n  const loadTeachers = async () => {\r\n    try {\r\n      setLoading(true);\r\n      const savedUser = localStorage.getItem('edutrack-user');\r\n      const userData = savedUser ? JSON.parse(savedUser) : null;\r\n      const schoolId = userData?.current_school_id;\r\n\r\n      if (!schoolId) {\r\n        console.warn('‚ö†Ô∏è Pas d\\'√©cole associ√©e');\r\n        setTeachers([]);\r\n        setLoading(false);\r\n        return;\r\n      }\r\n\r\n      // Charger les assignations depuis teacher_assignments\r\n      console.log('üîç Recherche assignations pour school_id:', schoolId);\r\n      const { data: assignments, error: assignError } = await supabase\r\n        .from('teacher_assignments')\r\n        .select('id, teacher_id, class_name, subject_name, schedule, start_date, is_active')\r\n        .eq('school_id', schoolId)\r\n        .eq('is_active', true)\r\n        .order('created_at', { ascending: false });\r\n\r\n      console.log('üìä R√©sultat assignations:', { assignments, error: assignError });\r\n\r\n      if (assignError) {\r\n        console.error('‚ùå Erreur chargement assignations:', assignError);\r\n        setTeachers([]);\r\n        setLoading(false);\r\n        return;\r\n      }\r\n\r\n      if (!assignments || assignments.length === 0) {\r\n        console.log('‚ö†Ô∏è Aucune assignation trouv√©e pour cette √©cole');\r\n        console.log('üí° V√©rification: y a-t-il des enseignants dans la table teachers ?');\r\n        \r\n        // Charger quand m√™me les enseignants sans assignation\r\n        const { data: allTeachers, error: allTeachersError } = await supabase\r\n          .from('teachers')\r\n          .select('id, user_id, school_id')\r\n          .eq('school_id', schoolId);\r\n        \r\n        console.log('üë®‚Äçüè´ Enseignants dans la table teachers:', allTeachers);\r\n        \r\n        if (allTeachers && allTeachers.length > 0) {\r\n          // Il y a des enseignants, mais pas d'assignations\r\n          const userIds = allTeachers.map(t => t.user_id);\r\n          const { data: users, error: userError } = await supabase\r\n            .from('users')\r\n            .select('id, email, phone, full_name')\r\n            .in('id', userIds)\r\n            .eq('role', 'teacher');\r\n          \r\n          console.log('üë§ Utilisateurs enseignants:', users);\r\n          \r\n          const teachersWithoutAssignment = allTeachers.map(teacher => {\r\n            const user = users?.find(u => u.id === teacher.user_id);\r\n            return {\r\n              id: teacher.id,\r\n              fullName: user?.full_name || 'Nom inconnu',\r\n              email: user?.email || 'Non renseign√©',\r\n              phone: user?.phone || 'Non renseign√©',\r\n              subjects: ['Aucune mati√®re assign√©e'],\r\n              classes: ['Aucune classe assign√©e'],\r\n              status: 'active',\r\n              teacherId: `PROF${String(teacher.id).padStart(3, '0')}`,\r\n              avatar: '/public/assets/images/no_image.png'\r\n            };\r\n          });\r\n          \r\n          setTeachers(teachersWithoutAssignment);\r\n          console.log('‚úÖ Enseignants charg√©s sans assignation:', teachersWithoutAssignment.length);\r\n        } else {\r\n          setTeachers([]);\r\n        }\r\n        \r\n        setLoading(false);\r\n        return;\r\n      }\r\n\r\n      // R√©cup√©rer les IDs uniques des enseignants (teachers.id)\r\n      const teacherIds = [...new Set(assignments.map(a => a.teacher_id))];\r\n\r\n      // Charger les enseignants depuis la table teachers pour obtenir les user_id\r\n      const { data: teachers, error: teachersError } = await supabase\r\n        .from('teachers')\r\n        .select('id, user_id')\r\n        .in('id', teacherIds);\r\n\r\n      if (teachersError) {\r\n        console.error('Erreur chargement teachers:', teachersError);\r\n      }\r\n\r\n      // Cr√©er un map teacher_id -> user_id\r\n      const teacherToUserMap = new Map();\r\n      (teachers || []).forEach(teacher => {\r\n        teacherToUserMap.set(teacher.id, teacher.user_id);\r\n      });\r\n\r\n      // R√©cup√©rer les user_id correspondants\r\n      const userIds = [...new Set(teachers?.map(t => t.user_id) || [])];\r\n\r\n      // Charger les informations des utilisateurs\r\n      const { data: users, error: userError } = await supabase\r\n        .from('users')\r\n        .select('id, email, phone, full_name')\r\n        .in('id', userIds)\r\n        .eq('role', 'teacher');\r\n\r\n      if (userError) {\r\n        console.error('Erreur chargement utilisateurs:', userError);\r\n      }\r\n\r\n      // Cr√©er un map des utilisateurs pour un acc√®s rapide (par user_id)\r\n      const userMap = new Map();\r\n      (users || []).forEach(user => {\r\n        userMap.set(user.id, user);\r\n      });\r\n\r\n      // Regrouper par enseignant\r\n      const teacherMap = new Map();\r\n      \r\n      assignments.forEach(assignment => {\r\n        const teacherId = assignment.teacher_id; // teachers.id\r\n        const userId = teacherToUserMap.get(teacherId); // Obtenir le user_id correspondant\r\n        const user = userMap.get(userId); // R√©cup√©rer les infos utilisateur\r\n        \r\n        if (!teacherMap.has(teacherId)) {\r\n          teacherMap.set(teacherId, {\r\n            id: teacherId,\r\n            fullName: user?.full_name || 'Nom inconnu',\r\n            email: user?.email || 'Non renseign√©',\r\n            phone: user?.phone || 'Non renseign√©',\r\n            subjects: [],\r\n            classes: [],\r\n            totalHours: 0,\r\n            status: 'active',\r\n            joinDate: assignment.start_date ? new Date(assignment.start_date).toLocaleDateString('fr-FR') : 'Non renseign√©e',\r\n            teacherId: teacherId.substring(0, 8),\r\n            avatar: '/public/assets/images/no_image.png'\r\n          });\r\n        }\r\n        \r\n        const teacher = teacherMap.get(teacherId);\r\n        \r\n        // Ajouter les mati√®res et classes (√©viter les doublons)\r\n        if (assignment.subject_name && !teacher.subjects.includes(assignment.subject_name)) {\r\n          teacher.subjects.push(assignment.subject_name);\r\n        }\r\n        if (assignment.class_name && !teacher.classes.includes(assignment.class_name)) {\r\n          teacher.classes.push(assignment.class_name);\r\n        }\r\n        // Extraire weekly_hours du schedule JSON\r\n        const weeklyHours = assignment.schedule?.weekly_hours || 0;\r\n        teacher.totalHours += weeklyHours;\r\n      });\r\n      \r\n      const formattedTeachers = Array.from(teacherMap.values()).map(teacher => ({\r\n        ...teacher,\r\n        subject: teacher.subjects.join(', ') || 'Non assign√©',\r\n        className: teacher.classes.join(', ') || 'Non assign√©'\r\n      }));\r\n      \r\n      setTeachers(formattedTeachers);\r\n      console.log(`‚úÖ ${formattedTeachers.length} enseignant(s) charg√©(s)`);\r\n    } catch (error) {\r\n      console.error('Exception chargement enseignants:', error);\r\n      setTeachers([]);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  // Options dynamiques bas√©es sur les donn√©es de l'√©cole\r\n  const subjectOptions = [\r\n    { value: '', label: 'Toutes les mati√®res' },\r\n    ...schoolSubjects.map(subject => ({\r\n      value: subject.name,\r\n      label: subject.name\r\n    }))\r\n  ];\r\n\r\n  const statusOptions = [\r\n    { value: '', label: 'Tous les statuts' },\r\n    { value: 'active', label: 'Actif' },\r\n    { value: 'inactive', label: 'Inactif' },\r\n    { value: 'pending', label: 'En attente' }\r\n  ];\r\n\r\n  const classOptions = [\r\n    { value: '', label: 'Toutes les classes' },\r\n    ...schoolClasses.map(cls => ({\r\n      value: cls.name,\r\n      label: cls.name\r\n    }))\r\n  ];\r\n\r\n\r\n\r\n  // Fonctions pour le workflow multi-√©tablissements\r\n  const resetMultiSchoolWorkflow = () => {\r\n    setCurrentStep(1);\r\n    setAssignationMode('existing');\r\n    setSelectedExistingTeacher(null);\r\n    setTeacherSearchTerm('');\r\n  };\r\n\r\n  const nextStep = () => {\r\n    if (currentStep < 3) setCurrentStep(currentStep + 1);\r\n  };\r\n\r\n  const prevStep = () => {\r\n    if (currentStep > 1) setCurrentStep(currentStep - 1);\r\n  };\r\n\r\n  const handleMultiSchoolAssignment = () => {\r\n    resetMultiSchoolWorkflow();\r\n    setShowMultiSchoolAssignment(true);\r\n  };\r\n\r\n  const getStatusBadge = (status) => {\r\n    const statusConfig = {\r\n      active: { label: 'Actif', className: 'bg-success/10 text-success' },\r\n      inactive: { label: 'Inactif', className: 'bg-error/10 text-error' },\r\n      pending: { label: 'En attente', className: 'bg-warning/10 text-warning' }\r\n    };\r\n    \r\n    const config = statusConfig?.[status] || statusConfig?.active;\r\n    return (\r\n      <span className={`px-2 py-1 rounded-full text-xs font-caption font-caption-normal ${config?.className}`}>\r\n        {config?.label}\r\n      </span>\r\n    );\r\n  };\r\n\r\n  const filteredTeachers = teachers?.filter(teacher => {\r\n    const matchesSearch = teacher?.fullName?.toLowerCase()?.includes(searchTerm?.toLowerCase()) ||\r\n                         teacher?.email?.toLowerCase()?.includes(searchTerm?.toLowerCase()) ||\r\n                         teacher?.teacherId?.toLowerCase()?.includes(searchTerm?.toLowerCase());\r\n    const matchesSubject = !filterSubject || teacher?.subject === filterSubject;\r\n    const matchesStatus = !filterStatus || teacher?.status === filterStatus;\r\n    \r\n    return matchesSearch && matchesSubject && matchesStatus;\r\n  });\r\n\r\n\r\n\r\n  const handleEditTeacher = (teacherId) => {\r\n    const teacher = teachers.find(t => t.id === teacherId);\r\n    if (teacher) {\r\n      setSelectedTeacher(teacher);\r\n      setNewTeacher({\r\n        fullName: teacher.fullName,\r\n        email: teacher.email,\r\n        phone: teacher.phone,\r\n        subjects: Array.isArray(teacher.subject) ? teacher.subject : [teacher.subject],\r\n        classes: Array.isArray(teacher.className) ? teacher.className : [teacher.className],\r\n        password: '',\r\n        confirmPassword: ''\r\n      });\r\n      setShowEditModal(true);\r\n    }\r\n  };\r\n\r\n  const handleUpdateTeacher = () => {\r\n    if (selectedTeacher && newTeacher.fullName && newTeacher.email && newTeacher.subjects.length > 0 && newTeacher.classes.length > 0) {\r\n      \r\n      // Si un nouveau mot de passe est fourni, le valider\r\n      if (newTeacher.password) {\r\n        if (!validatePassword(newTeacher.password)) {\r\n          alert('Le mot de passe doit contenir au moins 8 caract√®res avec : une majuscule, une minuscule, un chiffre et un caract√®re sp√©cial');\r\n          return;\r\n        }\r\n        \r\n        if (newTeacher.password !== newTeacher.confirmPassword) {\r\n          alert('Les mots de passe ne correspondent pas');\r\n          return;\r\n        }\r\n      }\r\n      \r\n      setTeachers(teachers.map(teacher => \r\n        teacher.id === selectedTeacher.id\r\n          ? {\r\n              ...teacher,\r\n              fullName: newTeacher.fullName,\r\n              email: newTeacher.email,\r\n              phone: newTeacher.phone,\r\n              subject: newTeacher.subjects.join(', '), // Afficher toutes les mati√®res\r\n              className: newTeacher.classes.join(', '), // Afficher toutes les classes\r\n              subjects: newTeacher.subjects,\r\n              classes: newTeacher.classes\r\n            }\r\n          : teacher\r\n      ));\r\n      setShowEditModal(false);\r\n      setSelectedTeacher(null);\r\n      setNewTeacher({\r\n        fullName: '',\r\n        email: '',\r\n        phone: '',\r\n        subjects: [],\r\n        classes: [],\r\n        password: '',\r\n        confirmPassword: ''\r\n      });\r\n    }\r\n  };\r\n\r\n  const handleDeleteTeacher = (teacherId) => {\r\n    const teacher = teachers.find(t => t.id === teacherId);\r\n    if (teacher) {\r\n      setSelectedTeacher(teacher);\r\n      setShowDeleteModal(true);\r\n    }\r\n  };\r\n\r\n  const handleConfirmDelete = () => {\r\n    if (selectedTeacher) {\r\n      setTeachers(teachers.filter(teacher => teacher.id !== selectedTeacher.id));\r\n      setShowDeleteModal(false);\r\n      setSelectedTeacher(null);\r\n    }\r\n  };\r\n\r\n  const handleToggleStatus = (teacherId) => {\r\n    setTeachers(teachers.map(teacher => \r\n      teacher.id === teacherId \r\n        ? { ...teacher, status: teacher.status === 'active' ? 'inactive' : 'active' }\r\n        : teacher\r\n    ));\r\n  };\r\n\r\n  const validatePassword = (password) => {\r\n    if (password.length < 8) return false;\r\n    if (!/(?=.*[a-z])/.test(password)) return false;\r\n    if (!/(?=.*[A-Z])/.test(password)) return false;\r\n    if (!/(?=.*\\d)/.test(password)) return false;\r\n    if (!/(?=.*[@$!%*?&])/.test(password)) return false;\r\n    return true;\r\n  };\r\n\r\n  const generateSecurePassword = () => {\r\n    const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789@$!%*?&';\r\n    let password = '';\r\n    // Au moins une majuscule, une minuscule, un chiffre et un caract√®re sp√©cial\r\n    password += 'ABCDEFGHIJKLMNOPQRSTUVWXYZ'[Math.floor(Math.random() * 26)];\r\n    password += 'abcdefghijklmnopqrstuvwxyz'[Math.floor(Math.random() * 26)];\r\n    password += '0123456789'[Math.floor(Math.random() * 10)];\r\n    password += '@$!%*?&'[Math.floor(Math.random() * 7)];\r\n    \r\n    // Compl√©ter avec 4 caract√®res al√©atoires\r\n    for (let i = 4; i < 8; i++) {\r\n      password += chars[Math.floor(Math.random() * chars.length)];\r\n    }\r\n    \r\n    // M√©langer les caract√®res\r\n    password = password.split('').sort(() => 0.5 - Math.random()).join('');\r\n    \r\n    setNewTeacher(prev => ({ \r\n      ...prev, \r\n      password: password,\r\n      confirmPassword: password\r\n    }));\r\n  };\r\n\r\n  const handleAddSubject = async () => {\r\n    if (!newSubject.trim()) {\r\n      alert('Veuillez entrer le nom de la mati√®re');\r\n      return;\r\n    }\r\n\r\n    // V√©rifier si la mati√®re existe d√©j√†\r\n    if (schoolSubjects.some(s => s.name.toLowerCase() === newSubject.trim().toLowerCase())) {\r\n      alert('Cette mati√®re existe d√©j√†');\r\n      return;\r\n    }\r\n\r\n    try {\r\n      // R√©cup√©rer les mati√®res personnalis√©es actuelles\r\n      const { data: schoolData, error: fetchError } = await supabase\r\n        .from('schools')\r\n        .select('custom_subjects')\r\n        .eq('id', currentSchool.id)\r\n        .single();\r\n\r\n      if (fetchError) {\r\n        console.error('‚ùå Erreur r√©cup√©ration mati√®res:', fetchError);\r\n        alert('Erreur lors de la r√©cup√©ration des mati√®res');\r\n        return;\r\n      }\r\n\r\n      // Ajouter la nouvelle mati√®re √† la liste\r\n      const currentCustomSubjects = schoolData.custom_subjects || [];\r\n      const updatedCustomSubjects = [...currentCustomSubjects, newSubject.trim()];\r\n\r\n      // Sauvegarder dans la base de donn√©es\r\n      const { error: updateError } = await supabase\r\n        .from('schools')\r\n        .update({ custom_subjects: updatedCustomSubjects })\r\n        .eq('id', currentSchool.id);\r\n\r\n      if (updateError) {\r\n        console.error('‚ùå Erreur sauvegarde mati√®re:', updateError);\r\n        alert('Erreur lors de la sauvegarde de la mati√®re');\r\n        return;\r\n      }\r\n\r\n      // Ajouter la nouvelle mati√®re √† l'√©tat local\r\n      const newSubjectObj = {\r\n        id: `custom-${Date.now()}`,\r\n        name: newSubject.trim()\r\n      };\r\n\r\n      setSchoolSubjects([...schoolSubjects, newSubjectObj]);\r\n      setNewSubject('');\r\n      setShowAddSubjectModal(false);\r\n      \r\n      console.log('‚úÖ Mati√®re ajout√©e et sauvegard√©e:', newSubjectObj.name);\r\n    } catch (error) {\r\n      console.error('Exception ajout mati√®re:', error);\r\n      alert('Erreur lors de l\\'ajout de la mati√®re');\r\n    }\r\n  };\r\n\r\n  // Gestion de la s√©lection multiple de mati√®res\r\n  const toggleSubjectSelection = (subjectName) => {\r\n    setNewTeacher(prev => {\r\n      const currentSubjects = prev.subjects || [];\r\n      if (currentSubjects.includes(subjectName)) {\r\n        return { ...prev, subjects: currentSubjects.filter(s => s !== subjectName) };\r\n      } else {\r\n        return { ...prev, subjects: [...currentSubjects, subjectName] };\r\n      }\r\n    });\r\n  };\r\n\r\n  // Gestion de la s√©lection multiple de classes\r\n  const toggleClassSelection = (className) => {\r\n    setNewTeacher(prev => {\r\n      const currentClasses = prev.classes || [];\r\n      if (currentClasses.includes(className)) {\r\n        return { ...prev, classes: currentClasses.filter(c => c !== className) };\r\n      } else {\r\n        return { ...prev, classes: [...currentClasses, className] };\r\n      }\r\n    });\r\n  };\r\n\r\n  // Indicateur de chargement\r\n  if (loading) {\r\n    return (\r\n      <div className=\"flex items-center justify-center py-12\">\r\n        <div className=\"text-center\">\r\n          <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4\"></div>\r\n          <p className=\"text-text-secondary\">Chargement des enseignants...</p>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      {/* Informations de l'√©tablissement */}\r\n      {currentSchool && (\r\n        <div className=\"bg-gradient-to-r from-primary/10 to-secondary/10 border border-primary/20 rounded-lg p-4\">\r\n          <div className=\"flex items-start space-x-3\">\r\n            <div className=\"w-10 h-10 bg-primary/10 rounded-lg flex items-center justify-center\">\r\n              <Icon name=\"Building\" size={20} className=\"text-primary\" />\r\n            </div>\r\n            <div className=\"flex-1\">\r\n              <h4 className=\"font-heading font-heading-semibold text-text-primary mb-1\">\r\n                {currentSchool.name}\r\n              </h4>\r\n              <div className=\"flex flex-wrap gap-4 text-sm text-text-secondary\">\r\n                <span className=\"flex items-center gap-1\">\r\n                  <Icon name=\"School\" size={14} className=\"text-primary\" />\r\n                  Type: {currentSchool.type}\r\n                </span>\r\n                <span className=\"flex items-center gap-1\">\r\n                  <Icon name=\"Users\" size={14} className=\"text-primary\" />\r\n                  {schoolClasses.length} classe(s)\r\n                </span>\r\n                <span className=\"flex items-center gap-1\">\r\n                  <Icon name=\"BookOpen\" size={14} className=\"text-primary\" />\r\n                  {schoolSubjects.length} mati√®re(s)\r\n                </span>\r\n                <Button\r\n                  variant=\"ghost\"\r\n                  size=\"sm\"\r\n                  iconName=\"Plus\"\r\n                  onClick={() => setShowAddSubjectModal(true)}\r\n                  className=\"text-xs\"\r\n                >\r\n                  Ajouter une mati√®re\r\n                </Button>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* No teacher message */}\r\n      {teachers.length === 0 && (\r\n        <div className=\"bg-blue-50 border border-blue-200 rounded-lg p-4\">\r\n          <div className=\"flex items-start space-x-3\">\r\n            <Icon name=\"Info\" size={20} className=\"text-blue-600 mt-0.5\" />\r\n            <div>\r\n              <h4 className=\"font-body font-body-semibold text-blue-900 mb-1\">\r\n                Aucun enseignant\r\n              </h4>\r\n              <p className=\"text-sm text-blue-700\">\r\n                Aucun enseignant n'a encore √©t√© cr√©√©.\r\n                Cliquez sur \"Assigner Enseignant\" pour commencer.\r\n              </p>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Header with Actions */}\r\n      <div className=\"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4\">\r\n        <div>\r\n          <h2 className=\"font-heading font-heading-bold text-xl text-text-primary\">\r\n            Gestion des Enseignants\r\n          </h2>\r\n          <p className=\"font-body font-body-normal text-sm text-text-secondary mt-1\">\r\n            G√©rez les comptes et affectations des enseignants\r\n          </p>\r\n        </div>\r\n        <div className=\"flex gap-2\">\r\n          <Button\r\n            variant=\"default\"\r\n            iconName=\"School\"\r\n            iconPosition=\"left\"\r\n            onClick={handleMultiSchoolAssignment}\r\n          >\r\n            Assigner Enseignant\r\n          </Button>\r\n        </div>\r\n      </div>\r\n\r\n\r\n\r\n      {/* Filters */}\r\n      <div className=\"bg-card rounded-lg border border-border p-4\">\r\n        <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\r\n          <Input\r\n            type=\"search\"\r\n            placeholder=\"Rechercher par nom, email ou ID...\"\r\n            value={searchTerm}\r\n            onChange={(e) => setSearchTerm(e?.target?.value)}\r\n            className=\"w-full\"\r\n          />\r\n          <Select\r\n            placeholder=\"Filtrer par mati√®re\"\r\n            options={subjectOptions}\r\n            value={filterSubject}\r\n            onChange={setFilterSubject}\r\n          />\r\n          <Select\r\n            placeholder=\"Filtrer par statut\"\r\n            options={statusOptions}\r\n            value={filterStatus}\r\n            onChange={setFilterStatus}\r\n          />\r\n        </div>\r\n      </div>\r\n\r\n      {/* Teachers Table */}\r\n      <div className=\"bg-card rounded-lg border border-border overflow-hidden\">\r\n        <div className=\"overflow-x-auto\">\r\n          <table className=\"w-full\">\r\n            <thead className=\"bg-muted\">\r\n              <tr>\r\n                <th className=\"text-left p-4 font-heading font-heading-semibold text-sm text-text-primary\">\r\n                  Enseignant\r\n                </th>\r\n                <th className=\"text-left p-4 font-heading font-heading-semibold text-sm text-text-primary\">\r\n                  Mati√®re\r\n                </th>\r\n                <th className=\"text-left p-4 font-heading font-heading-semibold text-sm text-text-primary\">\r\n                  Classe\r\n                </th>\r\n                <th className=\"text-left p-4 font-heading font-heading-semibold text-sm text-text-primary\">\r\n                  Contact\r\n                </th>\r\n                <th className=\"text-left p-4 font-heading font-heading-semibold text-sm text-text-primary\">\r\n                  Statut\r\n                </th>\r\n                <th className=\"text-right p-4 font-heading font-heading-semibold text-sm text-text-primary\">\r\n                  Actions\r\n                </th>\r\n              </tr>\r\n            </thead>\r\n            <tbody>\r\n              {filteredTeachers?.map((teacher) => (\r\n                <tr key={teacher?.id} className=\"border-t border-border hover:bg-muted/30\">\r\n                  <td className=\"p-4\">\r\n                    <div className=\"flex items-center space-x-3\">\r\n                      <Image\r\n                        src={teacher?.avatar}\r\n                        alt={teacher?.fullName}\r\n                        className=\"w-10 h-10 rounded-full object-cover\"\r\n                        fallback=\"/public/assets/images/no_image.png\"\r\n                      />\r\n                      <div>\r\n                        <p className=\"font-body font-body-medium text-sm text-text-primary\">\r\n                          {teacher?.fullName}\r\n                        </p>\r\n                        <p className=\"font-caption font-caption-normal text-xs text-text-secondary\">\r\n                          ID: {teacher?.teacherId}\r\n                        </p>\r\n                      </div>\r\n                    </div>\r\n                  </td>\r\n                  <td className=\"p-4\">\r\n                    <p className=\"font-body font-body-normal text-sm text-text-primary\">\r\n                      {teacher?.subject}\r\n                    </p>\r\n                  </td>\r\n                  <td className=\"p-4\">\r\n                    <p className=\"font-body font-body-normal text-sm text-text-primary\">\r\n                      {teacher?.className}\r\n                    </p>\r\n                  </td>\r\n                  <td className=\"p-4\">\r\n                    <div>\r\n                      <p className=\"font-body font-body-normal text-sm text-text-primary\">\r\n                        {teacher?.email}\r\n                      </p>\r\n                      <p className=\"font-caption font-caption-normal text-xs text-text-secondary\">\r\n                        {teacher?.phone}\r\n                      </p>\r\n                    </div>\r\n                  </td>\r\n                  <td className=\"p-4\">\r\n                    {getStatusBadge(teacher?.status)}\r\n                  </td>\r\n                  <td className=\"p-4\">\r\n                    <div className=\"flex items-center justify-end space-x-1\">\r\n                      <Button\r\n                        variant=\"ghost\"\r\n                        size=\"icon\"\r\n                        onClick={() => handleToggleStatus(teacher?.id)}\r\n                        title={teacher?.status === 'active' ? 'D√©sactiver' : 'Activer'}\r\n                      >\r\n                        <Icon name={teacher?.status === 'active' ? 'UserX' : 'UserCheck'} size={16} />\r\n                      </Button>\r\n                      <Button\r\n                        variant=\"ghost\"\r\n                        size=\"icon\"\r\n                        onClick={() => handleEditTeacher(teacher?.id)}\r\n                        title=\"Modifier\"\r\n                      >\r\n                        <Icon name=\"Edit\" size={16} />\r\n                      </Button>\r\n                      <Button\r\n                        variant=\"ghost\"\r\n                        size=\"icon\"\r\n                        onClick={() => handleDeleteTeacher(teacher?.id)}\r\n                        title=\"Supprimer\"\r\n                      >\r\n                        <Icon name=\"Trash2\" size={16} />\r\n                      </Button>\r\n                    </div>\r\n                  </td>\r\n                </tr>\r\n              ))}\r\n            </tbody>\r\n          </table>\r\n        </div>\r\n\r\n        {filteredTeachers?.length === 0 && (\r\n          <div className=\"p-8 text-center\">\r\n            <Icon name=\"Users\" size={48} className=\"text-muted-foreground mx-auto mb-4\" />\r\n            <p className=\"font-body font-body-normal text-text-secondary\">\r\n              Aucun enseignant trouv√© avec les crit√®res de recherche\r\n            </p>\r\n          </div>\r\n        )}\r\n      </div>\r\n\r\n      {/* Summary Stats */}\r\n      <div className=\"grid grid-cols-1 sm:grid-cols-4 gap-4\">\r\n        <div className=\"bg-card rounded-lg border border-border p-4\">\r\n          <div className=\"flex items-center space-x-3\">\r\n            <div className=\"w-10 h-10 bg-success/10 rounded-lg flex items-center justify-center\">\r\n              <Icon name=\"UserCheck\" size={20} className=\"text-success\" />\r\n            </div>\r\n            <div>\r\n              <p className=\"font-heading font-heading-semibold text-lg text-text-primary\">\r\n                {teachers?.filter(t => t?.status === 'active')?.length}\r\n              </p>\r\n              <p className=\"font-caption font-caption-normal text-xs text-text-secondary\">\r\n                Enseignants actifs\r\n              </p>\r\n            </div>\r\n          </div>\r\n        </div>\r\n        \r\n        <div className=\"bg-card rounded-lg border border-border p-4\">\r\n          <div className=\"flex items-center space-x-3\">\r\n            <div className=\"w-10 h-10 bg-warning/10 rounded-lg flex items-center justify-center\">\r\n              <Icon name=\"Clock\" size={20} className=\"text-warning\" />\r\n            </div>\r\n            <div>\r\n              <p className=\"font-heading font-heading-semibold text-lg text-text-primary\">\r\n                {teachers?.filter(t => t?.status === 'pending')?.length}\r\n              </p>\r\n              <p className=\"font-caption font-caption-normal text-xs text-text-secondary\">\r\n                En attente\r\n              </p>\r\n            </div>\r\n          </div>\r\n        </div>\r\n        \r\n        <div className=\"bg-card rounded-lg border border-border p-4\">\r\n          <div className=\"flex items-center space-x-3\">\r\n            <div className=\"w-10 h-10 bg-error/10 rounded-lg flex items-center justify-center\">\r\n              <Icon name=\"UserX\" size={20} className=\"text-error\" />\r\n            </div>\r\n            <div>\r\n              <p className=\"font-heading font-heading-semibold text-lg text-text-primary\">\r\n                {teachers?.filter(t => t?.status === 'inactive')?.length}\r\n              </p>\r\n              <p className=\"font-caption font-caption-normal text-xs text-text-secondary\">\r\n                Inactifs\r\n              </p>\r\n            </div>\r\n          </div>\r\n        </div>\r\n        \r\n        <div className=\"bg-card rounded-lg border border-border p-4\">\r\n          <div className=\"flex items-center space-x-3\">\r\n            <div className=\"w-10 h-10 bg-primary/10 rounded-lg flex items-center justify-center\">\r\n              <Icon name=\"Users\" size={20} className=\"text-primary\" />\r\n            </div>\r\n            <div>\r\n              <p className=\"font-heading font-heading-semibold text-lg text-text-primary\">\r\n                {teachers?.length}\r\n              </p>\r\n              <p className=\"font-caption font-caption-normal text-xs text-text-secondary\">\r\n                Total enseignants\r\n              </p>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Modal Modifier Enseignant */}\r\n      {showEditModal && selectedTeacher && (\r\n        <div className=\"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4\">\r\n          <div className=\"bg-card rounded-lg border border-border max-w-2xl w-full max-h-[90vh] overflow-y-auto\">\r\n            <div className=\"flex items-center justify-between p-6 border-b border-border\">\r\n              <h3 className=\"font-heading font-heading-semibold text-lg text-text-primary\">\r\n                Modifier {selectedTeacher.fullName}\r\n              </h3>\r\n              <Button\r\n                variant=\"ghost\"\r\n                size=\"icon\"\r\n                onClick={() => {\r\n                  setShowEditModal(false);\r\n                  setSelectedTeacher(null);\r\n                  setNewTeacher({\r\n                    fullName: '',\r\n                    email: '',\r\n                    phone: '',\r\n                    subject: '',\r\n                    className: '',\r\n                    password: '',\r\n                    confirmPassword: ''\r\n                  });\r\n                }}\r\n              >\r\n                <Icon name=\"X\" size={20} />\r\n              </Button>\r\n            </div>\r\n            \r\n            <div className=\"p-6 space-y-4\">\r\n              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n                <Input\r\n                  label=\"Nom complet\"\r\n                  placeholder=\"Ex: Marie Nguema\"\r\n                  value={newTeacher.fullName}\r\n                  onChange={(e) => setNewTeacher(prev => ({ ...prev, fullName: e.target.value }))}\r\n                  required\r\n                />\r\n                <Input\r\n                  label=\"Email\"\r\n                  type=\"email\"\r\n                  placeholder=\"marie.nguema@school.cm\"\r\n                  value={newTeacher.email}\r\n                  onChange={(e) => setNewTeacher(prev => ({ ...prev, email: e.target.value }))}\r\n                  required\r\n                />\r\n                <Input\r\n                  label=\"T√©l√©phone\"\r\n                  placeholder=\"+237 6XX XX XX XX\"\r\n                  value={newTeacher.phone}\r\n                  onChange={(e) => setNewTeacher(prev => ({ ...prev, phone: e.target.value }))}\r\n                />\r\n                \r\n                {/* S√©lection multiple de mati√®res */}\r\n                <div className=\"space-y-2\">\r\n                  <label className=\"block text-sm font-body font-body-medium text-text-secondary\">\r\n                    Mati√®res enseign√©es *\r\n                  </label>\r\n                  <div className=\"grid grid-cols-2 gap-2 max-h-48 overflow-y-auto border border-border rounded-lg p-3\">\r\n                    {schoolSubjects.map((subject) => (\r\n                      <label\r\n                        key={subject.id}\r\n                        className=\"flex items-center space-x-2 cursor-pointer hover:bg-muted p-2 rounded\"\r\n                      >\r\n                        <input\r\n                          type=\"checkbox\"\r\n                          checked={newTeacher.subjects?.includes(subject.name)}\r\n                          onChange={() => toggleSubjectSelection(subject.name)}\r\n                          className=\"w-4 h-4 text-primary border-border rounded focus:ring-primary\"\r\n                        />\r\n                        <span className=\"text-sm text-text-primary\">{subject.name}</span>\r\n                      </label>\r\n                    ))}\r\n                  </div>\r\n                  {newTeacher.subjects?.length > 0 && (\r\n                    <p className=\"text-xs text-text-tertiary\">\r\n                      {newTeacher.subjects.length} mati√®re(s) s√©lectionn√©e(s): {newTeacher.subjects.join(', ')}\r\n                    </p>\r\n                  )}\r\n                </div>\r\n\r\n                {/* S√©lection multiple de classes */}\r\n                <div className=\"space-y-2\">\r\n                  <label className=\"block text-sm font-body font-body-medium text-text-secondary\">\r\n                    Classes assign√©es *\r\n                  </label>\r\n                  <div className=\"grid grid-cols-2 gap-2 max-h-48 overflow-y-auto border border-border rounded-lg p-3\">\r\n                    {schoolClasses.map((cls) => (\r\n                      <label\r\n                        key={cls.id}\r\n                        className=\"flex items-center space-x-2 cursor-pointer hover:bg-muted p-2 rounded\"\r\n                      >\r\n                        <input\r\n                          type=\"checkbox\"\r\n                          checked={newTeacher.classes?.includes(cls.name)}\r\n                          onChange={() => toggleClassSelection(cls.name)}\r\n                          className=\"w-4 h-4 text-primary border-border rounded focus:ring-primary\"\r\n                        />\r\n                        <span className=\"text-sm text-text-primary\">{cls.name}</span>\r\n                      </label>\r\n                    ))}\r\n                  </div>\r\n                  {newTeacher.classes?.length > 0 && (\r\n                    <p className=\"text-xs text-text-tertiary\">\r\n                      {newTeacher.classes.length} classe(s) s√©lectionn√©e(s): {newTeacher.classes.join(', ')}\r\n                    </p>\r\n                  )}\r\n                </div>\r\n                \r\n                <div className=\"space-y-4 pt-4 border-t border-gray-200\">\r\n                  <div className=\"text-sm font-medium text-gray-700\">Modifier le mot de passe (optionnel)</div>\r\n                  <div className=\"flex gap-2\">\r\n                    <Input\r\n                      label=\"Nouveau mot de passe\"\r\n                      type=\"password\"\r\n                      placeholder=\"Minimum 8 caract√®res\"\r\n                      value={newTeacher.password}\r\n                      onChange={(e) => setNewTeacher(prev => ({ ...prev, password: e.target.value }))}\r\n                    />\r\n                    <Button\r\n                      variant=\"outline\"\r\n                      size=\"sm\"\r\n                      onClick={generateSecurePassword}\r\n                      className=\"mt-6\"\r\n                    >\r\n                      G√©n√©rer\r\n                    </Button>\r\n                  </div>\r\n                  <Input\r\n                    label=\"Confirmer le nouveau mot de passe\"\r\n                    type=\"password\"\r\n                    placeholder=\"R√©p√©ter le mot de passe\"\r\n                    value={newTeacher.confirmPassword}\r\n                    onChange={(e) => setNewTeacher(prev => ({ ...prev, confirmPassword: e.target.value }))}\r\n                  />\r\n                  {newTeacher.password && !validatePassword(newTeacher.password) && (\r\n                    <div className=\"text-sm text-red-600 bg-red-50 p-2 rounded\">\r\n                      Le mot de passe doit contenir au moins 8 caract√®res avec : une majuscule, une minuscule, un chiffre et un caract√®re sp√©cial (@$!%*?&)\r\n                    </div>\r\n                  )}\r\n                  {newTeacher.password && newTeacher.confirmPassword && newTeacher.password !== newTeacher.confirmPassword && (\r\n                    <div className=\"text-sm text-red-600 bg-red-50 p-2 rounded\">\r\n                      Les mots de passe ne correspondent pas\r\n                    </div>\r\n                  )}\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"flex gap-3 p-6 border-t border-border\">\r\n              <Button variant=\"default\" onClick={handleUpdateTeacher}>\r\n                Sauvegarder\r\n              </Button>\r\n              <Button variant=\"outline\" onClick={() => {\r\n                setShowEditModal(false);\r\n                setSelectedTeacher(null);\r\n                setNewTeacher({\r\n                  fullName: '',\r\n                  email: '',\r\n                  phone: '',\r\n                  subject: '',\r\n                  className: '',\r\n                  password: '',\r\n                  confirmPassword: ''\r\n                });\r\n              }}>\r\n                Annuler\r\n              </Button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Modal Confirmer Suppression */}\r\n      {showDeleteModal && selectedTeacher && (\r\n        <div className=\"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4\">\r\n          <div className=\"bg-card rounded-lg border border-border max-w-md w-full\">\r\n            <div className=\"flex items-center justify-between p-6 border-b border-border\">\r\n              <h3 className=\"font-heading font-heading-semibold text-lg text-text-primary\">\r\n                Supprimer l'enseignant\r\n              </h3>\r\n              <Button\r\n                variant=\"ghost\"\r\n                size=\"icon\"\r\n                onClick={() => {\r\n                  setShowDeleteModal(false);\r\n                  setSelectedTeacher(null);\r\n                }}\r\n              >\r\n                <Icon name=\"X\" size={20} />\r\n              </Button>\r\n            </div>\r\n            \r\n            <div className=\"p-6\">\r\n              <div className=\"flex items-center space-x-3 mb-4\">\r\n                <div className=\"w-12 h-12 bg-error/10 rounded-lg flex items-center justify-center\">\r\n                  <Icon name=\"AlertTriangle\" size={24} className=\"text-error\" />\r\n                </div>\r\n                <div>\r\n                  <p className=\"font-body font-body-medium text-sm text-text-primary\">\r\n                    Supprimer {selectedTeacher.fullName} ?\r\n                  </p>\r\n                  <p className=\"font-caption font-caption-normal text-xs text-text-secondary\">\r\n                    {selectedTeacher.subject} - {selectedTeacher.className}\r\n                  </p>\r\n                </div>\r\n              </div>\r\n              \r\n              <div className=\"bg-error/10 rounded-lg p-4\">\r\n                <p className=\"font-caption font-caption-normal text-xs text-error\">\r\n                  ‚ö†Ô∏è Cette action est irr√©versible. L'enseignant sera d√©finitivement supprim√© du syst√®me.\r\n                </p>\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"flex gap-3 p-6 border-t border-border\">\r\n              <Button variant=\"destructive\" onClick={handleConfirmDelete}>\r\n                Supprimer d√©finitivement\r\n              </Button>\r\n              <Button variant=\"outline\" onClick={() => {\r\n                setShowDeleteModal(false);\r\n                setSelectedTeacher(null);\r\n              }}>\r\n                Annuler\r\n              </Button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Modal Assignation Multi-√âtablissements */}\r\n      {showMultiSchoolAssignment && (\r\n        <div className=\"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50 p-4 animate-in fade-in duration-200\">\r\n          <div className=\"bg-card rounded-2xl border border-border/50 shadow-2xl max-w-6xl w-full max-h-[90vh] overflow-hidden animate-in slide-in-from-bottom-4 duration-300\">\r\n            {/* En-t√™te moderne avec gradient */}\r\n            <div className=\"relative bg-gradient-to-r from-primary/10 via-primary/5 to-secondary/10 border-b border-border/50\">\r\n              <div className=\"flex items-center justify-between p-6\">\r\n                <div className=\"flex items-center space-x-4\">\r\n                  <div className=\"w-12 h-12 bg-primary/20 rounded-xl flex items-center justify-center ring-2 ring-primary/30\">\r\n                    <Icon name=\"School\" size={24} className=\"text-primary\" />\r\n                  </div>\r\n                  <div>\r\n                    <h3 className=\"font-heading font-heading-bold text-xl text-text-primary flex items-center gap-2\">\r\n                      Assignation Multi-√âtablissements\r\n                      <span className=\"px-2 py-0.5 bg-primary/10 text-primary text-xs rounded-full font-medium\">\r\n                        Nouveau\r\n                      </span>\r\n                    </h3>\r\n                    <p className=\"text-sm text-text-secondary mt-0.5 flex items-center gap-1\">\r\n                      <Icon name=\"Circle\" size={8} className=\"text-primary fill-current\" />\r\n                      √âtape {currentStep} sur 3 - {currentStep === 1 ? 'Type d\\'assignation' : currentStep === 2 ? 'S√©lection enseignant' : 'Configuration finale'}\r\n                    </p>\r\n                  </div>\r\n                </div>\r\n                <button\r\n                  onClick={() => {\r\n                    setShowMultiSchoolAssignment(false);\r\n                    resetMultiSchoolWorkflow();\r\n                  }}\r\n                  className=\"w-10 h-10 rounded-lg hover:bg-muted/50 transition-all duration-200 flex items-center justify-center group\"\r\n                >\r\n                  <Icon name=\"X\" size={20} className=\"text-text-secondary group-hover:text-text-primary transition-colors\" />\r\n                </button>\r\n              </div>\r\n            </div>\r\n            \r\n            {/* Indicateur de progression moderne */}\r\n            <div className=\"px-6 py-6 bg-muted/30\">\r\n              <div className=\"flex items-center justify-between max-w-2xl mx-auto\">\r\n                {[1, 2, 3].map((step, index) => (\r\n                  <div key={step} className=\"flex items-center flex-1\">\r\n                    <div className=\"flex flex-col items-center flex-1\">\r\n                      {/* Ic√¥ne de l'√©tape */}\r\n                      <div className={`relative w-12 h-12 rounded-xl flex items-center justify-center text-sm font-bold transition-all duration-300 ${\r\n                        step === currentStep \r\n                          ? 'bg-gradient-to-br from-primary to-primary/80 text-white shadow-lg scale-110 ring-4 ring-primary/20' \r\n                          : step < currentStep \r\n                          ? 'bg-gradient-to-br from-success to-success/80 text-white shadow-md' \r\n                          : 'bg-muted/50 text-muted-foreground border border-border'\r\n                      }`}>\r\n                        {step < currentStep ? (\r\n                          <Icon name=\"Check\" size={20} className=\"animate-in zoom-in duration-200\" />\r\n                        ) : (\r\n                          <span className=\"transition-all duration-200\">{step}</span>\r\n                        )}\r\n                        {/* Pulse effect pour l'√©tape active */}\r\n                        {step === currentStep && (\r\n                          <span className=\"absolute inset-0 rounded-xl bg-primary animate-ping opacity-20\"></span>\r\n                        )}\r\n                      </div>\r\n                      \r\n                      {/* Label de l'√©tape */}\r\n                      <div className=\"mt-3 text-center\">\r\n                        <span className={`text-xs font-semibold block transition-colors duration-200 ${\r\n                          step === currentStep ? 'text-primary' : step < currentStep ? 'text-success' : 'text-text-secondary'\r\n                        }`}>\r\n                          {step === 1 ? 'Type' : step === 2 ? 'Enseignant' : 'Assignation'}\r\n                        </span>\r\n                        <span className=\"text-xs text-text-tertiary block mt-0.5\">\r\n                          {step === 1 ? 'Choisir' : step === 2 ? 'S√©lectionner' : 'Configurer'}\r\n                        </span>\r\n                      </div>\r\n                    </div>\r\n                    \r\n                    {/* Ligne de connexion */}\r\n                    {step < 3 && (\r\n                      <div className=\"flex-1 h-1 mx-2 -mt-8 relative\">\r\n                        <div className=\"absolute inset-0 bg-border rounded-full\"></div>\r\n                        <div className={`absolute inset-0 bg-gradient-to-r from-primary to-success rounded-full transition-all duration-500 ${\r\n                          step < currentStep ? 'w-full' : 'w-0'\r\n                        }`}></div>\r\n                      </div>\r\n                    )}\r\n                  </div>\r\n                ))}\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"p-8 overflow-y-auto max-h-[calc(90vh-240px)]\">\r\n              {/* √âtape 1: Choix du type */}\r\n              {currentStep === 1 && (\r\n                <div className=\"space-y-8 max-w-4xl mx-auto\">\r\n                  {/* En-t√™te de l'√©tape avec animation */}\r\n                  <div className=\"text-center space-y-3 animate-in fade-in slide-in-from-bottom-2 duration-500\">\r\n                    <div className=\"inline-flex items-center justify-center w-16 h-16 bg-gradient-to-br from-primary/20 to-secondary/20 rounded-2xl mb-2\">\r\n                      <Icon name=\"School\" size={32} className=\"text-primary\" />\r\n                    </div>\r\n                    <h4 className=\"font-heading font-heading-bold text-2xl text-text-primary\">\r\n                      Type d'Assignation\r\n                    </h4>\r\n                    <p className=\"text-base text-text-secondary max-w-md mx-auto\">\r\n                      Choisissez si vous souhaitez assigner un enseignant existant ou cr√©er un nouveau profil\r\n                    </p>\r\n                  </div>\r\n\r\n                  {/* Cartes de s√©lection modernes */}\r\n                  <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6 animate-in fade-in slide-in-from-bottom-4 duration-500 delay-100\">\r\n                    {/* Carte Enseignant Existant */}\r\n                    <div \r\n                      onClick={() => setAssignationMode('existing')}\r\n                      className={`group relative overflow-hidden rounded-2xl p-6 cursor-pointer transition-all duration-300 ${\r\n                        assignationMode === 'existing' \r\n                          ? 'bg-gradient-to-br from-primary/10 to-primary/5 border-2 border-primary shadow-xl shadow-primary/10 scale-105' \r\n                          : 'bg-card border-2 border-border hover:border-primary/50 hover:shadow-lg hover:scale-102'\r\n                      }`}\r\n                    >\r\n                      {/* Badge de s√©lection */}\r\n                      {assignationMode === 'existing' && (\r\n                        <div className=\"absolute top-4 right-4 w-8 h-8 bg-primary rounded-full flex items-center justify-center animate-in zoom-in duration-300\">\r\n                          <Icon name=\"Check\" size={16} className=\"text-white\" />\r\n                        </div>\r\n                      )}\r\n                      \r\n                      {/* Effet de brillance au hover */}\r\n                      <div className=\"absolute inset-0 bg-gradient-to-r from-transparent via-white/5 to-transparent -translate-x-full group-hover:translate-x-full transition-transform duration-1000\"></div>\r\n                      \r\n                      <div className=\"relative space-y-4\">\r\n                        {/* Ic√¥ne avec animation */}\r\n                        <div className={`w-14 h-14 rounded-xl flex items-center justify-center transition-all duration-300 ${\r\n                          assignationMode === 'existing' \r\n                            ? 'bg-primary text-white shadow-lg' \r\n                            : 'bg-muted/50 text-muted-foreground group-hover:bg-primary/10 group-hover:text-primary'\r\n                        }`}>\r\n                          <Icon name=\"Users\" size={28} className=\"transition-transform group-hover:scale-110\" />\r\n                        </div>\r\n                        \r\n                        {/* Contenu */}\r\n                        <div className=\"space-y-2\">\r\n                          <h5 className=\"font-heading font-heading-bold text-lg text-text-primary\">\r\n                            Enseignant Existant\r\n                          </h5>\r\n                          <p className=\"text-sm text-text-secondary leading-relaxed\">\r\n                            Recherchez et assignez un enseignant d√©j√† enregistr√© dans le syst√®me global\r\n                          </p>\r\n                        </div>\r\n                        \r\n                        {/* Avantages */}\r\n                        <div className=\"space-y-2 pt-2 border-t border-border/50\">\r\n                          <div className=\"flex items-center gap-2 text-xs text-text-tertiary\">\r\n                            <Icon name=\"Check\" size={14} className=\"text-success\" />\r\n                            <span>Processus rapide</span>\r\n                          </div>\r\n                          <div className=\"flex items-center gap-2 text-xs text-text-tertiary\">\r\n                            <Icon name=\"Check\" size={14} className=\"text-success\" />\r\n                            <span>Profil d√©j√† configur√©</span>\r\n                          </div>\r\n                        </div>\r\n                      </div>\r\n                    </div>\r\n\r\n                    {/* Carte Nouvel Enseignant */}\r\n                    <div \r\n                      onClick={() => setAssignationMode('new')}\r\n                      className={`group relative overflow-hidden rounded-2xl p-6 cursor-pointer transition-all duration-300 ${\r\n                        assignationMode === 'new' \r\n                          ? 'bg-gradient-to-br from-success/10 to-success/5 border-2 border-success shadow-xl shadow-success/10 scale-105' \r\n                          : 'bg-card border-2 border-border hover:border-success/50 hover:shadow-lg hover:scale-102'\r\n                      }`}\r\n                    >\r\n                      {/* Badge de s√©lection */}\r\n                      {assignationMode === 'new' && (\r\n                        <div className=\"absolute top-4 right-4 w-8 h-8 bg-success rounded-full flex items-center justify-center animate-in zoom-in duration-300\">\r\n                          <Icon name=\"Check\" size={16} className=\"text-white\" />\r\n                        </div>\r\n                      )}\r\n                      \r\n                      {/* Effet de brillance au hover */}\r\n                      <div className=\"absolute inset-0 bg-gradient-to-r from-transparent via-white/5 to-transparent -translate-x-full group-hover:translate-x-full transition-transform duration-1000\"></div>\r\n                      \r\n                      <div className=\"relative space-y-4\">\r\n                        {/* Ic√¥ne avec animation */}\r\n                        <div className={`w-14 h-14 rounded-xl flex items-center justify-center transition-all duration-300 ${\r\n                          assignationMode === 'new' \r\n                            ? 'bg-success text-white shadow-lg' \r\n                            : 'bg-muted/50 text-muted-foreground group-hover:bg-success/10 group-hover:text-success'\r\n                        }`}>\r\n                          <Icon name=\"UserPlus\" size={28} className=\"transition-transform group-hover:scale-110\" />\r\n                        </div>\r\n                        \r\n                        {/* Contenu */}\r\n                        <div className=\"space-y-2\">\r\n                          <h5 className=\"font-heading font-heading-bold text-lg text-text-primary\">\r\n                            Nouvel Enseignant\r\n                          </h5>\r\n                          <p className=\"text-sm text-text-secondary leading-relaxed\">\r\n                            Cr√©ez un nouveau compte enseignant et assignez-le √† votre √©tablissement\r\n                          </p>\r\n                        </div>\r\n                        \r\n                        {/* Avantages */}\r\n                        <div className=\"space-y-2 pt-2 border-t border-border/50\">\r\n                          <div className=\"flex items-center gap-2 text-xs text-text-tertiary\">\r\n                            <Icon name=\"Check\" size={14} className=\"text-success\" />\r\n                            <span>Personnalisation compl√®te</span>\r\n                          </div>\r\n                          <div className=\"flex items-center gap-2 text-xs text-text-tertiary\">\r\n                            <Icon name=\"Check\" size={14} className=\"text-success\" />\r\n                            <span>Nouveau dans le syst√®me</span>\r\n                          </div>\r\n                        </div>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n\r\n                  {/* Informations sur l'√©tablissement avec design moderne */}\r\n                  <div className=\"animate-in fade-in slide-in-from-bottom-4 duration-500 delay-200\">\r\n                    <div className=\"bg-gradient-to-r from-primary/5 via-primary/3 to-secondary/5 border border-primary/20 rounded-xl p-5 shadow-sm\">\r\n                      <div className=\"flex items-start gap-4\">\r\n                        <div className=\"w-12 h-12 bg-primary/20 rounded-xl flex items-center justify-center shrink-0\">\r\n                          <Icon name=\"Building\" size={24} className=\"text-primary\" />\r\n                        </div>\r\n                        <div className=\"flex-1 min-w-0\">\r\n                          <div className=\"flex items-center gap-2 mb-1\">\r\n                            <h5 className=\"font-heading font-heading-bold text-base text-text-primary\">\r\n                              √âtablissement de destination\r\n                            </h5>\r\n                            <span className=\"px-2 py-0.5 bg-primary/10 text-primary text-xs rounded-full font-medium\">\r\n                              Actif\r\n                            </span>\r\n                          </div>\r\n                          <p className=\"text-base font-semibold text-primary mb-1\">\r\n                            {currentSchool?.name || 'Chargement...'}\r\n                          </p>\r\n                          <p className=\"text-xs text-text-tertiary flex items-center gap-1\">\r\n                            <Icon name=\"Info\" size={12} />\r\n                            Vous assignez les enseignants uniquement √† votre √©tablissement\r\n                          </p>\r\n                        </div>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              )}\r\n\r\n              {/* √âtape 2: Recherche/Cr√©ation enseignant */}\r\n              {currentStep === 2 && (\r\n                <div className=\"space-y-6\">\r\n                  {assignationMode === 'existing' ? (\r\n                    <div className=\"max-w-4xl mx-auto\">\r\n                      <div className=\"text-center mb-8 animate-in fade-in slide-in-from-bottom-2 duration-500\">\r\n                        <div className=\"inline-flex items-center justify-center w-16 h-16 bg-gradient-to-br from-primary/20 to-primary/10 rounded-2xl mb-3\">\r\n                          <Icon name=\"Users\" size={32} className=\"text-primary\" />\r\n                        </div>\r\n                        <h5 className=\"font-heading font-heading-bold text-2xl text-text-primary mb-2\">\r\n                          S√©lectionner un Enseignant\r\n                        </h5>\r\n                        <p className=\"text-base text-text-secondary max-w-xl mx-auto\">\r\n                          Choisissez un enseignant dans la liste. Les enseignants peuvent √™tre assign√©s √† plusieurs √©tablissements.\r\n                        </p>\r\n                      </div>\r\n\r\n                      <div className=\"animate-in fade-in slide-in-from-bottom-4 duration-500 delay-100\">\r\n                        <TeacherSearchSelector\r\n                          onTeacherSelect={(teacher) => {\r\n                            setSelectedExistingTeacher(teacher);\r\n                          }}\r\n                          onCreateNew={() => {\r\n                            setAssignationMode('new');\r\n                            setSelectedExistingTeacher(null);\r\n                          }}\r\n                          selectedTeacher={selectedExistingTeacher}\r\n                        />\r\n                      </div>\r\n                    </div>\r\n                  ) : (\r\n                    <div className=\"max-w-4xl mx-auto\">\r\n                      <div className=\"text-center mb-8 animate-in fade-in slide-in-from-bottom-2 duration-500\">\r\n                        <div className=\"inline-flex items-center justify-center w-16 h-16 bg-gradient-to-br from-success/20 to-success/10 rounded-2xl mb-3\">\r\n                          <Icon name=\"UserPlus\" size={32} className=\"text-success\" />\r\n                        </div>\r\n                        <h5 className=\"font-heading font-heading-bold text-2xl text-text-primary mb-2\">\r\n                          Cr√©er un Nouveau Compte\r\n                        </h5>\r\n                        <p className=\"text-base text-text-secondary max-w-xl mx-auto\">\r\n                          Remplissez les informations pour cr√©er un nouveau profil enseignant dans le syst√®me\r\n                        </p>\r\n                      </div>\r\n\r\n                      <div className=\"bg-card rounded-2xl border border-border shadow-lg p-8 animate-in fade-in slide-in-from-bottom-4 duration-500 delay-100\">\r\n                        {/* Informations personnelles */}\r\n                        <div className=\"mb-8\">\r\n                          <h6 className=\"font-heading font-heading-bold text-lg text-text-primary mb-1 flex items-center gap-2\">\r\n                            <Icon name=\"User\" size={20} className=\"text-primary\" />\r\n                            Informations Personnelles\r\n                          </h6>\r\n                          <p className=\"text-sm text-text-tertiary mb-4\">Donn√©es de base de l'enseignant</p>\r\n                          \r\n                          <div className=\"grid grid-cols-1 md:grid-cols-2 gap-5\">\r\n                            <Input\r\n                              label=\"Nom complet\"\r\n                              placeholder=\"Ex: Marie Nguema\"\r\n                              value={newTeacher.fullName}\r\n                              onChange={(e) => setNewTeacher(prev => ({ ...prev, fullName: e.target.value }))}\r\n                              required\r\n                              className=\"transition-all duration-200 focus-within:shadow-sm\"\r\n                            />\r\n                            <Input\r\n                              label=\"Email\"\r\n                              type=\"email\"\r\n                              placeholder=\"marie.nguema@school.cm\"\r\n                              value={newTeacher.email}\r\n                              onChange={(e) => setNewTeacher(prev => ({ ...prev, email: e.target.value }))}\r\n                              required\r\n                              className=\"transition-all duration-200 focus-within:shadow-sm\"\r\n                            />\r\n                            <Input\r\n                              label=\"T√©l√©phone\"\r\n                              placeholder=\"+237 6XX XX XX XX\"\r\n                              value={newTeacher.phone}\r\n                              onChange={(e) => setNewTeacher(prev => ({ ...prev, phone: e.target.value }))}\r\n                              required\r\n                              className=\"transition-all duration-200 focus-within:shadow-sm\"\r\n                            />\r\n                          </div>\r\n                        </div>\r\n\r\n                        {/* S√©lection des mati√®res avec design moderne */}\r\n                        <div className=\"mb-8\">\r\n                          <h6 className=\"font-heading font-heading-bold text-lg text-text-primary mb-1 flex items-center gap-2\">\r\n                            <Icon name=\"BookOpen\" size={20} className=\"text-primary\" />\r\n                            Mati√®res Enseign√©es\r\n                          </h6>\r\n                          <p className=\"text-sm text-text-tertiary mb-4\">S√©lectionnez une ou plusieurs mati√®res</p>\r\n                          \r\n                          <div className=\"bg-muted/30 border border-border rounded-xl p-4 max-h-64 overflow-y-auto\">\r\n                            <div className=\"grid grid-cols-2 md:grid-cols-3 gap-3\">\r\n                              {schoolSubjects.map((subject) => (\r\n                                <label\r\n                                  key={subject.id}\r\n                                  className={`relative flex items-center space-x-3 p-3 rounded-lg cursor-pointer transition-all duration-200 ${\r\n                                    newTeacher.subjects?.includes(subject.name)\r\n                                      ? 'bg-primary/10 border-2 border-primary shadow-sm'\r\n                                      : 'bg-card border border-border hover:border-primary/50 hover:bg-muted/50'\r\n                                  }`}\r\n                                >\r\n                                  <input\r\n                                    type=\"checkbox\"\r\n                                    checked={newTeacher.subjects?.includes(subject.name)}\r\n                                    onChange={() => toggleSubjectSelection(subject.name)}\r\n                                    className=\"w-4 h-4 text-primary border-border rounded focus:ring-primary focus:ring-2\"\r\n                                  />\r\n                                  <span className=\"text-sm font-medium text-text-primary\">{subject.name}</span>\r\n                                  {newTeacher.subjects?.includes(subject.name) && (\r\n                                    <div className=\"absolute top-1 right-1 w-5 h-5 bg-primary rounded-full flex items-center justify-center\">\r\n                                      <Icon name=\"Check\" size={12} className=\"text-white\" />\r\n                                    </div>\r\n                                  )}\r\n                                </label>\r\n                              ))}\r\n                            </div>\r\n                          </div>\r\n                          \r\n                          {newTeacher.subjects?.length > 0 && (\r\n                            <div className=\"mt-3 flex items-center gap-2 text-sm\">\r\n                              <Icon name=\"CheckCircle\" size={16} className=\"text-success\" />\r\n                              <span className=\"text-text-secondary\">\r\n                                <span className=\"font-semibold text-primary\">{newTeacher.subjects.length}</span> mati√®re(s) s√©lectionn√©e(s)\r\n                              </span>\r\n                            </div>\r\n                          )}\r\n                        </div>\r\n\r\n                        {/* S√©lection des classes avec design moderne */}\r\n                        <div className=\"mb-8\">\r\n                          <h6 className=\"font-heading font-heading-bold text-lg text-text-primary mb-1 flex items-center gap-2\">\r\n                            <Icon name=\"Users\" size={20} className=\"text-primary\" />\r\n                            Classes Assign√©es\r\n                          </h6>\r\n                          <p className=\"text-sm text-text-tertiary mb-4\">S√©lectionnez les classes √† g√©rer</p>\r\n                          \r\n                          <div className=\"bg-muted/30 border border-border rounded-xl p-4 max-h-64 overflow-y-auto\">\r\n                            <div className=\"grid grid-cols-2 md:grid-cols-3 gap-3\">\r\n                              {schoolClasses.map((cls) => (\r\n                                <label\r\n                                  key={cls.id}\r\n                                  className={`relative flex items-center space-x-3 p-3 rounded-lg cursor-pointer transition-all duration-200 ${\r\n                                    newTeacher.classes?.includes(cls.name)\r\n                                      ? 'bg-success/10 border-2 border-success shadow-sm'\r\n                                      : 'bg-card border border-border hover:border-success/50 hover:bg-muted/50'\r\n                                  }`}\r\n                                >\r\n                                  <input\r\n                                    type=\"checkbox\"\r\n                                    checked={newTeacher.classes?.includes(cls.name)}\r\n                                    onChange={() => toggleClassSelection(cls.name)}\r\n                                    className=\"w-4 h-4 text-success border-border rounded focus:ring-success focus:ring-2\"\r\n                                  />\r\n                                  <span className=\"text-sm font-medium text-text-primary\">{cls.name}</span>\r\n                                  {newTeacher.classes?.includes(cls.name) && (\r\n                                    <div className=\"absolute top-1 right-1 w-5 h-5 bg-success rounded-full flex items-center justify-center\">\r\n                                      <Icon name=\"Check\" size={12} className=\"text-white\" />\r\n                                    </div>\r\n                                  )}\r\n                                </label>\r\n                              ))}\r\n                            </div>\r\n                          </div>\r\n                          \r\n                          {newTeacher.classes?.length > 0 && (\r\n                            <div className=\"mt-3 flex items-center gap-2 text-sm\">\r\n                              <Icon name=\"CheckCircle\" size={16} className=\"text-success\" />\r\n                              <span className=\"text-text-secondary\">\r\n                                <span className=\"font-semibold text-success\">{newTeacher.classes.length}</span> classe(s) s√©lectionn√©e(s)\r\n                              </span>\r\n                            </div>\r\n                          )}\r\n                        </div>\r\n                        \r\n                        {/* S√©curit√© du compte */}\r\n                        <div>\r\n                          <h6 className=\"font-heading font-heading-bold text-lg text-text-primary mb-1 flex items-center gap-2\">\r\n                            <Icon name=\"Lock\" size={20} className=\"text-primary\" />\r\n                            S√©curit√© du Compte\r\n                          </h6>\r\n                          <p className=\"text-sm text-text-tertiary mb-4\">D√©finissez un mot de passe s√©curis√©</p>\r\n                          \r\n                          <div className=\"grid grid-cols-1 md:grid-cols-2 gap-5\">\r\n                            <div className=\"space-y-2\">\r\n                              <div className=\"flex items-center gap-2\">\r\n                                <Input\r\n                                  label=\"Mot de passe\"\r\n                                  type=\"password\"\r\n                                  placeholder=\"Minimum 8 caract√®res\"\r\n                                  value={newTeacher.password}\r\n                                  onChange={(e) => setNewTeacher(prev => ({ ...prev, password: e.target.value }))}\r\n                                  required\r\n                                  className=\"flex-1 transition-all duration-200 focus-within:shadow-sm\"\r\n                                />\r\n                                <Button\r\n                                  variant=\"outline\"\r\n                                  size=\"sm\"\r\n                                  onClick={generateSecurePassword}\r\n                                  className=\"mt-6 hover:bg-primary/10 hover:text-primary transition-all duration-200\"\r\n                                  iconName=\"RefreshCw\"\r\n                                >\r\n                                  G√©n√©rer\r\n                                </Button>\r\n                              </div>\r\n                            </div>\r\n                            <Input\r\n                              label=\"Confirmer le mot de passe\"\r\n                              type=\"password\"\r\n                              placeholder=\"R√©p√©ter le mot de passe\"\r\n                              value={newTeacher.confirmPassword}\r\n                              onChange={(e) => setNewTeacher(prev => ({ ...prev, confirmPassword: e.target.value }))}\r\n                              required\r\n                              className=\"transition-all duration-200 focus-within:shadow-sm\"\r\n                            />\r\n                          </div>\r\n\r\n                          {/* Messages de validation */}\r\n                          {newTeacher.password && !validatePassword(newTeacher.password) && (\r\n                            <div className=\"mt-4 bg-error/10 border border-error/30 rounded-lg p-3 animate-in fade-in duration-200\">\r\n                              <div className=\"flex items-start gap-2\">\r\n                                <Icon name=\"AlertCircle\" size={16} className=\"text-error mt-0.5\" />\r\n                                <div className=\"text-sm text-error\">\r\n                                  <p className=\"font-semibold mb-1\">Mot de passe trop faible</p>\r\n                                  <p className=\"text-xs\">Le mot de passe doit contenir au moins 8 caract√®res avec : une majuscule, une minuscule, un chiffre et un caract√®re sp√©cial (@$!%*?&)</p>\r\n                                </div>\r\n                              </div>\r\n                            </div>\r\n                          )}\r\n                          {newTeacher.password && newTeacher.confirmPassword && newTeacher.password !== newTeacher.confirmPassword && (\r\n                            <div className=\"mt-4 bg-error/10 border border-error/30 rounded-lg p-3 animate-in fade-in duration-200\">\r\n                              <div className=\"flex items-center gap-2\">\r\n                                <Icon name=\"AlertCircle\" size={16} className=\"text-error\" />\r\n                                <p className=\"text-sm text-error font-medium\">Les mots de passe ne correspondent pas</p>\r\n                              </div>\r\n                            </div>\r\n                          )}\r\n                        </div>\r\n                      </div>\r\n                    </div>\r\n                  )}\r\n                </div>\r\n              )}\r\n\r\n              {/* √âtape 3: Configuration assignation */}\r\n              {currentStep === 3 && selectedExistingTeacher && (\r\n                <div className=\"max-w-4xl mx-auto\">\r\n                  <div className=\"text-center mb-8 animate-in fade-in slide-in-from-bottom-2 duration-500\">\r\n                    <div className=\"inline-flex items-center justify-center w-16 h-16 bg-gradient-to-br from-success/20 to-success/10 rounded-2xl mb-3\">\r\n                      <Icon name=\"Settings\" size={32} className=\"text-success\" />\r\n                    </div>\r\n                    <h5 className=\"font-heading font-heading-bold text-2xl text-text-primary mb-2\">\r\n                      Configuration de l'Assignation\r\n                    </h5>\r\n                    <p className=\"text-base text-text-secondary max-w-xl mx-auto\">\r\n                      D√©finissez les classes et mati√®res que cet enseignant g√©rera dans votre √©tablissement\r\n                    </p>\r\n                  </div>\r\n\r\n                  <div className=\"animate-in fade-in slide-in-from-bottom-4 duration-500 delay-100\">\r\n                    <TeacherAssignmentManager\r\n                      teacher={selectedExistingTeacher}\r\n                      currentSchool={currentSchool}\r\n                      onAssignmentComplete={(assignment) => {\r\n                        alert('Assignation cr√©√©e avec succ√®s !');\r\n                        setShowMultiSchoolAssignment(false);\r\n                        resetMultiSchoolWorkflow();\r\n                        loadTeachers(); // Recharger la liste des enseignants\r\n                      }}\r\n                      onCancel={() => {\r\n                        setShowMultiSchoolAssignment(false);\r\n                        resetMultiSchoolWorkflow();\r\n                      }}\r\n                    />\r\n                  </div>\r\n                </div>\r\n              )}\r\n\r\n              {/* Navigation (sauf pour l'√©tape 3 qui a ses propres boutons) */}\r\n              {currentStep < 3 && (\r\n                <div className=\"flex items-center justify-between p-6 border-t border-border/50 bg-muted/20\">\r\n                  <div className=\"flex gap-3\">\r\n                    {currentStep > 1 && (\r\n                      <Button \r\n                        variant=\"outline\" \r\n                        onClick={prevStep}\r\n                        iconName=\"ChevronLeft\"\r\n                        iconPosition=\"left\"\r\n                        className=\"px-6 hover:bg-muted/50 transition-all duration-200\"\r\n                      >\r\n                        Pr√©c√©dent\r\n                      </Button>\r\n                    )}\r\n                  </div>\r\n                  \r\n                  <div className=\"flex gap-3\">\r\n                    <Button \r\n                      variant=\"outline\" \r\n                      onClick={() => {\r\n                        setShowMultiSchoolAssignment(false);\r\n                        resetMultiSchoolWorkflow();\r\n                      }}\r\n                      className=\"px-6 hover:bg-error/10 hover:text-error hover:border-error/50 transition-all duration-200\"\r\n                    >\r\n                      Annuler\r\n                    </Button>\r\n                    \r\n                    <Button \r\n                      onClick={() => {\r\n                        if (currentStep === 2 && assignationMode === 'new') {\r\n                          // Valider et cr√©er l'enseignant avant de passer √† l'√©tape 3\r\n                          if (newTeacher.fullName && newTeacher.email && \r\n                              newTeacher.subjects?.length > 0 && newTeacher.classes?.length > 0 &&\r\n                              newTeacher.password && newTeacher.confirmPassword) {\r\n                            \r\n                            if (!validatePassword(newTeacher.password)) {\r\n                              alert('Le mot de passe doit contenir au moins 8 caract√®res avec : une majuscule, une minuscule, un chiffre et un caract√®re sp√©cial');\r\n                              return;\r\n                            }\r\n                            \r\n                            if (newTeacher.password !== newTeacher.confirmPassword) {\r\n                              alert('Les mots de passe ne correspondent pas');\r\n                              return;\r\n                            }\r\n                            \r\n                            // Cr√©er un objet enseignant temporaire pour l'assignation\r\n                            const tempTeacher = {\r\n                              id: `temp-${Date.now()}`,\r\n                              fullName: newTeacher.fullName,\r\n                              email: newTeacher.email,\r\n                              phone: newTeacher.phone,\r\n                              subjects: newTeacher.subjects,\r\n                              classes: newTeacher.classes,\r\n                              password: newTeacher.password,\r\n                              isNew: true // Marquer comme nouveau\r\n                            };\r\n                            setSelectedExistingTeacher(tempTeacher);\r\n                            nextStep();\r\n                          } else {\r\n                            alert('Veuillez remplir tous les champs obligatoires');\r\n                          }\r\n                        } else {\r\n                          nextStep();\r\n                        }\r\n                      }}\r\n                      disabled={\r\n                        (currentStep === 1 && !assignationMode) ||\r\n                        (currentStep === 2 && assignationMode === 'existing' && !selectedExistingTeacher)\r\n                      }\r\n                      iconName=\"ChevronRight\"\r\n                      iconPosition=\"right\"\r\n                      className=\"px-6 bg-gradient-to-r from-primary to-primary/90 hover:from-primary/90 hover:to-primary shadow-lg hover:shadow-primary/30 transition-all duration-200\"\r\n                    >\r\n                      {currentStep === 2 && assignationMode === 'new' ? 'Cr√©er et Continuer' : 'Suivant'}\r\n                    </Button>\r\n                  </div>\r\n                </div>\r\n              )}\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Modal Ajouter une mati√®re */}\r\n      {showAddSubjectModal && (\r\n        <div className=\"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50 p-4 animate-in fade-in duration-200\">\r\n          <div className=\"bg-card rounded-2xl border border-border/50 shadow-2xl w-full max-w-md animate-in slide-in-from-bottom-4 duration-300\">\r\n            {/* En-t√™te moderne */}\r\n            <div className=\"relative bg-gradient-to-r from-primary/10 via-primary/5 to-secondary/10 p-6 border-b border-border/50\">\r\n              <div className=\"flex items-center justify-between\">\r\n                <div className=\"flex items-center gap-3\">\r\n                  <div className=\"w-10 h-10 bg-primary/20 rounded-xl flex items-center justify-center\">\r\n                    <Icon name=\"BookOpen\" size={20} className=\"text-primary\" />\r\n                  </div>\r\n                  <h3 className=\"font-heading font-heading-bold text-xl text-text-primary\">\r\n                    Ajouter une mati√®re\r\n                  </h3>\r\n                </div>\r\n                <button\r\n                  onClick={() => {\r\n                    setShowAddSubjectModal(false);\r\n                    setNewSubject('');\r\n                  }}\r\n                  className=\"w-8 h-8 rounded-lg hover:bg-muted/50 transition-all duration-200 flex items-center justify-center\"\r\n                >\r\n                  <Icon name=\"X\" size={18} className=\"text-text-secondary\" />\r\n                </button>\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"p-6 space-y-5\">\r\n              {/* Champ de saisie avec style moderne */}\r\n              <div className=\"space-y-2\">\r\n                <label className=\"block text-sm font-semibold text-text-primary\">\r\n                  Nom de la mati√®re *\r\n                </label>\r\n                <Input\r\n                  type=\"text\"\r\n                  placeholder=\"Ex: Informatique, Biologie, Arts plastiques...\"\r\n                  value={newSubject}\r\n                  onChange={(e) => setNewSubject(e.target.value)}\r\n                  onKeyPress={(e) => {\r\n                    if (e.key === 'Enter') {\r\n                      handleAddSubject();\r\n                    }\r\n                  }}\r\n                  className=\"transition-all duration-200 focus-within:shadow-md\"\r\n                />\r\n                <p className=\"text-xs text-text-tertiary flex items-center gap-1\">\r\n                  <Icon name=\"Info\" size={12} />\r\n                  Cette mati√®re sera ajout√©e √† la liste des mati√®res disponibles\r\n                </p>\r\n              </div>\r\n\r\n              {/* Message informatif avec design moderne */}\r\n              <div className=\"bg-gradient-to-r from-blue-50 to-blue-50/50 border border-blue-200 rounded-xl p-4\">\r\n                <div className=\"flex items-start gap-3\">\r\n                  <div className=\"w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center shrink-0\">\r\n                    <Icon name=\"Info\" size={16} className=\"text-blue-600\" />\r\n                  </div>\r\n                  <div>\r\n                    <p className=\"text-sm font-semibold text-blue-900 mb-1\">\r\n                      Note importante\r\n                    </p>\r\n                    <p className=\"text-xs text-blue-700 leading-relaxed\">\r\n                      Cette mati√®re sera disponible uniquement pour votre √©tablissement et restera enregistr√©e pour les prochaines assignations.\r\n                    </p>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n            {/* Boutons d'action avec design moderne */}\r\n            <div className=\"flex gap-3 p-6 border-t border-border/50 bg-muted/20\">\r\n              <Button\r\n                variant=\"outline\"\r\n                onClick={() => {\r\n                  setShowAddSubjectModal(false);\r\n                  setNewSubject('');\r\n                }}\r\n                className=\"flex-1 hover:bg-muted/50 transition-all duration-200\"\r\n              >\r\n                Annuler\r\n              </Button>\r\n              <Button\r\n                onClick={handleAddSubject}\r\n                className=\"flex-1 bg-gradient-to-r from-primary to-primary/90 hover:from-primary/90 hover:to-primary shadow-lg hover:shadow-primary/30 transition-all duration-200\"\r\n                disabled={!newSubject.trim()}\r\n                iconName=\"Plus\"\r\n                iconPosition=\"left\"\r\n              >\r\n                Ajouter\r\n              </Button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default TeacherManagementTab;","// Service pour la gestion des cartes scolaires\r\n\r\nimport { supabase } from '../lib/supabase';\r\n\r\n// Obtenir l'√©cole actuelle\r\nconst getCurrentSchoolId = async () => {\r\n  try {\r\n    // 1. Essayer le localStorage d'abord\r\n    const savedUser = localStorage.getItem('edutrack-user');\r\n    if (savedUser) {\r\n      const userData = JSON.parse(savedUser);\r\n      if (userData.current_school_id) {\r\n        return userData.current_school_id;\r\n      }\r\n    }\r\n\r\n    // 2. Si pas dans localStorage, r√©cup√©rer depuis Supabase\r\n    const { data: { user } } = await supabase.auth.getUser();\r\n    if (!user) {\r\n      console.warn('‚ö†Ô∏è Utilisateur non authentifi√©');\r\n      return null;\r\n    }\r\n\r\n    // R√©cup√©rer l'√©cole depuis la table users\r\n    const { data: userData, error } = await supabase\r\n      .from('users')\r\n      .select('current_school_id, schools:current_school_id(id, name)')\r\n      .eq('id', user.id)\r\n      .single();\r\n\r\n    if (error) {\r\n      console.error('‚ùå Erreur r√©cup√©ration √©cole utilisateur:', error);\r\n      return null;\r\n    }\r\n\r\n    if (userData?.current_school_id) {\r\n      console.log('‚úÖ √âcole trouv√©e:', userData.current_school_id, userData.schools?.name);\r\n      return userData.current_school_id;\r\n    }\r\n\r\n    console.warn('‚ö†Ô∏è Aucune √©cole associ√©e √† l\\'utilisateur');\r\n    return null;\r\n  } catch (error) {\r\n    console.error('‚ùå Erreur getCurrentSchoolId:', error);\r\n    return null;\r\n  }\r\n};\r\n\r\n// Formatage des dates\r\nconst formatDate = (date) => {\r\n  return date.toLocaleDateString('fr-FR');\r\n};\r\n\r\n// Calcul de la date d'expiration (fin d'ann√©e scolaire)\r\nconst getExpiryDate = () => {\r\n  const now = new Date();\r\n  const currentYear = now.getFullYear();\r\n  const currentMonth = now.getMonth();\r\n  \r\n  // Si on est entre septembre et d√©cembre, l'expiration est en juin de l'ann√©e suivante\r\n  // Sinon, c'est en juin de l'ann√©e courante\r\n  const expiryYear = currentMonth >= 8 ? currentYear + 1 : currentYear;\r\n  return new Date(expiryYear, 5, 30); // 30 juin\r\n};\r\n\r\n// Service principal\r\nexport const cardService = {\r\n  // Obtenir toutes les cartes\r\n  getAllCards: async () => {\r\n    try {\r\n      const schoolId = await getCurrentSchoolId();\r\n      if (!schoolId) {\r\n        throw new Error('Pas d\\'√©cole associ√©e');\r\n      }\r\n\r\n      // R√©cup√©rer les cartes avec les informations des √©tudiants\r\n      const { data, error } = await supabase\r\n        .from('student_cards')\r\n        .select(`\r\n          id,\r\n          card_number,\r\n          issue_date,\r\n          expiry_date,\r\n          status,\r\n          created_at,\r\n          updated_at,\r\n          student_id,\r\n          students:student_id (\r\n            id,\r\n            user_id,\r\n            first_name,\r\n            last_name,\r\n            date_of_birth,\r\n            users:user_id (\r\n              photo\r\n            )\r\n          )\r\n        `)\r\n        .eq('school_id', schoolId)\r\n        .order('created_at', { ascending: false });\r\n\r\n      if (error) throw error;\r\n\r\n      // R√©cup√©rer les classes des √©tudiants via les attendances r√©centes\r\n      const studentIds = data.map(card => card.student_id).filter(Boolean);\r\n      \r\n      let studentClasses = {};\r\n      if (studentIds.length > 0) {\r\n        const { data: attendancesData } = await supabase\r\n          .from('attendances')\r\n          .select(`\r\n            student_id,\r\n            classes:class_id (\r\n              name\r\n            )\r\n          `)\r\n          .in('student_id', studentIds)\r\n          .order('date', { ascending: false })\r\n          .limit(studentIds.length);\r\n\r\n        if (attendancesData) {\r\n          attendancesData.forEach(att => {\r\n            if (!studentClasses[att.student_id] && att.classes?.name) {\r\n              studentClasses[att.student_id] = att.classes.name;\r\n            }\r\n          });\r\n        }\r\n      }\r\n\r\n      // Transformer au format attendu\r\n      const formattedCards = data.map(card => ({\r\n        id: card.id,\r\n        studentId: card.students?.user_id || card.students?.id,\r\n        studentName: `${card.students?.first_name || ''} ${card.students?.last_name || ''}`.trim(),\r\n        class: studentClasses[card.student_id] || 'Non assign√©',\r\n        photo: card.students?.users?.photo || '/assets/images/no_image.png',\r\n        cardNumber: card.card_number,\r\n        issueDate: card.issue_date ? new Date(card.issue_date).toLocaleDateString('fr-FR') : '',\r\n        expiryDate: card.expiry_date ? new Date(card.expiry_date).toLocaleDateString('fr-FR') : '',\r\n        status: card.status,\r\n        dateOfBirth: card.students?.date_of_birth ? new Date(card.students.date_of_birth).toLocaleDateString('fr-FR') : '',\r\n        parentName: 'Non renseign√©', // Parents relation √† impl√©menter plus tard\r\n        emergencyContact: 'Non renseign√©', // Parents relation √† impl√©menter plus tard\r\n        bloodType: 'Non renseign√©', // √Ä ajouter dans la table students si n√©cessaire\r\n        medicalNotes: 'Aucune' // √Ä ajouter dans la table students si n√©cessaire\r\n      }));\r\n\r\n      return formattedCards;\r\n    } catch (error) {\r\n      console.error('‚ùå Erreur chargement cartes Supabase:', error);\r\n      console.error('Code erreur:', error.code);\r\n      console.error('Message:', error.message);\r\n      console.error('Details:', error.details);\r\n      throw error;\r\n    }\r\n  }\r\n};\r\n\r\n// Exporter la fonction getCurrentSchoolId pour utilisation dans d'autres services\r\nexport { getCurrentSchoolId };\r\n\r\nexport default cardService;","import React, { useState, useEffect } from 'react';\r\nimport Icon from '../../../components/AppIcon';\r\nimport Button from '../../../components/ui/Button';\r\nimport Input from '../../../components/ui/Input';\r\nimport Image from '../../../components/AppImage';\r\nimport cardService from '../../../services/cardService';\r\n\r\nconst CardGenerationModal = ({ isOpen, onClose, onCardGenerated }) => {\r\n  const [step, setStep] = useState(1); // 1: Recherche √©tudiant, 2: Confirmation\r\n  const [searchTerm, setSearchTerm] = useState('');\r\n  const [availableStudents, setAvailableStudents] = useState([]);\r\n  const [selectedStudent, setSelectedStudent] = useState(null);\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const [isGenerating, setIsGenerating] = useState(false);\r\n  const [error, setError] = useState('');\r\n\r\n  // Recherche des √©tudiants disponibles\r\n  useEffect(() => {\r\n    if (isOpen && step === 1) {\r\n      loadAvailableStudents();\r\n    }\r\n  }, [isOpen, step, searchTerm]);\r\n\r\n  const loadAvailableStudents = async () => {\r\n    try {\r\n      setIsLoading(true);\r\n      setError('');\r\n      const students = await cardService.searchAvailableStudents(searchTerm);\r\n      setAvailableStudents(students);\r\n    } catch (err) {\r\n      setError('Erreur lors de la recherche des √©tudiants');\r\n      console.error('Erreur:', err);\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleStudentSelect = (student) => {\r\n    setSelectedStudent(student);\r\n    setStep(2);\r\n  };\r\n\r\n  const handleGenerateCard = async () => {\r\n    if (!selectedStudent) return;\r\n\r\n    try {\r\n      setIsGenerating(true);\r\n      setError('');\r\n      const newCard = await cardService.generateCard(selectedStudent.id);\r\n      \r\n      // Informer le parent de la nouvelle carte g√©n√©r√©e\r\n      if (onCardGenerated) {\r\n        onCardGenerated(newCard);\r\n      }\r\n      \r\n      handleClose();\r\n    } catch (err) {\r\n      setError(err.message || 'Erreur lors de la g√©n√©ration de la carte');\r\n    } finally {\r\n      setIsGenerating(false);\r\n    }\r\n  };\r\n\r\n  const handleClose = () => {\r\n    setStep(1);\r\n    setSearchTerm('');\r\n    setSelectedStudent(null);\r\n    setError('');\r\n    setIsLoading(false);\r\n    setIsGenerating(false);\r\n    onClose();\r\n  };\r\n\r\n  const handleBackToSearch = () => {\r\n    setStep(1);\r\n    setSelectedStudent(null);\r\n    setError('');\r\n  };\r\n\r\n  if (!isOpen) return null;\r\n\r\n  return (\r\n    <div className=\"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4\">\r\n      <div className=\"bg-card rounded-lg border border-border max-w-2xl w-full max-h-[90vh] overflow-y-auto\">\r\n        {/* Header */}\r\n        <div className=\"flex items-center justify-between p-6 border-b border-border\">\r\n          <div>\r\n            <h3 className=\"font-heading font-heading-semibold text-lg text-text-primary\">\r\n              {step === 1 ? 'S√©lectionner un √âtudiant' : 'Confirmer la G√©n√©ration'}\r\n            </h3>\r\n            <p className=\"font-body font-body-normal text-sm text-text-secondary mt-1\">\r\n              {step === 1 \r\n                ? 'Choisissez un √©tudiant pour g√©n√©rer sa carte scolaire'\r\n                : 'V√©rifiez les informations avant de g√©n√©rer la carte'\r\n              }\r\n            </p>\r\n          </div>\r\n          <Button\r\n            variant=\"ghost\"\r\n            size=\"icon\"\r\n            onClick={handleClose}\r\n          >\r\n            <Icon name=\"X\" size={20} />\r\n          </Button>\r\n        </div>\r\n\r\n        {/* Error Message */}\r\n        {error && (\r\n          <div className=\"mx-6 mt-4 p-3 bg-error/10 border border-error/20 rounded-lg\">\r\n            <div className=\"flex items-center space-x-2\">\r\n              <Icon name=\"AlertCircle\" size={16} className=\"text-error\" />\r\n              <p className=\"font-body font-body-normal text-sm text-error\">\r\n                {error}\r\n              </p>\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        {/* Step 1: Recherche et s√©lection d'√©tudiant */}\r\n        {step === 1 && (\r\n          <div className=\"p-6\">\r\n            {/* Barre de recherche */}\r\n            <div className=\"mb-6\">\r\n              <Input\r\n                type=\"search\"\r\n                placeholder=\"Rechercher par nom, ID ou classe...\"\r\n                value={searchTerm}\r\n                onChange={(e) => setSearchTerm(e.target.value)}\r\n                className=\"w-full\"\r\n              />\r\n            </div>\r\n\r\n            {/* Liste des √©tudiants */}\r\n            <div className=\"space-y-2 max-h-96 overflow-y-auto\">\r\n              {isLoading ? (\r\n                <div className=\"flex items-center justify-center py-8\">\r\n                  <div className=\"flex items-center space-x-2\">\r\n                    <div className=\"w-5 h-5 border-2 border-primary border-t-transparent rounded-full animate-spin\"></div>\r\n                    <span className=\"font-body font-body-normal text-sm text-text-secondary\">\r\n                      Recherche en cours...\r\n                    </span>\r\n                  </div>\r\n                </div>\r\n              ) : availableStudents.length === 0 ? (\r\n                <div className=\"text-center py-8\">\r\n                  <Icon name=\"Users\" size={48} className=\"text-muted-foreground mx-auto mb-4\" />\r\n                  <p className=\"font-body font-body-normal text-text-secondary\">\r\n                    {searchTerm \r\n                      ? 'Aucun √©tudiant trouv√© avec ces crit√®res'\r\n                      : 'Aucun √©tudiant disponible pour la g√©n√©ration de carte'\r\n                    }\r\n                  </p>\r\n                </div>\r\n              ) : (\r\n                availableStudents.map((student) => (\r\n                  <div\r\n                    key={student.id}\r\n                    className=\"flex items-center justify-between p-4 border border-border rounded-lg hover:bg-muted/30 cursor-pointer transition-colors\"\r\n                    onClick={() => handleStudentSelect(student)}\r\n                  >\r\n                    <div className=\"flex items-center space-x-3\">\r\n                      <Image\r\n                        src={student.photo}\r\n                        alt={student.name}\r\n                        className=\"w-12 h-12 rounded-full object-cover\"\r\n                        fallback=\"/public/assets/images/no_image.png\"\r\n                      />\r\n                      <div>\r\n                        <h4 className=\"font-body font-body-medium text-sm text-text-primary\">\r\n                          {student.name}\r\n                        </h4>\r\n                        <div className=\"flex items-center space-x-4 mt-1\">\r\n                          <p className=\"font-caption font-caption-normal text-xs text-text-secondary\">\r\n                            ID: {student.id}\r\n                          </p>\r\n                          <p className=\"font-caption font-caption-normal text-xs text-text-secondary\">\r\n                            Classe: {student.class}\r\n                          </p>\r\n                        </div>\r\n                      </div>\r\n                    </div>\r\n                    <div className=\"flex items-center space-x-2\">\r\n                      {student.hasCard ? (\r\n                        <span className=\"px-2 py-1 bg-warning/10 text-warning rounded-full text-xs font-caption font-caption-normal\">\r\n                          Carte existante\r\n                        </span>\r\n                      ) : (\r\n                        <span className=\"px-2 py-1 bg-success/10 text-success rounded-full text-xs font-caption font-caption-normal\">\r\n                          Disponible\r\n                        </span>\r\n                      )}\r\n                      <Icon name=\"ChevronRight\" size={16} className=\"text-muted-foreground\" />\r\n                    </div>\r\n                  </div>\r\n                ))\r\n              )}\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        {/* Step 2: Confirmation */}\r\n        {step === 2 && selectedStudent && (\r\n          <div className=\"p-6\">\r\n            {/* Informations de l'√©tudiant */}\r\n            <div className=\"bg-muted/20 rounded-lg p-6 mb-6\">\r\n              <div className=\"flex items-center space-x-4 mb-4\">\r\n                <Image\r\n                  src={selectedStudent.photo}\r\n                  alt={selectedStudent.name}\r\n                  className=\"w-16 h-16 rounded-lg object-cover\"\r\n                  fallback=\"/public/assets/images/no_image.png\"\r\n                />\r\n                <div>\r\n                  <h4 className=\"font-heading font-heading-semibold text-lg text-text-primary\">\r\n                    {selectedStudent.name}\r\n                  </h4>\r\n                  <p className=\"font-body font-body-normal text-sm text-text-secondary\">\r\n                    {selectedStudent.id} ‚Ä¢ Classe {selectedStudent.class}\r\n                  </p>\r\n                </div>\r\n              </div>\r\n\r\n              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n                <div>\r\n                  <p className=\"font-caption font-caption-normal text-xs text-text-secondary mb-1\">\r\n                    Parent/Tuteur\r\n                  </p>\r\n                  <p className=\"font-body font-body-normal text-sm text-text-primary\">\r\n                    {selectedStudent.parentName}\r\n                  </p>\r\n                </div>\r\n                <div>\r\n                  <p className=\"font-caption font-caption-normal text-xs text-text-secondary mb-1\">\r\n                    Contact d'urgence\r\n                  </p>\r\n                  <p className=\"font-body font-body-normal text-sm text-text-primary\">\r\n                    {selectedStudent.emergencyContact}\r\n                  </p>\r\n                </div>\r\n                <div>\r\n                  <p className=\"font-caption font-caption-normal text-xs text-text-secondary mb-1\">\r\n                    Groupe sanguin\r\n                  </p>\r\n                  <p className=\"font-body font-body-normal text-sm text-text-primary\">\r\n                    {selectedStudent.bloodType}\r\n                  </p>\r\n                </div>\r\n                <div>\r\n                  <p className=\"font-caption font-caption-normal text-xs text-text-secondary mb-1\">\r\n                    Notes m√©dicales\r\n                  </p>\r\n                  <p className=\"font-body font-body-normal text-sm text-text-primary\">\r\n                    {selectedStudent.medicalNotes || 'Aucune'}\r\n                  </p>\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n            {/* Informations de la carte √† g√©n√©rer */}\r\n            <div className=\"bg-primary/5 rounded-lg p-4 mb-6\">\r\n              <h5 className=\"font-heading font-heading-semibold text-sm text-text-primary mb-3\">\r\n                Informations de la carte\r\n              </h5>\r\n              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-3 text-sm\">\r\n                <div>\r\n                  <p className=\"font-caption font-caption-normal text-xs text-text-secondary\">\r\n                    Date d'√©mission\r\n                  </p>\r\n                  <p className=\"font-body font-body-normal text-text-primary\">\r\n                    {new Date().toLocaleDateString('fr-FR')}\r\n                  </p>\r\n                </div>\r\n                <div>\r\n                  <p className=\"font-caption font-caption-normal text-xs text-text-secondary\">\r\n                    Date d'expiration\r\n                  </p>\r\n                  <p className=\"font-body font-body-normal text-text-primary\">\r\n                    30/06/{new Date().getFullYear() + (new Date().getMonth() >= 8 ? 1 : 0)}\r\n                  </p>\r\n                </div>\r\n                <div>\r\n                  <p className=\"font-caption font-caption-normal text-xs text-text-secondary\">\r\n                    Statut initial\r\n                  </p>\r\n                  <p className=\"font-body font-body-normal text-text-primary\">\r\n                    Brouillon (n√©cessite validation)\r\n                  </p>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        {/* Footer */}\r\n        <div className=\"flex gap-3 p-6 border-t border-border\">\r\n          {step === 1 ? (\r\n            <Button variant=\"outline\" onClick={handleClose}>\r\n              Annuler\r\n            </Button>\r\n          ) : (\r\n            <>\r\n              <Button variant=\"outline\" onClick={handleBackToSearch}>\r\n                Retour\r\n              </Button>\r\n              <Button \r\n                variant=\"default\" \r\n                onClick={handleGenerateCard}\r\n                disabled={isGenerating}\r\n                iconName={isGenerating ? undefined : \"CreditCard\"}\r\n                iconPosition=\"left\"\r\n              >\r\n                {isGenerating ? (\r\n                  <div className=\"flex items-center space-x-2\">\r\n                    <div className=\"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin\"></div>\r\n                    <span>G√©n√©ration...</span>\r\n                  </div>\r\n                ) : (\r\n                  'G√©n√©rer la Carte'\r\n                )}\r\n              </Button>\r\n            </>\r\n          )}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default CardGenerationModal;","import React, { useState, useEffect } from 'react';\r\nimport Icon from '../../../components/AppIcon';\r\nimport Button from '../../../components/ui/Button';\r\nimport Input from '../../../components/ui/Input';\r\nimport Select from '../../../components/ui/Select';\r\nimport { Checkbox } from '../../../components/ui/Checkbox';\r\nimport Image from '../../../components/AppImage';\r\nimport CardGenerationModal from './CardGenerationModal';\r\nimport cardService from '../../../services/cardService';\r\n\r\nconst StudentCardTab = () => {\r\n  const [searchTerm, setSearchTerm] = useState('');\r\n  const [filterClass, setFilterClass] = useState('');\r\n  const [filterStatus, setFilterStatus] = useState('');\r\n  const [selectedCards, setSelectedCards] = useState([]);\r\n  const [showPreview, setShowPreview] = useState(false);\r\n  const [previewCard, setPreviewCard] = useState(null);\r\n  const [showGenerationModal, setShowGenerationModal] = useState(false);\r\n  const [studentCards, setStudentCards] = useState([]);\r\n  const [isLoading, setIsLoading] = useState(true);\r\n  const [error, setError] = useState('');\r\n  const [successMessage, setSuccessMessage] = useState('');\r\n\r\n  // Load cards on component mount\r\n  useEffect(() => {\r\n    loadCards();\r\n  }, []);\r\n\r\n  const loadCards = async () => {\r\n    try {\r\n      setIsLoading(true);\r\n      setError('');\r\n      const cards = await cardService.getAllCards();\r\n      setStudentCards(cards);\r\n    } catch (err) {\r\n      console.error('Erreur chargement cartes:', err);\r\n      \r\n      // V√©rifier si c'est une erreur de table manquante\r\n      if (err.message?.includes('relation') || err.code === '42P01') {\r\n        setError('‚ö†Ô∏è Table student_cards non trouv√©e. Veuillez ex√©cuter la migration SQL dans Supabase.');\r\n      } else if (err.message?.includes('√©cole')) {\r\n        setError('‚ùå Aucune √©cole associ√©e √† votre compte.');\r\n      } else {\r\n        setError(`Erreur: ${err.message || 'Impossible de charger les cartes'}`);\r\n      }\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  // Affichage des messages de succ√®s temporaires\r\n  useEffect(() => {\r\n    if (successMessage) {\r\n      const timer = setTimeout(() => {\r\n        setSuccessMessage('');\r\n      }, 5000);\r\n      return () => clearTimeout(timer);\r\n    }\r\n  }, [successMessage]);\r\n\r\n  const classOptions = [\r\n    { value: '', label: 'Toutes les classes' },\r\n    { value: 'CP', label: 'CP' },\r\n    { value: 'CE1', label: 'CE1' },\r\n    { value: 'CE2', label: 'CE2' },\r\n    { value: 'CM1', label: 'CM1' },\r\n    { value: 'CM2', label: 'CM2' }\r\n  ];\r\n\r\n  const statusOptions = [\r\n    { value: '', label: 'Tous les statuts' },\r\n    { value: 'draft', label: 'Brouillon' },\r\n    { value: 'pending_validation', label: 'En attente de validation' },\r\n    { value: 'issued', label: '√âmise' },\r\n    { value: 'printed', label: 'Imprim√©e' },\r\n    { value: 'expired', label: 'Expir√©e' }\r\n  ];\r\n\r\n  const getStatusBadge = (status) => {\r\n    const statusConfig = {\r\n      draft: { label: 'Brouillon', className: 'bg-muted text-muted-foreground' },\r\n      pending_validation: { label: 'En validation', className: 'bg-warning/10 text-warning' },\r\n      issued: { label: '√âmise', className: 'bg-success/10 text-success' },\r\n      printed: { label: 'Imprim√©e', className: 'bg-primary/10 text-primary' },\r\n      expired: { label: 'Expir√©e', className: 'bg-error/10 text-error' }\r\n    };\r\n    \r\n    const config = statusConfig?.[status] || statusConfig?.draft;\r\n    return (\r\n      <span className={`px-2 py-1 rounded-full text-xs font-caption font-caption-normal ${config?.className}`}>\r\n        {config?.label}\r\n      </span>\r\n    );\r\n  };\r\n\r\n  const filteredCards = studentCards?.filter(card => {\r\n    const matchesSearch = card?.studentName?.toLowerCase()?.includes(searchTerm?.toLowerCase()) ||\r\n                         card?.cardNumber?.toLowerCase()?.includes(searchTerm?.toLowerCase()) ||\r\n                         card?.studentId?.toLowerCase()?.includes(searchTerm?.toLowerCase());\r\n    const matchesClass = !filterClass || card?.class === filterClass;\r\n    const matchesStatus = !filterStatus || card?.status === filterStatus;\r\n    \r\n    return matchesSearch && matchesClass && matchesStatus;\r\n  });\r\n\r\n  const handleGenerateCard = () => {\r\n    setShowGenerationModal(true);\r\n  };\r\n\r\n  const handleCardGenerated = (newCard) => {\r\n    setStudentCards(prev => [...prev, newCard]);\r\n    setSuccessMessage(`Carte g√©n√©r√©e avec succ√®s pour ${newCard.studentName}`);\r\n  };\r\n\r\n  const handleValidateCard = async (cardId) => {\r\n    try {\r\n      const updatedCard = await cardService.validateCard(cardId);\r\n      setStudentCards(prev => \r\n        prev.map(card => \r\n          card.id === cardId ? updatedCard : card\r\n        )\r\n      );\r\n      setSuccessMessage('Carte valid√©e avec succ√®s');\r\n    } catch (err) {\r\n      setError(err.message || 'Erreur lors de la validation');\r\n    }\r\n  };\r\n\r\n  const handlePrintCard = async (cardId) => {\r\n    try {\r\n      const updatedCard = await cardService.printCard(cardId);\r\n      setStudentCards(prev => \r\n        prev.map(card => \r\n          card.id === cardId ? updatedCard : card\r\n        )\r\n      );\r\n      setSuccessMessage('Carte imprim√©e avec succ√®s');\r\n    } catch (err) {\r\n      setError(err.message || 'Erreur lors de l\\'impression');\r\n    }\r\n  };\r\n\r\n  const handleBulkPrint = async () => {\r\n    if (selectedCards.length === 0) return;\r\n    \r\n    try {\r\n      const updatedCards = await cardService.bulkPrintCards(selectedCards);\r\n      setStudentCards(prev => \r\n        prev.map(card => {\r\n          const updated = updatedCards.find(u => u.id === card.id);\r\n          return updated || card;\r\n        })\r\n      );\r\n      setSelectedCards([]);\r\n      setSuccessMessage(`${updatedCards.length} carte(s) imprim√©e(s) avec succ√®s`);\r\n    } catch (err) {\r\n      setError(err.message || 'Erreur lors de l\\'impression en lot');\r\n    }\r\n  };\r\n\r\n  const handleRegenerateCard = async (studentId) => {\r\n    try {\r\n      const newCard = await cardService.regenerateCard(studentId);\r\n      setStudentCards(prev => \r\n        prev.map(card => \r\n          card.studentId === studentId && card.status !== 'expired' \r\n            ? { ...card, status: 'expired' } \r\n            : card\r\n        ).concat(newCard)\r\n      );\r\n      setSuccessMessage('Carte r√©g√©n√©r√©e avec succ√®s');\r\n    } catch (err) {\r\n      setError(err.message || 'Erreur lors de la r√©g√©n√©ration');\r\n    }\r\n  };\r\n\r\n  const handleBulkValidate = async () => {\r\n    const validatableCards = selectedCards.filter(cardId => {\r\n      const card = studentCards.find(c => c.id === cardId);\r\n      return card && ['draft', 'pending_validation'].includes(card.status);\r\n    });\r\n\r\n    if (validatableCards.length === 0) {\r\n      setError('Aucune carte s√©lectionn√©e ne peut √™tre valid√©e');\r\n      return;\r\n    }\r\n\r\n    try {\r\n      const updatedCards = await cardService.bulkValidateCards(validatableCards);\r\n      setStudentCards(prev => \r\n        prev.map(card => {\r\n          const updated = updatedCards.find(u => u.id === card.id);\r\n          return updated || card;\r\n        })\r\n      );\r\n      setSelectedCards([]);\r\n      setSuccessMessage(`${updatedCards.length} carte(s) valid√©e(s) avec succ√®s`);\r\n    } catch (err) {\r\n      setError(err.message || 'Erreur lors de la validation en lot');\r\n    }\r\n  };\r\n\r\n  const handlePreviewCard = (card) => {\r\n    setPreviewCard(card);\r\n    setShowPreview(true);\r\n  };\r\n\r\n  const toggleCardSelection = (cardId) => {\r\n    setSelectedCards(prev => \r\n      prev.includes(cardId) \r\n        ? prev.filter(id => id !== cardId)\r\n        : [...prev, cardId]\r\n    );\r\n  };\r\n\r\n  const getCurrentDate = () => {\r\n    return new Date().toLocaleDateString('fr-FR');\r\n  };\r\n\r\n  const getExpiryDate = () => {\r\n    const date = new Date();\r\n    date.setMonth(5); // Juin (mois 5)\r\n    date.setDate(30);\r\n    return date.toLocaleDateString('fr-FR');\r\n  };\r\n\r\n  // Loading state\r\n  if (isLoading) {\r\n    return (\r\n      <div className=\"flex items-center justify-center py-12\">\r\n        <div className=\"text-center\">\r\n          <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4\"></div>\r\n          <p className=\"text-text-secondary\">Chargement des cartes scolaires...</p>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      {/* Production mode - No cards info */}\r\n      {studentCards.length === 0 && (\r\n        <div className=\"bg-blue-50 border border-blue-200 rounded-lg p-4\">\r\n          <div className=\"flex items-start space-x-3\">\r\n            <Icon name=\"Info\" size={20} className=\"text-blue-600 mt-0.5\" />\r\n            <div>\r\n              <h4 className=\"font-body font-body-semibold text-blue-900 mb-1\">\r\n                Aucune carte scolaire\r\n              </h4>\r\n              <p className=\"text-sm text-blue-700\">\r\n                Aucune carte n'a encore √©t√© g√©n√©r√©e. Utilisez le bouton \"Nouvelle Carte\" pour cr√©er des cartes scolaires pour vos √©l√®ves.\r\n              </p>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Messages d'erreur et de succ√®s */}\r\n      {error && (\r\n        <div className=\"p-3 bg-error/10 border border-error/20 rounded-lg\">\r\n          <div className=\"flex items-center space-x-2\">\r\n            <Icon name=\"AlertCircle\" size={16} className=\"text-error\" />\r\n            <p className=\"font-body font-body-normal text-sm text-error\">\r\n              {error}\r\n            </p>\r\n            <Button\r\n              variant=\"ghost\"\r\n              size=\"icon\"\r\n              onClick={() => setError('')}\r\n              className=\"ml-auto\"\r\n            >\r\n              <Icon name=\"X\" size={16} />\r\n            </Button>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {successMessage && (\r\n        <div className=\"p-3 bg-success/10 border border-success/20 rounded-lg\">\r\n          <div className=\"flex items-center space-x-2\">\r\n            <Icon name=\"CheckCircle\" size={16} className=\"text-success\" />\r\n            <p className=\"font-body font-body-normal text-sm text-success\">\r\n              {successMessage}\r\n            </p>\r\n            <Button\r\n              variant=\"ghost\"\r\n              size=\"icon\"\r\n              onClick={() => setSuccessMessage('')}\r\n              className=\"ml-auto\"\r\n            >\r\n              <Icon name=\"X\" size={16} />\r\n            </Button>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Header with Actions */}\r\n      <div className=\"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4\">\r\n        <div>\r\n          <h2 className=\"font-heading font-heading-bold text-xl text-text-primary\">\r\n            Cartes Scolaires\r\n          </h2>\r\n          <p className=\"font-body font-body-normal text-sm text-text-secondary mt-1\">\r\n            G√©rez la g√©n√©ration et validation des cartes d'identit√© √©tudiante\r\n          </p>\r\n        </div>\r\n        <div className=\"flex gap-2\">\r\n          <Button\r\n            variant=\"outline\"\r\n            iconName=\"CheckCircle\"\r\n            iconPosition=\"left\"\r\n            onClick={handleBulkValidate}\r\n            disabled={selectedCards.length === 0}\r\n          >\r\n            Valider s√©lection ({selectedCards.length})\r\n          </Button>\r\n          <Button\r\n            variant=\"outline\"\r\n            iconName=\"Printer\"\r\n            iconPosition=\"left\"\r\n            onClick={handleBulkPrint}\r\n            disabled={selectedCards.length === 0}\r\n          >\r\n            Imprimer s√©lection ({selectedCards.length})\r\n          </Button>\r\n          <Button\r\n            variant=\"default\"\r\n            iconName=\"CreditCard\"\r\n            iconPosition=\"left\"\r\n            onClick={handleGenerateCard}\r\n          >\r\n            Nouvelle Carte\r\n          </Button>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Quick Actions Cards */}\r\n      <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\r\n        <div \r\n          className=\"bg-card rounded-lg border border-border p-6 cursor-pointer hover:bg-muted/30 transition-colors\"\r\n          onClick={handleGenerateCard}\r\n        >\r\n          <div className=\"flex items-center space-x-3\">\r\n            <div className=\"w-12 h-12 bg-primary/10 rounded-lg flex items-center justify-center\">\r\n              <Icon name=\"CreditCard\" size={24} className=\"text-primary\" />\r\n            </div>\r\n            <div>\r\n              <h3 className=\"font-heading font-heading-semibold text-lg text-text-primary mb-1\">\r\n                G√©n√©ration rapide\r\n              </h3>\r\n              <p className=\"font-body font-body-normal text-sm text-text-secondary\">\r\n                Cr√©er une nouvelle carte pour un √©l√®ve\r\n              </p>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <div \r\n          className=\"bg-card rounded-lg border border-border p-6 cursor-pointer hover:bg-muted/30 transition-colors\"\r\n          onClick={handleBulkValidate}\r\n        >\r\n          <div className=\"flex items-center space-x-3\">\r\n            <div className=\"w-12 h-12 bg-warning/10 rounded-lg flex items-center justify-center\">\r\n              <Icon name=\"CheckCircle\" size={24} className=\"text-warning\" />\r\n            </div>\r\n            <div>\r\n              <h3 className=\"font-heading font-heading-semibold text-lg text-text-primary mb-1\">\r\n                Validation en lot\r\n                {selectedCards.length > 0 && (\r\n                  <span className=\"ml-2 px-2 py-1 bg-warning/20 text-warning rounded-full text-xs\">\r\n                    {selectedCards.length}\r\n                  </span>\r\n                )}\r\n              </h3>\r\n              <p className=\"font-body font-body-normal text-sm text-text-secondary\">\r\n                Valider plusieurs cartes simultan√©ment\r\n              </p>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <div \r\n          className=\"bg-card rounded-lg border border-border p-6 cursor-pointer hover:bg-muted/30 transition-colors\"\r\n          onClick={handleBulkPrint}\r\n        >\r\n          <div className=\"flex items-center space-x-3\">\r\n            <div className=\"w-12 h-12 bg-success/10 rounded-lg flex items-center justify-center\">\r\n              <Icon name=\"Printer\" size={24} className=\"text-success\" />\r\n            </div>\r\n            <div>\r\n              <h3 className=\"font-heading font-heading-semibold text-lg text-text-primary mb-1\">\r\n                Impression\r\n                {selectedCards.length > 0 && (\r\n                  <span className=\"ml-2 px-2 py-1 bg-success/20 text-success rounded-full text-xs\">\r\n                    {selectedCards.length}\r\n                  </span>\r\n                )}\r\n              </h3>\r\n              <p className=\"font-body font-body-normal text-sm text-text-secondary\">\r\n                Imprimer les cartes valid√©es\r\n              </p>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Filters */}\r\n      <div className=\"bg-card rounded-lg border border-border p-4\">\r\n        <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\r\n          <Input\r\n            type=\"search\"\r\n            placeholder=\"Rechercher par nom, num√©ro de carte...\"\r\n            value={searchTerm}\r\n            onChange={(e) => setSearchTerm(e?.target?.value)}\r\n            className=\"w-full\"\r\n          />\r\n          <Select\r\n            placeholder=\"Filtrer par classe\"\r\n            options={classOptions}\r\n            value={filterClass}\r\n            onChange={setFilterClass}\r\n          />\r\n          <Select\r\n            placeholder=\"Filtrer par statut\"\r\n            options={statusOptions}\r\n            value={filterStatus}\r\n            onChange={setFilterStatus}\r\n          />\r\n        </div>\r\n      </div>\r\n\r\n      {/* Cards Table */}\r\n      <div className=\"bg-card rounded-lg border border-border overflow-hidden\">\r\n        {isLoading ? (\r\n          <div className=\"flex items-center justify-center py-12\">\r\n            <div className=\"flex items-center space-x-3\">\r\n              <div className=\"w-6 h-6 border-2 border-primary border-t-transparent rounded-full animate-spin\"></div>\r\n              <span className=\"font-body font-body-normal text-text-secondary\">\r\n                Chargement des cartes...\r\n              </span>\r\n            </div>\r\n          </div>\r\n        ) : (\r\n          <div className=\"overflow-x-auto\">\r\n            <table className=\"w-full\">\r\n            <thead className=\"bg-muted\">\r\n              <tr>\r\n                <th className=\"text-left p-4 w-12\">\r\n                  <Checkbox\r\n                    checked={selectedCards.length === filteredCards.length}\r\n                    onChange={(e) => {\r\n                      if (e.target.checked) {\r\n                        setSelectedCards(filteredCards.map(card => card.id));\r\n                      } else {\r\n                        setSelectedCards([]);\r\n                      }\r\n                    }}\r\n                  />\r\n                </th>\r\n                <th className=\"text-left p-4 font-heading font-heading-semibold text-sm text-text-primary\">\r\n                  √âl√®ve\r\n                </th>\r\n                <th className=\"text-left p-4 font-heading font-heading-semibold text-sm text-text-primary\">\r\n                  Num√©ro de carte\r\n                </th>\r\n                <th className=\"text-left p-4 font-heading font-heading-semibold text-sm text-text-primary\">\r\n                  Classe\r\n                </th>\r\n                <th className=\"text-left p-4 font-heading font-heading-semibold text-sm text-text-primary\">\r\n                  Dates\r\n                </th>\r\n                <th className=\"text-left p-4 font-heading font-heading-semibold text-sm text-text-primary\">\r\n                  Statut\r\n                </th>\r\n                <th className=\"text-right p-4 font-heading font-heading-semibold text-sm text-text-primary\">\r\n                  Actions\r\n                </th>\r\n              </tr>\r\n            </thead>\r\n            <tbody>\r\n              {filteredCards?.map((card) => (\r\n                <tr key={card?.id} className=\"border-t border-border hover:bg-muted/30\">\r\n                  <td className=\"p-4\">\r\n                    <Checkbox\r\n                      checked={selectedCards.includes(card.id)}\r\n                      onChange={() => toggleCardSelection(card.id)}\r\n                    />\r\n                  </td>\r\n                  <td className=\"p-4\">\r\n                    <div className=\"flex items-center space-x-3\">\r\n                      <Image\r\n                        src={card?.photo}\r\n                        alt={card?.studentName}\r\n                        className=\"w-10 h-10 rounded-full object-cover\"\r\n                        fallback=\"/public/assets/images/no_image.png\"\r\n                      />\r\n                      <div>\r\n                        <p className=\"font-body font-body-medium text-sm text-text-primary\">\r\n                          {card?.studentName}\r\n                        </p>\r\n                        <p className=\"font-caption font-caption-normal text-xs text-text-secondary\">\r\n                          ID: {card?.studentId}\r\n                        </p>\r\n                      </div>\r\n                    </div>\r\n                  </td>\r\n                  <td className=\"p-4\">\r\n                    <p className=\"font-body font-body-normal text-sm text-text-primary font-mono\">\r\n                      {card?.cardNumber}\r\n                    </p>\r\n                  </td>\r\n                  <td className=\"p-4\">\r\n                    <p className=\"font-body font-body-normal text-sm text-text-primary\">\r\n                      {card?.class}\r\n                    </p>\r\n                  </td>\r\n                  <td className=\"p-4\">\r\n                    <div>\r\n                      <p className=\"font-body font-body-normal text-sm text-text-primary\">\r\n                        √âmise: {card?.issueDate}\r\n                      </p>\r\n                      <p className=\"font-caption font-caption-normal text-xs text-text-secondary\">\r\n                        Expire: {card?.expiryDate}\r\n                      </p>\r\n                    </div>\r\n                  </td>\r\n                  <td className=\"p-4\">\r\n                    {getStatusBadge(card?.status)}\r\n                  </td>\r\n                  <td className=\"p-4\">\r\n                    <div className=\"flex items-center justify-end space-x-1\">\r\n                      <Button\r\n                        variant=\"ghost\"\r\n                        size=\"icon\"\r\n                        onClick={() => handlePreviewCard(card)}\r\n                        title=\"Aper√ßu\"\r\n                      >\r\n                        <Icon name=\"Eye\" size={16} />\r\n                      </Button>\r\n                      {card?.status === 'pending_validation' && (\r\n                        <Button\r\n                          variant=\"ghost\"\r\n                          size=\"icon\"\r\n                          onClick={() => handleValidateCard(card?.id)}\r\n                          title=\"Valider\"\r\n                        >\r\n                          <Icon name=\"CheckCircle\" size={16} />\r\n                        </Button>\r\n                      )}\r\n                      {(card?.status === 'issued' || card?.status === 'printed') && (\r\n                        <Button\r\n                          variant=\"ghost\"\r\n                          size=\"icon\"\r\n                          onClick={() => handlePrintCard(card?.id)}\r\n                          title=\"Imprimer\"\r\n                        >\r\n                          <Icon name=\"Printer\" size={16} />\r\n                        </Button>\r\n                      )}\r\n                      <Button\r\n                        variant=\"ghost\"\r\n                        size=\"icon\"\r\n                        onClick={() => handleRegenerateCard(card?.studentId)}\r\n                        title=\"R√©g√©n√©rer\"\r\n                      >\r\n                        <Icon name=\"RotateCcw\" size={16} />\r\n                      </Button>\r\n                    </div>\r\n                  </td>\r\n                </tr>\r\n              ))}\r\n            </tbody>\r\n          </table>\r\n\r\n          {filteredCards?.length === 0 && (\r\n            <div className=\"p-8 text-center\">\r\n              <Icon name=\"CreditCard\" size={48} className=\"text-muted-foreground mx-auto mb-4\" />\r\n              <p className=\"font-body font-body-normal text-text-secondary\">\r\n                Aucune carte trouv√©e avec les crit√®res de recherche\r\n              </p>\r\n            </div>\r\n          )}\r\n        </div>\r\n        )}\r\n      </div>\r\n\r\n      {/* Card Preview Modal */}\r\n      {showPreview && previewCard && (\r\n        <div className=\"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4\">\r\n          <div className=\"bg-card rounded-lg border border-border max-w-md w-full\">\r\n            {/* Modal Header */}\r\n            <div className=\"flex items-center justify-between p-6 border-b border-border\">\r\n              <h3 className=\"font-heading font-heading-semibold text-lg text-text-primary\">\r\n                Aper√ßu Carte Scolaire\r\n              </h3>\r\n              <Button\r\n                variant=\"ghost\"\r\n                size=\"icon\"\r\n                onClick={() => setShowPreview(false)}\r\n              >\r\n                <Icon name=\"X\" size={20} />\r\n              </Button>\r\n            </div>\r\n\r\n            {/* Card Preview */}\r\n            <div className=\"p-6\">\r\n              <div className=\"bg-gradient-to-br from-primary to-primary/80 rounded-lg p-6 text-white shadow-lg\">\r\n                <div className=\"flex justify-between items-start mb-4\">\r\n                  <div>\r\n                    <h4 className=\"font-heading font-heading-bold text-lg\">EduTrack-CM</h4>\r\n                    <p className=\"font-caption font-caption-normal text-sm opacity-90\">√âcole Primaire</p>\r\n                  </div>\r\n                  <div className=\"text-right\">\r\n                    <p className=\"font-mono text-sm\">{previewCard?.cardNumber}</p>\r\n                    <p className=\"font-caption font-caption-normal text-xs opacity-90\">Ann√©e 2024-2025</p>\r\n                  </div>\r\n                </div>\r\n                \r\n                <div className=\"flex items-center space-x-4 mb-4\">\r\n                  <Image\r\n                    src={previewCard?.photo}\r\n                    alt={previewCard?.studentName}\r\n                    className=\"w-16 h-16 rounded-lg object-cover border-2 border-white\"\r\n                    fallback=\"/public/assets/images/no_image.png\"\r\n                  />\r\n                  <div>\r\n                    <h5 className=\"font-heading font-heading-semibold text-lg\">{previewCard?.studentName}</h5>\r\n                    <p className=\"font-body font-body-normal text-sm opacity-90\">Classe: {previewCard?.class}</p>\r\n                  </div>\r\n                </div>\r\n                \r\n                <div className=\"border-t border-white/20 pt-3 mt-3\">\r\n                  <div className=\"grid grid-cols-2 gap-3 text-sm\">\r\n                    <div>\r\n                      <p className=\"font-caption font-caption-normal text-xs opacity-75\">Groupe sanguin</p>\r\n                      <p className=\"font-body font-body-medium\">{previewCard?.bloodType}</p>\r\n                    </div>\r\n                    <div>\r\n                      <p className=\"font-caption font-caption-normal text-xs opacity-75\">Urgence</p>\r\n                      <p className=\"font-body font-body-medium text-xs\">{previewCard?.emergencyContact}</p>\r\n                    </div>\r\n                  </div>\r\n                  {previewCard?.medicalNotes && previewCard?.medicalNotes !== \"Aucune\" && (\r\n                    <div className=\"mt-2\">\r\n                      <p className=\"font-caption font-caption-normal text-xs opacity-75\">Notes m√©dicales</p>\r\n                      <p className=\"font-body font-body-normal text-xs\">{previewCard?.medicalNotes}</p>\r\n                    </div>\r\n                  )}\r\n                </div>\r\n                \r\n                <div className=\"flex justify-between items-center mt-4 pt-3 border-t border-white/20\">\r\n                  <p className=\"font-caption font-caption-normal text-xs opacity-75\">\r\n                    Valide jusqu'au {previewCard?.expiryDate}\r\n                  </p>\r\n                  <div className=\"w-8 h-8 bg-white rounded flex items-center justify-center\">\r\n                    <Icon name=\"Shield\" size={16} className=\"text-primary\" />\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n            {/* Modal Footer */}\r\n            <div className=\"flex gap-3 p-6 border-t border-border\">\r\n              <Button variant=\"default\" onClick={() => handlePrintCard(previewCard?.id)}>\r\n                Imprimer\r\n              </Button>\r\n              <Button variant=\"outline\" onClick={() => setShowPreview(false)}>\r\n                Fermer\r\n              </Button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Summary Stats */}\r\n      <div className=\"grid grid-cols-1 sm:grid-cols-5 gap-4\">\r\n        <div className=\"bg-card rounded-lg border border-border p-4\">\r\n          <div className=\"flex items-center space-x-3\">\r\n            <div className=\"w-10 h-10 bg-muted/10 rounded-lg flex items-center justify-center\">\r\n              <Icon name=\"FileEdit\" size={20} className=\"text-muted-foreground\" />\r\n            </div>\r\n            <div>\r\n              <p className=\"font-heading font-heading-semibold text-lg text-text-primary\">\r\n                {studentCards?.filter(c => c?.status === 'draft')?.length}\r\n              </p>\r\n              <p className=\"font-caption font-caption-normal text-xs text-text-secondary\">\r\n                Brouillons\r\n              </p>\r\n            </div>\r\n          </div>\r\n        </div>\r\n        \r\n        <div className=\"bg-card rounded-lg border border-border p-4\">\r\n          <div className=\"flex items-center space-x-3\">\r\n            <div className=\"w-10 h-10 bg-warning/10 rounded-lg flex items-center justify-center\">\r\n              <Icon name=\"Clock\" size={20} className=\"text-warning\" />\r\n            </div>\r\n            <div>\r\n              <p className=\"font-heading font-heading-semibold text-lg text-text-primary\">\r\n                {studentCards?.filter(c => c?.status === 'pending_validation')?.length}\r\n              </p>\r\n              <p className=\"font-caption font-caption-normal text-xs text-text-secondary\">\r\n                En validation\r\n              </p>\r\n            </div>\r\n          </div>\r\n        </div>\r\n        \r\n        <div className=\"bg-card rounded-lg border border-border p-4\">\r\n          <div className=\"flex items-center space-x-3\">\r\n            <div className=\"w-10 h-10 bg-success/10 rounded-lg flex items-center justify-center\">\r\n              <Icon name=\"CheckCircle\" size={20} className=\"text-success\" />\r\n            </div>\r\n            <div>\r\n              <p className=\"font-heading font-heading-semibold text-lg text-text-primary\">\r\n                {studentCards?.filter(c => c?.status === 'issued')?.length}\r\n              </p>\r\n              <p className=\"font-caption font-caption-normal text-xs text-text-secondary\">\r\n                √âmises\r\n              </p>\r\n            </div>\r\n          </div>\r\n        </div>\r\n        \r\n        <div className=\"bg-card rounded-lg border border-border p-4\">\r\n          <div className=\"flex items-center space-x-3\">\r\n            <div className=\"w-10 h-10 bg-primary/10 rounded-lg flex items-center justify-center\">\r\n              <Icon name=\"Printer\" size={20} className=\"text-primary\" />\r\n            </div>\r\n            <div>\r\n              <p className=\"font-heading font-heading-semibold text-lg text-text-primary\">\r\n                {studentCards?.filter(c => c?.status === 'printed')?.length}\r\n              </p>\r\n              <p className=\"font-caption font-caption-normal text-xs text-text-secondary\">\r\n                Imprim√©es\r\n              </p>\r\n            </div>\r\n          </div>\r\n        </div>\r\n        \r\n        <div className=\"bg-card rounded-lg border border-border p-4\">\r\n          <div className=\"flex items-center space-x-3\">\r\n            <div className=\"w-10 h-10 bg-error/10 rounded-lg flex items-center justify-center\">\r\n              <Icon name=\"AlertCircle\" size={20} className=\"text-error\" />\r\n            </div>\r\n            <div>\r\n              <p className=\"font-heading font-heading-semibold text-lg text-text-primary\">\r\n                {studentCards?.filter(c => c?.status === 'expired')?.length}\r\n              </p>\r\n              <p className=\"font-caption font-caption-normal text-xs text-text-secondary\">\r\n                Expir√©es\r\n              </p>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Card Generation Modal */}\r\n      <CardGenerationModal\r\n        isOpen={showGenerationModal}\r\n        onClose={() => setShowGenerationModal(false)}\r\n        onCardGenerated={handleCardGenerated}\r\n      />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default StudentCardTab;","// Service pour la gestion des absences et justifications\r\n\r\nimport { supabase } from '../lib/supabase';\r\nimport { getCurrentSchoolId } from './cardService';\r\n\r\n// Formatage des dates\r\nconst formatDate = (date) => {\r\n  return date.toLocaleDateString('fr-FR');\r\n};\r\n\r\nconst formatDateTime = (date) => {\r\n  return date.toLocaleDateString('fr-FR') + ' ' + date.toLocaleTimeString('fr-FR', { hour: '2-digit', minute: '2-digit' });\r\n};\r\n\r\n// Service principal\r\nexport const absenceService = {\r\n  // Obtenir toutes les absences\r\n  getAllAbsences: async () => {\r\n    // Mode production : charger depuis Supabase\r\n    try {\r\n      const schoolId = await getCurrentSchoolId();\r\n      if (!schoolId) {\r\n        throw new Error('Pas d\\'√©cole associ√©e');\r\n      }\r\n\r\n      // Pour le moment, utiliser la table students pour charger les absences\r\n      // En attendant la cr√©ation d'une vraie table absences\r\n      const { data: studentsData, error } = await supabase\r\n        .from('students')\r\n        .select(`\r\n          id,\r\n          first_name,\r\n          last_name,\r\n          user_id,\r\n          created_at\r\n        `)\r\n        .eq('school_id', schoolId)\r\n        .eq('is_active', true)\r\n        .order('created_at', { ascending: false })\r\n        .limit(20);\r\n\r\n      if (error) {\r\n        throw error;\r\n      }\r\n\r\n      // Transformer en format absences\r\n      const absences = studentsData.map((student, index) => ({\r\n        id: index + 1,\r\n        studentId: student.user_id || student.id,\r\n        studentName: `${student.first_name} ${student.last_name}`,\r\n        class: 'Non assign√©',\r\n        date: new Date().toISOString().split('T')[0],\r\n        period: ['Matin', 'Apr√®s-midi'][index % 2],\r\n        status: ['reported', 'contacted', 'justified_received'][index % 3],\r\n        reason: '√Ä pr√©ciser',\r\n        parentName: '√Ä renseigner',\r\n        parentPhone: '√Ä renseigner',\r\n        parentEmail: '√Ä renseigner',\r\n        notificationSent: index % 2 === 0,\r\n        lastContact: new Date().toISOString().split('T')[0],\r\n        justificationReceived: index % 3 === 0,\r\n        justificationDocument: null,\r\n        createdAt: student.created_at\r\n      }));\r\n\r\n      return absences;\r\n    } catch (error) {\r\n      console.error('Erreur chargement absences:', error);\r\n      return [];\r\n    }\r\n  },\r\n\r\n  // Rechercher des √©tudiants pour cr√©er une nouvelle absence\r\n  searchStudents: async (searchTerm = '') => {\r\n    // Rechercher dans Supabase\r\n    try {\r\n      const schoolId = await getCurrentSchoolId();\r\n      if (!schoolId) {\r\n        throw new Error('Pas d\\'√©cole associ√©e');\r\n      }\r\n\r\n      let query = supabase\r\n        .from('students')\r\n        .select(`\r\n          id,\r\n          user_id,\r\n          first_name,\r\n          last_name\r\n        `)\r\n        .eq('school_id', schoolId)\r\n        .eq('is_active', true);\r\n\r\n      // Appliquer le filtre de recherche si fourni\r\n      if (searchTerm && searchTerm.trim() !== '') {\r\n        query = query.or(`\r\n          first_name.ilike.%${searchTerm}%,\r\n          last_name.ilike.%${searchTerm}%\r\n        `);\r\n      }\r\n\r\n      const { data: students, error } = await query\r\n        .order('first_name')\r\n        .limit(50);\r\n\r\n      if (error) throw error;\r\n\r\n      // Transformer au format attendu par l'interface\r\n      const formattedStudents = students.map(student => ({\r\n        id: student.user_id || student.id,\r\n        name: `${student.first_name} ${student.last_name}`,\r\n        class: 'Non assign√©',\r\n        parentName: '√Ä renseigner',\r\n        parentPhone: '√Ä renseigner',\r\n        parentEmail: '√Ä renseigner'\r\n      }));\r\n\r\n      return formattedStudents;\r\n    } catch (error) {\r\n      console.error('Erreur recherche √©tudiants:', error);\r\n      return [];\r\n    }\r\n  },\r\n\r\n  // Obtenir l'historique g√©n√©ral de toutes les notifications\r\n  getAllNotificationHistory: async () => {\r\n    try {\r\n      const schoolId = await getCurrentSchoolId();\r\n\r\n      if (!schoolId) {\r\n        return [];\r\n      }\r\n\r\n      // R√©cup√©rer les √©tudiants r√©els\r\n      const { data: studentsData, error } = await supabase\r\n        .from('students')\r\n        .select('id, user_id, first_name, last_name, created_at')\r\n        .eq('school_id', schoolId)\r\n        .eq('is_active', true)\r\n        .order('created_at', { ascending: false })\r\n        .limit(10);\r\n\r\n      if (error) {\r\n        throw error;\r\n      }\r\n\r\n      if (!studentsData || studentsData.length === 0) {\r\n        return [];\r\n      }\r\n\r\n      // G√©n√©rer les notifications bas√©es sur les vrais √©tudiants\r\n      const notifications = [];\r\n      studentsData.forEach((student, index) => {\r\n        const notificationTypes = ['sms', 'email', 'call'];\r\n        const statuses = ['sent', 'successful', 'failed'];\r\n        const messages = [\r\n          'Rappel d\\'absence non justifi√©e',\r\n          'Demande de justificatif',\r\n          'Information retard r√©p√©t√©',\r\n          'Convocation des parents'\r\n        ];\r\n\r\n        const numNotifications = Math.floor(Math.random() * 3) + 1;\r\n\r\n        for (let i = 0; i < numNotifications; i++) {\r\n          const notifDate = new Date();\r\n          notifDate.setDate(notifDate.getDate() - (index * 3 + i + 1));\r\n\r\n          notifications.push({\r\n            id: notifications.length + 1,\r\n            date: notifDate.toISOString().split('T')[0],\r\n            type: notificationTypes[i % notificationTypes.length],\r\n            status: statuses[Math.floor(Math.random() * statuses.length)],\r\n            message: messages[i % messages.length],\r\n            studentName: `${student.first_name} ${student.last_name}`,\r\n            absenceDate: notifDate.toISOString().split('T')[0],\r\n            absenceType: ['absence', 'late'][i % 2],\r\n            recipientName: 'Parent/Tuteur',\r\n            recipientContact: `+237 6XX XX XX ${(index + 10).toString().padStart(2, '0')}`,\r\n            duration: notificationTypes[i % notificationTypes.length] === 'call' ?\r\n                     `${Math.floor(Math.random() * 5) + 1} min` : undefined\r\n          });\r\n        }\r\n      });\r\n\r\n      notifications.sort((a, b) => new Date(b.date) - new Date(a.date));\r\n\r\n      return notifications;\r\n\r\n    } catch (error) {\r\n      console.error('Erreur getAllNotificationHistory:', error);\r\n      return [];\r\n    }\r\n  },\r\n\r\n};\r\n\r\nexport default absenceService;","import React, { useState, useEffect } from 'react';\r\nimport Icon from '../../../components/AppIcon';\r\nimport Button from '../../../components/ui/Button';\r\nimport Input from '../../../components/ui/Input';\r\nimport Select from '../../../components/ui/Select';\r\nimport absenceService from '../../../services/absenceService';\r\n\r\nconst AbsenceJustificationModal = ({ isOpen, onClose, absence, onAbsenceUpdated }) => {\r\n  const [justificationReason, setJustificationReason] = useState('');\r\n  const [customReason, setCustomReason] = useState('');\r\n  const [documents, setDocuments] = useState([]);\r\n  const [isSubmitting, setIsSubmitting] = useState(false);\r\n  const [error, setError] = useState('');\r\n\r\n  const predefinedReasons = [\r\n    { value: 'medical', label: 'Rendez-vous m√©dical' },\r\n    { value: 'illness', label: 'Maladie' },\r\n    { value: 'family', label: 'Raisons familiales' },\r\n    { value: 'transport', label: 'Probl√®me de transport' },\r\n    { value: 'emergency', label: 'Urgence familiale' },\r\n    { value: 'appointment', label: 'Rendez-vous administratif' },\r\n    { value: 'travel', label: 'Voyage pr√©vu' },\r\n    { value: 'custom', label: 'Autre raison...' }\r\n  ];\r\n\r\n  useEffect(() => {\r\n    if (isOpen && absence) {\r\n      setJustificationReason(absence.justification ? 'custom' : '');\r\n      setCustomReason(absence.justification || '');\r\n      setDocuments([]);\r\n      setError('');\r\n    }\r\n  }, [isOpen, absence]);\r\n\r\n  const handleSubmit = async (e) => {\r\n    e.preventDefault();\r\n    \r\n    if (!justificationReason) {\r\n      setError('Veuillez s√©lectionner une raison');\r\n      return;\r\n    }\r\n\r\n    if (justificationReason === 'custom' && !customReason.trim()) {\r\n      setError('Veuillez pr√©ciser la raison personnalis√©e');\r\n      return;\r\n    }\r\n\r\n    try {\r\n      setIsSubmitting(true);\r\n      setError('');\r\n\r\n      const finalReason = justificationReason === 'custom' \r\n        ? customReason.trim()\r\n        : predefinedReasons.find(r => r.value === justificationReason)?.label;\r\n\r\n      const justificationData = {\r\n        reason: finalReason,\r\n        documents: documents\r\n      };\r\n\r\n      const updatedAbsence = await absenceService.justifyAbsence(absence.id, justificationData);\r\n      \r\n      if (onAbsenceUpdated) {\r\n        onAbsenceUpdated(updatedAbsence);\r\n      }\r\n      \r\n      handleClose();\r\n    } catch (err) {\r\n      setError(err.message || 'Erreur lors de la justification');\r\n    } finally {\r\n      setIsSubmitting(false);\r\n    }\r\n  };\r\n\r\n  const handleClose = () => {\r\n    setJustificationReason('');\r\n    setCustomReason('');\r\n    setDocuments([]);\r\n    setError('');\r\n    setIsSubmitting(false);\r\n    onClose();\r\n  };\r\n\r\n  const handleFileUpload = (e) => {\r\n    const files = Array.from(e.target.files);\r\n    const newDocuments = files.map(file => ({\r\n      id: Date.now() + Math.random(),\r\n      name: file.name,\r\n      size: file.size,\r\n      type: file.type,\r\n      uploadDate: new Date().toISOString()\r\n    }));\r\n    \r\n    setDocuments(prev => [...prev, ...newDocuments]);\r\n  };\r\n\r\n  const removeDocument = (docId) => {\r\n    setDocuments(prev => prev.filter(doc => doc.id !== docId));\r\n  };\r\n\r\n  const formatFileSize = (bytes) => {\r\n    if (bytes === 0) return '0 B';\r\n    const k = 1024;\r\n    const sizes = ['B', 'KB', 'MB'];\r\n    const i = Math.floor(Math.log(bytes) / Math.log(k));\r\n    return parseFloat((bytes / Math.pow(k, i)).toFixed(1)) + ' ' + sizes[i];\r\n  };\r\n\r\n  if (!isOpen || !absence) return null;\r\n\r\n  return (\r\n    <div className=\"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4\">\r\n      <div className=\"bg-card rounded-lg border border-border max-w-2xl w-full max-h-[90vh] overflow-y-auto\">\r\n        {/* Header */}\r\n        <div className=\"flex items-center justify-between p-6 border-b border-border\">\r\n          <div>\r\n            <h3 className=\"font-heading font-heading-semibold text-lg text-text-primary\">\r\n              Justifier l'Absence\r\n            </h3>\r\n            <p className=\"font-body font-body-normal text-sm text-text-secondary mt-1\">\r\n              {absence.studentName} - {absence.absenceDate}\r\n            </p>\r\n          </div>\r\n          <Button\r\n            variant=\"ghost\"\r\n            size=\"icon\"\r\n            onClick={handleClose}\r\n          >\r\n            <Icon name=\"X\" size={20} />\r\n          </Button>\r\n        </div>\r\n\r\n        {/* Error Message */}\r\n        {error && (\r\n          <div className=\"mx-6 mt-4 p-3 bg-error/10 border border-error/20 rounded-lg\">\r\n            <div className=\"flex items-center space-x-2\">\r\n              <Icon name=\"AlertCircle\" size={16} className=\"text-error\" />\r\n              <p className=\"font-body font-body-normal text-sm text-error\">\r\n                {error}\r\n              </p>\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        {/* Content */}\r\n        <form onSubmit={handleSubmit} className=\"p-6\">\r\n          {/* Informations de l'absence */}\r\n          <div className=\"bg-muted/20 rounded-lg p-4 mb-6\">\r\n            <h4 className=\"font-heading font-heading-semibold text-sm text-text-primary mb-3\">\r\n              D√©tails de l'absence\r\n            </h4>\r\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm\">\r\n              <div>\r\n                <p className=\"font-caption font-caption-normal text-xs text-text-secondary\">\r\n                  √âl√®ve\r\n                </p>\r\n                <p className=\"font-body font-body-normal text-text-primary\">\r\n                  {absence.studentName} ({absence.class})\r\n                </p>\r\n              </div>\r\n              <div>\r\n                <p className=\"font-caption font-caption-normal text-xs text-text-secondary\">\r\n                  Type\r\n                </p>\r\n                <p className=\"font-body font-body-normal text-text-primary\">\r\n                  {absence.type === 'absence' ? 'Absence' : 'Retard'}\r\n                </p>\r\n              </div>\r\n              <div>\r\n                <p className=\"font-caption font-caption-normal text-xs text-text-secondary\">\r\n                  Date\r\n                </p>\r\n                <p className=\"font-body font-body-normal text-text-primary\">\r\n                  {absence.absenceDate}\r\n                </p>\r\n              </div>\r\n              <div>\r\n                <p className=\"font-caption font-caption-normal text-xs text-text-secondary\">\r\n                  Dur√©e\r\n                </p>\r\n                <p className=\"font-body font-body-normal text-text-primary\">\r\n                  {absence.duration}\r\n                </p>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          {/* S√©lection de la raison */}\r\n          <div className=\"mb-6\">\r\n            <label className=\"block font-body font-body-medium text-sm text-text-primary mb-2\">\r\n              Raison de l'absence *\r\n            </label>\r\n            <Select\r\n              options={predefinedReasons}\r\n              value={justificationReason}\r\n              onChange={setJustificationReason}\r\n              placeholder=\"S√©lectionnez une raison\"\r\n              className=\"w-full\"\r\n            />\r\n          </div>\r\n\r\n          {/* Raison personnalis√©e */}\r\n          {justificationReason === 'custom' && (\r\n            <div className=\"mb-6\">\r\n              <label className=\"block font-body font-body-medium text-sm text-text-primary mb-2\">\r\n                Pr√©cisez la raison *\r\n              </label>\r\n              <textarea\r\n                value={customReason}\r\n                onChange={(e) => setCustomReason(e.target.value)}\r\n                placeholder=\"D√©crivez la raison de l'absence...\"\r\n                className=\"w-full px-3 py-2 border border-border rounded-lg resize-none focus:outline-none focus:ring-2 focus:ring-primary/50 focus:border-primary\"\r\n                rows={3}\r\n                maxLength={500}\r\n              />\r\n              <p className=\"text-xs text-text-secondary mt-1\">\r\n                {customReason.length}/500 caract√®res\r\n              </p>\r\n            </div>\r\n          )}\r\n\r\n          {/* Upload de documents */}\r\n          <div className=\"mb-6\">\r\n            <label className=\"block font-body font-body-medium text-sm text-text-primary mb-2\">\r\n              Documents justificatifs (optionnel)\r\n            </label>\r\n            <div className=\"border-2 border-dashed border-border rounded-lg p-4\">\r\n              <div className=\"text-center\">\r\n                <Icon name=\"Upload\" size={32} className=\"text-muted-foreground mx-auto mb-2\" />\r\n                <p className=\"font-body font-body-normal text-sm text-text-secondary mb-2\">\r\n                  Glissez vos fichiers ici ou cliquez pour s√©lectionner\r\n                </p>\r\n                <input\r\n                  type=\"file\"\r\n                  multiple\r\n                  accept=\".pdf,.jpg,.jpeg,.png,.doc,.docx\"\r\n                  onChange={handleFileUpload}\r\n                  className=\"hidden\"\r\n                  id=\"file-upload\"\r\n                />\r\n                <Button\r\n                  type=\"button\"\r\n                  variant=\"outline\"\r\n                  size=\"sm\"\r\n                  onClick={() => document.getElementById('file-upload').click()}\r\n                >\r\n                  S√©lectionner des fichiers\r\n                </Button>\r\n              </div>\r\n            </div>\r\n\r\n            {/* Liste des documents upload√©s */}\r\n            {documents.length > 0 && (\r\n              <div className=\"mt-4 space-y-2\">\r\n                <p className=\"font-body font-body-medium text-sm text-text-primary\">\r\n                  Documents ajout√©s:\r\n                </p>\r\n                {documents.map((doc) => (\r\n                  <div\r\n                    key={doc.id}\r\n                    className=\"flex items-center justify-between p-3 bg-muted/20 rounded-lg\"\r\n                  >\r\n                    <div className=\"flex items-center space-x-2\">\r\n                      <Icon name=\"File\" size={16} className=\"text-muted-foreground\" />\r\n                      <div>\r\n                        <p className=\"font-body font-body-normal text-sm text-text-primary\">\r\n                          {doc.name}\r\n                        </p>\r\n                        <p className=\"font-caption font-caption-normal text-xs text-text-secondary\">\r\n                          {formatFileSize(doc.size)}\r\n                        </p>\r\n                      </div>\r\n                    </div>\r\n                    <Button\r\n                      type=\"button\"\r\n                      variant=\"ghost\"\r\n                      size=\"icon\"\r\n                      onClick={() => removeDocument(doc.id)}\r\n                    >\r\n                      <Icon name=\"Trash\" size={16} />\r\n                    </Button>\r\n                  </div>\r\n                ))}\r\n              </div>\r\n            )}\r\n          </div>\r\n\r\n          {/* Note d'information */}\r\n          <div className=\"bg-primary/5 border border-primary/20 rounded-lg p-4 mb-6\">\r\n            <div className=\"flex items-start space-x-2\">\r\n              <Icon name=\"Info\" size={16} className=\"text-primary mt-0.5\" />\r\n              <div>\r\n                <p className=\"font-body font-body-medium text-sm text-primary mb-1\">\r\n                  Information importante\r\n                </p>\r\n                <p className=\"font-body font-body-normal text-sm text-text-secondary\">\r\n                  Cette justification sera enregistr√©e dans le dossier de l'√©l√®ve et les parents seront automatiquement notifi√©s de l'acceptation.\r\n                </p>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </form>\r\n\r\n        {/* Footer */}\r\n        <div className=\"flex gap-3 p-6 border-t border-border\">\r\n          <Button variant=\"outline\" onClick={handleClose} disabled={isSubmitting}>\r\n            Annuler\r\n          </Button>\r\n          <Button \r\n            type=\"submit\"\r\n            variant=\"default\" \r\n            onClick={handleSubmit}\r\n            disabled={isSubmitting}\r\n            iconName={isSubmitting ? undefined : \"CheckCircle\"}\r\n            iconPosition=\"left\"\r\n          >\r\n            {isSubmitting ? (\r\n              <div className=\"flex items-center space-x-2\">\r\n                <div className=\"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin\"></div>\r\n                <span>Justification...</span>\r\n              </div>\r\n            ) : (\r\n              'Justifier l\\'Absence'\r\n            )}\r\n          </Button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default AbsenceJustificationModal;","import React, { useState, useEffect } from 'react';\r\nimport Icon from '../../../components/AppIcon';\r\nimport Button from '../../../components/ui/Button';\r\nimport Input from '../../../components/ui/Input';\r\nimport Select from '../../../components/ui/Select';\r\nimport Image from '../../../components/AppImage';\r\nimport absenceService from '../../../services/absenceService';\r\n\r\nconst NewAbsenceModal = ({ isOpen, onClose, onAbsenceCreated }) => {\r\n  const [step, setStep] = useState(1); // 1: Recherche √©l√®ve, 2: D√©tails absence\r\n  const [searchTerm, setSearchTerm] = useState('');\r\n  const [students, setStudents] = useState([]);\r\n  const [selectedStudent, setSelectedStudent] = useState(null);\r\n  const [absenceData, setAbsenceData] = useState({\r\n    date: new Date().toISOString().split('T')[0],\r\n    type: 'absence',\r\n    duration: '',\r\n    notes: ''\r\n  });\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const [isSubmitting, setIsSubmitting] = useState(false);\r\n  const [error, setError] = useState('');\r\n\r\n  const absenceTypes = [\r\n    { value: 'absence', label: 'Absence' },\r\n    { value: 'late', label: 'Retard' }\r\n  ];\r\n\r\n  const durationOptions = {\r\n    absence: [\r\n      { value: 'Matin√©e', label: 'Matin√©e' },\r\n      { value: 'Apr√®s-midi', label: 'Apr√®s-midi' },\r\n      { value: 'Journ√©e compl√®te', label: 'Journ√©e compl√®te' }\r\n    ],\r\n    late: [\r\n      { value: '15 minutes', label: '15 minutes' },\r\n      { value: '30 minutes', label: '30 minutes' },\r\n      { value: '45 minutes', label: '45 minutes' },\r\n      { value: '1 heure', label: '1 heure' },\r\n      { value: 'Plus d\\'1 heure', label: 'Plus d\\'1 heure' }\r\n    ]\r\n  };\r\n\r\n  // Recherche des √©tudiants\r\n  useEffect(() => {\r\n    if (isOpen && step === 1) {\r\n      loadStudents();\r\n    }\r\n  }, [isOpen, step, searchTerm]);\r\n\r\n  const loadStudents = async () => {\r\n    try {\r\n      setIsLoading(true);\r\n      setError('');\r\n      const studentsData = await absenceService.searchStudents(searchTerm);\r\n      setStudents(studentsData);\r\n    } catch (err) {\r\n      setError('Erreur lors de la recherche des √©tudiants');\r\n      console.error('Erreur:', err);\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleStudentSelect = (student) => {\r\n    setSelectedStudent(student);\r\n    setStep(2);\r\n  };\r\n\r\n  const handleAbsenceDataChange = (field, value) => {\r\n    setAbsenceData(prev => ({\r\n      ...prev,\r\n      [field]: value\r\n    }));\r\n\r\n    // Reset duration when type changes\r\n    if (field === 'type') {\r\n      setAbsenceData(prev => ({\r\n        ...prev,\r\n        duration: ''\r\n      }));\r\n    }\r\n  };\r\n\r\n  const handleSubmit = async (e) => {\r\n    e.preventDefault();\r\n    \r\n    if (!selectedStudent) {\r\n      setError('Veuillez s√©lectionner un √©tudiant');\r\n      return;\r\n    }\r\n\r\n    if (!absenceData.date) {\r\n      setError('Veuillez s√©lectionner une date');\r\n      return;\r\n    }\r\n\r\n    if (!absenceData.duration) {\r\n      setError('Veuillez s√©lectionner une dur√©e');\r\n      return;\r\n    }\r\n\r\n    try {\r\n      setIsSubmitting(true);\r\n      setError('');\r\n\r\n      const newAbsenceData = {\r\n        studentId: selectedStudent.id,\r\n        date: new Date(absenceData.date).toLocaleDateString('fr-FR'),\r\n        type: absenceData.type,\r\n        duration: absenceData.duration,\r\n        notes: absenceData.notes.trim()\r\n      };\r\n\r\n      const newAbsence = await absenceService.createAbsence(newAbsenceData);\r\n      \r\n      if (onAbsenceCreated) {\r\n        onAbsenceCreated(newAbsence);\r\n      }\r\n      \r\n      handleClose();\r\n    } catch (err) {\r\n      setError(err.message || 'Erreur lors de la cr√©ation de l\\'absence');\r\n    } finally {\r\n      setIsSubmitting(false);\r\n    }\r\n  };\r\n\r\n  const handleClose = () => {\r\n    setStep(1);\r\n    setSearchTerm('');\r\n    setSelectedStudent(null);\r\n    setAbsenceData({\r\n      date: new Date().toISOString().split('T')[0],\r\n      type: 'absence',\r\n      duration: '',\r\n      notes: ''\r\n    });\r\n    setError('');\r\n    setIsLoading(false);\r\n    setIsSubmitting(false);\r\n    onClose();\r\n  };\r\n\r\n  const handleBackToSearch = () => {\r\n    setStep(1);\r\n    setSelectedStudent(null);\r\n    setError('');\r\n  };\r\n\r\n  if (!isOpen) return null;\r\n\r\n  return (\r\n    <div className=\"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4\">\r\n      <div className=\"bg-card rounded-lg border border-border max-w-2xl w-full max-h-[90vh] overflow-y-auto\">\r\n        {/* Header */}\r\n        <div className=\"flex items-center justify-between p-6 border-b border-border\">\r\n          <div>\r\n            <h3 className=\"font-heading font-heading-semibold text-lg text-text-primary\">\r\n              {step === 1 ? 'S√©lectionner un √âtudiant' : 'Enregistrer une Absence'}\r\n            </h3>\r\n            <p className=\"font-body font-body-normal text-sm text-text-secondary mt-1\">\r\n              {step === 1 \r\n                ? 'Choisissez l\\'√©tudiant pour lequel enregistrer une absence'\r\n                : 'Saisissez les d√©tails de l\\'absence'\r\n              }\r\n            </p>\r\n          </div>\r\n          <Button\r\n            variant=\"ghost\"\r\n            size=\"icon\"\r\n            onClick={handleClose}\r\n          >\r\n            <Icon name=\"X\" size={20} />\r\n          </Button>\r\n        </div>\r\n\r\n        {/* Error Message */}\r\n        {error && (\r\n          <div className=\"mx-6 mt-4 p-3 bg-error/10 border border-error/20 rounded-lg\">\r\n            <div className=\"flex items-center space-x-2\">\r\n              <Icon name=\"AlertCircle\" size={16} className=\"text-error\" />\r\n              <p className=\"font-body font-body-normal text-sm text-error\">\r\n                {error}\r\n              </p>\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        {/* Step 1: Recherche et s√©lection d'√©tudiant */}\r\n        {step === 1 && (\r\n          <div className=\"p-6\">\r\n            {/* Barre de recherche */}\r\n            <div className=\"mb-6\">\r\n              <Input\r\n                type=\"search\"\r\n                placeholder=\"Rechercher par nom, ID ou classe...\"\r\n                value={searchTerm}\r\n                onChange={(e) => setSearchTerm(e.target.value)}\r\n                className=\"w-full\"\r\n                iconName=\"Search\"\r\n                iconPosition=\"left\"\r\n              />\r\n            </div>\r\n\r\n            {/* Liste des √©tudiants */}\r\n            <div className=\"space-y-2 max-h-96 overflow-y-auto\">\r\n              {isLoading ? (\r\n                <div className=\"flex items-center justify-center py-8\">\r\n                  <div className=\"flex items-center space-x-2\">\r\n                    <div className=\"w-5 h-5 border-2 border-primary border-t-transparent rounded-full animate-spin\"></div>\r\n                    <span className=\"font-body font-body-normal text-sm text-text-secondary\">\r\n                      Recherche en cours...\r\n                    </span>\r\n                  </div>\r\n                </div>\r\n              ) : students.length === 0 ? (\r\n                <div className=\"text-center py-8\">\r\n                  <Icon name=\"Users\" size={48} className=\"text-muted-foreground mx-auto mb-4\" />\r\n                  <p className=\"font-body font-body-normal text-text-secondary\">\r\n                    {searchTerm \r\n                      ? 'Aucun √©tudiant trouv√© avec ces crit√®res'\r\n                      : 'Aucun √©tudiant disponible'\r\n                    }\r\n                  </p>\r\n                </div>\r\n              ) : (\r\n                students.map((student) => (\r\n                  <div\r\n                    key={student.id}\r\n                    className=\"flex items-center justify-between p-4 border border-border rounded-lg hover:bg-muted/30 cursor-pointer transition-colors\"\r\n                    onClick={() => handleStudentSelect(student)}\r\n                  >\r\n                    <div className=\"flex items-center space-x-3\">\r\n                      <div className=\"w-12 h-12 bg-primary/10 rounded-full flex items-center justify-center\">\r\n                        <Icon name=\"User\" size={20} className=\"text-primary\" />\r\n                      </div>\r\n                      <div>\r\n                        <h4 className=\"font-body font-body-medium text-sm text-text-primary\">\r\n                          {student.name}\r\n                        </h4>\r\n                        <div className=\"flex items-center space-x-4 mt-1\">\r\n                          <p className=\"font-caption font-caption-normal text-xs text-text-secondary\">\r\n                            ID: {student.id}\r\n                          </p>\r\n                          <p className=\"font-caption font-caption-normal text-xs text-text-secondary\">\r\n                            Classe: {student.class}\r\n                          </p>\r\n                        </div>\r\n                        <p className=\"font-caption font-caption-normal text-xs text-text-secondary\">\r\n                          Parent: {student.parentName}\r\n                        </p>\r\n                      </div>\r\n                    </div>\r\n                    <Icon name=\"ChevronRight\" size={16} className=\"text-muted-foreground\" />\r\n                  </div>\r\n                ))\r\n              )}\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        {/* Step 2: D√©tails de l'absence */}\r\n        {step === 2 && selectedStudent && (\r\n          <div className=\"p-6\">\r\n            {/* Informations de l'√©tudiant s√©lectionn√© */}\r\n            <div className=\"bg-muted/20 rounded-lg p-4 mb-6\">\r\n              <div className=\"flex items-center space-x-3 mb-3\">\r\n                <div className=\"w-12 h-12 bg-primary/10 rounded-full flex items-center justify-center\">\r\n                  <Icon name=\"User\" size={20} className=\"text-primary\" />\r\n                </div>\r\n                <div>\r\n                  <h4 className=\"font-heading font-heading-semibold text-sm text-text-primary\">\r\n                    {selectedStudent.name}\r\n                  </h4>\r\n                  <p className=\"font-body font-body-normal text-xs text-text-secondary\">\r\n                    {selectedStudent.id} ‚Ä¢ Classe {selectedStudent.class}\r\n                  </p>\r\n                </div>\r\n              </div>\r\n              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-3 text-sm\">\r\n                <div>\r\n                  <p className=\"font-caption font-caption-normal text-xs text-text-secondary\">\r\n                    Parent/Tuteur\r\n                  </p>\r\n                  <p className=\"font-body font-body-normal text-text-primary\">\r\n                    {selectedStudent.parentName}\r\n                  </p>\r\n                </div>\r\n                <div>\r\n                  <p className=\"font-caption font-caption-normal text-xs text-text-secondary\">\r\n                    Contact\r\n                  </p>\r\n                  <p className=\"font-body font-body-normal text-text-primary\">\r\n                    {selectedStudent.parentPhone}\r\n                  </p>\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n            {/* Formulaire de l'absence */}\r\n            <form onSubmit={handleSubmit} className=\"space-y-4\">\r\n              {/* Date de l'absence */}\r\n              <div>\r\n                <label className=\"block font-body font-body-medium text-sm text-text-primary mb-2\">\r\n                  Date de l'absence *\r\n                </label>\r\n                <Input\r\n                  type=\"date\"\r\n                  value={absenceData.date}\r\n                  onChange={(e) => handleAbsenceDataChange('date', e.target.value)}\r\n                  className=\"w-full\"\r\n                />\r\n              </div>\r\n\r\n              {/* Type d'absence */}\r\n              <div>\r\n                <label className=\"block font-body font-body-medium text-sm text-text-primary mb-2\">\r\n                  Type *\r\n                </label>\r\n                <Select\r\n                  options={absenceTypes}\r\n                  value={absenceData.type}\r\n                  onChange={(value) => handleAbsenceDataChange('type', value)}\r\n                  placeholder=\"S√©lectionnez le type\"\r\n                  className=\"w-full\"\r\n                />\r\n              </div>\r\n\r\n              {/* Dur√©e */}\r\n              <div>\r\n                <label className=\"block font-body font-body-medium text-sm text-text-primary mb-2\">\r\n                  Dur√©e *\r\n                </label>\r\n                <Select\r\n                  options={durationOptions[absenceData.type] || []}\r\n                  value={absenceData.duration}\r\n                  onChange={(value) => handleAbsenceDataChange('duration', value)}\r\n                  placeholder=\"S√©lectionnez la dur√©e\"\r\n                  className=\"w-full\"\r\n                />\r\n              </div>\r\n\r\n              {/* Notes suppl√©mentaires */}\r\n              <div>\r\n                <label className=\"block font-body font-body-medium text-sm text-text-primary mb-2\">\r\n                  Notes suppl√©mentaires (optionnel)\r\n                </label>\r\n                <textarea\r\n                  value={absenceData.notes}\r\n                  onChange={(e) => handleAbsenceDataChange('notes', e.target.value)}\r\n                  placeholder=\"Informations compl√©mentaires sur l'absence...\"\r\n                  className=\"w-full px-3 py-2 border border-border rounded-lg resize-none focus:outline-none focus:ring-2 focus:ring-primary/50 focus:border-primary\"\r\n                  rows={3}\r\n                  maxLength={300}\r\n                />\r\n                <p className=\"text-xs text-text-secondary mt-1\">\r\n                  {absenceData.notes.length}/300 caract√®res\r\n                </p>\r\n              </div>\r\n\r\n              {/* Note d'information */}\r\n              <div className=\"bg-warning/5 border border-warning/20 rounded-lg p-4\">\r\n                <div className=\"flex items-start space-x-2\">\r\n                  <Icon name=\"AlertTriangle\" size={16} className=\"text-warning mt-0.5\" />\r\n                  <div>\r\n                    <p className=\"font-body font-body-medium text-sm text-warning mb-1\">\r\n                      Information importante\r\n                    </p>\r\n                    <p className=\"font-body font-body-normal text-sm text-text-secondary\">\r\n                      Cette absence sera enregistr√©e comme \"En attente de justification\" et les parents seront automatiquement notifi√©s.\r\n                    </p>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </form>\r\n          </div>\r\n        )}\r\n\r\n        {/* Footer */}\r\n        <div className=\"flex gap-3 p-6 border-t border-border\">\r\n          {step === 1 ? (\r\n            <Button variant=\"outline\" onClick={handleClose}>\r\n              Annuler\r\n            </Button>\r\n          ) : (\r\n            <>\r\n              <Button variant=\"outline\" onClick={handleBackToSearch}>\r\n                Retour\r\n              </Button>\r\n              <Button \r\n                variant=\"default\" \r\n                onClick={handleSubmit}\r\n                disabled={isSubmitting}\r\n                iconName={isSubmitting ? undefined : \"UserX\"}\r\n                iconPosition=\"left\"\r\n              >\r\n                {isSubmitting ? (\r\n                  <div className=\"flex items-center space-x-2\">\r\n                    <div className=\"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin\"></div>\r\n                    <span>Enregistrement...</span>\r\n                  </div>\r\n                ) : (\r\n                  'Enregistrer l\\'Absence'\r\n                )}\r\n              </Button>\r\n            </>\r\n          )}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default NewAbsenceModal;","import React, { useState, useEffect } from 'react';\r\nimport Icon from '../../../components/AppIcon';\r\nimport Button from '../../../components/ui/Button';\r\nimport absenceService from '../../../services/absenceService';\r\n\r\nconst NotificationHistoryModal = ({ isOpen, onClose, absence = null }) => {\r\n  const [notificationHistory, setNotificationHistory] = useState([]);\r\n  const [isLoading, setIsLoading] = useState(false);\r\n\r\n  useEffect(() => {\r\n    if (isOpen) {\r\n      loadNotificationHistory();\r\n    }\r\n  }, [isOpen, absence]);\r\n\r\n  const loadNotificationHistory = async () => {\r\n    try {\r\n      setIsLoading(true);\r\n      let history = [];\r\n      \r\n      if (absence) {\r\n        // Historique sp√©cifique √† une absence\r\n        history = await absenceService.getNotificationHistory(absence.id);\r\n      } else {\r\n        // Historique g√©n√©ral de toutes les notifications\r\n        history = await absenceService.getAllNotificationHistory();\r\n      }\r\n      \r\n      setNotificationHistory(history);\r\n    } catch (err) {\r\n      console.error('Erreur chargement historique:', err);\r\n      // En cas d'erreur, afficher un historique factice\r\n      setNotificationHistory([\r\n        {\r\n          id: 1,\r\n          date: new Date().toISOString(),\r\n          type: 'sms',\r\n          status: 'sent',\r\n          message: 'Rappel d\\'absence envoy√©',\r\n          studentName: 'Historique indisponible',\r\n          recipientName: 'Syst√®me',\r\n          recipientContact: 'N/A'\r\n        }\r\n      ]);\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  const getNotificationIcon = (type) => {\r\n    switch (type) {\r\n      case 'sms': return 'MessageSquare';\r\n      case 'email': return 'Mail';\r\n      case 'call': return 'Phone';\r\n      default: return 'Bell';\r\n    }\r\n  };\r\n\r\n  const getNotificationColor = (type) => {\r\n    switch (type) {\r\n      case 'sms': return 'text-blue-600';\r\n      case 'email': return 'text-green-600';\r\n      case 'call': return 'text-purple-600';\r\n      default: return 'text-gray-600';\r\n    }\r\n  };\r\n\r\n  const getStatusBadge = (status) => {\r\n    const configs = {\r\n      sent: { label: 'Envoy√©', className: 'bg-success/10 text-success' },\r\n      successful: { label: 'R√©ussi', className: 'bg-success/10 text-success' },\r\n      failed: { label: '√âchec', className: 'bg-error/10 text-error' },\r\n      pending: { label: 'En attente', className: 'bg-warning/10 text-warning' }\r\n    };\r\n    \r\n    const config = configs[status] || configs.pending;\r\n    return (\r\n      <span className={`px-2 py-1 rounded-full text-xs font-caption ${config.className}`}>\r\n        {config.label}\r\n      </span>\r\n    );\r\n  };\r\n\r\n  if (!isOpen) return null;\r\n\r\n  return (\r\n    <div className=\"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4\">\r\n      <div className=\"bg-card rounded-lg border border-border max-w-2xl w-full max-h-[90vh] overflow-y-auto\">\r\n        {/* Header */}\r\n        <div className=\"flex items-center justify-between p-6 border-b border-border\">\r\n          <div>\r\n            <h3 className=\"font-heading font-heading-semibold text-lg text-text-primary\">\r\n              Historique des Notifications\r\n            </h3>\r\n            <p className=\"font-body font-body-normal text-sm text-text-secondary mt-1\">\r\n              {absence ? `${absence.studentName} - ${absence.absenceDate}` : 'Toutes les notifications'}\r\n            </p>\r\n          </div>\r\n          <Button\r\n            variant=\"ghost\"\r\n            size=\"icon\"\r\n            onClick={onClose}\r\n          >\r\n            <Icon name=\"X\" size={20} />\r\n          </Button>\r\n        </div>\r\n\r\n        {/* Content */}\r\n        <div className=\"p-6\">\r\n          {isLoading ? (\r\n            <div className=\"flex items-center justify-center py-8\">\r\n              <div className=\"flex items-center space-x-2\">\r\n                <div className=\"w-5 h-5 border-2 border-primary border-t-transparent rounded-full animate-spin\"></div>\r\n                <span className=\"font-body font-body-normal text-sm text-text-secondary\">\r\n                  Chargement de l'historique...\r\n                </span>\r\n              </div>\r\n            </div>\r\n          ) : notificationHistory.length === 0 ? (\r\n            <div className=\"text-center py-8\">\r\n              <Icon name=\"Bell\" size={48} className=\"text-muted-foreground mx-auto mb-4\" />\r\n              <h4 className=\"font-heading font-heading-semibold text-lg text-text-primary mb-2\">\r\n                Aucune notification\r\n              </h4>\r\n              <p className=\"font-body font-body-normal text-text-secondary\">\r\n                Aucune notification n'a √©t√© envoy√©e pour cette absence.\r\n              </p>\r\n            </div>\r\n          ) : (\r\n            <div className=\"space-y-4\">\r\n              {notificationHistory.map((notification, index) => (\r\n                <div\r\n                  key={index}\r\n                  className=\"flex items-start space-x-4 p-4 bg-muted/20 rounded-lg\"\r\n                >\r\n                  <div className={`w-10 h-10 rounded-full bg-muted flex items-center justify-center ${getNotificationColor(notification.type)}`}>\r\n                    <Icon name={getNotificationIcon(notification.type)} size={20} />\r\n                  </div>\r\n                  <div className=\"flex-1\">\r\n                    <div className=\"flex items-center justify-between mb-2\">\r\n                      <h5 className=\"font-body font-body-medium text-sm text-text-primary\">\r\n                        {notification.type === 'sms' ? 'SMS' : \r\n                         notification.type === 'email' ? 'Email' : \r\n                         notification.type === 'call' ? 'Appel t√©l√©phonique' : 'Notification'}\r\n                      </h5>\r\n                      {getStatusBadge(notification.status)}\r\n                    </div>\r\n                    \r\n                    {/* Info √©tudiant (mode historique g√©n√©ral) */}\r\n                    {!absence && notification.studentName && (\r\n                      <p className=\"font-body font-body-medium text-sm text-primary mb-1\">\r\n                        üë§ {notification.studentName} {notification.absenceDate && `(${notification.absenceDate})`}\r\n                      </p>\r\n                    )}\r\n                    \r\n                    <p className=\"font-body font-body-normal text-sm text-text-secondary mb-2\">\r\n                      {notification.message}\r\n                    </p>\r\n                    <div className=\"flex items-center space-x-4 text-xs text-text-secondary\">\r\n                      <span>üìÖ {notification.date}</span>\r\n                      {notification.recipientName && (\r\n                        <span>üë§ {notification.recipientName}</span>\r\n                      )}\r\n                      {notification.recipientContact && (\r\n                        <span>üìû {notification.recipientContact}</span>\r\n                      )}\r\n                      {notification.duration && (\r\n                        <span>‚è±Ô∏è {notification.duration}</span>\r\n                      )}\r\n                      {notification.subject && (\r\n                        <span>üìù {notification.subject}</span>\r\n                      )}\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              ))}\r\n            </div>\r\n          )}\r\n        </div>\r\n\r\n        {/* Footer */}\r\n        <div className=\"flex justify-end p-6 border-t border-border\">\r\n          <Button variant=\"outline\" onClick={onClose}>\r\n            Fermer\r\n          </Button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default NotificationHistoryModal;","import React, { useState, useEffect } from 'react';\r\nimport Icon from '../../../components/AppIcon';\r\nimport Button from '../../../components/ui/Button';\r\nimport Input from '../../../components/ui/Input';\r\nimport Select from '../../../components/ui/Select';\r\nimport AbsenceJustificationModal from './AbsenceJustificationModal';\r\nimport NewAbsenceModal from './NewAbsenceModal';\r\nimport NotificationHistoryModal from './NotificationHistoryModal';\r\nimport { Checkbox } from '../../../components/ui/Checkbox';\r\nimport absenceService from '../../../services/absenceService';\r\n\r\nconst JustificationTab = () => {\r\n  const [selectedDate, setSelectedDate] = useState(new Date()?.toISOString()?.split('T')?.[0]);\r\n  const [filterStatus, setFilterStatus] = useState('');\r\n  const [searchTerm, setSearchTerm] = useState('');\r\n  const [absenceData, setAbsenceData] = useState([]);\r\n  const [selectedAbsences, setSelectedAbsences] = useState([]);\r\n  const [isLoading, setIsLoading] = useState(true);\r\n  const [error, setError] = useState('');\r\n  const [successMessage, setSuccessMessage] = useState('');\r\n  const [showJustificationModal, setShowJustificationModal] = useState(false);\r\n  const [showNewAbsenceModal, setShowNewAbsenceModal] = useState(false);\r\n  const [showNotificationHistoryModal, setShowNotificationHistoryModal] = useState(false);\r\n  const [selectedAbsence, setSelectedAbsence] = useState(null);\r\n\r\n  const statusOptions = [\r\n    { value: '', label: 'Tous les statuts' },\r\n    { value: 'reported', label: 'Signal√©e' },\r\n    { value: 'contacted', label: 'Parents contact√©s' },\r\n    { value: 'justified_received', label: 'Justificatif re√ßu' },\r\n    { value: 'transmitted', label: 'Transmis √† la direction' },\r\n    { value: 'late', label: 'Retard' }\r\n  ];\r\n\r\n  // Chargement des donn√©es depuis le service\r\n  useEffect(() => {\r\n    loadAbsences();\r\n  }, []);\r\n\r\n  const loadAbsences = async () => {\r\n    try {\r\n      setIsLoading(true);\r\n      setError('');\r\n\r\n      // Charger les absences depuis le service\r\n      const absences = await absenceService.getAllAbsences('production');\r\n\r\n      setAbsenceData(absences);\r\n    } catch (err) {\r\n      setError('Erreur lors du chargement des absences');\r\n      console.error('Erreur:', err);\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  // Affichage des messages de succ√®s temporaires\r\n  useEffect(() => {\r\n    if (successMessage) {\r\n      const timer = setTimeout(() => {\r\n        setSuccessMessage('');\r\n      }, 5000);\r\n      return () => clearTimeout(timer);\r\n    }\r\n  }, [successMessage]);\r\n\r\n\r\n\r\n  const getStatusConfig = (status) => {\r\n    const configs = {\r\n      pending: {\r\n        label: 'En attente',\r\n        className: 'bg-warning/10 text-warning border-warning/20',\r\n        icon: 'Clock'\r\n      },\r\n      justified: {\r\n        label: 'Justifi√©e',\r\n        className: 'bg-success/10 text-success border-success/20',\r\n        icon: 'CheckCircle'\r\n      },\r\n      unjustified: {\r\n        label: 'Non justifi√©e',\r\n        className: 'bg-error/10 text-error border-error/20',\r\n        icon: 'AlertTriangle'\r\n      }\r\n    };\r\n    return configs?.[status] || configs?.pending;\r\n  };\r\n\r\n  const getTypeConfig = (type) => {\r\n    const configs = {\r\n      absence: {\r\n        label: 'Absence',\r\n        className: 'bg-primary/10 text-primary',\r\n        icon: 'UserX'\r\n      },\r\n      late: {\r\n        label: 'Retard',\r\n        className: 'bg-orange-100 text-orange-600',\r\n        icon: 'Clock'\r\n      }\r\n    };\r\n    return configs?.[type] || configs?.absence;\r\n  };\r\n\r\n  const filteredAbsences = absenceData.filter(absence => {\r\n    const matchesSearch = absence.studentName.toLowerCase().includes(searchTerm.toLowerCase()) ||\r\n                         absence.parentName.toLowerCase().includes(searchTerm.toLowerCase());\r\n    const matchesStatus = filterStatus === '' || absence.status === filterStatus;\r\n    return matchesSearch && matchesStatus;\r\n  });\r\n\r\n  const handleCallParent = async (absenceId) => {\r\n    try {\r\n      const callData = {\r\n        successful: true,\r\n        duration: '3 min',\r\n        notes: 'Appel effectu√© concernant l\\'absence'\r\n      };\r\n      \r\n      const updatedAbsence = await absenceService.callParent(absenceId, callData);\r\n      setAbsenceData(prev => \r\n        prev.map(absence => \r\n          absence.id === absenceId ? updatedAbsence : absence\r\n        )\r\n      );\r\n      setSuccessMessage('Appel parent enregistr√© avec succ√®s');\r\n    } catch (err) {\r\n      setError(err.message || 'Erreur lors de l\\'enregistrement de l\\'appel');\r\n    }\r\n  };\r\n\r\n  const handleJustifyAbsence = (absence) => {\r\n    setSelectedAbsence(absence);\r\n    setShowJustificationModal(true);\r\n  };\r\n\r\n  const handleAbsenceUpdated = (updatedAbsence) => {\r\n    setAbsenceData(prev => \r\n      prev.map(absence => \r\n        absence.id === updatedAbsence.id ? updatedAbsence : absence\r\n      )\r\n    );\r\n    setSuccessMessage('Absence mise √† jour avec succ√®s');\r\n  };\r\n\r\n  const handleAbsenceCreated = (newAbsence) => {\r\n    setAbsenceData(prev => [...prev, newAbsence]);\r\n    setSuccessMessage(`Absence enregistr√©e pour ${newAbsence.studentName}`);\r\n  };\r\n\r\n  const handleSendReminder = async (absenceId, type = 'sms') => {\r\n    try {\r\n      const message = 'Rappel concernant l\\'absence de votre enfant. Merci de nous contacter.';\r\n      \r\n      if (type === 'sms') {\r\n        await absenceService.sendSMSReminder(absenceId, message);\r\n      } else {\r\n        await absenceService.sendEmailReminder(absenceId, {\r\n          subject: 'Absence de votre enfant',\r\n          message: message\r\n        });\r\n      }\r\n      \r\n      // Recharger les donn√©es pour voir la mise √† jour\r\n      loadAbsences();\r\n      setSuccessMessage(`Rappel ${type} envoy√© avec succ√®s`);\r\n    } catch (err) {\r\n      setError(err.message || 'Erreur lors de l\\'envoi du rappel');\r\n    }\r\n  };\r\n\r\n  const handleBulkReminders = async () => {\r\n    if (selectedAbsences.length === 0) {\r\n      setError('Veuillez s√©lectionner au moins une absence');\r\n      return;\r\n    }\r\n\r\n    try {\r\n      const message = 'Rappel concernant l\\'absence de votre enfant.';\r\n      await absenceService.bulkSendReminders(selectedAbsences, 'sms', message);\r\n      \r\n      loadAbsences();\r\n      setSelectedAbsences([]);\r\n      setSuccessMessage(`Rappels envoy√©s pour ${selectedAbsences.length} absence(s)`);\r\n    } catch (err) {\r\n      setError(err.message || 'Erreur lors de l\\'envoi des rappels');\r\n    }\r\n  };\r\n\r\n  const handleBulkJustify = async () => {\r\n    const justifiableAbsences = selectedAbsences.filter(absenceId => {\r\n      const absence = absenceData.find(a => a.id === absenceId);\r\n      return absence && absence.status !== 'justified';\r\n    });\r\n\r\n    if (justifiableAbsences.length === 0) {\r\n      setError('Aucune absence s√©lectionn√©e ne peut √™tre justifi√©e');\r\n      return;\r\n    }\r\n\r\n    try {\r\n      const reason = 'Justification group√©e par l\\'administration';\r\n      await absenceService.bulkJustifyAbsences(justifiableAbsences, reason);\r\n      \r\n      loadAbsences();\r\n      setSelectedAbsences([]);\r\n      setSuccessMessage(`${justifiableAbsences.length} absence(s) justifi√©e(s)`);\r\n    } catch (err) {\r\n      setError(err.message || 'Erreur lors de la justification group√©e');\r\n    }\r\n  };\r\n\r\n  const toggleAbsenceSelection = (absenceId) => {\r\n    setSelectedAbsences(prev => \r\n      prev.includes(absenceId) \r\n        ? prev.filter(id => id !== absenceId)\r\n        : [...prev, absenceId]\r\n    );\r\n  };\r\n\r\n  const stats = {\r\n    pending: absenceData.filter(a => a.status === 'pending').length,\r\n    unjustified: absenceData.filter(a => a.status === 'unjustified').length,\r\n    toCall: absenceData.filter(a => !a.notifiedParent && a.status === 'pending').length,\r\n    late: absenceData.filter(a => a.type === 'late').length\r\n  };\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      {/* Messages d'erreur et de succ√®s */}\r\n      {error && (\r\n        <div className=\"p-3 bg-error/10 border border-error/20 rounded-lg\">\r\n          <div className=\"flex items-center space-x-2\">\r\n            <Icon name=\"AlertCircle\" size={16} className=\"text-error\" />\r\n            <p className=\"font-body font-body-normal text-sm text-error\">\r\n              {error}\r\n            </p>\r\n            <Button\r\n              variant=\"ghost\"\r\n              size=\"icon\"\r\n              onClick={() => setError('')}\r\n              className=\"ml-auto\"\r\n            >\r\n              <Icon name=\"X\" size={16} />\r\n            </Button>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {successMessage && (\r\n        <div className=\"p-3 bg-success/10 border border-success/20 rounded-lg\">\r\n          <div className=\"flex items-center space-x-2\">\r\n            <Icon name=\"CheckCircle\" size={16} className=\"text-success\" />\r\n            <p className=\"font-body font-body-normal text-sm text-success\">\r\n              {successMessage}\r\n            </p>\r\n            <Button\r\n              variant=\"ghost\"\r\n              size=\"icon\"\r\n              onClick={() => setSuccessMessage('')}\r\n              className=\"ml-auto\"\r\n            >\r\n              <Icon name=\"X\" size={16} />\r\n            </Button>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Header */}\r\n      <div className=\"flex flex-col gap-4\">\r\n        <div className=\"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4\">\r\n          <div>\r\n            <h2 className=\"font-heading font-heading-bold text-2xl text-text-primary\">\r\n              Gestion des Absences\r\n            </h2>\r\n            <p className=\"font-body font-body-normal text-text-secondary mt-1\">\r\n              Suivi des absences et retards, justifications et relances parents\r\n            </p>\r\n          </div>\r\n          <div className=\"flex items-center gap-2\">\r\n            <Button\r\n              variant=\"default\"\r\n              iconName=\"Plus\"\r\n              iconPosition=\"left\"\r\n              onClick={() => setShowNewAbsenceModal(true)}\r\n            >\r\n              Nouvelle Absence\r\n            </Button>\r\n            <Button\r\n              variant=\"outline\"\r\n              iconName=\"History\"\r\n              iconPosition=\"left\"\r\n              onClick={() => setShowNotificationHistoryModal(true)}\r\n            >\r\n              Historique\r\n            </Button>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Actions group√©es */}\r\n        {selectedAbsences.length > 0 && (\r\n          <div className=\"bg-accent/5 border border-accent/20 rounded-lg p-4\">\r\n            <div className=\"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3\">\r\n              <div className=\"flex items-center gap-3\">\r\n                <Icon name=\"CheckSquare\" size={20} className=\"text-accent\" />\r\n                <span className=\"font-body font-body-medium text-text-primary\">\r\n                  {selectedAbsences.length} absence(s) s√©lectionn√©e(s)\r\n                </span>\r\n              </div>\r\n              <div className=\"flex items-center gap-2\">\r\n                <Button\r\n                  variant=\"outline\"\r\n                  size=\"sm\"\r\n                  iconName=\"CheckCircle\"\r\n                  iconPosition=\"left\"\r\n                  onClick={handleBulkJustify}\r\n                >\r\n                  Justifier la s√©lection\r\n                </Button>\r\n                <Button\r\n                  variant=\"outline\"\r\n                  size=\"sm\"\r\n                  iconName=\"Mail\"\r\n                  iconPosition=\"left\"\r\n                  onClick={handleBulkReminders}\r\n                >\r\n                  Envoyer des rappels\r\n                </Button>\r\n                <Button\r\n                  variant=\"ghost\"\r\n                  size=\"sm\"\r\n                  iconName=\"X\"\r\n                  onClick={() => setSelectedAbsences([])}\r\n                  title=\"D√©s√©lectionner tout\"\r\n                />\r\n              </div>\r\n            </div>\r\n          </div>\r\n        )}\r\n      </div>\r\n\r\n      {/* Quick Stats */}\r\n      <div className=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4\">\r\n        <div className=\"bg-card rounded-lg border border-border p-4\">\r\n          <div className=\"flex items-center space-x-3\">\r\n            <div className=\"w-12 h-12 bg-warning/10 rounded-lg flex items-center justify-center\">\r\n              <Icon name=\"Clock\" size={24} className=\"text-warning\" />\r\n            </div>\r\n            <div>\r\n              <p className=\"font-heading font-heading-bold text-2xl text-text-primary\">\r\n                {stats.pending}\r\n              </p>\r\n              <p className=\"font-caption font-caption-normal text-sm text-text-secondary\">\r\n                En attente justification\r\n              </p>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"bg-card rounded-lg border border-border p-4\">\r\n          <div className=\"flex items-center space-x-3\">\r\n            <div className=\"w-12 h-12 bg-error/10 rounded-lg flex items-center justify-center\">\r\n              <Icon name=\"AlertTriangle\" size={24} className=\"text-error\" />\r\n            </div>\r\n            <div>\r\n              <p className=\"font-heading font-heading-bold text-2xl text-text-primary\">\r\n                {stats.unjustified}\r\n              </p>\r\n              <p className=\"font-caption font-caption-normal text-sm text-text-secondary\">\r\n                Non justifi√©es\r\n              </p>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"bg-card rounded-lg border border-border p-4\">\r\n          <div className=\"flex items-center space-x-3\">\r\n            <div className=\"w-12 h-12 bg-primary/10 rounded-lg flex items-center justify-center\">\r\n              <Icon name=\"Phone\" size={24} className=\"text-primary\" />\r\n            </div>\r\n            <div>\r\n              <p className=\"font-heading font-heading-bold text-2xl text-text-primary\">\r\n                {stats.toCall}\r\n              </p>\r\n              <p className=\"font-caption font-caption-normal text-sm text-text-secondary\">\r\n                Parents √† appeler\r\n              </p>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"bg-card rounded-lg border border-border p-4\">\r\n          <div className=\"flex items-center space-x-3\">\r\n            <div className=\"w-12 h-12 bg-orange-100 rounded-lg flex items-center justify-center\">\r\n              <Icon name=\"Clock\" size={24} className=\"text-orange-600\" />\r\n            </div>\r\n            <div>\r\n              <p className=\"font-heading font-heading-bold text-2xl text-text-primary\">\r\n                {stats.late}\r\n              </p>\r\n              <p className=\"font-caption font-caption-normal text-sm text-text-secondary\">\r\n                Retards\r\n              </p>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Filters */}\r\n      <div className=\"bg-card rounded-lg border border-border p-6\">\r\n        <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\r\n          <Input\r\n            placeholder=\"Rechercher un √©l√®ve ou parent...\"\r\n            value={searchTerm}\r\n            onChange={(e) => setSearchTerm(e.target.value)}\r\n            iconName=\"Search\"\r\n            iconPosition=\"left\"\r\n          />\r\n          <Select\r\n            options={statusOptions}\r\n            value={filterStatus}\r\n            onChange={setFilterStatus}\r\n            placeholder=\"Filtrer par statut\"\r\n          />\r\n          <Input\r\n            type=\"date\"\r\n            value={selectedDate}\r\n            onChange={(e) => setSelectedDate(e.target.value)}\r\n            iconName=\"Calendar\"\r\n            iconPosition=\"left\"\r\n          />\r\n        </div>\r\n        \r\n        {/* Actions de s√©lection */}\r\n        {filteredAbsences.length > 0 && (\r\n          <div className=\"flex items-center gap-2 mt-4 pt-4 border-t border-border\">\r\n            <span className=\"text-sm text-text-secondary\">S√©lection :</span>\r\n            <Button\r\n              variant=\"ghost\"\r\n              size=\"xs\"\r\n              onClick={() => {\r\n                const allIds = filteredAbsences.map(a => a.id);\r\n                setSelectedAbsences(allIds);\r\n              }}\r\n            >\r\n              Tout s√©lectionner\r\n            </Button>\r\n            <Button\r\n              variant=\"ghost\"\r\n              size=\"xs\"\r\n              onClick={() => setSelectedAbsences([])}\r\n            >\r\n              Tout d√©s√©lectionner\r\n            </Button>\r\n            <span className=\"text-sm text-text-secondary ml-2\">\r\n              {filteredAbsences.length} absence(s) affich√©e(s)\r\n            </span>\r\n          </div>\r\n        )}\r\n      </div>\r\n\r\n      {/* Absences List */}\r\n      <div className=\"bg-card rounded-lg border border-border p-6\">\r\n        <div className=\"flex items-center justify-between mb-6\">\r\n          <h3 className=\"font-heading font-heading-semibold text-lg text-text-primary\">\r\n            Absences et Retards ({filteredAbsences.length})\r\n          </h3>\r\n          <div className=\"flex items-center space-x-2\">\r\n            <Button variant=\"ghost\" size=\"sm\">\r\n              <Icon name=\"Download\" size={16} className=\"mr-2\" />\r\n              Exporter\r\n            </Button>\r\n          </div>\r\n        </div>\r\n\r\n        {isLoading ? (\r\n          <div className=\"flex items-center justify-center py-12\">\r\n            <div className=\"flex items-center space-x-3\">\r\n              <div className=\"w-6 h-6 border-2 border-primary border-t-transparent rounded-full animate-spin\"></div>\r\n              <span className=\"font-body font-body-normal text-text-secondary\">\r\n                Chargement des absences...\r\n              </span>\r\n            </div>\r\n          </div>\r\n        ) : (\r\n          <div className=\"overflow-x-auto\">\r\n            <table className=\"w-full\">\r\n              <thead>\r\n                <tr className=\"border-b border-border\">\r\n                  <th className=\"text-left py-3 px-4 w-12\">\r\n                    <Checkbox\r\n                      checked={selectedAbsences.length === filteredAbsences.length}\r\n                      onChange={(e) => {\r\n                        if (e.target.checked) {\r\n                          setSelectedAbsences(filteredAbsences.map(absence => absence.id));\r\n                        } else {\r\n                          setSelectedAbsences([]);\r\n                        }\r\n                      }}\r\n                    />\r\n                  </th>\r\n                  <th className=\"text-left py-3 px-4 font-body font-body-semibold text-sm text-text-secondary\">\r\n                    √âl√®ve\r\n                  </th>\r\n                <th className=\"text-left py-3 px-4 font-body font-body-semibold text-sm text-text-secondary\">\r\n                  Date / Type\r\n                </th>\r\n                <th className=\"text-left py-3 px-4 font-body font-body-semibold text-sm text-text-secondary\">\r\n                  Dur√©e\r\n                </th>\r\n                <th className=\"text-left py-3 px-4 font-body font-body-semibold text-sm text-text-secondary\">\r\n                  Statut\r\n                </th>\r\n                <th className=\"text-left py-3 px-4 font-body font-body-semibold text-sm text-text-secondary\">\r\n                  Justification\r\n                </th>\r\n                <th className=\"text-left py-3 px-4 font-body font-body-semibold text-sm text-text-secondary\">\r\n                  Actions\r\n                </th>\r\n              </tr>\r\n            </thead>\r\n            <tbody>\r\n              {filteredAbsences.map((absence) => {\r\n                const statusConfig = getStatusConfig(absence.status);\r\n                const typeConfig = getTypeConfig(absence.type);\r\n                \r\n                return (\r\n                  <tr key={absence.id} className=\"border-b border-border hover:bg-muted/50 transition-micro\">\r\n                    <td className=\"py-4 px-4\">\r\n                      <Checkbox\r\n                        checked={selectedAbsences.includes(absence.id)}\r\n                        onChange={() => toggleAbsenceSelection(absence.id)}\r\n                      />\r\n                    </td>\r\n                    <td className=\"py-4 px-4\">\r\n                      <div>\r\n                        <div className=\"font-body font-body-semibold text-sm text-text-primary\">\r\n                          {absence.studentName}\r\n                        </div>\r\n                        <div className=\"font-caption font-caption-normal text-xs text-text-secondary\">\r\n                          {absence.class} - {absence.studentId}\r\n                        </div>\r\n                        <div className=\"font-caption font-caption-normal text-xs text-text-secondary\">\r\n                          {absence.parentName} - {absence.parentPhone}\r\n                        </div>\r\n                      </div>\r\n                    </td>\r\n                    <td className=\"py-4 px-4\">\r\n                      <div className=\"font-body font-body-normal text-sm text-text-primary\">\r\n                        {absence.absenceDate}\r\n                      </div>\r\n                      <span className={`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${typeConfig.className}`}>\r\n                        <Icon name={typeConfig.icon} size={12} className=\"mr-1\" />\r\n                        {typeConfig.label}\r\n                      </span>\r\n                    </td>\r\n                    <td className=\"py-4 px-4\">\r\n                      <div className=\"font-body font-body-normal text-sm text-text-primary\">\r\n                        {absence.duration}\r\n                      </div>\r\n                    </td>\r\n                    <td className=\"py-4 px-4\">\r\n                      <span className={`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium border ${statusConfig.className}`}>\r\n                        <Icon name={statusConfig.icon} size={12} className=\"mr-1\" />\r\n                        {statusConfig.label}\r\n                      </span>\r\n                    </td>\r\n                    <td className=\"py-4 px-4\">\r\n                      <div className=\"font-body font-body-normal text-sm text-text-primary\">\r\n                        {absence.justification || '-'}\r\n                      </div>\r\n                      {absence.justificationDate && (\r\n                        <div className=\"font-caption font-caption-normal text-xs text-text-secondary\">\r\n                          Le {absence.justificationDate}\r\n                        </div>\r\n                      )}\r\n                    </td>\r\n                    <td className=\"py-4 px-4\">\r\n                      <div className=\"flex items-center space-x-2\">\r\n                        {absence.status === 'pending' && (\r\n                          <Button\r\n                            variant=\"ghost\"\r\n                            size=\"sm\"\r\n                            onClick={() => handleCallParent(absence.id)}\r\n                            title=\"Appeler parent\"\r\n                          >\r\n                            <Icon name=\"Phone\" size={16} />\r\n                          </Button>\r\n                        )}\r\n                        {absence.status !== 'justified' && (\r\n                          <Button\r\n                            variant=\"ghost\"\r\n                            size=\"sm\"\r\n                            onClick={() => handleJustifyAbsence(absence)}\r\n                            title=\"Justifier\"\r\n                          >\r\n                            <Icon name=\"CheckCircle\" size={16} />\r\n                          </Button>\r\n                        )}\r\n                        <Button\r\n                          variant=\"ghost\"\r\n                          size=\"sm\"\r\n                          onClick={() => handleSendReminder(absence.id, 'sms')}\r\n                          title=\"SMS\"\r\n                        >\r\n                          <Icon name=\"MessageSquare\" size={16} />\r\n                        </Button>\r\n                        <Button\r\n                          variant=\"ghost\"\r\n                          size=\"sm\"\r\n                          onClick={() => handleSendReminder(absence.id, 'email')}\r\n                          title=\"Email\"\r\n                        >\r\n                          <Icon name=\"Mail\" size={16} />\r\n                        </Button>\r\n                        {absence.notificationHistory && absence.notificationHistory.length > 0 && (\r\n                          <Button\r\n                            variant=\"ghost\"\r\n                            size=\"sm\"\r\n                            onClick={() => {\r\n                              setSelectedAbsence(absence);\r\n                              setShowNotificationHistoryModal(true);\r\n                            }}\r\n                            title=\"Historique des notifications\"\r\n                          >\r\n                            <Icon name=\"History\" size={16} />\r\n                          </Button>\r\n                        )}\r\n                      </div>\r\n                    </td>\r\n                  </tr>\r\n                );\r\n              })}\r\n            </tbody>\r\n          </table>\r\n\r\n          {filteredAbsences.length === 0 && (\r\n            <div className=\"text-center py-12\">\r\n              <Icon name=\"CheckCircle\" size={48} className=\"text-muted-foreground mx-auto mb-4\" />\r\n              <h3 className=\"font-heading font-heading-semibold text-lg text-text-primary mb-2\">\r\n                Aucune absence trouv√©e\r\n              </h3>\r\n              <p className=\"font-body font-body-normal text-text-secondary\">\r\n                Aucune absence ne correspond √† vos crit√®res de recherche.\r\n              </p>\r\n            </div>\r\n          )}\r\n        </div>\r\n        )}\r\n      </div>\r\n      {/* Modals */}\r\n      <AbsenceJustificationModal\r\n        isOpen={showJustificationModal}\r\n        onClose={() => setShowJustificationModal(false)}\r\n        absence={selectedAbsence}\r\n        onAbsenceUpdated={handleAbsenceUpdated}\r\n      />\r\n\r\n      <NewAbsenceModal\r\n        isOpen={showNewAbsenceModal}\r\n        onClose={() => setShowNewAbsenceModal(false)}\r\n        onAbsenceCreated={handleAbsenceCreated}\r\n      />\r\n\r\n      <NotificationHistoryModal\r\n        isOpen={showNotificationHistoryModal}\r\n        onClose={() => setShowNotificationHistoryModal(false)}\r\n        absence={selectedAbsence}\r\n      />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default JustificationTab;","import React, { useState, useEffect } from 'react';\r\nimport { X, CheckCircle, AlertTriangle, Info, AlertCircle } from 'lucide-react';\r\n\r\nexport const Toast = ({ message, type = 'success', duration = 5000, onClose }) => {\r\n  const [isVisible, setIsVisible] = useState(true);\r\n  const [isLeaving, setIsLeaving] = useState(false);\r\n\r\n  useEffect(() => {\r\n    const timer = setTimeout(() => {\r\n      setIsLeaving(true);\r\n      setTimeout(() => {\r\n        setIsVisible(false);\r\n        onClose && onClose();\r\n      }, 300);\r\n    }, duration);\r\n\r\n    return () => clearTimeout(timer);\r\n  }, [duration, onClose]);\r\n\r\n  const handleClose = () => {\r\n    setIsLeaving(true);\r\n    setTimeout(() => {\r\n      setIsVisible(false);\r\n      onClose && onClose();\r\n    }, 300);\r\n  };\r\n\r\n  const getToastConfig = (type) => {\r\n    const configs = {\r\n      success: {\r\n        icon: CheckCircle,\r\n        className: 'bg-green-50 border-green-200 text-green-800',\r\n        iconColor: 'text-green-500'\r\n      },\r\n      error: {\r\n        icon: AlertCircle,\r\n        className: 'bg-red-50 border-red-200 text-red-800',\r\n        iconColor: 'text-red-500'\r\n      },\r\n      warning: {\r\n        icon: AlertTriangle,\r\n        className: 'bg-yellow-50 border-yellow-200 text-yellow-800',\r\n        iconColor: 'text-yellow-500'\r\n      },\r\n      info: {\r\n        icon: Info,\r\n        className: 'bg-blue-50 border-blue-200 text-blue-800',\r\n        iconColor: 'text-blue-500'\r\n      }\r\n    };\r\n    return configs[type] || configs.success;\r\n  };\r\n\r\n  if (!isVisible) return null;\r\n\r\n  const config = getToastConfig(type);\r\n  const Icon = config.icon;\r\n\r\n  return (\r\n    <div className={`fixed top-4 left-1/2 transform -translate-x-1/2 z-50 transition-all duration-300 ${\r\n      isLeaving ? 'translate-y-[-100px] opacity-0' : 'translate-y-0 opacity-100'\r\n    }`}>\r\n      <div className={`\r\n        flex items-center p-4 rounded-lg border shadow-lg max-w-md\r\n        ${config.className}\r\n        transform transition-all duration-300\r\n      `}>\r\n        <Icon className={`w-5 h-5 mr-3 ${config.iconColor}`} />\r\n        <p className=\"text-sm font-medium flex-1\">{message}</p>\r\n        <button\r\n          onClick={handleClose}\r\n          className=\"ml-3 text-gray-400 hover:text-gray-600 transition-colors\"\r\n        >\r\n          <X className=\"w-4 h-4\" />\r\n        </button>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport const ToastContainer = ({ toasts, removeToast }) => {\r\n  return (\r\n    <div className=\"fixed top-4 left-1/2 transform -translate-x-1/2 z-50 space-y-2 w-full max-w-md\">\r\n      {toasts.map((toast) => (\r\n        <Toast\r\n          key={toast.id}\r\n          message={toast.message}\r\n          type={toast.type}\r\n          duration={toast.duration}\r\n          onClose={() => removeToast(toast.id)}\r\n        />\r\n      ))}\r\n    </div>\r\n  );\r\n};\r\n\r\n// Hook pour g√©rer les toasts\r\nexport const useToast = () => {\r\n  const [toasts, setToasts] = useState([]);\r\n\r\n  const addToast = (message, type = 'success', duration = 5000) => {\r\n    const id = Date.now() + Math.random();\r\n    const toast = { id, message, type, duration };\r\n    \r\n    setToasts(prev => [...prev, toast]);\r\n    \r\n    setTimeout(() => {\r\n      removeToast(id);\r\n    }, duration + 300);\r\n  };\r\n\r\n  const removeToast = (id) => {\r\n    setToasts(prev => prev.filter(toast => toast.id !== id));\r\n  };\r\n\r\n  return {\r\n    toasts,\r\n    addToast,\r\n    removeToast,\r\n    showSuccess: (message, duration = 6000) => addToast(message, 'success', duration),\r\n    showError: (message, duration = 8000) => addToast(message, 'error', duration),\r\n    showWarning: (message, duration = 7000) => addToast(message, 'warning', duration),\r\n    showInfo: (message, duration = 5000) => addToast(message, 'info', duration)\r\n  };\r\n};\r\n\r\nexport default Toast;","// Service pour la gestion des paiements scolaires\r\n\r\nimport { supabase } from '../lib/supabase';\r\nimport { getCurrentSchoolId } from './cardService';\r\n\r\n// Formatage des dates\r\nconst formatDate = (date) => {\r\n  return date.toLocaleDateString('fr-FR');\r\n};\r\n\r\nconst formatDateTime = (date) => {\r\n  return date.toLocaleDateString('fr-FR') + ' ' + date.toLocaleTimeString('fr-FR', { hour: '2-digit', minute: '2-digit' });\r\n};\r\n\r\n// Service principal\r\nexport const paymentService = {\r\n  // Obtenir tous les paiements avec statistiques\r\n  getAllPayments: async () => {\r\n    try {\r\n      const schoolId = await getCurrentSchoolId();\r\n      if (!schoolId) {\r\n        throw new Error('Pas d\\'√©cole associ√©e');\r\n      }\r\n\r\n      // Charger les √©tudiants r√©els depuis Supabase\r\n      const { data: studentsData, error } = await supabase\r\n        .from('students')\r\n        .select(`\r\n          id,\r\n          user_id,\r\n          first_name,\r\n          last_name,\r\n          school_id,\r\n          is_active,\r\n          created_at\r\n        `)\r\n        .eq('school_id', schoolId)\r\n        .eq('is_active', true)\r\n        .order('created_at', { ascending: false })\r\n        .limit(15);\r\n\r\n      if (error) {\r\n        throw error;\r\n      }\r\n\r\n      if (!studentsData || studentsData.length === 0) {\r\n        return {\r\n          payments: [],\r\n          statistics: {\r\n            total: 0,\r\n            collected: 0,\r\n            overdue: 0,\r\n            outstanding: 0\r\n          }\r\n        };\r\n      }\r\n\r\n      // G√©n√©rer des paiements depuis les vrais √©tudiants\r\n      const payments = studentsData.map((student, index) => {\r\n        const baseAmount = 20000 + (index % 3) * 5000;\r\n        const statuses = ['completed', 'pending', 'overdue', 'partial'];\r\n        const status = statuses[index % statuses.length];\r\n        const amountPaid = status === 'completed' ? baseAmount :\r\n                          status === 'partial' ? Math.floor(baseAmount * 0.6) : 0;\r\n\r\n        return {\r\n          id: index + 1,\r\n          student: {\r\n            studentId: student.user_id || student.id,\r\n            firstName: student.first_name,\r\n            lastName: student.last_name,\r\n            class: 'Non assign√©',\r\n            parentName: '√Ä renseigner',\r\n            parentPhone: '√Ä renseigner',\r\n            parentEmail: '√Ä renseigner'\r\n          },\r\n          feeType: ['Frais de scolarit√©', 'Transport', 'Cantine', 'Uniforme'][index % 4],\r\n          period: 'Novembre 2024',\r\n          description: 'Paiement mensuel',\r\n          totalAmount: baseAmount,\r\n          amountPaid: amountPaid,\r\n          remainingBalance: baseAmount - amountPaid,\r\n          status: status,\r\n          dueDate: '2024-11-15',\r\n          paymentDate: status === 'completed' || status === 'partial' ? '2024-11-10' : null,\r\n          paymentMethod: status === 'completed' || status === 'partial' ?\r\n                        ['Mobile Money', 'Esp√®ces', 'Virement'][index % 3] : null,\r\n          receiptId: status === 'completed' || status === 'partial' ? `REC${(index + 1).toString().padStart(3, '0')}` : null,\r\n          paymentHistory: status === 'completed' || status === 'partial' ? [{\r\n            date: '2024-11-10',\r\n            amount: amountPaid,\r\n            method: ['Mobile Money', 'Esp√®ces', 'Virement'][index % 3],\r\n            reference: `REF${index + 1}`,\r\n            receivedBy: 'Secr√©taire'\r\n          }] : [],\r\n          createdAt: student.created_at\r\n        };\r\n      });\r\n\r\n      // Calculer les statistiques\r\n      const statistics = payments.reduce((acc, payment) => {\r\n        acc.total += payment.totalAmount || 0;\r\n        acc.collected += payment.amountPaid || 0;\r\n\r\n        if (payment.status === 'overdue') {\r\n          acc.overdue += payment.totalAmount - (payment.amountPaid || 0);\r\n        }\r\n\r\n        return acc;\r\n      }, {\r\n        total: 0,\r\n        collected: 0,\r\n        overdue: 0\r\n      });\r\n\r\n      statistics.outstanding = statistics.total - statistics.collected;\r\n\r\n      return {\r\n        payments,\r\n        statistics\r\n      };\r\n\r\n    } catch (error) {\r\n      console.error('Erreur chargement paiements:', error);\r\n      return {\r\n        payments: [],\r\n        statistics: {\r\n          total: 0,\r\n          collected: 0,\r\n          overdue: 0,\r\n          outstanding: 0\r\n        }\r\n      };\r\n    }\r\n  },\r\n\r\n  // Rechercher des √©tudiants pour cr√©er un nouveau paiement\r\n  searchStudents: async (searchTerm = '') => {\r\n    try {\r\n      const schoolId = await getCurrentSchoolId();\r\n      if (!schoolId) {\r\n        return [];\r\n      }\r\n\r\n      let query = supabase\r\n        .from('students')\r\n        .select('id, user_id, first_name, last_name')\r\n        .eq('school_id', schoolId)\r\n        .eq('is_active', true);\r\n\r\n      // Appliquer le filtre de recherche si fourni\r\n      if (searchTerm && searchTerm.trim() !== '') {\r\n        query = query.or(`first_name.ilike.%${searchTerm}%, last_name.ilike.%${searchTerm}%`);\r\n      }\r\n\r\n      const { data: students, error } = await query\r\n        .order('first_name')\r\n        .limit(50);\r\n\r\n      if (error) {\r\n        throw error;\r\n      }\r\n\r\n      return students?.map(student => ({\r\n        id: student.user_id || student.id,\r\n        name: `${student.first_name} ${student.last_name}`,\r\n        class: 'Non assign√©',\r\n        parentName: '√Ä renseigner',\r\n        parentPhone: '√Ä renseigner',\r\n        parentEmail: '√Ä renseigner'\r\n      })) || [];\r\n\r\n    } catch (error) {\r\n      console.error('Erreur searchStudents:', error);\r\n      return [];\r\n    }\r\n  },\r\n\r\n};\r\n\r\nexport default paymentService;","import React, { useState, useEffect } from 'react';\r\nimport Icon from '../../../components/AppIcon';\r\nimport Button from '../../../components/ui/Button';\r\nimport Input from '../../../components/ui/Input';\r\nimport Select from '../../../components/ui/Select';\r\nimport paymentService from '../../../services/paymentService';\r\n\r\nconst PaymentRegistrationModal = ({ isOpen, onClose, onPaymentRecorded, selectedPayment = null }) => {\r\n  const [step, setStep] = useState(1); // 1: S√©lection √©tudiant, 2: D√©tails paiement\r\n  const [searchTerm, setSearchTerm] = useState('');\r\n  const [students, setStudents] = useState([]);\r\n  const [feeTypes, setFeeTypes] = useState([]);\r\n  const [selectedStudent, setSelectedStudent] = useState(null);\r\n  const [paymentData, setPaymentData] = useState({\r\n    feeType: '',\r\n    period: '',\r\n    amount: '',\r\n    totalAmount: '',\r\n    paymentMethod: '',\r\n    reference: '',\r\n    description: '',\r\n    dueDate: new Date().toISOString().split('T')[0]\r\n  });\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const [isSubmitting, setIsSubmitting] = useState(false);\r\n  const [error, setError] = useState('');\r\n\r\n  const paymentMethods = [\r\n    { value: 'cash', label: 'Esp√®ces' },\r\n    { value: 'mobile_money', label: 'Mobile Money' },\r\n    { value: 'bank_transfer', label: 'Virement bancaire' },\r\n    { value: 'check', label: 'Ch√®que' },\r\n    { value: 'card', label: 'Carte bancaire' }\r\n  ];\r\n\r\n  const currentMonth = new Date().toLocaleDateString('fr-FR', { month: 'long', year: 'numeric' });\r\n  const periodOptions = [\r\n    { value: currentMonth, label: currentMonth },\r\n    { value: 'Octobre 2024', label: 'Octobre 2024' },\r\n    { value: 'Septembre 2024', label: 'Septembre 2024' },\r\n    { value: 'Ao√ªt 2024', label: 'Ao√ªt 2024' }\r\n  ];\r\n\r\n  useEffect(() => {\r\n    if (isOpen) {\r\n      loadInitialData();\r\n      if (selectedPayment) {\r\n        // Mode modification d'un paiement existant\r\n        initializeWithExistingPayment();\r\n      }\r\n    }\r\n  }, [isOpen, selectedPayment]);\r\n\r\n  const loadInitialData = async () => {\r\n    try {\r\n      setIsLoading(true);\r\n      const [studentsResult, feeTypesResult] = await Promise.all([\r\n        paymentService.searchStudents(searchTerm),\r\n        paymentService.getFeeTypes()\r\n      ]);\r\n      setStudents(studentsResult);\r\n      setFeeTypes(feeTypesResult);\r\n    } catch (err) {\r\n      setError('Erreur lors du chargement des donn√©es');\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  const initializeWithExistingPayment = () => {\r\n    if (selectedPayment) {\r\n      setSelectedStudent({\r\n        id: selectedPayment.studentId,\r\n        name: selectedPayment.studentName,\r\n        class: selectedPayment.class,\r\n        parentName: selectedPayment.parentName,\r\n        parentPhone: selectedPayment.parentPhone\r\n      });\r\n      setPaymentData({\r\n        feeType: selectedPayment.feeType,\r\n        period: selectedPayment.period,\r\n        amount: (selectedPayment.amount - selectedPayment.paidAmount).toString(),\r\n        totalAmount: selectedPayment.amount.toString(),\r\n        paymentMethod: '',\r\n        reference: '',\r\n        description: selectedPayment.description,\r\n        dueDate: selectedPayment.dueDate.split('/').reverse().join('-')\r\n      });\r\n      setStep(2);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (step === 1 && searchTerm !== '') {\r\n      const timer = setTimeout(() => {\r\n        loadStudents();\r\n      }, 300);\r\n      return () => clearTimeout(timer);\r\n    }\r\n  }, [searchTerm]);\r\n\r\n  const loadStudents = async () => {\r\n    try {\r\n      setIsLoading(true);\r\n      const studentsResult = await paymentService.searchStudents(searchTerm);\r\n      setStudents(studentsResult);\r\n    } catch (err) {\r\n      setError('Erreur lors de la recherche');\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleStudentSelect = (student) => {\r\n    setSelectedStudent(student);\r\n    setStep(2);\r\n  };\r\n\r\n  const handlePaymentDataChange = (field, value) => {\r\n    setPaymentData(prev => ({\r\n      ...prev,\r\n      [field]: value\r\n    }));\r\n\r\n    // Auto-remplir le montant total si un type de frais est s√©lectionn√©\r\n    if (field === 'feeType' && value) {\r\n      const selectedFeeType = feeTypes.find(f => f.id === value);\r\n      if (selectedFeeType && !paymentData.totalAmount) {\r\n        setPaymentData(prev => ({\r\n          ...prev,\r\n          totalAmount: selectedFeeType.amount.toString(),\r\n          amount: selectedFeeType.amount.toString(),\r\n          description: selectedFeeType.name\r\n        }));\r\n      }\r\n    }\r\n  };\r\n\r\n  const validatePaymentData = () => {\r\n    if (!selectedStudent) {\r\n      setError('Veuillez s√©lectionner un √©tudiant');\r\n      return false;\r\n    }\r\n\r\n    if (!paymentData.feeType) {\r\n      setError('Veuillez s√©lectionner le type de frais');\r\n      return false;\r\n    }\r\n\r\n    if (!paymentData.period) {\r\n      setError('Veuillez s√©lectionner la p√©riode');\r\n      return false;\r\n    }\r\n\r\n    if (!paymentData.amount || parseFloat(paymentData.amount) <= 0) {\r\n      setError('Veuillez saisir un montant valide');\r\n      return false;\r\n    }\r\n\r\n    if (!paymentData.paymentMethod) {\r\n      setError('Veuillez s√©lectionner le mode de paiement');\r\n      return false;\r\n    }\r\n\r\n    if (parseFloat(paymentData.amount) > parseFloat(paymentData.totalAmount || paymentData.amount)) {\r\n      setError('Le montant pay√© ne peut pas d√©passer le montant total');\r\n      return false;\r\n    }\r\n\r\n    return true;\r\n  };\r\n\r\n  const handleSubmit = async (e) => {\r\n    e.preventDefault();\r\n    \r\n    if (!validatePaymentData()) {\r\n      return;\r\n    }\r\n\r\n    try {\r\n      setIsSubmitting(true);\r\n      setError('');\r\n\r\n      const paymentSubmissionData = {\r\n        studentId: selectedStudent.id,\r\n        feeType: paymentData.feeType,\r\n        period: paymentData.period,\r\n        amount: parseFloat(paymentData.amount),\r\n        totalAmount: parseFloat(paymentData.totalAmount || paymentData.amount),\r\n        paymentMethod: paymentData.paymentMethod,\r\n        reference: paymentData.reference.trim(),\r\n        description: paymentData.description.trim(),\r\n        dueDate: new Date(paymentData.dueDate).toLocaleDateString('fr-FR')\r\n      };\r\n\r\n      const result = await paymentService.recordPayment(paymentSubmissionData);\r\n      \r\n      if (onPaymentRecorded) {\r\n        onPaymentRecorded(result);\r\n      }\r\n      \r\n      handleClose();\r\n    } catch (err) {\r\n      setError(err.message || 'Erreur lors de l\\'enregistrement du paiement');\r\n    } finally {\r\n      setIsSubmitting(false);\r\n    }\r\n  };\r\n\r\n  const handleClose = () => {\r\n    setStep(1);\r\n    setSearchTerm('');\r\n    setSelectedStudent(null);\r\n    setPaymentData({\r\n      feeType: '',\r\n      period: '',\r\n      amount: '',\r\n      totalAmount: '',\r\n      paymentMethod: '',\r\n      reference: '',\r\n      description: '',\r\n      dueDate: new Date().toISOString().split('T')[0]\r\n    });\r\n    setError('');\r\n    setIsLoading(false);\r\n    setIsSubmitting(false);\r\n    onClose();\r\n  };\r\n\r\n  const handleBackToSearch = () => {\r\n    setStep(1);\r\n    setSelectedStudent(null);\r\n    setError('');\r\n  };\r\n\r\n  if (!isOpen) return null;\r\n\r\n  return (\r\n    <div className=\"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4\">\r\n      <div className=\"bg-card rounded-lg border border-border max-w-2xl w-full max-h-[90vh] overflow-y-auto\">\r\n        {/* Header */}\r\n        <div className=\"flex items-center justify-between p-6 border-b border-border\">\r\n          <div>\r\n            <h3 className=\"font-heading font-heading-semibold text-lg text-text-primary\">\r\n              {selectedPayment ? 'Compl√©ter le Paiement' : \r\n               step === 1 ? 'S√©lectionner un √âtudiant' : 'Enregistrer un Paiement'}\r\n            </h3>\r\n            <p className=\"font-body font-body-normal text-sm text-text-secondary mt-1\">\r\n              {selectedPayment ? `Paiement pour ${selectedPayment.studentName}` :\r\n               step === 1 ? 'Choisissez l\\'√©tudiant pour lequel enregistrer un paiement'\r\n               : 'Saisissez les d√©tails du paiement re√ßu'}\r\n            </p>\r\n          </div>\r\n          <Button\r\n            variant=\"ghost\"\r\n            size=\"icon\"\r\n            onClick={handleClose}\r\n          >\r\n            <Icon name=\"X\" size={20} />\r\n          </Button>\r\n        </div>\r\n\r\n        {/* Error Message */}\r\n        {error && (\r\n          <div className=\"mx-6 mt-4 p-3 bg-error/10 border border-error/20 rounded-lg\">\r\n            <div className=\"flex items-center space-x-2\">\r\n              <Icon name=\"AlertCircle\" size={16} className=\"text-error\" />\r\n              <p className=\"font-body font-body-normal text-sm text-error\">\r\n                {error}\r\n              </p>\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        {/* Step 1: Recherche et s√©lection d'√©tudiant */}\r\n        {step === 1 && !selectedPayment && (\r\n          <div className=\"p-6\">\r\n            <div className=\"mb-6\">\r\n              <Input\r\n                type=\"search\"\r\n                placeholder=\"Rechercher par nom, ID ou classe...\"\r\n                value={searchTerm}\r\n                onChange={(e) => setSearchTerm(e.target.value)}\r\n                className=\"w-full\"\r\n                iconName=\"Search\"\r\n                iconPosition=\"left\"\r\n              />\r\n            </div>\r\n\r\n            <div className=\"space-y-2 max-h-96 overflow-y-auto\">\r\n              {isLoading ? (\r\n                <div className=\"flex items-center justify-center py-8\">\r\n                  <div className=\"flex items-center space-x-2\">\r\n                    <div className=\"w-5 h-5 border-2 border-primary border-t-transparent rounded-full animate-spin\"></div>\r\n                    <span className=\"font-body font-body-normal text-sm text-text-secondary\">\r\n                      Recherche en cours...\r\n                    </span>\r\n                  </div>\r\n                </div>\r\n              ) : students.length === 0 ? (\r\n                <div className=\"text-center py-8\">\r\n                  <Icon name=\"Users\" size={48} className=\"text-muted-foreground mx-auto mb-4\" />\r\n                  <p className=\"font-body font-body-normal text-text-secondary\">\r\n                    {searchTerm \r\n                      ? 'Aucun √©tudiant trouv√© avec ces crit√®res'\r\n                      : 'Saisissez un nom pour rechercher un √©tudiant'\r\n                    }\r\n                  </p>\r\n                </div>\r\n              ) : (\r\n                students.map((student) => (\r\n                  <div\r\n                    key={student.id}\r\n                    className=\"flex items-center justify-between p-4 border border-border rounded-lg hover:bg-muted/30 cursor-pointer transition-colors\"\r\n                    onClick={() => handleStudentSelect(student)}\r\n                  >\r\n                    <div className=\"flex items-center space-x-3\">\r\n                      <div className=\"w-12 h-12 bg-primary/10 rounded-full flex items-center justify-center\">\r\n                        <Icon name=\"User\" size={20} className=\"text-primary\" />\r\n                      </div>\r\n                      <div>\r\n                        <h4 className=\"font-body font-body-medium text-sm text-text-primary\">\r\n                          {student.name}\r\n                        </h4>\r\n                        <div className=\"flex items-center space-x-4 mt-1\">\r\n                          <p className=\"font-caption font-caption-normal text-xs text-text-secondary\">\r\n                            ID: {student.id}\r\n                          </p>\r\n                          <p className=\"font-caption font-caption-normal text-xs text-text-secondary\">\r\n                            Classe: {student.class}\r\n                          </p>\r\n                        </div>\r\n                        <p className=\"font-caption font-caption-normal text-xs text-text-secondary\">\r\n                          Parent: {student.parentName}\r\n                        </p>\r\n                      </div>\r\n                    </div>\r\n                    <Icon name=\"ChevronRight\" size={16} className=\"text-muted-foreground\" />\r\n                  </div>\r\n                ))\r\n              )}\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        {/* Step 2: D√©tails du paiement */}\r\n        {(step === 2 || selectedPayment) && selectedStudent && (\r\n          <div className=\"p-6\">\r\n            {/* Informations de l'√©tudiant */}\r\n            <div className=\"bg-muted/20 rounded-lg p-4 mb-6\">\r\n              <div className=\"flex items-center space-x-3 mb-3\">\r\n                <div className=\"w-12 h-12 bg-primary/10 rounded-full flex items-center justify-center\">\r\n                  <Icon name=\"User\" size={20} className=\"text-primary\" />\r\n                </div>\r\n                <div>\r\n                  <h4 className=\"font-heading font-heading-semibold text-sm text-text-primary\">\r\n                    {selectedStudent.name}\r\n                  </h4>\r\n                  <p className=\"font-body font-body-normal text-xs text-text-secondary\">\r\n                    {selectedStudent.id} ‚Ä¢ Classe {selectedStudent.class}\r\n                  </p>\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n            {/* Formulaire de paiement */}\r\n            <form onSubmit={handleSubmit} className=\"space-y-4\">\r\n              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n                {/* Type de frais */}\r\n                <div>\r\n                  <label className=\"block font-body font-body-medium text-sm text-text-primary mb-2\">\r\n                    Type de frais *\r\n                  </label>\r\n                  <Select\r\n                    options={feeTypes.map(fee => ({ value: fee.id, label: fee.name }))}\r\n                    value={paymentData.feeType}\r\n                    onChange={(value) => handlePaymentDataChange('feeType', value)}\r\n                    placeholder=\"S√©lectionnez le type de frais\"\r\n                    disabled={!!selectedPayment}\r\n                  />\r\n                </div>\r\n\r\n                {/* P√©riode */}\r\n                <div>\r\n                  <label className=\"block font-body font-body-medium text-sm text-text-primary mb-2\">\r\n                    P√©riode *\r\n                  </label>\r\n                  <Select\r\n                    options={periodOptions}\r\n                    value={paymentData.period}\r\n                    onChange={(value) => handlePaymentDataChange('period', value)}\r\n                    placeholder=\"S√©lectionnez la p√©riode\"\r\n                    disabled={!!selectedPayment}\r\n                  />\r\n                </div>\r\n              </div>\r\n\r\n              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n                {/* Montant total */}\r\n                <div>\r\n                  <label className=\"block font-body font-body-medium text-sm text-text-primary mb-2\">\r\n                    Montant total (FCFA) *\r\n                  </label>\r\n                  <Input\r\n                    type=\"number\"\r\n                    value={paymentData.totalAmount}\r\n                    onChange={(e) => handlePaymentDataChange('totalAmount', e.target.value)}\r\n                    placeholder=\"0\"\r\n                    disabled={!!selectedPayment}\r\n                  />\r\n                </div>\r\n\r\n                {/* Montant pay√© */}\r\n                <div>\r\n                  <label className=\"block font-body font-body-medium text-sm text-text-primary mb-2\">\r\n                    Montant pay√© (FCFA) *\r\n                  </label>\r\n                  <Input\r\n                    type=\"number\"\r\n                    value={paymentData.amount}\r\n                    onChange={(e) => handlePaymentDataChange('amount', e.target.value)}\r\n                    placeholder=\"0\"\r\n                  />\r\n                </div>\r\n              </div>\r\n\r\n              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n                {/* Mode de paiement */}\r\n                <div>\r\n                  <label className=\"block font-body font-body-medium text-sm text-text-primary mb-2\">\r\n                    Mode de paiement *\r\n                  </label>\r\n                  <Select\r\n                    options={paymentMethods}\r\n                    value={paymentData.paymentMethod}\r\n                    onChange={(value) => handlePaymentDataChange('paymentMethod', value)}\r\n                    placeholder=\"S√©lectionnez le mode\"\r\n                  />\r\n                </div>\r\n\r\n                {/* R√©f√©rence */}\r\n                <div>\r\n                  <label className=\"block font-body font-body-medium text-sm text-text-primary mb-2\">\r\n                    R√©f√©rence (optionnel)\r\n                  </label>\r\n                  <Input\r\n                    value={paymentData.reference}\r\n                    onChange={(e) => handlePaymentDataChange('reference', e.target.value)}\r\n                    placeholder=\"Num√©ro de transaction, ch√®que...\"\r\n                  />\r\n                </div>\r\n              </div>\r\n\r\n              {/* Description */}\r\n              <div>\r\n                <label className=\"block font-body font-body-medium text-sm text-text-primary mb-2\">\r\n                  Description\r\n                </label>\r\n                <Input\r\n                  value={paymentData.description}\r\n                  onChange={(e) => handlePaymentDataChange('description', e.target.value)}\r\n                  placeholder=\"Description du paiement\"\r\n                />\r\n              </div>\r\n\r\n              {/* R√©sum√© du paiement */}\r\n              {paymentData.amount && paymentData.totalAmount && (\r\n                <div className=\"bg-primary/5 border border-primary/20 rounded-lg p-4\">\r\n                  <h5 className=\"font-heading font-heading-semibold text-sm text-primary mb-2\">\r\n                    R√©sum√© du paiement\r\n                  </h5>\r\n                  <div className=\"grid grid-cols-2 gap-4 text-sm\">\r\n                    <div>\r\n                      <p className=\"text-text-secondary\">Montant pay√©:</p>\r\n                      <p className=\"font-semibold text-text-primary\">\r\n                        {parseInt(paymentData.amount).toLocaleString()} FCFA\r\n                      </p>\r\n                    </div>\r\n                    <div>\r\n                      <p className=\"text-text-secondary\">Solde restant:</p>\r\n                      <p className=\"font-semibold text-text-primary\">\r\n                        {Math.max(0, parseInt(paymentData.totalAmount || paymentData.amount) - parseInt(paymentData.amount)).toLocaleString()} FCFA\r\n                      </p>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              )}\r\n            </form>\r\n          </div>\r\n        )}\r\n\r\n        {/* Footer */}\r\n        <div className=\"flex gap-3 p-6 border-t border-border\">\r\n          {step === 1 && !selectedPayment ? (\r\n            <Button variant=\"outline\" onClick={handleClose}>\r\n              Annuler\r\n            </Button>\r\n          ) : (\r\n            <>\r\n              {!selectedPayment && (\r\n                <Button variant=\"outline\" onClick={handleBackToSearch}>\r\n                  Retour\r\n                </Button>\r\n              )}\r\n              <Button variant=\"outline\" onClick={handleClose}>\r\n                Annuler\r\n              </Button>\r\n              <Button \r\n                variant=\"default\" \r\n                onClick={handleSubmit}\r\n                disabled={isSubmitting}\r\n                iconName={isSubmitting ? undefined : \"DollarSign\"}\r\n                iconPosition=\"left\"\r\n              >\r\n                {isSubmitting ? (\r\n                  <div className=\"flex items-center space-x-2\">\r\n                    <div className=\"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin\"></div>\r\n                    <span>Enregistrement...</span>\r\n                  </div>\r\n                ) : (\r\n                  'Enregistrer le Paiement'\r\n                )}\r\n              </Button>\r\n            </>\r\n          )}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default PaymentRegistrationModal;","import React, { useState, useRef, useEffect } from 'react';\r\nimport DOMPurify from 'dompurify';\r\nimport { X, Printer, Download, Eye } from 'lucide-react';\r\nimport Button from '../../../components/ui/Button';\r\nimport paymentService from '../../../services/paymentService';\r\n\r\nexport const ReceiptModal = ({ isOpen, onClose, paymentId, studentData }) => {\r\n  const [receipt, setReceipt] = useState(null);\r\n  const [loading, setLoading] = useState(false);\r\n  const [error, setError] = useState('');\r\n  const printRef = useRef();\r\n\r\n  useEffect(() => {\r\n    if (isOpen && paymentId) {\r\n      loadReceiptData();\r\n    }\r\n  }, [isOpen, paymentId]);\r\n\r\n  const loadReceiptData = async () => {\r\n    setLoading(true);\r\n    setError('');\r\n    try {\r\n      const receiptData = await paymentService.generateReceipt(paymentId);\r\n      setReceipt(receiptData);\r\n    } catch (err) {\r\n      setError('Erreur lors du chargement du re√ßu');\r\n      console.error('Erreur chargement re√ßu:', err);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const handlePrint = () => {\r\n    if (printRef.current) {\r\n      // Sanitize le contenu HTML pour pr√©venir les attaques XSS\r\n      const sanitizedContent = DOMPurify.sanitize(printRef.current.innerHTML, {\r\n        ALLOWED_TAGS: [\r\n          'div', 'span', 'p', 'h1', 'h2', 'h3', 'h4', 'table', 'thead', 'tbody',\r\n          'tr', 'th', 'td', 'strong', 'em', 'br', 'ul', 'ol', 'li', 'hr'\r\n        ],\r\n        ALLOWED_ATTR: ['class']\r\n      });\r\n\r\n      const printWindow = window.open('', '_blank');\r\n      printWindow.document.write(`\r\n        <!DOCTYPE html>\r\n        <html>\r\n          <head>\r\n            <title>Re√ßu de Paiement</title>\r\n            <style>\r\n              * { margin: 0; padding: 0; box-sizing: border-box; }\r\n              body { font-family: Arial, sans-serif; padding: 20px; }\r\n              @media print { body { padding: 0; } }\r\n            </style>\r\n          </head>\r\n          <body>\r\n            ${sanitizedContent}\r\n          </body>\r\n        </html>\r\n      `);\r\n      printWindow.document.close();\r\n      printWindow.focus();\r\n      setTimeout(() => {\r\n        printWindow.print();\r\n        printWindow.close();\r\n      }, 250);\r\n    }\r\n  };\r\n\r\n  const handleDownload = () => {\r\n    if (receipt) {\r\n      // Sanitize le contenu HTML avant t√©l√©chargement\r\n      const sanitizedContent = DOMPurify.sanitize(printRef.current.innerHTML, {\r\n        ALLOWED_TAGS: [\r\n          'div', 'span', 'p', 'h1', 'h2', 'h3', 'h4', 'table', 'thead', 'tbody',\r\n          'tr', 'th', 'td', 'strong', 'em', 'br', 'ul', 'ol', 'li', 'hr'\r\n        ],\r\n        ALLOWED_ATTR: ['class']\r\n      });\r\n\r\n      const blob = new Blob([sanitizedContent], { type: 'text/html' });\r\n      const url = URL.createObjectURL(blob);\r\n\r\n      const a = document.createElement('a');\r\n      a.href = url;\r\n      a.download = `recu_${DOMPurify.sanitize(receipt.receiptNumber)}.html`;\r\n      document.body.appendChild(a);\r\n      a.click();\r\n      document.body.removeChild(a);\r\n      URL.revokeObjectURL(url);\r\n    }\r\n  };\r\n\r\n  const formatCurrency = (amount) => {\r\n    return new Intl.NumberFormat('fr-FR', {\r\n      style: 'currency',\r\n      currency: 'XAF',\r\n      minimumFractionDigits: 0\r\n    }).format(amount);\r\n  };\r\n\r\n  const formatDate = (dateString) => {\r\n    return new Date(dateString).toLocaleDateString('fr-FR', {\r\n      day: '2-digit',\r\n      month: '2-digit',\r\n      year: 'numeric',\r\n      hour: '2-digit',\r\n      minute: '2-digit'\r\n    });\r\n  };\r\n\r\n  if (!isOpen) return null;\r\n\r\n  return (\r\n    <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4\">\r\n      <div className=\"bg-white rounded-lg shadow-xl w-full max-w-4xl max-h-[90vh] overflow-hidden\">\r\n        {/* Header */}\r\n        <div className=\"flex items-center justify-between p-6 border-b\">\r\n          <h2 className=\"text-xl font-semibold text-gray-900 flex items-center gap-2\">\r\n            <Eye className=\"w-5 h-5\" />\r\n            Re√ßu de Paiement\r\n          </h2>\r\n          <div className=\"flex items-center gap-2\">\r\n            {receipt && (\r\n              <>\r\n                <Button\r\n                  variant=\"outline\"\r\n                  size=\"sm\"\r\n                  onClick={handleDownload}\r\n                  className=\"flex items-center gap-2\"\r\n                >\r\n                  <Download className=\"w-4 h-4\" />\r\n                  T√©l√©charger\r\n                </Button>\r\n                <Button\r\n                  variant=\"outline\"\r\n                  size=\"sm\"\r\n                  onClick={handlePrint}\r\n                  className=\"flex items-center gap-2\"\r\n                >\r\n                  <Printer className=\"w-4 h-4\" />\r\n                  Imprimer\r\n                </Button>\r\n              </>\r\n            )}\r\n            <button\r\n              onClick={onClose}\r\n              className=\"text-gray-400 hover:text-gray-600 transition-colors\"\r\n            >\r\n              <X className=\"w-6 h-6\" />\r\n            </button>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Content */}\r\n        <div className=\"p-6 overflow-y-auto max-h-[calc(90vh-120px)]\">\r\n          {loading && (\r\n            <div className=\"flex items-center justify-center py-12\">\r\n              <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600\"></div>\r\n              <span className=\"ml-2 text-gray-600\">Chargement du re√ßu...</span>\r\n            </div>\r\n          )}\r\n\r\n          {error && (\r\n            <div className=\"bg-red-50 border border-red-200 rounded-lg p-4 mb-4\">\r\n              <p className=\"text-red-600\">{error}</p>\r\n            </div>\r\n          )}\r\n\r\n          {receipt && (\r\n            <div ref={printRef} className=\"bg-white\">\r\n              {/* Receipt Header */}\r\n              <div className=\"text-center mb-8 border-b pb-6\">\r\n                <h1 className=\"text-2xl font-bold text-gray-900 mb-2\">\r\n                  √âTABLISSEMENT SCOLAIRE\r\n                </h1>\r\n                <p className=\"text-gray-600\">EduTrack-CM - Syst√®me de Gestion Scolaire</p>\r\n                <p className=\"text-sm text-gray-500 mt-2\">\r\n                  Adresse de l'√©tablissement ‚Ä¢ T√©l√©phone ‚Ä¢ Email\r\n                </p>\r\n              </div>\r\n\r\n              {/* Receipt Info */}\r\n              <div className=\"grid grid-cols-2 gap-8 mb-8\">\r\n                <div>\r\n                  <h3 className=\"font-semibold text-gray-900 mb-3\">Informations du Re√ßu</h3>\r\n                  <div className=\"space-y-2 text-sm\">\r\n                    <div className=\"flex justify-between\">\r\n                      <span className=\"text-gray-600\">N¬∞ Re√ßu:</span>\r\n                      <span className=\"font-medium\">{receipt.receiptNumber}</span>\r\n                    </div>\r\n                    <div className=\"flex justify-between\">\r\n                      <span className=\"text-gray-600\">Date:</span>\r\n                      <span className=\"font-medium\">{formatDate(receipt.date)}</span>\r\n                    </div>\r\n                    <div className=\"flex justify-between\">\r\n                      <span className=\"text-gray-600\">Re√ßu par:</span>\r\n                      <span className=\"font-medium\">{receipt.receivedBy}</span>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n\r\n                <div>\r\n                  <h3 className=\"font-semibold text-gray-900 mb-3\">Informations √âl√®ve</h3>\r\n                  <div className=\"space-y-2 text-sm\">\r\n                    <div className=\"flex justify-between\">\r\n                      <span className=\"text-gray-600\">Nom:</span>\r\n                      <span className=\"font-medium\">{receipt.student.firstName} {receipt.student.lastName}</span>\r\n                    </div>\r\n                    <div className=\"flex justify-between\">\r\n                      <span className=\"text-gray-600\">Matricule:</span>\r\n                      <span className=\"font-medium\">{receipt.student.studentId}</span>\r\n                    </div>\r\n                    <div className=\"flex justify-between\">\r\n                      <span className=\"text-gray-600\">Classe:</span>\r\n                      <span className=\"font-medium\">{receipt.student.class}</span>\r\n                    </div>\r\n                    <div className=\"flex justify-between\">\r\n                      <span className=\"text-gray-600\">Parent:</span>\r\n                      <span className=\"font-medium\">{receipt.student.parentName}</span>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n\r\n              {/* Payment Details */}\r\n              <div className=\"mb-8\">\r\n                <h3 className=\"font-semibold text-gray-900 mb-4\">D√©tails du Paiement</h3>\r\n                <div className=\"bg-gray-50 rounded-lg p-4\">\r\n                  <div className=\"grid grid-cols-2 gap-4 mb-4\">\r\n                    <div>\r\n                      <span className=\"text-sm text-gray-600\">Type de frais:</span>\r\n                      <p className=\"font-medium\">{receipt.payment.feeType}</p>\r\n                    </div>\r\n                    <div>\r\n                      <span className=\"text-sm text-gray-600\">P√©riode:</span>\r\n                      <p className=\"font-medium\">{receipt.payment.period}</p>\r\n                    </div>\r\n                    <div>\r\n                      <span className=\"text-sm text-gray-600\">Mode de paiement:</span>\r\n                      <p className=\"font-medium\">{receipt.payment.paymentMethod}</p>\r\n                    </div>\r\n                    <div>\r\n                      <span className=\"text-sm text-gray-600\">R√©f√©rence:</span>\r\n                      <p className=\"font-medium\">{receipt.payment.reference || 'N/A'}</p>\r\n                    </div>\r\n                  </div>\r\n\r\n                  {receipt.payment.description && (\r\n                    <div className=\"mb-4\">\r\n                      <span className=\"text-sm text-gray-600\">Description:</span>\r\n                      <p className=\"font-medium\">{receipt.payment.description}</p>\r\n                    </div>\r\n                  )}\r\n                </div>\r\n              </div>\r\n\r\n              {/* Amount Breakdown */}\r\n              <div className=\"mb-8\">\r\n                <h3 className=\"font-semibold text-gray-900 mb-4\">D√©tail des Montants</h3>\r\n                <div className=\"border rounded-lg overflow-hidden\">\r\n                  <table className=\"w-full\">\r\n                    <thead className=\"bg-gray-50\">\r\n                      <tr>\r\n                        <th className=\"px-4 py-3 text-left text-sm font-medium text-gray-700\">\r\n                          Description\r\n                        </th>\r\n                        <th className=\"px-4 py-3 text-right text-sm font-medium text-gray-700\">\r\n                          Montant\r\n                        </th>\r\n                      </tr>\r\n                    </thead>\r\n                    <tbody className=\"divide-y divide-gray-200\">\r\n                      <tr>\r\n                        <td className=\"px-4 py-3 text-sm\">Montant d√ª</td>\r\n                        <td className=\"px-4 py-3 text-sm text-right\">\r\n                          {formatCurrency(receipt.payment.totalAmount)}\r\n                        </td>\r\n                      </tr>\r\n                      <tr>\r\n                        <td className=\"px-4 py-3 text-sm\">Montant pay√©</td>\r\n                        <td className=\"px-4 py-3 text-sm text-right font-medium text-green-600\">\r\n                          {formatCurrency(receipt.payment.amountPaid)}\r\n                        </td>\r\n                      </tr>\r\n                      <tr className=\"bg-gray-50\">\r\n                        <td className=\"px-4 py-3 text-sm font-medium\">Solde restant</td>\r\n                        <td className=\"px-4 py-3 text-sm text-right font-medium\">\r\n                          {formatCurrency(receipt.payment.remainingBalance)}\r\n                        </td>\r\n                      </tr>\r\n                    </tbody>\r\n                  </table>\r\n                </div>\r\n              </div>\r\n\r\n              {/* Payment Status */}\r\n              <div className=\"mb-8\">\r\n                <div className=\"bg-green-50 border border-green-200 rounded-lg p-4\">\r\n                  <div className=\"flex items-center justify-between\">\r\n                    <div>\r\n                      <h4 className=\"font-medium text-green-800\">Statut du Paiement</h4>\r\n                      <p className=\"text-sm text-green-600 mt-1\">\r\n                        {receipt.payment.status === 'completed' \r\n                          ? 'Paiement complet' \r\n                          : 'Paiement partiel'}\r\n                      </p>\r\n                    </div>\r\n                    <div className=\"text-2xl font-bold text-green-600\">\r\n                      {formatCurrency(receipt.payment.amountPaid)}\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n\r\n              {/* Footer */}\r\n              <div className=\"border-t pt-6 mt-8\">\r\n                <div className=\"grid grid-cols-2 gap-8\">\r\n                  <div>\r\n                    <p className=\"text-sm text-gray-600 mb-2\">Signature de l'√©l√®ve/Parent:</p>\r\n                    <div className=\"border-b border-gray-300 h-12\"></div>\r\n                  </div>\r\n                  <div>\r\n                    <p className=\"text-sm text-gray-600 mb-2\">Signature du Secr√©taire:</p>\r\n                    <div className=\"border-b border-gray-300 h-12\"></div>\r\n                  </div>\r\n                </div>\r\n                \r\n                <div className=\"mt-6 text-center\">\r\n                  <p className=\"text-xs text-gray-500\">\r\n                    Ce re√ßu est g√©n√©r√© automatiquement par EduTrack-CM ‚Ä¢ \r\n                    Conservez ce re√ßu comme preuve de paiement\r\n                  </p>\r\n                  <p className=\"text-xs text-gray-400 mt-1\">\r\n                    G√©n√©r√© le {formatDate(new Date().toISOString())}\r\n                  </p>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          )}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ReceiptModal;","import React, { useState, useEffect } from 'react';\r\nimport { X, Calendar, Receipt, Search, Filter, Download, Eye } from 'lucide-react';\r\nimport Button from '../../../components/ui/Button';\r\nimport Input from '../../../components/ui/Input';\r\nimport Select from '../../../components/ui/Select';\r\nimport paymentService from '../../../services/paymentService';\r\n\r\nexport const PaymentHistoryModal = ({ isOpen, onClose, studentId, studentName, onViewReceipt }) => {\r\n  const [payments, setPayments] = useState([]);\r\n  const [filteredPayments, setFilteredPayments] = useState([]);\r\n  const [loading, setLoading] = useState(false);\r\n  const [error, setError] = useState('');\r\n  const [summary, setSummary] = useState({\r\n    total: 0,\r\n    paid: 0,\r\n    pending: 0,\r\n    overdue: 0\r\n  });\r\n\r\n  // Filtres\r\n  const [filters, setFilters] = useState({\r\n    period: '',\r\n    feeType: '',\r\n    status: '',\r\n    dateFrom: '',\r\n    dateTo: '',\r\n    searchTerm: ''\r\n  });\r\n\r\n  const [showFilters, setShowFilters] = useState(false);\r\n\r\n  useEffect(() => {\r\n    if (isOpen && studentId) {\r\n      loadPaymentHistory();\r\n    }\r\n  }, [isOpen, studentId]);\r\n\r\n  useEffect(() => {\r\n    applyFilters();\r\n  }, [payments, filters]);\r\n\r\n  const loadPaymentHistory = async () => {\r\n    setLoading(true);\r\n    setError('');\r\n    try {\r\n      const historyData = await paymentService.getPaymentHistory(studentId);\r\n      setPayments(historyData.payments || []);\r\n      setSummary(historyData.summary || summary);\r\n    } catch (err) {\r\n      setError('Erreur lors du chargement de l\\'historique');\r\n      console.error('Erreur chargement historique:', err);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const applyFilters = () => {\r\n    let filtered = [...payments];\r\n\r\n    // Filtre par p√©riode\r\n    if (filters.period) {\r\n      filtered = filtered.filter(payment => payment.period === filters.period);\r\n    }\r\n\r\n    // Filtre par type de frais\r\n    if (filters.feeType) {\r\n      filtered = filtered.filter(payment => payment.feeType === filters.feeType);\r\n    }\r\n\r\n    // Filtre par statut\r\n    if (filters.status) {\r\n      filtered = filtered.filter(payment => payment.status === filters.status);\r\n    }\r\n\r\n    // Filtre par date\r\n    if (filters.dateFrom) {\r\n      filtered = filtered.filter(payment => \r\n        new Date(payment.dueDate) >= new Date(filters.dateFrom)\r\n      );\r\n    }\r\n\r\n    if (filters.dateTo) {\r\n      filtered = filtered.filter(payment => \r\n        new Date(payment.dueDate) <= new Date(filters.dateTo)\r\n      );\r\n    }\r\n\r\n    // Filtre par terme de recherche\r\n    if (filters.searchTerm) {\r\n      const term = filters.searchTerm.toLowerCase();\r\n      filtered = filtered.filter(payment =>\r\n        payment.feeType.toLowerCase().includes(term) ||\r\n        payment.description?.toLowerCase().includes(term) ||\r\n        payment.reference?.toLowerCase().includes(term)\r\n      );\r\n    }\r\n\r\n    setFilteredPayments(filtered);\r\n  };\r\n\r\n  const handleFilterChange = (key, value) => {\r\n    setFilters(prev => ({\r\n      ...prev,\r\n      [key]: value\r\n    }));\r\n  };\r\n\r\n  const clearFilters = () => {\r\n    setFilters({\r\n      period: '',\r\n      feeType: '',\r\n      status: '',\r\n      dateFrom: '',\r\n      dateTo: '',\r\n      searchTerm: ''\r\n    });\r\n  };\r\n\r\n  const exportHistory = () => {\r\n    const csvContent = [\r\n      ['Date', 'Type de frais', 'P√©riode', 'Montant d√ª', 'Montant pay√©', 'Solde', 'Statut', 'Date de paiement'].join(','),\r\n      ...filteredPayments.map(payment => [\r\n        formatDate(payment.dueDate),\r\n        payment.feeType,\r\n        payment.period,\r\n        payment.totalAmount,\r\n        payment.amountPaid || 0,\r\n        payment.remainingBalance,\r\n        getStatusText(payment.status),\r\n        payment.paymentDate ? formatDate(payment.paymentDate) : 'Non pay√©'\r\n      ].join(','))\r\n    ].join('\\n');\r\n\r\n    const blob = new Blob([csvContent], { type: 'text/csv' });\r\n    const url = URL.createObjectURL(blob);\r\n    const a = document.createElement('a');\r\n    a.href = url;\r\n    a.download = `historique_paiements_${studentName.replace(/\\s+/g, '_')}.csv`;\r\n    document.body.appendChild(a);\r\n    a.click();\r\n    document.body.removeChild(a);\r\n    URL.revokeObjectURL(url);\r\n  };\r\n\r\n  const formatCurrency = (amount) => {\r\n    return new Intl.NumberFormat('fr-FR', {\r\n      style: 'currency',\r\n      currency: 'XAF',\r\n      minimumFractionDigits: 0\r\n    }).format(amount);\r\n  };\r\n\r\n  const formatDate = (dateString) => {\r\n    return new Date(dateString).toLocaleDateString('fr-FR');\r\n  };\r\n\r\n  const getStatusText = (status) => {\r\n    const statusMap = {\r\n      'pending': 'En attente',\r\n      'partial': 'Partiel',\r\n      'completed': 'Pay√©',\r\n      'overdue': 'En retard'\r\n    };\r\n    return statusMap[status] || status;\r\n  };\r\n\r\n  const getStatusColor = (status) => {\r\n    const colorMap = {\r\n      'pending': 'bg-yellow-100 text-yellow-800',\r\n      'partial': 'bg-blue-100 text-blue-800',\r\n      'completed': 'bg-green-100 text-green-800',\r\n      'overdue': 'bg-red-100 text-red-800'\r\n    };\r\n    return colorMap[status] || 'bg-gray-100 text-gray-800';\r\n  };\r\n\r\n  if (!isOpen) return null;\r\n\r\n  return (\r\n    <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4\">\r\n      <div className=\"bg-white rounded-lg shadow-xl w-full max-w-6xl max-h-[90vh] overflow-hidden\">\r\n        {/* Header */}\r\n        <div className=\"flex items-center justify-between p-6 border-b\">\r\n          <div>\r\n            <h2 className=\"text-xl font-semibold text-gray-900 flex items-center gap-2\">\r\n              <Calendar className=\"w-5 h-5\" />\r\n              Historique des Paiements\r\n            </h2>\r\n            <p className=\"text-sm text-gray-600 mt-1\">\r\n              √âl√®ve: <span className=\"font-medium\">{studentName}</span>\r\n            </p>\r\n          </div>\r\n          <div className=\"flex items-center gap-2\">\r\n            <Button\r\n              variant=\"outline\"\r\n              size=\"sm\"\r\n              onClick={() => setShowFilters(!showFilters)}\r\n              className=\"flex items-center gap-2\"\r\n            >\r\n              <Filter className=\"w-4 h-4\" />\r\n              Filtres\r\n            </Button>\r\n            <Button\r\n              variant=\"outline\"\r\n              size=\"sm\"\r\n              onClick={exportHistory}\r\n              className=\"flex items-center gap-2\"\r\n            >\r\n              <Download className=\"w-4 h-4\" />\r\n              Exporter\r\n            </Button>\r\n            <button\r\n              onClick={onClose}\r\n              className=\"text-gray-400 hover:text-gray-600 transition-colors\"\r\n            >\r\n              <X className=\"w-6 h-6\" />\r\n            </button>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Summary Cards */}\r\n        <div className=\"p-6 bg-gray-50 border-b\">\r\n          <div className=\"grid grid-cols-4 gap-4\">\r\n            <div className=\"bg-white rounded-lg p-4 text-center\">\r\n              <p className=\"text-sm text-gray-600\">Total d√ª</p>\r\n              <p className=\"text-xl font-bold text-gray-900\">{formatCurrency(summary.total)}</p>\r\n            </div>\r\n            <div className=\"bg-white rounded-lg p-4 text-center\">\r\n              <p className=\"text-sm text-gray-600\">Pay√©</p>\r\n              <p className=\"text-xl font-bold text-green-600\">{formatCurrency(summary.paid)}</p>\r\n            </div>\r\n            <div className=\"bg-white rounded-lg p-4 text-center\">\r\n              <p className=\"text-sm text-gray-600\">En attente</p>\r\n              <p className=\"text-xl font-bold text-yellow-600\">{formatCurrency(summary.pending)}</p>\r\n            </div>\r\n            <div className=\"bg-white rounded-lg p-4 text-center\">\r\n              <p className=\"text-sm text-gray-600\">En retard</p>\r\n              <p className=\"text-xl font-bold text-red-600\">{formatCurrency(summary.overdue)}</p>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Filters */}\r\n        {showFilters && (\r\n          <div className=\"p-6 bg-gray-50 border-b\">\r\n            <div className=\"grid grid-cols-3 gap-4 mb-4\">\r\n              <div>\r\n                <label className=\"block text-sm font-medium text-gray-700 mb-1\">\r\n                  Rechercher\r\n                </label>\r\n                <div className=\"relative\">\r\n                  <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4\" />\r\n                  <Input\r\n                    type=\"text\"\r\n                    placeholder=\"Type de frais, description...\"\r\n                    value={filters.searchTerm}\r\n                    onChange={(e) => handleFilterChange('searchTerm', e.target.value)}\r\n                    className=\"pl-10\"\r\n                  />\r\n                </div>\r\n              </div>\r\n              <div>\r\n                <label className=\"block text-sm font-medium text-gray-700 mb-1\">\r\n                  P√©riode\r\n                </label>\r\n                <Select\r\n                  value={filters.period}\r\n                  onChange={(e) => handleFilterChange('period', e.target.value)}\r\n                >\r\n                  <option value=\"\">Toutes les p√©riodes</option>\r\n                  <option value=\"2024-2025\">2024-2025</option>\r\n                  <option value=\"Trimestre 1\">Trimestre 1</option>\r\n                  <option value=\"Trimestre 2\">Trimestre 2</option>\r\n                  <option value=\"Trimestre 3\">Trimestre 3</option>\r\n                </Select>\r\n              </div>\r\n              <div>\r\n                <label className=\"block text-sm font-medium text-gray-700 mb-1\">\r\n                  Type de frais\r\n                </label>\r\n                <Select\r\n                  value={filters.feeType}\r\n                  onChange={(e) => handleFilterChange('feeType', e.target.value)}\r\n                >\r\n                  <option value=\"\">Tous les types</option>\r\n                  <option value=\"Frais de scolarit√©\">Frais de scolarit√©</option>\r\n                  <option value=\"Frais d'inscription\">Frais d'inscription</option>\r\n                  <option value=\"Frais d'examen\">Frais d'examen</option>\r\n                  <option value=\"Frais d'activit√©s\">Frais d'activit√©s</option>\r\n                  <option value=\"Frais de transport\">Frais de transport</option>\r\n                </Select>\r\n              </div>\r\n            </div>\r\n            <div className=\"grid grid-cols-4 gap-4\">\r\n              <div>\r\n                <label className=\"block text-sm font-medium text-gray-700 mb-1\">\r\n                  Statut\r\n                </label>\r\n                <Select\r\n                  value={filters.status}\r\n                  onChange={(e) => handleFilterChange('status', e.target.value)}\r\n                >\r\n                  <option value=\"\">Tous les statuts</option>\r\n                  <option value=\"pending\">En attente</option>\r\n                  <option value=\"partial\">Partiel</option>\r\n                  <option value=\"completed\">Pay√©</option>\r\n                  <option value=\"overdue\">En retard</option>\r\n                </Select>\r\n              </div>\r\n              <div>\r\n                <label className=\"block text-sm font-medium text-gray-700 mb-1\">\r\n                  Date d√©but\r\n                </label>\r\n                <Input\r\n                  type=\"date\"\r\n                  value={filters.dateFrom}\r\n                  onChange={(e) => handleFilterChange('dateFrom', e.target.value)}\r\n                />\r\n              </div>\r\n              <div>\r\n                <label className=\"block text-sm font-medium text-gray-700 mb-1\">\r\n                  Date fin\r\n                </label>\r\n                <Input\r\n                  type=\"date\"\r\n                  value={filters.dateTo}\r\n                  onChange={(e) => handleFilterChange('dateTo', e.target.value)}\r\n                />\r\n              </div>\r\n              <div className=\"flex items-end\">\r\n                <Button\r\n                  variant=\"outline\"\r\n                  onClick={clearFilters}\r\n                  className=\"w-full\"\r\n                >\r\n                  Effacer filtres\r\n                </Button>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        {/* Content */}\r\n        <div className=\"flex-1 overflow-y-auto p-6\">\r\n          {loading && (\r\n            <div className=\"flex items-center justify-center py-12\">\r\n              <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600\"></div>\r\n              <span className=\"ml-2 text-gray-600\">Chargement de l'historique...</span>\r\n            </div>\r\n          )}\r\n\r\n          {error && (\r\n            <div className=\"bg-red-50 border border-red-200 rounded-lg p-4 mb-4\">\r\n              <p className=\"text-red-600\">{error}</p>\r\n            </div>\r\n          )}\r\n\r\n          {!loading && !error && (\r\n            <>\r\n              <div className=\"mb-4 flex items-center justify-between\">\r\n                <p className=\"text-sm text-gray-600\">\r\n                  {filteredPayments.length} paiement(s) trouv√©(s)\r\n                </p>\r\n              </div>\r\n\r\n              {filteredPayments.length === 0 ? (\r\n                <div className=\"text-center py-12\">\r\n                  <Calendar className=\"w-12 h-12 text-gray-400 mx-auto mb-4\" />\r\n                  <p className=\"text-gray-600\">Aucun paiement trouv√©</p>\r\n                </div>\r\n              ) : (\r\n                <div className=\"bg-white rounded-lg border overflow-hidden\">\r\n                  <div className=\"overflow-x-auto\">\r\n                    <table className=\"w-full\">\r\n                      <thead className=\"bg-gray-50\">\r\n                        <tr>\r\n                          <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\r\n                            Date d'√©ch√©ance\r\n                          </th>\r\n                          <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\r\n                            Type de frais\r\n                          </th>\r\n                          <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\r\n                            P√©riode\r\n                          </th>\r\n                          <th className=\"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider\">\r\n                            Montant d√ª\r\n                          </th>\r\n                          <th className=\"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider\">\r\n                            Montant pay√©\r\n                          </th>\r\n                          <th className=\"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider\">\r\n                            Solde\r\n                          </th>\r\n                          <th className=\"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider\">\r\n                            Statut\r\n                          </th>\r\n                          <th className=\"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider\">\r\n                            Actions\r\n                          </th>\r\n                        </tr>\r\n                      </thead>\r\n                      <tbody className=\"bg-white divide-y divide-gray-200\">\r\n                        {filteredPayments.map((payment) => (\r\n                          <tr key={payment.id} className=\"hover:bg-gray-50\">\r\n                            <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-900\">\r\n                              {formatDate(payment.dueDate)}\r\n                            </td>\r\n                            <td className=\"px-6 py-4 whitespace-nowrap\">\r\n                              <div>\r\n                                <div className=\"text-sm font-medium text-gray-900\">\r\n                                  {payment.feeType}\r\n                                </div>\r\n                                {payment.description && (\r\n                                  <div className=\"text-sm text-gray-500\">\r\n                                    {payment.description}\r\n                                  </div>\r\n                                )}\r\n                              </div>\r\n                            </td>\r\n                            <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-900\">\r\n                              {payment.period}\r\n                            </td>\r\n                            <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-900 text-right\">\r\n                              {formatCurrency(payment.totalAmount)}\r\n                            </td>\r\n                            <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-900 text-right\">\r\n                              {formatCurrency(payment.amountPaid || 0)}\r\n                            </td>\r\n                            <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-900 text-right\">\r\n                              {formatCurrency(payment.remainingBalance)}\r\n                            </td>\r\n                            <td className=\"px-6 py-4 whitespace-nowrap text-center\">\r\n                              <span className={`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${getStatusColor(payment.status)}`}>\r\n                                {getStatusText(payment.status)}\r\n                              </span>\r\n                            </td>\r\n                            <td className=\"px-6 py-4 whitespace-nowrap text-center text-sm font-medium\">\r\n                              <div className=\"flex items-center justify-center gap-2\">\r\n                                {payment.status !== 'pending' && payment.receiptId && (\r\n                                  <button\r\n                                    onClick={() => onViewReceipt(payment.receiptId)}\r\n                                    className=\"text-blue-600 hover:text-blue-900 transition-colors\"\r\n                                    title=\"Voir le re√ßu\"\r\n                                  >\r\n                                    <Receipt className=\"w-4 h-4\" />\r\n                                  </button>\r\n                                )}\r\n                              </div>\r\n                            </td>\r\n                          </tr>\r\n                        ))}\r\n                      </tbody>\r\n                    </table>\r\n                  </div>\r\n                </div>\r\n              )}\r\n            </>\r\n          )}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default PaymentHistoryModal;","import React, { useState, useEffect } from 'react';\r\nimport { X, Calendar, ChevronLeft, ChevronRight, Clock, AlertTriangle, CheckCircle } from 'lucide-react';\r\nimport Button from '../../../components/ui/Button';\r\nimport paymentService from '../../../services/paymentService';\r\n\r\nexport const PaymentCalendarModal = ({ isOpen, onClose }) => {\r\n  const [currentDate, setCurrentDate] = useState(new Date());\r\n  const [payments, setPayments] = useState([]);\r\n  const [loading, setLoading] = useState(false);\r\n  const [selectedDate, setSelectedDate] = useState(null);\r\n  const [viewMode, setViewMode] = useState('month'); // 'month' ou 'week'\r\n\r\n  useEffect(() => {\r\n    if (isOpen) {\r\n      loadPayments();\r\n    }\r\n  }, [isOpen, currentDate]);\r\n\r\n  const loadPayments = async () => {\r\n    setLoading(true);\r\n    try {\r\n      const data = await paymentService.getAllPayments();\r\n      setPayments(data.payments || []);\r\n    } catch (err) {\r\n      console.error('Erreur chargement paiements:', err);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const getDaysInMonth = (date) => {\r\n    const year = date.getFullYear();\r\n    const month = date.getMonth();\r\n    const firstDay = new Date(year, month, 1);\r\n    const lastDay = new Date(year, month + 1, 0);\r\n    const daysInMonth = lastDay.getDate();\r\n    const startDate = new Date(firstDay);\r\n    startDate.setDate(startDate.getDate() - firstDay.getDay());\r\n\r\n    const days = [];\r\n    for (let i = 0; i < 42; i++) {\r\n      const day = new Date(startDate);\r\n      day.setDate(startDate.getDate() + i);\r\n      days.push(day);\r\n    }\r\n    return days;\r\n  };\r\n\r\n  const getPaymentsForDate = (date) => {\r\n    const dateStr = date.toISOString().split('T')[0];\r\n    return payments.filter(payment => {\r\n      const paymentDate = new Date(payment.dueDate).toISOString().split('T')[0];\r\n      return paymentDate === dateStr;\r\n    });\r\n  };\r\n\r\n  const getStatusColor = (status) => {\r\n    const colors = {\r\n      completed: 'bg-green-100 text-green-800 border-green-200',\r\n      pending: 'bg-yellow-100 text-yellow-800 border-yellow-200',\r\n      overdue: 'bg-red-100 text-red-800 border-red-200',\r\n      partial: 'bg-blue-100 text-blue-800 border-blue-200'\r\n    };\r\n    return colors[status] || colors.pending;\r\n  };\r\n\r\n  const getStatusIcon = (status) => {\r\n    const icons = {\r\n      completed: CheckCircle,\r\n      pending: Clock,\r\n      overdue: AlertTriangle,\r\n      partial: Clock\r\n    };\r\n    const Icon = icons[status] || Clock;\r\n    return <Icon className=\"w-3 h-3\" />;\r\n  };\r\n\r\n  const formatCurrency = (amount) => {\r\n    return new Intl.NumberFormat('fr-FR', {\r\n      style: 'currency',\r\n      currency: 'XAF',\r\n      minimumFractionDigits: 0\r\n    }).format(amount);\r\n  };\r\n\r\n  const navigateMonth = (direction) => {\r\n    const newDate = new Date(currentDate);\r\n    newDate.setMonth(currentDate.getMonth() + direction);\r\n    setCurrentDate(newDate);\r\n  };\r\n\r\n  const monthNames = [\r\n    'Janvier', 'F√©vrier', 'Mars', 'Avril', 'Mai', 'Juin',\r\n    'Juillet', 'Ao√ªt', 'Septembre', 'Octobre', 'Novembre', 'D√©cembre'\r\n  ];\r\n\r\n  const dayNames = ['Dim', 'Lun', 'Mar', 'Mer', 'Jeu', 'Ven', 'Sam'];\r\n\r\n  if (!isOpen) return null;\r\n\r\n  const days = getDaysInMonth(currentDate);\r\n  const today = new Date();\r\n  today.setHours(0, 0, 0, 0);\r\n\r\n  return (\r\n    <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4\">\r\n      <div className=\"bg-white rounded-lg shadow-xl w-full max-w-6xl max-h-[90vh] overflow-hidden\">\r\n        {/* Header */}\r\n        <div className=\"flex items-center justify-between p-4 border-b\">\r\n          <div>\r\n            <h2 className=\"text-lg font-semibold text-gray-900 flex items-center gap-2\">\r\n              <Calendar className=\"w-5 h-5\" />\r\n              Calendrier des √âch√©ances de Paiement\r\n            </h2>\r\n            <p className=\"text-sm text-gray-600 mt-1\">\r\n              {monthNames[currentDate.getMonth()]} {currentDate.getFullYear()}\r\n            </p>\r\n          </div>\r\n          \r\n          <div className=\"flex items-center gap-2\">\r\n            <Button\r\n              variant=\"outline\"\r\n              size=\"sm\"\r\n              onClick={() => navigateMonth(-1)}\r\n              className=\"h-8 w-8 p-0\"\r\n            >\r\n              <ChevronLeft className=\"w-4 h-4\" />\r\n            </Button>\r\n            \r\n            <Button\r\n              variant=\"outline\"\r\n              size=\"sm\"\r\n              onClick={() => setCurrentDate(new Date())}\r\n            >\r\n              Aujourd'hui\r\n            </Button>\r\n            \r\n            <Button\r\n              variant=\"outline\"\r\n              size=\"sm\"\r\n              onClick={() => navigateMonth(1)}\r\n              className=\"h-8 w-8 p-0\"\r\n            >\r\n              <ChevronRight className=\"w-4 h-4\" />\r\n            </Button>\r\n\r\n            <button\r\n              onClick={onClose}\r\n              className=\"text-gray-400 hover:text-gray-600 transition-colors ml-2\"\r\n            >\r\n              <X className=\"w-6 h-6\" />\r\n            </button>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Calendar Content */}\r\n        <div className=\"flex flex-1 overflow-hidden\">\r\n          {/* Calendar Grid */}\r\n          <div className=\"flex-1 p-4\">\r\n            {loading && (\r\n              <div className=\"flex items-center justify-center py-12\">\r\n                <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600\"></div>\r\n                <span className=\"ml-2 text-gray-600\">Chargement du calendrier...</span>\r\n              </div>\r\n            )}\r\n\r\n            {!loading && (\r\n              <div className=\"grid grid-cols-7 gap-2\">\r\n                {/* Day Headers */}\r\n                {dayNames.map(day => (\r\n                  <div key={day} className=\"text-center font-medium text-gray-700 py-2 text-sm\">\r\n                    {day}\r\n                  </div>\r\n                ))}\r\n\r\n                {/* Calendar Days */}\r\n                {days.map((day, index) => {\r\n                  const isCurrentMonth = day.getMonth() === currentDate.getMonth();\r\n                  const isToday = day.getTime() === today.getTime();\r\n                  const dayPayments = getPaymentsForDate(day);\r\n                  const isSelected = selectedDate && day.getTime() === selectedDate.getTime();\r\n\r\n                  return (\r\n                    <div\r\n                      key={index}\r\n                      className={`\r\n                        min-h-[80px] p-1 border border-gray-200 cursor-pointer\r\n                        hover:bg-gray-50 transition-colors\r\n                        ${!isCurrentMonth ? 'bg-gray-50 text-gray-400' : 'bg-white'}\r\n                        ${isToday ? 'bg-blue-50 border-blue-300' : ''}\r\n                        ${isSelected ? 'ring-2 ring-blue-500' : ''}\r\n                      `}\r\n                      onClick={() => setSelectedDate(day)}\r\n                    >\r\n                      <div className={`\r\n                        text-sm font-medium mb-1\r\n                        ${isToday ? 'text-blue-600' : ''}\r\n                      `}>\r\n                        {day.getDate()}\r\n                      </div>\r\n                      \r\n                      <div className=\"space-y-1\">\r\n                        {dayPayments.slice(0, 3).map((payment, idx) => (\r\n                          <div\r\n                            key={idx}\r\n                            className={`\r\n                              text-xs p-1 rounded border\r\n                              ${getStatusColor(payment.status)}\r\n                              truncate\r\n                            `}\r\n                            title={`${payment.student.firstName} ${payment.student.lastName} - ${formatCurrency(payment.totalAmount)}`}\r\n                          >\r\n                            <div className=\"flex items-center gap-1\">\r\n                              {getStatusIcon(payment.status)}\r\n                              <span className=\"truncate\">\r\n                                {payment.student.firstName} {payment.student.lastName}\r\n                              </span>\r\n                            </div>\r\n                          </div>\r\n                        ))}\r\n                        \r\n                        {dayPayments.length > 3 && (\r\n                          <div className=\"text-xs text-gray-500 text-center\">\r\n                            +{dayPayments.length - 3} autres\r\n                          </div>\r\n                        )}\r\n                      </div>\r\n                    </div>\r\n                  );\r\n                })}\r\n              </div>\r\n            )}\r\n          </div>\r\n\r\n          {/* Sidebar Details */}\r\n          {selectedDate && (\r\n            <div className=\"w-80 border-l bg-gray-50 p-4 overflow-y-auto\">\r\n              <h3 className=\"font-medium text-gray-900 mb-3\">\r\n                Paiements du {selectedDate.toLocaleDateString('fr-FR', {\r\n                  weekday: 'long',\r\n                  day: 'numeric',\r\n                  month: 'long',\r\n                  year: 'numeric'\r\n                })}\r\n              </h3>\r\n\r\n              {(() => {\r\n                const dayPayments = getPaymentsForDate(selectedDate);\r\n                \r\n                if (dayPayments.length === 0) {\r\n                  return (\r\n                    <div className=\"text-center py-8\">\r\n                      <Calendar className=\"w-12 h-12 text-gray-400 mx-auto mb-2\" />\r\n                      <p className=\"text-gray-500 text-sm\">Aucun paiement pr√©vu</p>\r\n                    </div>\r\n                  );\r\n                }\r\n\r\n                return (\r\n                  <div className=\"space-y-3\">\r\n                    {dayPayments.map((payment) => (\r\n                      <div\r\n                        key={payment.id}\r\n                        className={`\r\n                          p-3 rounded-lg border\r\n                          ${getStatusColor(payment.status)}\r\n                        `}\r\n                      >\r\n                        <div className=\"flex items-start justify-between mb-2\">\r\n                          <div>\r\n                            <p className=\"font-medium text-sm\">\r\n                              {payment.student.firstName} {payment.student.lastName}\r\n                            </p>\r\n                            <p className=\"text-xs opacity-75\">\r\n                              {payment.student.class} ‚Ä¢ {payment.student.studentId}\r\n                            </p>\r\n                          </div>\r\n                          {getStatusIcon(payment.status)}\r\n                        </div>\r\n                        \r\n                        <div className=\"space-y-1 text-xs\">\r\n                          <div className=\"flex justify-between\">\r\n                            <span>Type:</span>\r\n                            <span className=\"font-medium\">{payment.feeType}</span>\r\n                          </div>\r\n                          <div className=\"flex justify-between\">\r\n                            <span>Montant:</span>\r\n                            <span className=\"font-medium\">{formatCurrency(payment.totalAmount)}</span>\r\n                          </div>\r\n                          {payment.amountPaid > 0 && (\r\n                            <div className=\"flex justify-between\">\r\n                              <span>Pay√©:</span>\r\n                              <span className=\"font-medium text-green-600\">\r\n                                {formatCurrency(payment.amountPaid)}\r\n                              </span>\r\n                            </div>\r\n                          )}\r\n                          <div className=\"flex justify-between\">\r\n                            <span>Statut:</span>\r\n                            <span className=\"font-medium\">\r\n                              {payment.status === 'completed' ? 'Pay√©' :\r\n                               payment.status === 'pending' ? 'En attente' :\r\n                               payment.status === 'overdue' ? 'En retard' : 'Partiel'}\r\n                            </span>\r\n                          </div>\r\n                        </div>\r\n\r\n                        <div className=\"mt-2 pt-2 border-t border-current border-opacity-20\">\r\n                          <p className=\"text-xs\">\r\n                            <span className=\"font-medium\">Parent:</span> {payment.student.parentName}\r\n                          </p>\r\n                          {payment.student.parentPhone && (\r\n                            <p className=\"text-xs\">\r\n                              <span className=\"font-medium\">T√©l:</span> {payment.student.parentPhone}\r\n                            </p>\r\n                          )}\r\n                        </div>\r\n                      </div>\r\n                    ))}\r\n                  </div>\r\n                );\r\n              })()}\r\n            </div>\r\n          )}\r\n        </div>\r\n\r\n        {/* Footer avec l√©gende */}\r\n        <div className=\"border-t p-4 bg-gray-50\">\r\n          <div className=\"flex items-center justify-between\">\r\n            <div className=\"flex items-center gap-4 text-xs\">\r\n              <div className=\"flex items-center gap-1\">\r\n                <div className=\"w-3 h-3 bg-green-100 border border-green-200 rounded\"></div>\r\n                <span>Pay√©</span>\r\n              </div>\r\n              <div className=\"flex items-center gap-1\">\r\n                <div className=\"w-3 h-3 bg-yellow-100 border border-yellow-200 rounded\"></div>\r\n                <span>En attente</span>\r\n              </div>\r\n              <div className=\"flex items-center gap-1\">\r\n                <div className=\"w-3 h-3 bg-red-100 border border-red-200 rounded\"></div>\r\n                <span>En retard</span>\r\n              </div>\r\n              <div className=\"flex items-center gap-1\">\r\n                <div className=\"w-3 h-3 bg-blue-100 border border-blue-200 rounded\"></div>\r\n                <span>Partiel</span>\r\n              </div>\r\n            </div>\r\n            \r\n            <div className=\"text-xs text-gray-500\">\r\n              Cliquez sur une date pour voir les d√©tails\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default PaymentCalendarModal;","import React, { useState, useEffect } from 'react';\r\nimport { X, BarChart3, TrendingUp, TrendingDown, DollarSign, Users, Calendar, Download } from 'lucide-react';\r\nimport Button from '../../../components/ui/Button';\r\nimport Select from '../../../components/ui/Select';\r\nimport paymentService from '../../../services/paymentService';\r\n\r\nexport const PaymentAnalyticsModal = ({ isOpen, onClose }) => {\r\n  const [payments, setPayments] = useState([]);\r\n  const [loading, setLoading] = useState(false);\r\n  const [analytics, setAnalytics] = useState(null);\r\n  const [period, setPeriod] = useState('month');\r\n  const [selectedClass, setSelectedClass] = useState('');\r\n\r\n  useEffect(() => {\r\n    if (isOpen) {\r\n      loadAnalytics();\r\n    }\r\n  }, [isOpen, period, selectedClass]);\r\n\r\n  const loadAnalytics = async () => {\r\n    setLoading(true);\r\n    try {\r\n      const data = await paymentService.getAllPayments();\r\n      setPayments(data.payments || []);\r\n      calculateAnalytics(data.payments || []);\r\n    } catch (err) {\r\n      console.error('Erreur chargement analytics:', err);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const calculateAnalytics = (paymentsData) => {\r\n    const filteredPayments = selectedClass \r\n      ? paymentsData.filter(p => p.student?.class === selectedClass)\r\n      : paymentsData;\r\n\r\n    const now = new Date();\r\n    const periodDate = new Date();\r\n    \r\n    switch(period) {\r\n      case 'week':\r\n        periodDate.setDate(now.getDate() - 7);\r\n        break;\r\n      case 'month':\r\n        periodDate.setMonth(now.getMonth() - 1);\r\n        break;\r\n      case 'quarter':\r\n        periodDate.setMonth(now.getMonth() - 3);\r\n        break;\r\n      case 'year':\r\n        periodDate.setFullYear(now.getFullYear() - 1);\r\n        break;\r\n      default:\r\n        periodDate.setMonth(now.getMonth() - 1);\r\n    }\r\n\r\n    const periodPayments = filteredPayments.filter(p => \r\n      new Date(p.dueDate) >= periodDate\r\n    );\r\n\r\n    // Calculs des m√©triques\r\n    const totalAmount = periodPayments.reduce((sum, p) => sum + p.totalAmount, 0);\r\n    const totalPaid = periodPayments.reduce((sum, p) => sum + (p.amountPaid || 0), 0);\r\n    const totalOutstanding = totalAmount - totalPaid;\r\n    \r\n    const completedPayments = periodPayments.filter(p => p.status === 'completed').length;\r\n    const pendingPayments = periodPayments.filter(p => p.status === 'pending').length;\r\n    const overduePayments = periodPayments.filter(p => p.status === 'overdue').length;\r\n    const partialPayments = periodPayments.filter(p => p.status === 'partial').length;\r\n\r\n    // Analyse par m√©thode de paiement\r\n    const paymentMethods = {};\r\n    periodPayments.forEach(p => {\r\n      if (p.paymentMethod && p.status !== 'pending') {\r\n        paymentMethods[p.paymentMethod] = (paymentMethods[p.paymentMethod] || 0) + (p.amountPaid || 0);\r\n      }\r\n    });\r\n\r\n    // Analyse par type de frais\r\n    const feeTypes = {};\r\n    periodPayments.forEach(p => {\r\n      feeTypes[p.feeType] = (feeTypes[p.feeType] || 0) + p.totalAmount;\r\n    });\r\n\r\n    // Analyse par classe\r\n    const classAnalysis = {};\r\n    periodPayments.forEach(p => {\r\n      const className = p.student?.class || 'Non d√©fini';\r\n      if (!classAnalysis[className]) {\r\n        classAnalysis[className] = { total: 0, paid: 0, count: 0 };\r\n      }\r\n      classAnalysis[className].total += p.totalAmount;\r\n      classAnalysis[className].paid += (p.amountPaid || 0);\r\n      classAnalysis[className].count += 1;\r\n    });\r\n\r\n    // Taux de recouvrement\r\n    const collectionRate = totalAmount > 0 ? (totalPaid / totalAmount) * 100 : 0;\r\n    \r\n    // Calcul du taux de ponctualit√© (paiements √† temps)\r\n    const onTimePayments = periodPayments.filter(p => {\r\n      if (p.status !== 'completed' || !p.paymentDate) return false;\r\n      return new Date(p.paymentDate) <= new Date(p.dueDate);\r\n    }).length;\r\n    const punctualityRate = completedPayments > 0 ? (onTimePayments / completedPayments) * 100 : 0;\r\n\r\n    setAnalytics({\r\n      period: period,\r\n      totalPayments: periodPayments.length,\r\n      totalAmount,\r\n      totalPaid,\r\n      totalOutstanding,\r\n      completedPayments,\r\n      pendingPayments,\r\n      overduePayments,\r\n      partialPayments,\r\n      collectionRate,\r\n      punctualityRate,\r\n      paymentMethods,\r\n      feeTypes,\r\n      classAnalysis,\r\n      averagePayment: periodPayments.length > 0 ? totalAmount / periodPayments.length : 0\r\n    });\r\n  };\r\n\r\n  const formatCurrency = (amount) => {\r\n    return new Intl.NumberFormat('fr-FR', {\r\n      style: 'currency',\r\n      currency: 'XAF',\r\n      minimumFractionDigits: 0\r\n    }).format(amount);\r\n  };\r\n\r\n  const exportReport = () => {\r\n    if (!analytics) return;\r\n\r\n    const reportData = [\r\n      ['RAPPORT D\\'ANALYSE DES PAIEMENTS'],\r\n      [''],\r\n      ['P√©riode:', getPeriodLabel()],\r\n      ['Classe:', selectedClass || 'Toutes les classes'],\r\n      ['Date de g√©n√©ration:', new Date().toLocaleDateString('fr-FR')],\r\n      [''],\r\n      ['R√âSUM√â G√âN√âRAL'],\r\n      ['Nombre total de paiements:', analytics.totalPayments],\r\n      ['Montant total attendu:', formatCurrency(analytics.totalAmount)],\r\n      ['Montant total collect√©:', formatCurrency(analytics.totalPaid)],\r\n      ['Montant en attente:', formatCurrency(analytics.totalOutstanding)],\r\n      ['Taux de recouvrement:', `${analytics.collectionRate.toFixed(1)}%`],\r\n      ['Taux de ponctualit√©:', `${analytics.punctualityRate.toFixed(1)}%`],\r\n      [''],\r\n      ['R√âPARTITION PAR STATUT'],\r\n      ['Paiements compl√©t√©s:', analytics.completedPayments],\r\n      ['Paiements en attente:', analytics.pendingPayments],\r\n      ['Paiements en retard:', analytics.overduePayments],\r\n      ['Paiements partiels:', analytics.partialPayments],\r\n      [''],\r\n      ['ANALYSE PAR M√âTHODE DE PAIEMENT'],\r\n      ...Object.entries(analytics.paymentMethods).map(([method, amount]) => \r\n        [method, formatCurrency(amount)]\r\n      ),\r\n      [''],\r\n      ['ANALYSE PAR TYPE DE FRAIS'],\r\n      ...Object.entries(analytics.feeTypes).map(([type, amount]) => \r\n        [type, formatCurrency(amount)]\r\n      )\r\n    ];\r\n\r\n    const csvContent = reportData.map(row => row.join(',')).join('\\n');\r\n    const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });\r\n    const url = URL.createObjectURL(blob);\r\n    const a = document.createElement('a');\r\n    a.href = url;\r\n    a.download = `analyse_paiements_${period}_${new Date().toISOString().split('T')[0]}.csv`;\r\n    document.body.appendChild(a);\r\n    a.click();\r\n    document.body.removeChild(a);\r\n    URL.revokeObjectURL(url);\r\n  };\r\n\r\n  const getPeriodLabel = () => {\r\n    const labels = {\r\n      'week': 'Derni√®re semaine',\r\n      'month': 'Dernier mois',\r\n      'quarter': 'Dernier trimestre',\r\n      'year': 'Derni√®re ann√©e'\r\n    };\r\n    return labels[period] || 'Dernier mois';\r\n  };\r\n\r\n  const periodOptions = [\r\n    { value: 'week', label: 'Derni√®re semaine' },\r\n    { value: 'month', label: 'Dernier mois' },\r\n    { value: 'quarter', label: 'Dernier trimestre' },\r\n    { value: 'year', label: 'Derni√®re ann√©e' }\r\n  ];\r\n\r\n  const classOptions = [\r\n    { value: '', label: 'Toutes les classes' },\r\n    { value: 'CE1', label: 'CE1' },\r\n    { value: 'CE2', label: 'CE2' },\r\n    { value: 'CM1', label: 'CM1' },\r\n    { value: 'CM2', label: 'CM2' }\r\n  ];\r\n\r\n  if (!isOpen) return null;\r\n\r\n  return (\r\n    <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4\">\r\n      <div className=\"bg-white rounded-lg shadow-xl w-full max-w-6xl max-h-[90vh] overflow-hidden\">\r\n        {/* Header */}\r\n        <div className=\"flex items-center justify-between p-4 border-b\">\r\n          <div>\r\n            <h2 className=\"text-lg font-semibold text-gray-900 flex items-center gap-2\">\r\n              <BarChart3 className=\"w-5 h-5\" />\r\n              Analyses Financi√®res\r\n            </h2>\r\n            <p className=\"text-sm text-gray-600 mt-1\">\r\n              Statistiques et analyses des paiements scolaires\r\n            </p>\r\n          </div>\r\n          \r\n          <div className=\"flex items-center gap-2\">\r\n            <Button\r\n              variant=\"outline\"\r\n              size=\"sm\"\r\n              onClick={exportReport}\r\n              disabled={!analytics}\r\n              className=\"flex items-center gap-2\"\r\n            >\r\n              <Download className=\"w-4 h-4\" />\r\n              Exporter\r\n            </Button>\r\n            <button\r\n              onClick={onClose}\r\n              className=\"text-gray-400 hover:text-gray-600 transition-colors\"\r\n            >\r\n              <X className=\"w-6 h-6\" />\r\n            </button>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Filters */}\r\n        <div className=\"p-4 border-b bg-gray-50\">\r\n          <div className=\"grid grid-cols-2 gap-4\">\r\n            <div>\r\n              <label className=\"block text-sm font-medium text-gray-700 mb-1\">\r\n                P√©riode d'analyse\r\n              </label>\r\n              <Select\r\n                value={period}\r\n                onChange={setPeriod}\r\n                options={periodOptions}\r\n              />\r\n            </div>\r\n            <div>\r\n              <label className=\"block text-sm font-medium text-gray-700 mb-1\">\r\n                Classe\r\n              </label>\r\n              <Select\r\n                value={selectedClass}\r\n                onChange={setSelectedClass}\r\n                options={classOptions}\r\n              />\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Content */}\r\n        <div className=\"flex-1 overflow-y-auto p-4\">\r\n          {loading && (\r\n            <div className=\"flex items-center justify-center py-12\">\r\n              <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600\"></div>\r\n              <span className=\"ml-2 text-gray-600\">Calcul des analyses...</span>\r\n            </div>\r\n          )}\r\n\r\n          {!loading && analytics && (\r\n            <div className=\"space-y-6\">\r\n              {/* M√©triques principales */}\r\n              <div>\r\n                <h3 className=\"text-lg font-medium text-gray-900 mb-4\">\r\n                  R√©sum√© - {getPeriodLabel()}\r\n                </h3>\r\n                <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4\">\r\n                  <div className=\"bg-blue-50 rounded-lg p-4 border border-blue-200\">\r\n                    <div className=\"flex items-center justify-between\">\r\n                      <div>\r\n                        <p className=\"text-sm text-blue-600\">Total Attendu</p>\r\n                        <p className=\"text-xl font-bold text-blue-900\">\r\n                          {formatCurrency(analytics.totalAmount)}\r\n                        </p>\r\n                      </div>\r\n                      <DollarSign className=\"w-8 h-8 text-blue-500\" />\r\n                    </div>\r\n                  </div>\r\n\r\n                  <div className=\"bg-green-50 rounded-lg p-4 border border-green-200\">\r\n                    <div className=\"flex items-center justify-between\">\r\n                      <div>\r\n                        <p className=\"text-sm text-green-600\">Total Collect√©</p>\r\n                        <p className=\"text-xl font-bold text-green-900\">\r\n                          {formatCurrency(analytics.totalPaid)}\r\n                        </p>\r\n                      </div>\r\n                      <TrendingUp className=\"w-8 h-8 text-green-500\" />\r\n                    </div>\r\n                  </div>\r\n\r\n                  <div className=\"bg-red-50 rounded-lg p-4 border border-red-200\">\r\n                    <div className=\"flex items-center justify-between\">\r\n                      <div>\r\n                        <p className=\"text-sm text-red-600\">En Attente</p>\r\n                        <p className=\"text-xl font-bold text-red-900\">\r\n                          {formatCurrency(analytics.totalOutstanding)}\r\n                        </p>\r\n                      </div>\r\n                      <TrendingDown className=\"w-8 h-8 text-red-500\" />\r\n                    </div>\r\n                  </div>\r\n\r\n                  <div className=\"bg-purple-50 rounded-lg p-4 border border-purple-200\">\r\n                    <div className=\"flex items-center justify-between\">\r\n                      <div>\r\n                        <p className=\"text-sm text-purple-600\">Taux Recouvrement</p>\r\n                        <p className=\"text-xl font-bold text-purple-900\">\r\n                          {analytics.collectionRate.toFixed(1)}%\r\n                        </p>\r\n                      </div>\r\n                      <BarChart3 className=\"w-8 h-8 text-purple-500\" />\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n\r\n              {/* Statistiques d√©taill√©es */}\r\n              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\r\n                {/* R√©partition par statut */}\r\n                <div className=\"bg-white rounded-lg border p-4\">\r\n                  <h4 className=\"font-medium text-gray-900 mb-3\">R√©partition par Statut</h4>\r\n                  <div className=\"space-y-2\">\r\n                    <div className=\"flex justify-between items-center\">\r\n                      <span className=\"text-sm text-gray-600\">Compl√©t√©s</span>\r\n                      <div className=\"flex items-center gap-2\">\r\n                        <div className=\"w-16 bg-gray-200 rounded-full h-2\">\r\n                          <div \r\n                            className=\"bg-green-500 h-2 rounded-full\"\r\n                            style={{ width: `${(analytics.completedPayments / analytics.totalPayments) * 100}%` }}\r\n                          ></div>\r\n                        </div>\r\n                        <span className=\"text-sm font-medium\">{analytics.completedPayments}</span>\r\n                      </div>\r\n                    </div>\r\n                    <div className=\"flex justify-between items-center\">\r\n                      <span className=\"text-sm text-gray-600\">En attente</span>\r\n                      <div className=\"flex items-center gap-2\">\r\n                        <div className=\"w-16 bg-gray-200 rounded-full h-2\">\r\n                          <div \r\n                            className=\"bg-yellow-500 h-2 rounded-full\"\r\n                            style={{ width: `${(analytics.pendingPayments / analytics.totalPayments) * 100}%` }}\r\n                          ></div>\r\n                        </div>\r\n                        <span className=\"text-sm font-medium\">{analytics.pendingPayments}</span>\r\n                      </div>\r\n                    </div>\r\n                    <div className=\"flex justify-between items-center\">\r\n                      <span className=\"text-sm text-gray-600\">En retard</span>\r\n                      <div className=\"flex items-center gap-2\">\r\n                        <div className=\"w-16 bg-gray-200 rounded-full h-2\">\r\n                          <div \r\n                            className=\"bg-red-500 h-2 rounded-full\"\r\n                            style={{ width: `${(analytics.overduePayments / analytics.totalPayments) * 100}%` }}\r\n                          ></div>\r\n                        </div>\r\n                        <span className=\"text-sm font-medium\">{analytics.overduePayments}</span>\r\n                      </div>\r\n                    </div>\r\n                    <div className=\"flex justify-between items-center\">\r\n                      <span className=\"text-sm text-gray-600\">Partiels</span>\r\n                      <div className=\"flex items-center gap-2\">\r\n                        <div className=\"w-16 bg-gray-200 rounded-full h-2\">\r\n                          <div \r\n                            className=\"bg-blue-500 h-2 rounded-full\"\r\n                            style={{ width: `${(analytics.partialPayments / analytics.totalPayments) * 100}%` }}\r\n                          ></div>\r\n                        </div>\r\n                        <span className=\"text-sm font-medium\">{analytics.partialPayments}</span>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n\r\n                {/* M√©thodes de paiement */}\r\n                <div className=\"bg-white rounded-lg border p-4\">\r\n                  <h4 className=\"font-medium text-gray-900 mb-3\">M√©thodes de Paiement</h4>\r\n                  <div className=\"space-y-2\">\r\n                    {Object.entries(analytics.paymentMethods).map(([method, amount]) => (\r\n                      <div key={method} className=\"flex justify-between items-center\">\r\n                        <span className=\"text-sm text-gray-600\">{method}</span>\r\n                        <span className=\"text-sm font-medium\">{formatCurrency(amount)}</span>\r\n                      </div>\r\n                    ))}\r\n                    {Object.keys(analytics.paymentMethods).length === 0 && (\r\n                      <p className=\"text-sm text-gray-500 text-center py-4\">\r\n                        Aucune m√©thode de paiement enregistr√©e pour cette p√©riode\r\n                      </p>\r\n                    )}\r\n                  </div>\r\n                </div>\r\n              </div>\r\n\r\n              {/* Analyse par classe */}\r\n              {Object.keys(analytics.classAnalysis).length > 0 && (\r\n                <div className=\"bg-white rounded-lg border p-4\">\r\n                  <h4 className=\"font-medium text-gray-900 mb-3\">Analyse par Classe</h4>\r\n                  <div className=\"overflow-x-auto\">\r\n                    <table className=\"w-full text-sm\">\r\n                      <thead className=\"bg-gray-50\">\r\n                        <tr>\r\n                          <th className=\"text-left p-2 font-medium text-gray-700\">Classe</th>\r\n                          <th className=\"text-right p-2 font-medium text-gray-700\">Nb Paiements</th>\r\n                          <th className=\"text-right p-2 font-medium text-gray-700\">Total Attendu</th>\r\n                          <th className=\"text-right p-2 font-medium text-gray-700\">Total Pay√©</th>\r\n                          <th className=\"text-right p-2 font-medium text-gray-700\">Taux</th>\r\n                        </tr>\r\n                      </thead>\r\n                      <tbody className=\"divide-y divide-gray-200\">\r\n                        {Object.entries(analytics.classAnalysis).map(([className, data]) => (\r\n                          <tr key={className}>\r\n                            <td className=\"p-2 font-medium\">{className}</td>\r\n                            <td className=\"p-2 text-right\">{data.count}</td>\r\n                            <td className=\"p-2 text-right\">{formatCurrency(data.total)}</td>\r\n                            <td className=\"p-2 text-right\">{formatCurrency(data.paid)}</td>\r\n                            <td className=\"p-2 text-right\">\r\n                              <span className={`px-2 py-1 rounded text-xs ${\r\n                                ((data.paid / data.total) * 100) >= 80 \r\n                                  ? 'bg-green-100 text-green-800'\r\n                                  : ((data.paid / data.total) * 100) >= 50\r\n                                  ? 'bg-yellow-100 text-yellow-800'\r\n                                  : 'bg-red-100 text-red-800'\r\n                              }`}>\r\n                                {((data.paid / data.total) * 100).toFixed(1)}%\r\n                              </span>\r\n                            </td>\r\n                          </tr>\r\n                        ))}\r\n                      </tbody>\r\n                    </table>\r\n                  </div>\r\n                </div>\r\n              )}\r\n            </div>\r\n          )}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default PaymentAnalyticsModal;","import React, { useState, useEffect } from 'react';\r\nimport Icon from '../../../components/AppIcon';\r\nimport Button from '../../../components/ui/Button';\r\nimport Input from '../../../components/ui/Input';\r\nimport Select from '../../../components/ui/Select';\r\nimport { useToast, ToastContainer } from '../../../components/ui/Toast';\r\nimport paymentService from '../../../services/paymentService';\r\nimport PaymentRegistrationModal from './PaymentRegistrationModal';\r\nimport ReceiptModal from './ReceiptModal';\r\nimport PaymentHistoryModal from './PaymentHistoryModal';\r\nimport PaymentCalendarModal from './PaymentCalendarModal';\r\nimport PaymentAnalyticsModal from './PaymentAnalyticsModal';\r\n\r\nconst PaymentTab = () => {\r\n  const { toasts, showSuccess, showError, showInfo, removeToast } = useToast();\r\n\r\n  const [searchTerm, setSearchTerm] = useState('');\r\n  const [filterClass, setFilterClass] = useState('');\r\n  const [filterStatus, setFilterStatus] = useState('');\r\n  const [filterPeriod, setFilterPeriod] = useState('');\r\n  \r\n  // √âtats pour les donn√©es\r\n  const [payments, setPayments] = useState([]);\r\n  const [loading, setLoading] = useState(false);\r\n  const [bulkReminderLoading, setBulkReminderLoading] = useState(false);\r\n  const [error, setError] = useState('');\r\n  const [stats, setStats] = useState({\r\n    total: 0,\r\n    collected: 0,\r\n    outstanding: 0,\r\n    overdue: 0\r\n  });\r\n\r\n  // √âtats pour les modals\r\n  const [showRegistrationModal, setShowRegistrationModal] = useState(false);\r\n  const [showReceiptModal, setShowReceiptModal] = useState(false);\r\n  const [showHistoryModal, setShowHistoryModal] = useState(false);\r\n  const [showCalendarModal, setShowCalendarModal] = useState(false);\r\n  const [showAnalyticsModal, setShowAnalyticsModal] = useState(false);\r\n  const [selectedPaymentId, setSelectedPaymentId] = useState(null);\r\n  const [selectedStudent, setSelectedStudent] = useState(null);\r\n\r\n  // √âtat pour notification inline\r\n  const [inlineNotification, setInlineNotification] = useState(null);\r\n\r\n  useEffect(() => {\r\n    loadPayments();\r\n  }, []);\r\n\r\n  const loadPayments = async () => {\r\n    setLoading(true);\r\n    setError('');\r\n    try {\r\n      const data = await paymentService.getAllPayments('production');\r\n      setPayments(data.payments || []);\r\n      setStats(data.statistics || stats);\r\n    } catch (err) {\r\n      setError('Erreur lors du chargement des paiements');\r\n      showError('Erreur lors du chargement des paiements');\r\n      console.error('Erreur chargement paiements:', err);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const classOptions = [\r\n    { value: '', label: 'Toutes les classes' },\r\n    { value: 'CE1', label: 'CE1' },\r\n    { value: 'CE2', label: 'CE2' },\r\n    { value: 'CM1', label: 'CM1' },\r\n    { value: 'CM2', label: 'CM2' }\r\n  ];\r\n\r\n  const statusOptions = [\r\n    { value: '', label: 'Tous les statuts' },\r\n    { value: 'completed', label: 'Pay√©' },\r\n    { value: 'pending', label: 'En attente' },\r\n    { value: 'overdue', label: 'En retard' },\r\n    { value: 'partial', label: 'Partiel' }\r\n  ];\r\n\r\n  const periodOptions = [\r\n    { value: '', label: 'Toutes les p√©riodes' },\r\n    { value: '2024-2025', label: 'Ann√©e 2024-2025' },\r\n    { value: 'Trimestre 1', label: 'Trimestre 1' },\r\n    { value: 'Trimestre 2', label: 'Trimestre 2' },\r\n    { value: 'Trimestre 3', label: 'Trimestre 3' }\r\n  ];\r\n\r\n  const getStatusConfig = (status) => {\r\n    const configs = {\r\n      completed: {\r\n        label: 'Pay√©',\r\n        className: 'bg-success/10 text-success',\r\n        icon: 'CheckCircle'\r\n      },\r\n      pending: {\r\n        label: 'En attente',\r\n        className: 'bg-warning/10 text-warning',\r\n        icon: 'Clock'\r\n      },\r\n      overdue: {\r\n        label: 'En retard',\r\n        className: 'bg-error/10 text-error',\r\n        icon: 'AlertTriangle'\r\n      },\r\n      partial: {\r\n        label: 'Partiel',\r\n        className: 'bg-primary/10 text-primary',\r\n        icon: 'Minus'\r\n      }\r\n    };\r\n    return configs?.[status] || configs?.pending;\r\n  };\r\n\r\n  const filteredPayments = payments?.filter(payment => {\r\n    const matchesSearch = payment?.student?.firstName?.toLowerCase()?.includes(searchTerm?.toLowerCase()) ||\r\n                         payment?.student?.lastName?.toLowerCase()?.includes(searchTerm?.toLowerCase()) ||\r\n                         payment?.student?.parentName?.toLowerCase()?.includes(searchTerm?.toLowerCase()) ||\r\n                         payment?.student?.studentId?.toLowerCase()?.includes(searchTerm?.toLowerCase());\r\n    const matchesClass = !filterClass || payment?.student?.class === filterClass;\r\n    const matchesStatus = !filterStatus || payment?.status === filterStatus;\r\n    const matchesPeriod = !filterPeriod || payment?.period?.includes(filterPeriod);\r\n    \r\n    return matchesSearch && matchesClass && matchesStatus && matchesPeriod;\r\n  });\r\n\r\n  const handleSendReminder = async (paymentId) => {\r\n    try {\r\n      setLoading(true);\r\n      await paymentService.sendPaymentReminder(paymentId);\r\n      showSuccess('Rappel envoy√© avec succ√®s');\r\n      loadPayments();\r\n    } catch (err) {\r\n      showError('Erreur lors de l\\'envoi du rappel');\r\n      console.error('Erreur envoi rappel:', err);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleMarkAsPaid = async (paymentId) => {\r\n    try {\r\n      setLoading(true);\r\n      await paymentService.markAsPaid(paymentId);\r\n      showSuccess('Paiement marqu√© comme pay√©');\r\n      loadPayments();\r\n    } catch (err) {\r\n      showError('Erreur lors de la mise √† jour');\r\n      console.error('Erreur marquer pay√©:', err);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleBulkReminders = async () => {\r\n    const unpaidPayments = filteredPayments?.filter(p => p?.status === 'overdue' || p?.status === 'pending');\r\n    if (unpaidPayments.length === 0) {\r\n      showInfo('Aucun paiement en attente trouv√©');\r\n      setInlineNotification({\r\n        type: 'info',\r\n        message: 'Aucun paiement en attente trouv√©'\r\n      });\r\n      setTimeout(() => setInlineNotification(null), 4000);\r\n      return;\r\n    }\r\n\r\n    try {\r\n      setBulkReminderLoading(true);\r\n      setInlineNotification({\r\n        type: 'info',\r\n        message: `üì® Envoi de ${unpaidPayments.length} rappel(s) en cours...`\r\n      });\r\n      showInfo(`Envoi de ${unpaidPayments.length} rappel(s) en cours...`);\r\n      \r\n      await paymentService.sendBulkReminders(unpaidPayments.map(p => p.id));\r\n      \r\n      setInlineNotification({\r\n        type: 'success',\r\n        message: `‚úÖ ${unpaidPayments.length} rappel(s) envoy√©(s) avec succ√®s !`\r\n      });\r\n      showSuccess(`${unpaidPayments.length} rappel(s) envoy√©(s) avec succ√®s`);\r\n      setTimeout(() => setInlineNotification(null), 6000);\r\n    } catch (err) {\r\n      setInlineNotification({\r\n        type: 'error',\r\n        message: `‚ùå Erreur lors de l'envoi des rappels`\r\n      });\r\n      showError('Erreur lors de l\\'envoi des rappels');\r\n      setTimeout(() => setInlineNotification(null), 6000);\r\n      console.error('Erreur rappels group√©s:', err);\r\n    } finally {\r\n      setBulkReminderLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleExportReport = async () => {\r\n    try {\r\n      const reportData = await paymentService.getPaymentStats();\r\n      // Cr√©er un CSV simple pour l'export\r\n      const csvContent = [\r\n        ['√âl√®ve', 'Classe', 'Type de frais', 'P√©riode', 'Montant d√ª', 'Montant pay√©', 'Statut'].join(','),\r\n        ...filteredPayments.map(payment => [\r\n          `${payment.student.firstName} ${payment.student.lastName}`,\r\n          payment.student.class,\r\n          payment.feeType,\r\n          payment.period,\r\n          payment.totalAmount,\r\n          payment.amountPaid || 0,\r\n          payment.status\r\n        ].join(','))\r\n      ].join('\\n');\r\n\r\n      const blob = new Blob([csvContent], { type: 'text/csv' });\r\n      const url = URL.createObjectURL(blob);\r\n      const a = document.createElement('a');\r\n      a.href = url;\r\n      a.download = 'rapport_paiements.csv';\r\n      document.body.appendChild(a);\r\n      a.click();\r\n      document.body.removeChild(a);\r\n      URL.revokeObjectURL(url);\r\n      \r\n      showSuccess('Rapport export√© avec succ√®s');\r\n    } catch (err) {\r\n      showError('Erreur lors de l\\'export');\r\n      console.error('Erreur export:', err);\r\n    }\r\n  };\r\n\r\n  const handleViewHistory = (student) => {\r\n    setSelectedStudent(student);\r\n    setShowHistoryModal(true);\r\n  };\r\n\r\n  const handleViewReceipt = (paymentId) => {\r\n    setSelectedPaymentId(paymentId);\r\n    setShowReceiptModal(true);\r\n  };\r\n\r\n  const handleNewPayment = () => {\r\n    setShowRegistrationModal(true);\r\n  };\r\n\r\n  const handleShowCalendar = () => {\r\n    setShowCalendarModal(true);\r\n  };\r\n\r\n  const formatCurrency = (amount) => {\r\n    return new Intl.NumberFormat('fr-FR', {\r\n      style: 'currency',\r\n      currency: 'XAF',\r\n      minimumFractionDigits: 0\r\n    }).format(amount);\r\n  };\r\n\r\n  const formatDate = (dateString) => {\r\n    return new Date(dateString).toLocaleDateString('fr-FR');\r\n  };\r\n\r\n  return (\r\n    <div className=\"space-y-4\">\r\n      <ToastContainer toasts={toasts} removeToast={removeToast} />\r\n\r\n      {/* Header */}\r\n      <div className=\"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3\">\r\n        <div>\r\n          <h2 className=\"font-heading font-heading-bold text-lg text-text-primary\">\r\n            Gestion des Paiements\r\n          </h2>\r\n          <p className=\"font-body font-body-normal text-xs text-text-secondary mt-0.5\">\r\n            Suivi des frais de scolarit√© et paiements\r\n          </p>\r\n        </div>\r\n        <div className=\"flex items-center space-x-1.5\">\r\n          <Button\r\n            variant=\"default\"\r\n            size=\"sm\"\r\n            iconName=\"Plus\"\r\n            iconPosition=\"left\"\r\n            onClick={handleNewPayment}\r\n            disabled={loading}\r\n          >\r\n            Nouveau\r\n          </Button>\r\n          <Button\r\n            variant=\"outline\"\r\n            size=\"sm\"\r\n            iconName={bulkReminderLoading ? null : \"Mail\"}\r\n            iconPosition=\"left\"\r\n            onClick={handleBulkReminders}\r\n            disabled={loading || bulkReminderLoading}\r\n            loading={bulkReminderLoading}\r\n          >\r\n            {bulkReminderLoading ? 'Envoi...' : 'Rappels'}\r\n          </Button>\r\n          <Button\r\n            variant=\"outline\"\r\n            size=\"sm\"\r\n            iconName=\"Download\"\r\n            iconPosition=\"left\"\r\n            onClick={handleExportReport}\r\n            disabled={loading}\r\n          >\r\n            Export\r\n          </Button>\r\n          <Button\r\n            variant=\"outline\"\r\n            size=\"sm\"\r\n            iconName=\"BarChart3\"\r\n            iconPosition=\"left\"\r\n            onClick={() => setShowAnalyticsModal(true)}\r\n            disabled={loading}\r\n          >\r\n            Analyses\r\n          </Button>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Notification inline */}\r\n      {inlineNotification && (\r\n        <div className={`p-4 rounded-lg border-l-4 ${\r\n          inlineNotification.type === 'success' \r\n            ? 'bg-green-50 border-l-green-500 text-green-800' \r\n            : inlineNotification.type === 'error'\r\n            ? 'bg-red-50 border-l-red-500 text-red-800'\r\n            : inlineNotification.type === 'info'\r\n            ? 'bg-blue-50 border-l-blue-500 text-blue-800'\r\n            : 'bg-yellow-50 border-l-yellow-500 text-yellow-800'\r\n        } transition-all duration-300`}>\r\n          <p className=\"text-sm font-medium flex items-center\">\r\n            <span className=\"mr-2\">{inlineNotification.message}</span>\r\n            {bulkReminderLoading && (\r\n              <div className=\"animate-spin rounded-full h-4 w-4 border-b-2 border-current\"></div>\r\n            )}\r\n          </p>\r\n        </div>\r\n      )}\r\n\r\n      {/* Payment Statistics */}\r\n      <div className=\"grid grid-cols-2 md:grid-cols-4 gap-3\">\r\n        <div className=\"bg-card rounded border border-border p-3\">\r\n          <div className=\"flex items-center space-x-2\">\r\n            <div className=\"w-8 h-8 bg-primary/10 rounded flex items-center justify-center\">\r\n              <Icon name=\"Euro\" size={16} className=\"text-primary\" />\r\n            </div>\r\n            <div>\r\n              <p className=\"font-heading font-heading-semibold text-sm text-text-primary\">\r\n                {formatCurrency(stats?.total || 0)}\r\n              </p>\r\n              <p className=\"font-caption font-caption-normal text-xs text-text-secondary\">\r\n                Total attendu\r\n              </p>\r\n            </div>\r\n          </div>\r\n        </div>\r\n        \r\n        <div className=\"bg-card rounded border border-border p-3\">\r\n          <div className=\"flex items-center space-x-2\">\r\n            <div className=\"w-8 h-8 bg-success/10 rounded flex items-center justify-center\">\r\n              <Icon name=\"CheckCircle\" size={16} className=\"text-success\" />\r\n            </div>\r\n            <div>\r\n              <p className=\"font-heading font-heading-semibold text-sm text-text-primary\">\r\n                {formatCurrency(stats?.collected || 0)}\r\n              </p>\r\n              <p className=\"font-caption font-caption-normal text-xs text-text-secondary\">\r\n                Collect√©\r\n              </p>\r\n            </div>\r\n          </div>\r\n        </div>\r\n        \r\n        <div className=\"bg-card rounded border border-border p-3\">\r\n          <div className=\"flex items-center space-x-2\">\r\n            <div className=\"w-8 h-8 bg-error/10 rounded flex items-center justify-center\">\r\n              <Icon name=\"AlertTriangle\" size={16} className=\"text-error\" />\r\n            </div>\r\n            <div>\r\n              <p className=\"font-heading font-heading-semibold text-sm text-text-primary\">\r\n                {formatCurrency(stats?.outstanding || 0)}\r\n              </p>\r\n              <p className=\"font-caption font-caption-normal text-xs text-text-secondary\">\r\n                En attente\r\n              </p>\r\n            </div>\r\n          </div>\r\n        </div>\r\n        \r\n        <div className=\"bg-card rounded border border-border p-3\">\r\n          <div className=\"flex items-center space-x-2\">\r\n            <div className=\"w-8 h-8 bg-warning/10 rounded flex items-center justify-center\">\r\n              <Icon name=\"Clock\" size={16} className=\"text-warning\" />\r\n            </div>\r\n            <div>\r\n              <p className=\"font-heading font-heading-semibold text-sm text-text-primary\">\r\n                {(stats?.overdue || 0) + (stats?.pending || 0)}\r\n              </p>\r\n              <p className=\"font-caption font-caption-normal text-xs text-text-secondary\">\r\n                Impay√©s\r\n              </p>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Quick Actions */}  \r\n      <div className=\"flex flex-wrap items-center gap-2\">\r\n        <Button\r\n          variant=\"ghost\"\r\n          size=\"xs\"\r\n          iconName=\"Calendar\"\r\n          iconPosition=\"left\"\r\n          onClick={handleShowCalendar}\r\n        >\r\n          Calendrier\r\n        </Button>\r\n        <Button\r\n          variant=\"ghost\"\r\n          size=\"xs\"\r\n          iconName=\"History\"\r\n          iconPosition=\"left\"\r\n          onClick={() => setShowHistoryModal(true)}\r\n        >\r\n          Historique\r\n        </Button>\r\n        <Button\r\n          variant=\"ghost\"\r\n          size=\"xs\"\r\n          iconName=\"FileText\"\r\n          iconPosition=\"left\"\r\n          onClick={() => setShowAnalyticsModal(true)}\r\n        >\r\n          Rapport\r\n        </Button>\r\n        <Button\r\n          variant=\"ghost\"\r\n          size=\"xs\"\r\n          iconName=\"Repeat\"\r\n          iconPosition=\"left\"\r\n          onClick={loadPayments}\r\n          disabled={loading}\r\n        >\r\n          Actualiser\r\n        </Button>\r\n      </div>\r\n\r\n      {/* Filters */}\r\n      <div className=\"bg-card rounded border border-border p-3\">\r\n        <div className=\"grid grid-cols-1 md:grid-cols-4 gap-3\">\r\n          <Input\r\n            type=\"search\"\r\n            placeholder=\"Rechercher par nom ou ID...\"\r\n            value={searchTerm}\r\n            onChange={(e) => setSearchTerm(e?.target?.value)}\r\n          />\r\n          <Select\r\n            placeholder=\"Filtrer par classe\"\r\n            options={classOptions}\r\n            value={filterClass}\r\n            onChange={setFilterClass}\r\n          />\r\n          <Select\r\n            placeholder=\"Filtrer par statut\"\r\n            options={statusOptions}\r\n            value={filterStatus}\r\n            onChange={setFilterStatus}\r\n          />\r\n          <Select\r\n            placeholder=\"Filtrer par p√©riode\"\r\n            options={periodOptions}\r\n            value={filterPeriod}\r\n            onChange={setFilterPeriod}\r\n          />\r\n        </div>\r\n      </div>\r\n      {/* Payments Table */}\r\n      <div className=\"bg-card rounded border border-border overflow-hidden\">\r\n        {loading && (\r\n          <div className=\"flex items-center justify-center py-8\">\r\n            <div className=\"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600\"></div>\r\n            <span className=\"ml-2 text-gray-600 text-sm\">Chargement...</span>\r\n          </div>\r\n        )}\r\n\r\n        {error && (\r\n          <div className=\"p-4 text-center\">\r\n            <Icon name=\"AlertTriangle\" size={32} className=\"text-red-500 mx-auto mb-2\" />\r\n            <p className=\"text-red-600 font-medium text-sm\">{error}</p>\r\n            <Button \r\n              variant=\"outline\" \r\n              size=\"sm\"\r\n              onClick={loadPayments} \r\n              className=\"mt-2\"\r\n            >\r\n              R√©essayer\r\n            </Button>\r\n          </div>\r\n        )}\r\n\r\n        {!loading && !error && (\r\n          <div className=\"overflow-x-auto\">\r\n            <table className=\"w-full\">\r\n              <thead className=\"bg-muted\">\r\n                <tr>\r\n                  <th className=\"text-left p-2 font-heading font-heading-semibold text-xs text-text-primary\">\r\n                    √âl√®ve\r\n                  </th>\r\n                  <th className=\"text-left p-2 font-heading font-heading-semibold text-xs text-text-primary\">\r\n                    Type de frais\r\n                  </th>\r\n                  <th className=\"text-left p-2 font-heading font-heading-semibold text-xs text-text-primary\">\r\n                    P√©riode\r\n                  </th>\r\n                  <th className=\"text-left p-2 font-heading font-heading-semibold text-xs text-text-primary\">\r\n                    Montant\r\n                  </th>\r\n                  <th className=\"text-left p-2 font-heading font-heading-semibold text-xs text-text-primary\">\r\n                    Statut\r\n                  </th>\r\n                  <th className=\"text-left p-2 font-heading font-heading-semibold text-xs text-text-primary\">\r\n                    √âch√©ance\r\n                  </th>\r\n                  <th className=\"text-right p-2 font-heading font-heading-semibold text-xs text-text-primary\">\r\n                    Actions\r\n                  </th>\r\n                </tr>\r\n              </thead>\r\n              <tbody>\r\n                {filteredPayments?.map((payment) => {\r\n                  const statusConfig = getStatusConfig(payment?.status);\r\n                  const isOverdue = new Date(payment.dueDate) < new Date() && payment?.status !== 'completed';\r\n\r\n                  return (\r\n                    <tr key={payment?.id} className=\"border-t border-border hover:bg-muted/50 transition-micro\">\r\n                      <td className=\"p-2\">\r\n                        <div>\r\n                          <p className=\"font-body font-body-semibold text-xs text-text-primary\">\r\n                            {payment?.student?.firstName} {payment?.student?.lastName}\r\n                          </p>\r\n                          <p className=\"font-caption font-caption-normal text-xs text-text-secondary\">\r\n                            {payment?.student?.class} ‚Ä¢ {payment?.student?.studentId}\r\n                          </p>\r\n                          <p className=\"font-caption font-caption-normal text-xs text-text-secondary truncate max-w-32\">\r\n                            {payment?.student?.parentName}\r\n                          </p>\r\n                        </div>\r\n                      </td>\r\n                      <td className=\"p-2\">\r\n                        <div>\r\n                          <span className=\"font-body font-body-normal text-xs text-text-primary\">\r\n                            {payment?.feeType}\r\n                          </span>\r\n                          {payment?.description && (\r\n                            <p className=\"font-caption font-caption-normal text-xs text-text-secondary truncate max-w-24\">\r\n                              {payment?.description}\r\n                            </p>\r\n                          )}\r\n                        </div>\r\n                      </td>\r\n                      <td className=\"p-2\">\r\n                        <span className=\"font-body font-body-normal text-xs text-text-primary\">\r\n                          {payment?.period}\r\n                        </span>\r\n                      </td>\r\n                      <td className=\"p-2\">\r\n                        <div>\r\n                          <p className=\"font-body font-body-semibold text-xs text-text-primary\">\r\n                            {formatCurrency(payment?.totalAmount)}\r\n                          </p>\r\n                          {payment?.status === 'partial' && (\r\n                            <p className=\"font-caption font-caption-normal text-xs text-success\">\r\n                              Pay√©: {formatCurrency(payment?.amountPaid)}\r\n                            </p>\r\n                          )}\r\n                          {payment?.paymentMethod && (\r\n                            <p className=\"font-caption font-caption-normal text-xs text-text-secondary truncate max-w-20\">\r\n                              {payment?.paymentMethod}\r\n                            </p>\r\n                          )}\r\n                        </div>\r\n                      </td>\r\n                      <td className=\"p-2\">\r\n                        <div className=\"flex items-center space-x-1\">\r\n                          <span className={`px-1.5 py-0.5 rounded text-xs font-caption font-caption-normal ${statusConfig?.className}`}>\r\n                            {statusConfig?.label}\r\n                          </span>\r\n                          {isOverdue && (\r\n                            <Icon name=\"AlertTriangle\" size={12} className=\"text-error\" />\r\n                          )}\r\n                        </div>\r\n                      </td>\r\n                      <td className=\"p-2\">\r\n                        <div>\r\n                          <p className=\"font-body font-body-normal text-xs text-text-primary\">\r\n                            {formatDate(payment?.dueDate)}\r\n                          </p>\r\n                          {payment?.paymentDate && (\r\n                            <p className=\"font-caption font-caption-normal text-xs text-success\">\r\n                              Pay√© le {formatDate(payment?.paymentDate)}\r\n                            </p>\r\n                          )}\r\n                        </div>\r\n                      </td>\r\n                      <td className=\"p-2\">\r\n                        <div className=\"flex items-center justify-end space-x-1\">\r\n                          {payment?.status !== 'completed' && (\r\n                            <>\r\n                              <Button\r\n                                variant=\"ghost\"\r\n                                size=\"xs\"\r\n                                onClick={() => handleSendReminder(payment?.id)}\r\n                                title=\"Envoyer un rappel\"\r\n                                disabled={loading}\r\n                                className=\"h-6 w-6 p-0\"\r\n                              >\r\n                                <Icon name=\"Mail\" size={12} />\r\n                              </Button>\r\n                              <Button\r\n                                variant=\"ghost\"\r\n                                size=\"xs\"\r\n                                onClick={() => handleMarkAsPaid(payment?.id)}\r\n                                title=\"Marquer comme pay√©\"\r\n                                disabled={loading}\r\n                                className=\"h-6 w-6 p-0\"\r\n                              >\r\n                                <Icon name=\"CheckCircle\" size={12} />\r\n                              </Button>\r\n                            </>\r\n                          )}\r\n                          <Button\r\n                            variant=\"ghost\"\r\n                            size=\"xs\"\r\n                            onClick={() => handleViewHistory(payment?.student)}\r\n                            title=\"Voir l'historique\"\r\n                            className=\"h-6 w-6 p-0\"\r\n                          >\r\n                            <Icon name=\"History\" size={12} />\r\n                          </Button>\r\n                          {payment?.status !== 'pending' && payment?.receiptId && (\r\n                            <Button\r\n                              variant=\"ghost\"\r\n                              size=\"xs\"\r\n                              onClick={() => handleViewReceipt(payment?.receiptId)}\r\n                              title=\"Voir le re√ßu\"\r\n                              className=\"h-6 w-6 p-0\"\r\n                            >\r\n                              <Icon name=\"Receipt\" size={12} />\r\n                            </Button>\r\n                          )}\r\n                        </div>\r\n                      </td>\r\n                    </tr>\r\n                  );\r\n                })}\r\n              </tbody>\r\n            </table>\r\n\r\n            {filteredPayments?.length === 0 && !loading && (\r\n              <div className=\"p-6 text-center\">\r\n                <Icon name=\"CreditCard\" size={32} className=\"text-muted-foreground mx-auto mb-2\" />\r\n                <p className=\"font-body font-body-normal text-sm text-text-secondary\">\r\n                  Aucun paiement trouv√©\r\n                </p>\r\n              </div>\r\n            )}\r\n          </div>\r\n        )}\r\n      </div>\r\n      {/* Quick Actions */}\r\n      <div className=\"bg-accent/5 rounded border border-accent/20 p-3\">\r\n        <h3 className=\"font-heading font-heading-semibold text-xs text-text-primary mb-2\">\r\n          Actions rapides\r\n        </h3>\r\n        <div className=\"flex flex-wrap gap-1.5\">\r\n          <Button\r\n            variant=\"outline\"\r\n            size=\"xs\"\r\n            iconName=\"Plus\"\r\n            onClick={handleNewPayment}\r\n            disabled={loading}\r\n          >\r\n            Nouveau\r\n          </Button>\r\n          <Button\r\n            variant=\"outline\"\r\n            size=\"xs\"\r\n            iconName=\"Calendar\"\r\n            onClick={handleShowCalendar}\r\n          >\r\n            Calendrier\r\n          </Button>\r\n          <Button\r\n            variant=\"outline\"\r\n            size=\"xs\"\r\n            iconName=\"BarChart3\"\r\n            onClick={() => setShowAnalyticsModal(true)}\r\n          >\r\n            Analyses\r\n          </Button>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Modals */}\r\n      <PaymentRegistrationModal\r\n        isOpen={showRegistrationModal}\r\n        onClose={() => setShowRegistrationModal(false)}\r\n        onSuccess={() => {\r\n          showSuccess('Paiement enregistr√© avec succ√®s');\r\n          loadPayments();\r\n          setShowRegistrationModal(false);\r\n        }}\r\n      />\r\n\r\n      <ReceiptModal\r\n        isOpen={showReceiptModal}\r\n        onClose={() => {\r\n          setShowReceiptModal(false);\r\n          setSelectedPaymentId(null);\r\n        }}\r\n        paymentId={selectedPaymentId}\r\n      />\r\n\r\n      <PaymentHistoryModal\r\n        isOpen={showHistoryModal}\r\n        onClose={() => {\r\n          setShowHistoryModal(false);\r\n          setSelectedStudent(null);\r\n        }}\r\n        studentId={selectedStudent?.studentId}\r\n        studentName={selectedStudent ? `${selectedStudent.firstName} ${selectedStudent.lastName}` : ''}\r\n        onViewReceipt={handleViewReceipt}\r\n      />\r\n\r\n      <PaymentCalendarModal\r\n        isOpen={showCalendarModal}\r\n        onClose={() => setShowCalendarModal(false)}\r\n      />\r\n\r\n      <PaymentAnalyticsModal\r\n        isOpen={showAnalyticsModal}\r\n        onClose={() => setShowAnalyticsModal(false)}\r\n      />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default PaymentTab;","import { supabase } from '../lib/supabase';\r\nimport { getCurrentSchoolId } from './cardService';\r\n\r\n// V√©rifier si on est en mode production\r\nconst isProductionMode = () => {\r\n  // FORCER LE MODE PRODUCTION comme demand√© par l'utilisateur\r\n  console.log('CommunicationService: Mode PRODUCTION forc√© - utilisation exclusive des donn√©es Supabase');\r\n  return true;\r\n};\r\n\r\nclass CommunicationService {\r\n  // Obtenir la liste des parents de l'√©cole actuelle avec leurs enfants\r\n  async getParentsBySchool() {\r\n    console.log('CommunicationService: Mode production forc√© - r√©cup√©ration des parents');\r\n\r\n    try {\r\n      const schoolId = await getCurrentSchoolId();\r\n      if (!schoolId) {\r\n        console.log('CommunicationService: Aucun ID d\\'√©cole trouv√©');\r\n        return [];\r\n      }\r\n\r\n      console.log('CommunicationService: Recherche des parents pour l\\'√©cole:', schoolId);\r\n\r\n      // R√©cup√©rer les parents avec leurs enfants via la table de liaison\r\n      const { data, error } = await supabase\r\n        .from('parent_student_schools')\r\n        .select(`\r\n          parent_id,\r\n          student_id,\r\n          relationship_type,\r\n          is_primary_contact,\r\n          parents:parent_id (\r\n            id,\r\n            first_name,\r\n            last_name,\r\n            phone,\r\n            email,\r\n            user_id\r\n          ),\r\n          students:student_id (\r\n            id,\r\n            first_name,\r\n            last_name\r\n          )\r\n        `)\r\n        .eq('school_id', schoolId)\r\n        .eq('is_primary_contact', true); // Uniquement les contacts principaux\r\n\r\n      if (error) {\r\n        console.error('CommunicationService: Erreur lors de la r√©cup√©ration des parents:', error);\r\n        return [];\r\n      }\r\n\r\n      console.log('CommunicationService: Relations parent-√©tudiant trouv√©es:', data?.length || 0);\r\n\r\n      // Transformer et grouper les donn√©es par parent\r\n      const parentsMap = new Map();\r\n      \r\n      (data || []).forEach(relation => {\r\n        const parent = relation.parents;\r\n        const student = relation.students;\r\n        \r\n        if (!parent || !student) return;\r\n        \r\n        const parentKey = parent.id;\r\n        \r\n        if (!parentsMap.has(parentKey)) {\r\n          parentsMap.set(parentKey, {\r\n            id: parent.id,\r\n            name: `${parent.first_name} ${parent.last_name}`,\r\n            firstName: parent.first_name,\r\n            lastName: parent.last_name,\r\n            phone: parent.phone,\r\n            email: parent.email,\r\n            userId: parent.user_id,\r\n            students: []\r\n          });\r\n        }\r\n        \r\n        // Ajouter l'√©tudiant √† la liste des enfants du parent\r\n        parentsMap.get(parentKey).students.push({\r\n          id: student.id,\r\n          name: `${student.first_name} ${student.last_name}`,\r\n          class: 'Non d√©finie'\r\n        });\r\n      });\r\n\r\n      const parentsList = Array.from(parentsMap.values()).map(parent => ({\r\n        ...parent,\r\n        studentName: parent.students.map(s => s.name).join(', '),\r\n        class: parent.students.map(s => s.class).join(', ')\r\n      }));\r\n\r\n      console.log('CommunicationService: Parents format√©s:', parentsList.length);\r\n      if (parentsList.length > 0) {\r\n        console.log('CommunicationService: Premier parent:', parentsList[0]);\r\n      }\r\n\r\n      return parentsList;\r\n    } catch (error) {\r\n      console.error('CommunicationService: Erreur dans getParentsBySchool:', error);\r\n      return [];\r\n    }\r\n  }\r\n\r\n  // Obtenir l'historique des communications\r\n  async getCommunicationsHistory() {\r\n    console.log('CommunicationService: Mode production forc√© - r√©cup√©ration de l\\'historique');\r\n\r\n    try {\r\n      const schoolId = await getCurrentSchoolId();\r\n      if (!schoolId) {\r\n        console.log('CommunicationService: Aucun ID d\\'√©cole pour l\\'historique');\r\n        return [];\r\n      }\r\n\r\n      console.log('CommunicationService: Recherche de l\\'historique pour l\\'√©cole:', schoolId);\r\n\r\n      const { data, error } = await supabase\r\n        .from('communications')\r\n        .select(`\r\n          id,\r\n          message_type,\r\n          subject,\r\n          content,\r\n          recipients_data,\r\n          recipient_count,\r\n          status,\r\n          delivery_count,\r\n          sent_at,\r\n          template_used,\r\n          error_message,\r\n          sender:sent_by_user_id (\r\n            full_name,\r\n            role\r\n          )\r\n        `)\r\n        .eq('school_id', schoolId)\r\n        .order('sent_at', { ascending: false });\r\n\r\n      if (error) {\r\n        console.error('CommunicationService: Erreur lors de la r√©cup√©ration de l\\'historique:', error);\r\n        // Si la table n'existe pas encore, retourner un tableau vide\r\n        if (error.code === 'PGRST205' || error.message?.includes('table') || error.message?.includes('relationship')) {\r\n          console.log('CommunicationService: Table communications pas encore cr√©√©e, retour d\\'un tableau vide');\r\n          return [];\r\n        }\r\n        return [];\r\n      }\r\n\r\n      console.log('CommunicationService: Communications trouv√©es:', data?.length || 0);\r\n\r\n      // Transformer les donn√©es pour correspondre au format attendu\r\n      const communications = (data || []).map(comm => {\r\n        const recipientsData = Array.isArray(comm.recipients_data) ? comm.recipients_data : [];\r\n        const recipientNames = recipientsData.map(r => r.name || 'Destinataire').slice(0, 3);\r\n        if (recipientsData.length > 3) {\r\n          recipientNames.push(`+${recipientsData.length - 3} autres`);\r\n        }\r\n\r\n        return {\r\n          id: comm.id,\r\n          type: comm.message_type,\r\n          subject: comm.subject || 'Message sans sujet',\r\n          recipients: recipientNames,\r\n          sentDate: new Date(comm.sent_at).toLocaleDateString('fr-FR', {\r\n            year: 'numeric',\r\n            month: '2-digit',\r\n            day: '2-digit',\r\n            hour: '2-digit',\r\n            minute: '2-digit'\r\n          }),\r\n          status: comm.status,\r\n          deliveryCount: comm.delivery_count,\r\n          totalCount: comm.recipient_count,\r\n          template: comm.template_used,\r\n          sender: comm.sender?.full_name || 'Exp√©diteur inconnu',\r\n          content: comm.content,\r\n          errorMessage: comm.error_message\r\n        };\r\n      });\r\n\r\n      console.log('CommunicationService: Historique format√©:', communications.length);\r\n      if (communications.length > 0) {\r\n        console.log('CommunicationService: Premi√®re communication:', communications[0]);\r\n      }\r\n\r\n      return communications;\r\n    } catch (error) {\r\n      console.error('CommunicationService: Erreur dans getCommunicationsHistory:', error);\r\n      return [];\r\n    }\r\n  }\r\n\r\n  // Obtenir les templates de messages\r\n  async getMessageTemplates() {\r\n    console.log('CommunicationService: Mode production forc√© - r√©cup√©ration des templates');\r\n\r\n    try {\r\n      const schoolId = await getCurrentSchoolId();\r\n      if (!schoolId) {\r\n        console.log('CommunicationService: Aucun ID d\\'√©cole pour les templates');\r\n        return [];\r\n      }\r\n\r\n      const { data, error } = await supabase\r\n        .from('message_templates')\r\n        .select('*')\r\n        .eq('school_id', schoolId)\r\n        .eq('is_active', true)\r\n        .order('category', { ascending: true });\r\n\r\n      if (error) {\r\n        console.error('CommunicationService: Erreur lors de la r√©cup√©ration des templates:', error);\r\n        // Si la table n'existe pas encore, retourner des templates par d√©faut\r\n        if (error.code === 'PGRST205' || error.message?.includes('table')) {\r\n          console.log('CommunicationService: Table message_templates pas encore cr√©√©e, retour des templates par d√©faut');\r\n          return [\r\n            { value: 'custom', label: 'Message personnalis√©', category: 'custom', content: '', variables: [] },\r\n            { value: 'absence', label: 'Justification d\\'absence', category: 'attendance', content: 'Bonjour, votre enfant √©tait absent le {date}. Merci de fournir une justification.', variables: ['date'] },\r\n            { value: 'payment', label: 'Rappel de paiement', category: 'financial', content: 'Cher parent, un paiement est en attente. Merci de r√©gulariser.', variables: [] },\r\n            { value: 'announcement', label: 'Annonce g√©n√©rale', category: 'general', content: 'Chers parents, nous vous informons que {message}.', variables: ['message'] }\r\n          ];\r\n        }\r\n        return [];\r\n      }\r\n\r\n      console.log('CommunicationService: Templates trouv√©s:', data?.length || 0);\r\n\r\n      // Transformer en format option pour Select\r\n      const templates = (data || []).map(template => ({\r\n        value: template.id,\r\n        label: template.name,\r\n        category: template.category,\r\n        content: template.content,\r\n        variables: template.variables || []\r\n      }));\r\n\r\n      return templates;\r\n    } catch (error) {\r\n      console.error('CommunicationService: Erreur dans getMessageTemplates:', error);\r\n      return [];\r\n    }\r\n  }\r\n\r\n  // Envoyer un message\r\n  async sendMessage(messageData) {\r\n    console.log('CommunicationService: Mode production forc√© - envoi de message');\r\n\r\n    try {\r\n      const schoolId = await getCurrentSchoolId();\r\n      if (!schoolId) {\r\n        throw new Error('√âcole non trouv√©e');\r\n      }\r\n\r\n      // R√©cup√©rer l'utilisateur connect√©\r\n      const { data: { user } } = await supabase.auth.getUser();\r\n      if (!user) {\r\n        throw new Error('Utilisateur non authentifi√©');\r\n      }\r\n\r\n      console.log('CommunicationService: Pr√©paration envoi message:', {\r\n        type: messageData.type,\r\n        recipients: messageData.recipients.length,\r\n        school: schoolId\r\n      });\r\n\r\n      // Pr√©parer les donn√©es de la communication\r\n      const communicationData = {\r\n        school_id: schoolId,\r\n        sent_by_user_id: user.id,\r\n        message_type: messageData.type,\r\n        subject: messageData.subject,\r\n        content: messageData.content,\r\n        template_used: messageData.templateUsed,\r\n        recipients_data: messageData.recipients,\r\n        status: 'delivered', // Simuler la livraison r√©ussie\r\n        delivery_count: messageData.recipients.length,\r\n        sent_at: new Date().toISOString()\r\n      };\r\n\r\n      // Ins√©rer dans la base de donn√©es\r\n      const { data, error } = await supabase\r\n        .from('communications')\r\n        .insert(communicationData)\r\n        .select()\r\n        .single();\r\n\r\n      if (error) {\r\n        console.error('CommunicationService: Erreur lors de l\\'insertion:', error);\r\n        throw error;\r\n      }\r\n\r\n      console.log('CommunicationService: Message enregistr√© avec succ√®s:', data.id);\r\n\r\n      // Ici, vous pourriez ajouter l'int√©gration avec un vrai service SMS/Email\r\n      // Pour l'instant, nous simulons un envoi r√©ussi\r\n      return {\r\n        success: true,\r\n        messageId: data.id,\r\n        deliveredCount: messageData.recipients.length,\r\n        message: 'Message envoy√© avec succ√®s'\r\n      };\r\n    } catch (error) {\r\n      console.error('CommunicationService: Erreur dans sendMessage:', error);\r\n      return {\r\n        success: false,\r\n        error: error.message\r\n      };\r\n    }\r\n  }\r\n\r\n  // Cr√©er ou mettre √† jour un template\r\n  async saveTemplate(templateData) {\r\n    try {\r\n      const schoolId = await getCurrentSchoolId();\r\n      if (!schoolId) {\r\n        throw new Error('√âcole non trouv√©e');\r\n      }\r\n\r\n      const { data: { user } } = await supabase.auth.getUser();\r\n      if (!user) {\r\n        throw new Error('Utilisateur non authentifi√©');\r\n      }\r\n\r\n      const templateRecord = {\r\n        school_id: schoolId,\r\n        name: templateData.name,\r\n        category: templateData.category,\r\n        content: templateData.content,\r\n        variables: templateData.variables || [],\r\n        created_by: user.id\r\n      };\r\n\r\n      let result;\r\n      if (templateData.id) {\r\n        // Mise √† jour\r\n        result = await supabase\r\n          .from('message_templates')\r\n          .update(templateRecord)\r\n          .eq('id', templateData.id)\r\n          .eq('school_id', schoolId)\r\n          .select()\r\n          .single();\r\n      } else {\r\n        // Cr√©ation\r\n        result = await supabase\r\n          .from('message_templates')\r\n          .insert(templateRecord)\r\n          .select()\r\n          .single();\r\n      }\r\n\r\n      if (result.error) {\r\n        throw result.error;\r\n      }\r\n\r\n      console.log('CommunicationService: Template sauvegard√©:', result.data.id);\r\n      return { success: true, data: result.data };\r\n    } catch (error) {\r\n      console.error('CommunicationService: Erreur dans saveTemplate:', error);\r\n      return { success: false, error: error.message };\r\n    }\r\n  }\r\n\r\n  // Obtenir les statistiques de communication\r\n  async getCommunicationStats() {\r\n    try {\r\n      const schoolId = await getCurrentSchoolId();\r\n      if (!schoolId) {\r\n        return {\r\n          totalSent: 0,\r\n          delivered: 0,\r\n          failed: 0,\r\n          thisWeek: 0\r\n        };\r\n      }\r\n\r\n      const { data, error } = await supabase\r\n        .from('communications')\r\n        .select('status, sent_at, delivery_count')\r\n        .eq('school_id', schoolId);\r\n\r\n      if (error) {\r\n        console.error('CommunicationService: Erreur stats:', error);\r\n        return {\r\n          totalSent: 0,\r\n          delivered: 0,\r\n          failed: 0,\r\n          thisWeek: 0\r\n        };\r\n      }\r\n\r\n      const now = new Date();\r\n      const weekAgo = new Date(now.getTime() - 7 * 24 * 60 * 60 * 1000);\r\n\r\n      const stats = (data || []).reduce((acc, comm) => {\r\n        acc.totalSent++;\r\n        if (comm.status === 'delivered' || comm.status === 'partial') {\r\n          acc.delivered++;\r\n        } else if (comm.status === 'failed') {\r\n          acc.failed++;\r\n        }\r\n        \r\n        if (new Date(comm.sent_at) >= weekAgo) {\r\n          acc.thisWeek++;\r\n        }\r\n        \r\n        return acc;\r\n      }, {\r\n        totalSent: 0,\r\n        delivered: 0,\r\n        failed: 0,\r\n        thisWeek: 0\r\n      });\r\n\r\n      console.log('CommunicationService: Stats calcul√©es:', stats);\r\n      return stats;\r\n    } catch (error) {\r\n      console.error('CommunicationService: Erreur dans getCommunicationStats:', error);\r\n      return {\r\n        totalSent: 0,\r\n        delivered: 0,\r\n        failed: 0,\r\n        thisWeek: 0\r\n      };\r\n    }\r\n  }\r\n}\r\n\r\nexport const communicationService = new CommunicationService();\r\nexport default communicationService;\r\n","import React, { useState, useEffect } from 'react';\r\nimport Icon from '../../../components/AppIcon';\r\nimport Button from '../../../components/ui/Button';\r\nimport Input from '../../../components/ui/Input';\r\nimport Select from '../../../components/ui/Select';\r\nimport { Checkbox } from '../../../components/ui/Checkbox';\r\nimport { communicationService } from '../../../services/communicationService';\r\n\r\nconst NotificationCenter = () => {\r\n  const [selectedTab, setSelectedTab] = useState('send');\r\n  const [messageType, setMessageType] = useState('both');\r\n  const [message, setMessage] = useState('');\r\n  const [subject, setSubject] = useState('');\r\n  const [selectedTemplate, setSelectedTemplate] = useState('custom');\r\n  const [recipients, setRecipients] = useState([]);\r\n  const [sending, setSending] = useState(false);\r\n\r\n  // Real data state\r\n  const [parents, setParents] = useState([]);\r\n  const [sentMessages, setSentMessages] = useState([]);\r\n  const [templates, setTemplates] = useState([]);\r\n  const [loading, setLoading] = useState(true);\r\n\r\n  // Load data on component mount\r\n  useEffect(() => {\r\n    const loadData = async () => {\r\n      try {\r\n        setLoading(true);\r\n        const [parentsRes, historyRes, templatesRes] = await Promise.all([\r\n          communicationService.getParentsBySchool(),\r\n          communicationService.getCommunicationsHistory(),\r\n          communicationService.getMessageTemplates()\r\n        ]);\r\n\r\n        setParents(parentsRes || []);\r\n        setSentMessages(historyRes || []);\r\n        \r\n        // Ajouter des templates par d√©faut s'ils sont vides\r\n        const defaultTemplates = [\r\n          { \r\n            value: 'custom', \r\n            label: '‚úèÔ∏è Message personnalis√©', \r\n            category: 'custom', \r\n            content: '', \r\n            subjectDefault: '' \r\n          },\r\n          { \r\n            value: 'absence', \r\n            label: 'üìÖ Justification d\\'absence', \r\n            category: 'attendance', \r\n            content: 'Bonjour,\\n\\nVotre enfant {nom_enfant} √©tait absent(e) le {date}. Nous vous remercions de bien vouloir fournir un justificatif d\\'absence dans les plus brefs d√©lais.\\n\\nCordialement,\\nL\\'administration', \r\n            subjectDefault: 'Justificatif d\\'absence requis'\r\n          },\r\n          { \r\n            value: 'payment', \r\n            label: 'üí∞ Rappel de paiement', \r\n            category: 'financial', \r\n            content: 'Cher(e) parent,\\n\\nNous vous rappelons qu\\'un paiement concernant {nom_enfant} est en attente.\\n\\nMontant : {montant}\\nDate limite : {date_limite}\\n\\nMerci de r√©gulariser votre situation d√®s que possible.\\n\\nCordialement,\\nLe service financier', \r\n            subjectDefault: 'Rappel de paiement'\r\n          },\r\n          { \r\n            value: 'meeting', \r\n            label: 'üë• Convocation r√©union', \r\n            category: 'general', \r\n            content: 'Chers parents,\\n\\nVous √™tes convoqu√©(e) √† une r√©union le {date} √† {heure} concernant {sujet}.\\n\\nLieu : {lieu}\\n\\nVotre pr√©sence est importante.\\n\\nCordialement,\\nL\\'administration', \r\n            subjectDefault: 'Convocation √† une r√©union'\r\n          },\r\n          { \r\n            value: 'results', \r\n            label: 'üìä Publication des r√©sultats', \r\n            category: 'academic', \r\n            content: 'Bonjour,\\n\\nLes r√©sultats de {nom_enfant} pour {periode} sont maintenant disponibles.\\n\\nVous pouvez les consulter sur notre plateforme ou passer les r√©cup√©rer au secr√©tariat.\\n\\nCordialement,\\nL\\'√©quipe p√©dagogique', \r\n            subjectDefault: 'R√©sultats disponibles'\r\n          },\r\n          { \r\n            value: 'event', \r\n            label: 'üéâ Annonce √©v√©nement', \r\n            category: 'general', \r\n            content: 'Chers parents,\\n\\nNous avons le plaisir de vous annoncer {evenement} qui se tiendra le {date}.\\n\\n{details}\\n\\nNous comptons sur votre participation.\\n\\nCordialement,\\nL\\'√©quipe organisatrice', \r\n            subjectDefault: 'Annonce d\\'√©v√©nement'\r\n          },\r\n          { \r\n            value: 'health', \r\n            label: 'üè• Information sant√©', \r\n            category: 'health', \r\n            content: 'Cher(e) parent,\\n\\nNous vous informons que {nom_enfant} {information_sante}.\\n\\nMerci de nous contacter si besoin.\\n\\nCordialement,\\nL\\'infirmerie scolaire', \r\n            subjectDefault: 'Information sant√©'\r\n          },\r\n          { \r\n            value: 'behavior', \r\n            label: '‚ö†Ô∏è Note de comportement', \r\n            category: 'discipline', \r\n            content: 'Cher(e) parent,\\n\\nNous souhaitons attirer votre attention sur le comportement de {nom_enfant}.\\n\\n{description}\\n\\nNous vous demandons de prendre les mesures n√©cessaires.\\n\\nCordialement,\\nLa vie scolaire', \r\n            subjectDefault: 'Note de comportement'\r\n          }\r\n        ];\r\n        \r\n        setTemplates(templatesRes && templatesRes.length > 0 ? templatesRes : defaultTemplates);\r\n      } catch (error) {\r\n        console.error('Error loading communication data:', error);\r\n        setParents([]);\r\n        setSentMessages([]);\r\n        setTemplates([]);\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    };\r\n\r\n    loadData();\r\n  }, []);\r\n\r\n  // G√©rer le changement de template et appliquer le contenu\r\n  const handleTemplateChange = (templateValue) => {\r\n    setSelectedTemplate(templateValue);\r\n    \r\n    const template = templates.find(t => t.value === templateValue);\r\n    if (template && template.content) {\r\n      setMessage(template.content);\r\n      if (template.subjectDefault) {\r\n        setSubject(template.subjectDefault);\r\n      }\r\n    } else {\r\n      // Template personnalis√©, vider le message\r\n      setMessage('');\r\n      setSubject('');\r\n    }\r\n  };\r\n\r\n  // Filtres pour les parents\r\n  const [searchParent, setSearchParent] = useState('');\r\n  const [filterClass, setFilterClass] = useState('all');\r\n\r\n  // Filtrer les parents selon la recherche et la classe\r\n  const filteredParents = parents.filter(parent => {\r\n    const matchesSearch = searchParent === '' || \r\n      parent.name.toLowerCase().includes(searchParent.toLowerCase()) ||\r\n      parent.studentName.toLowerCase().includes(searchParent.toLowerCase()) ||\r\n      parent.phone.includes(searchParent);\r\n    \r\n    const matchesClass = filterClass === 'all' || parent.class.includes(filterClass);\r\n    \r\n    return matchesSearch && matchesClass;\r\n  });\r\n\r\n  // Classes disponibles\r\n  const availableClasses = ['all', ...new Set(parents.flatMap(p => \r\n    p.class.split(', ').filter(c => c !== 'Non d√©finie')\r\n  ))].filter(Boolean);\r\n\r\n  const handleSelectAll = () => {\r\n    if (recipients.length === parents.length) {\r\n      setRecipients([]);\r\n    } else {\r\n      setRecipients(parents?.map(p => p?.id));\r\n    }\r\n  };\r\n\r\n  const handleRecipientToggle = (parentId) => {\r\n    if (recipients.includes(parentId)) {\r\n      setRecipients(recipients.filter(id => id !== parentId));\r\n    } else {\r\n      setRecipients([...recipients, parentId]);\r\n    }\r\n  };\r\n\r\n  const handleSendMessage = async () => {\r\n    if (!message || recipients.length === 0) {\r\n      alert('Veuillez saisir un message et s√©lectionner au moins un destinataire.');\r\n      return;\r\n    }\r\n\r\n    try {\r\n      setSending(true);\r\n      const selectedParents = parents.filter(parent => recipients.includes(parent?.id));\r\n      const recipientsData = selectedParents.map(parent => ({\r\n        id: parent?.id,\r\n        name: parent?.name || `${parent?.first_name} ${parent?.last_name}`,\r\n        phone: parent?.phone,\r\n        email: parent?.email,\r\n        studentName: parent?.studentName || (parent?.students && parent?.students?.first_name + ' ' + parent?.students?.last_name)\r\n      }));\r\n\r\n      await communicationService.sendMessage({\r\n        type: messageType,\r\n        subject: subject || 'Message important',\r\n        message,\r\n        recipients: recipientsData\r\n      });\r\n\r\n      // Reset form\r\n      setMessage('');\r\n      setSubject('');\r\n      setRecipients([]);\r\n      setSelectedTemplate('custom');\r\n      \r\n      alert('Message envoy√© avec succ√®s !');\r\n      \r\n      // Reload history\r\n      const historyRes = await communicationService.getCommunicationsHistory();\r\n      setSentMessages(historyRes || []);\r\n    } catch (error) {\r\n      console.error('Error sending message:', error);\r\n      alert('Erreur lors de l\\'envoi du message.');\r\n    } finally {\r\n      setSending(false);\r\n    }\r\n  };\r\n\r\n  const getStatusIcon = (status) => {\r\n    switch (status) {\r\n      case 'delivered':\r\n        return { icon: 'CheckCircle', className: 'text-success' };\r\n      case 'failed':\r\n        return { icon: 'XCircle', className: 'text-error' };\r\n      default:\r\n        return { icon: 'Clock', className: 'text-warning' };\r\n    }\r\n  };\r\n\r\n  const getTypeIcon = (type) => {\r\n    switch (type) {\r\n      case 'sms':\r\n        return 'MessageSquare';\r\n      case 'email':\r\n        return 'Mail';\r\n      case 'whatsapp':\r\n        return 'Phone'; // Lucide a Phone qui ressemble au logo WhatsApp\r\n      case 'both':\r\n        return 'Send';\r\n      case 'all':\r\n        return 'Zap';\r\n      default:\r\n        return 'MessageSquare';\r\n    }\r\n  };\r\n\r\n  // Loading state\r\n  if (loading) {\r\n    return (\r\n      <div className=\"flex items-center justify-center h-64\">\r\n        <div className=\"flex items-center space-x-2 text-text-secondary\">\r\n          <Icon name=\"Loader2\" size={20} className=\"animate-spin\" />\r\n          <span>Chargement des communications...</span>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      {/* Header */}\r\n      <div>\r\n        <h2 className=\"font-heading font-heading-bold text-xl text-text-primary\">\r\n          Centre de Notifications\r\n        </h2>\r\n        <p className=\"font-body font-body-normal text-sm text-text-secondary mt-1\">\r\n          Envoyez des messages SMS et emails aux parents\r\n        </p>\r\n      </div>\r\n\r\n      {/* Tabs */}\r\n      <div className=\"border-b border-border\">\r\n        <nav className=\"flex space-x-8\">\r\n          <button\r\n            onClick={() => setSelectedTab('send')}\r\n            className={`py-2 px-1 border-b-2 font-body font-body-semibold text-sm transition-micro ${\r\n              selectedTab === 'send' \r\n                ? 'border-primary text-primary' \r\n                : 'border-transparent text-text-secondary hover:text-text-primary'\r\n            }`}\r\n          >\r\n            <div className=\"flex items-center space-x-2\">\r\n              <Icon name=\"Send\" size={16} />\r\n              <span>Envoyer un message</span>\r\n            </div>\r\n          </button>\r\n          <button\r\n            onClick={() => setSelectedTab('history')}\r\n            className={`py-2 px-1 border-b-2 font-body font-body-semibold text-sm transition-micro ${\r\n              selectedTab === 'history' \r\n                ? 'border-primary text-primary' \r\n                : 'border-transparent text-text-secondary hover:text-text-primary'\r\n            }`}\r\n          >\r\n            <div className=\"flex items-center space-x-2\">\r\n              <Icon name=\"History\" size={16} />\r\n              <span>Historique</span>\r\n            </div>\r\n          </button>\r\n        </nav>\r\n      </div>\r\n\r\n      {/* Send Message Tab */}\r\n      {selectedTab === 'send' && (\r\n        <div className=\"space-y-6\">\r\n          {/* Message Configuration */}\r\n          <div className=\"bg-card rounded-lg border border-border p-6\">\r\n            <h3 className=\"font-heading font-heading-semibold text-lg text-text-primary mb-4\">\r\n              Configuration du message\r\n            </h3>\r\n            \r\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4\">\r\n              <Select\r\n                label=\"Type de message\"\r\n                value={messageType}\r\n                onChange={setMessageType}\r\n                options={[\r\n                  { value: 'sms', label: 'üì± SMS uniquement' },\r\n                  { value: 'email', label: 'üìß Email uniquement' },\r\n                  { value: 'whatsapp', label: 'üí¨ WhatsApp' },\r\n                  { value: 'both', label: 'üì±üìß SMS + Email' },\r\n                  { value: 'all', label: 'üöÄ Tous les canaux' }\r\n                ]}\r\n              />\r\n              \r\n              <Select\r\n                label=\"Mod√®le de message\"\r\n                value={selectedTemplate}\r\n                onChange={handleTemplateChange}\r\n                options={templates.map(t => ({ value: t.value, label: t.label }))}\r\n                helperText=\"S√©lectionnez un mod√®le pr√©fait ou personnalisez votre message\"\r\n              />\r\n            </div>\r\n\r\n            {/* Note WhatsApp API */}\r\n            {(messageType === 'whatsapp' || messageType === 'all') && (\r\n              <div className=\"mb-4 p-3 bg-green-50 border border-green-200 rounded-lg\">\r\n                <div className=\"flex items-start space-x-2\">\r\n                  <Icon name=\"Info\" size={16} className=\"text-green-600 mt-0.5\" />\r\n                  <div className=\"flex-1\">\r\n                    <p className=\"text-sm font-medium text-green-900 mb-1\">\r\n                      üí¨ WhatsApp Business API\r\n                    </p>\r\n                    <p className=\"text-xs text-green-700\">\r\n                      L'int√©gration WhatsApp sera disponible prochainement. Les messages seront envoy√©s via l'API WhatsApp Business officielle pour une meilleure d√©livrabilit√©.\r\n                    </p>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            )}\r\n            \r\n            {/* Aide pour les variables */}\r\n            {selectedTemplate !== 'custom' && (\r\n              <div className=\"mb-4 p-3 bg-blue-50 border border-blue-200 rounded-lg\">\r\n                <div className=\"flex items-start space-x-2\">\r\n                  <Icon name=\"Info\" size={16} className=\"text-blue-600 mt-0.5\" />\r\n                  <div className=\"flex-1\">\r\n                    <p className=\"text-sm font-medium text-blue-900 mb-1\">\r\n                      Variables disponibles dans ce mod√®le :\r\n                    </p>\r\n                    <p className=\"text-xs text-blue-700\">\r\n                      Vous pouvez personnaliser les mots entre accolades comme {'{nom_enfant}'}, {'{date}'}, {'{heure}'}, etc.\r\n                    </p>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            )}\r\n            \r\n            <div className=\"space-y-4\">\r\n              <div>\r\n                <Input\r\n                  label=\"Sujet (optionnel pour SMS, requis pour Email)\"\r\n                  value={subject}\r\n                  onChange={setSubject}\r\n                  placeholder=\"Ex: Convocation, Rappel, Information importante...\"\r\n                />\r\n              </div>\r\n              \r\n              <div>\r\n                <div className=\"flex items-center justify-between mb-2\">\r\n                  <label className=\"block font-body font-body-medium text-sm text-text-primary\">\r\n                    Message *\r\n                  </label>\r\n                  <span className=\"text-xs text-text-secondary\">\r\n                    {message.length} caract√®res\r\n                    {messageType === 'sms' && message.length > 160 && (\r\n                      <span className=\"text-warning ml-2\">\r\n                        ({Math.ceil(message.length / 160)} SMS)\r\n                      </span>\r\n                    )}\r\n                  </span>\r\n                </div>\r\n                <textarea\r\n                  value={message}\r\n                  onChange={(e) => setMessage(e.target.value)}\r\n                  placeholder=\"Tapez votre message ici ou s√©lectionnez un mod√®le ci-dessus...\"\r\n                  className=\"w-full h-40 p-3 border border-border rounded-lg resize-none focus:outline-none focus:ring-2 focus:ring-primary/20 font-body\"\r\n                  required\r\n                />\r\n                {messageType === 'sms' && message.length > 160 && (\r\n                  <p className=\"text-xs text-warning mt-1\">\r\n                    ‚ö†Ô∏è Les SMS de plus de 160 caract√®res sont divis√©s en plusieurs messages\r\n                  </p>\r\n                )}\r\n              </div>\r\n              \r\n              {/* Boutons d'action rapide */}\r\n              <div className=\"flex items-center space-x-2\">\r\n                <button\r\n                  type=\"button\"\r\n                  onClick={() => setMessage(message + '\\n\\nCordialement,\\nL\\'administration')}\r\n                  className=\"text-xs text-primary hover:underline\"\r\n                >\r\n                  + Ajouter signature\r\n                </button>\r\n                <span className=\"text-text-secondary\">‚Ä¢</span>\r\n                <button\r\n                  type=\"button\"\r\n                  onClick={() => setMessage('')}\r\n                  className=\"text-xs text-error hover:underline\"\r\n                >\r\n                  Effacer le message\r\n                </button>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          {/* Recipients Selection */}\r\n          <div className=\"bg-card rounded-lg border border-border p-6\">\r\n            <div className=\"flex items-center justify-between mb-4\">\r\n              <h3 className=\"font-heading font-heading-semibold text-lg text-text-primary\">\r\n                Destinataires ({filteredParents?.length})\r\n              </h3>\r\n              <div className=\"flex items-center space-x-2\">\r\n                <span className=\"text-sm text-text-secondary\">\r\n                  {recipients.length} s√©lectionn√©(s)\r\n                </span>\r\n                <Button\r\n                  variant=\"outline\"\r\n                  size=\"sm\"\r\n                  onClick={handleSelectAll}\r\n                >\r\n                  {recipients.length === filteredParents.length ? 'D√©s√©lectionner tout' : 'S√©lectionner tout'}\r\n                </Button>\r\n              </div>\r\n            </div>\r\n\r\n            {/* Filtres */}\r\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4\">\r\n              <Input\r\n                placeholder=\"Rechercher un parent, √©l√®ve ou t√©l√©phone...\"\r\n                value={searchParent}\r\n                onChange={setSearchParent}\r\n                icon=\"Search\"\r\n              />\r\n              <Select\r\n                value={filterClass}\r\n                onChange={setFilterClass}\r\n                options={[\r\n                  { value: 'all', label: 'Toutes les classes' },\r\n                  ...availableClasses.filter(c => c !== 'all').map(c => ({ value: c, label: c }))\r\n                ]}\r\n              />\r\n            </div>\r\n            \r\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n              {filteredParents?.length === 0 ? (\r\n                <div className=\"col-span-full text-center py-8\">\r\n                  <Icon name=\"Users\" size={32} className=\"text-muted-foreground mx-auto mb-4\" />\r\n                  <h4 className=\"font-heading font-heading-medium text-base text-text-primary mb-2\">\r\n                    {parents?.length === 0 ? 'Aucun parent trouv√©' : 'Aucun r√©sultat'}\r\n                  </h4>\r\n                  <p className=\"text-text-secondary\">\r\n                    {parents?.length === 0 \r\n                      ? 'Aucun parent n\\'est enregistr√© dans la base de donn√©es pour cette √©cole.'\r\n                      : 'Aucun parent ne correspond √† vos crit√®res de recherche.'}\r\n                  </p>\r\n                </div>\r\n              ) : (\r\n                filteredParents?.map((parent) => (\r\n                  <div key={parent?.id} className=\"flex items-center space-x-3 p-3 border border-border rounded-lg hover:bg-accent/5 transition-micro\">\r\n                    <Checkbox\r\n                      checked={recipients?.includes(parent?.id)}\r\n                      onChange={() => handleRecipientToggle(parent?.id)}\r\n                    />\r\n                    <div className=\"flex-1\">\r\n                      <p className=\"font-body font-body-semibold text-sm text-text-primary\">\r\n                        {parent?.name || `${parent?.first_name} ${parent?.last_name}`}\r\n                      </p>\r\n                      <p className=\"font-caption font-caption-normal text-xs text-text-secondary\">\r\n                        üë¶ {parent?.studentName || (parent?.students && `${parent?.students?.first_name} ${parent?.students?.last_name}`)} \r\n                        <span className=\"ml-2\">üìö {parent?.class || parent?.students?.current_class}</span>\r\n                      </p>\r\n                      <div className=\"flex items-center space-x-4 mt-1\">\r\n                        <span className=\"font-caption font-caption-normal text-xs text-text-secondary\">\r\n                          üì± {parent?.phone}\r\n                        </span>\r\n                        {parent?.email && (\r\n                          <span className=\"font-caption font-caption-normal text-xs text-text-secondary\">\r\n                            ‚úâÔ∏è {parent?.email}\r\n                          </span>\r\n                        )}\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                ))\r\n              )}\r\n            </div>\r\n          </div>\r\n\r\n          {/* Send Button */}\r\n          <div className=\"flex justify-end\">\r\n            <Button\r\n              variant=\"default\"\r\n              iconName={sending ? \"Loader2\" : \"Send\"}\r\n              iconClassName={sending ? \"animate-spin\" : \"\"}\r\n              onClick={handleSendMessage}\r\n              disabled={sending || !message || recipients.length === 0}\r\n            >\r\n              {sending ? 'Envoi en cours...' : 'Envoyer le message'}\r\n            </Button>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* History Tab */}\r\n      {selectedTab === 'history' && (\r\n        <div className=\"space-y-6\">\r\n          <div className=\"bg-card rounded-lg border border-border\">\r\n            <div className=\"p-4 border-b border-border\">\r\n              <h3 className=\"font-heading font-heading-semibold text-lg text-text-primary\">\r\n                Messages envoy√©s\r\n              </h3>\r\n            </div>\r\n\r\n            <div className=\"divide-y divide-border\">\r\n              {sentMessages?.length === 0 ? (\r\n                <div className=\"p-8 text-center\">\r\n                  <Icon name=\"MessageCircle\" size={32} className=\"text-muted-foreground mx-auto mb-4\" />\r\n                  <h4 className=\"font-heading font-heading-medium text-base text-text-primary mb-2\">\r\n                    Aucun message envoy√©\r\n                  </h4>\r\n                  <p className=\"text-text-secondary\">\r\n                    L'historique de vos communications appara√Ætra ici une fois que vous aurez envoy√© des messages.\r\n                  </p>\r\n                </div>\r\n              ) : (\r\n                sentMessages?.map((msg) => {\r\n                  const statusConfig = getStatusIcon(msg?.status);\r\n                  \r\n                  return (\r\n                      <div key={msg?.id} className=\"p-4\">\r\n                      <div className=\"flex items-start justify-between\">\r\n                        <div className=\"flex items-start space-x-3\">\r\n                          <div className=\"w-10 h-10 bg-primary/10 rounded-lg flex items-center justify-center\">\r\n                            {msg?.type === 'whatsapp' ? (\r\n                              <span className=\"text-xl\">üí¨</span>\r\n                            ) : (\r\n                              <Icon name={getTypeIcon(msg?.type)} size={20} className=\"text-primary\" />\r\n                            )}\r\n                          </div>\r\n                          <div>\r\n                            <p className=\"font-body font-body-semibold text-sm text-text-primary\">\r\n                              {msg?.subject}\r\n                            </p>\r\n                            <p className=\"font-caption font-caption-normal text-xs text-text-secondary mt-1\">\r\n                              Destinataires: {msg?.recipients?.join(', ')}\r\n                            </p>\r\n                            <p className=\"font-caption font-caption-normal text-xs text-text-secondary\">\r\n                              Envoy√© le {msg?.sentDate}\r\n                            </p>\r\n                          </div>\r\n                        </div>\r\n\r\n                        <div className=\"flex items-center space-x-3\">\r\n                          <div className=\"text-right\">\r\n                            <div className={`flex items-center space-x-1 ${statusConfig?.className}`}>\r\n                              <Icon name={statusConfig?.icon} size={16} />\r\n                              <span className=\"font-caption font-caption-normal text-xs\">\r\n                                {msg?.status === 'delivered' ? 'Livr√©' : \r\n                                 msg?.status === 'failed' ? '√âchec' : 'En cours'}\r\n                              </span>\r\n                            </div>\r\n                            <p className=\"font-caption font-caption-normal text-xs text-text-secondary mt-1\">\r\n                              {msg?.deliveryCount} message(s)\r\n                            </p>\r\n                          </div>\r\n                          <Button\r\n                            variant=\"ghost\"\r\n                            size=\"icon\"\r\n                            title=\"Voir les d√©tails\"\r\n                          >\r\n                            <Icon name=\"Eye\" size={16} />\r\n                          </Button>\r\n                        </div>\r\n                      </div>\r\n                    </div>\r\n                  );\r\n                })\r\n              )}\r\n            </div>\r\n\r\n            {/* Statistics */}\r\n            <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4 p-4 bg-background/50\">\r\n              <div className=\"bg-card rounded-lg border border-border p-4\">\r\n                <div className=\"flex items-center space-x-3\">\r\n                  <div className=\"w-10 h-10 bg-primary/10 rounded-lg flex items-center justify-center\">\r\n                    <Icon name=\"Send\" size={20} className=\"text-primary\" />\r\n                  </div>\r\n                  <div>\r\n                    <p className=\"font-heading font-heading-semibold text-lg text-text-primary\">\r\n                      {sentMessages?.length || 0}\r\n                    </p>\r\n                    <p className=\"font-caption font-caption-normal text-xs text-text-secondary\">\r\n                      Messages envoy√©s\r\n                    </p>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n              \r\n              <div className=\"bg-card rounded-lg border border-border p-4\">\r\n                <div className=\"flex items-center space-x-3\">\r\n                  <div className=\"w-10 h-10 bg-success/10 rounded-lg flex items-center justify-center\">\r\n                    <Icon name=\"CheckCircle\" size={20} className=\"text-success\" />\r\n                  </div>\r\n                  <div>\r\n                    <p className=\"font-heading font-heading-semibold text-lg text-text-primary\">\r\n                      {sentMessages?.filter(m => m?.status === 'delivered')?.length || 0}\r\n                    </p>\r\n                    <p className=\"font-caption font-caption-normal text-xs text-text-secondary\">\r\n                      Messages livr√©s\r\n                    </p>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n\r\n              <div className=\"bg-card rounded-lg border border-border p-4\">\r\n                <div className=\"flex items-center space-x-3\">\r\n                  <div className=\"w-10 h-10 bg-error/10 rounded-lg flex items-center justify-center\">\r\n                    <Icon name=\"XCircle\" size={20} className=\"text-error\" />\r\n                  </div>\r\n                  <div>\r\n                    <p className=\"font-heading font-heading-semibold text-lg text-text-primary\">\r\n                      {sentMessages?.filter(m => m?.status === 'failed')?.length || 0}\r\n                    </p>\r\n                    <p className=\"font-caption font-caption-normal text-xs text-text-secondary\">\r\n                      √âchecs de livraison\r\n                    </p>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default NotificationCenter;","import React, { useState, useEffect } from 'react';\r\nimport Icon from '../../../components/AppIcon';\r\nimport Button from '../../../components/ui/Button';\r\nimport Input from '../../../components/ui/Input';\r\nimport Select from '../../../components/ui/Select';\r\nimport { supabase } from '../../../lib/supabase';\r\n\r\nconst TransferWorkflow = () => {\r\n  const [selectedStudent, setSelectedStudent] = useState('');\r\n  const [transferReason, setTransferReason] = useState('');\r\n  const [newSchool, setNewSchool] = useState('');\r\n  const [transferDate, setTransferDate] = useState('');\r\n  const [qrCodeGenerated, setQrCodeGenerated] = useState(false);\r\n  const [transferCode, setTransferCode] = useState('');\r\n  const [students, setStudents] = useState([]);\r\n  const [pendingTransfers, setPendingTransfers] = useState([]);\r\n  const [loading, setLoading] = useState(true);\r\n\r\n  // Charger les √©tudiants et transferts au montage\r\n  useEffect(() => {\r\n    const loadData = async () => {\r\n      setLoading(true);\r\n      try {\r\n        // Charger depuis Supabase\r\n        let schoolId = null;\r\n\r\n        // Essayer d'abord avec la session Supabase\r\n        const { data: { user: authUser } } = await supabase.auth.getUser();\r\n\r\n        if (authUser) {\r\n          // R√©cup√©rer l'√©cole depuis la table users\r\n          const { data: userData } = await supabase\r\n            .from('users')\r\n            .select('current_school_id')\r\n            .eq('id', authUser.id)\r\n            .single();\r\n          schoolId = userData?.current_school_id;\r\n        } else {\r\n          // Fallback : utiliser localStorage\r\n          const savedUser = localStorage.getItem('edutrack-user');\r\n          if (savedUser) {\r\n            const userData = JSON.parse(savedUser);\r\n            schoolId = userData.current_school_id || userData.school_id;\r\n          }\r\n        }\r\n\r\n        if (!schoolId) {\r\n          console.error('Aucune √©cole trouv√©e');\r\n          setPendingTransfers([]);\r\n          setStudents([]);\r\n          return;\r\n        }\r\n\r\n        // Charger les √©tudiants actifs de l'√©cole\r\n        const { data: studentsData, error: studentsError } = await supabase\r\n          .from('students')\r\n          .select('id, first_name, last_name')\r\n          .eq('is_active', true)\r\n          .eq('school_id', schoolId);\r\n\r\n        if (!studentsError && studentsData) {\r\n          setStudents(studentsData.map(s => ({\r\n            value: s.id,\r\n            label: `${s.first_name} ${s.last_name}`\r\n          })));\r\n        }\r\n\r\n        // Charger les transferts en cours de l'√©cole\r\n        const { data: transfers, error: transfersError } = await supabase\r\n          .from('transfers')\r\n          .select(`\r\n            *,\r\n            student:students(first_name, last_name)\r\n          `)\r\n          .eq('from_school_id', schoolId)\r\n          .order('request_date', { ascending: false });\r\n\r\n        if (!transfersError && transfers) {\r\n          setPendingTransfers(transfers.map(t => ({\r\n            id: t.id,\r\n            studentName: `${t.student?.first_name} ${t.student?.last_name}`,\r\n            studentId: t.student_id,\r\n            class: 'N/A',\r\n            transferDate: new Date(t.transfer_date).toLocaleDateString('fr-FR'),\r\n            newSchool: t.new_school_name,\r\n            reason: t.transfer_reason,\r\n            status: t.status,\r\n            transferCode: t.transfer_code,\r\n            qrCode: \"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTAwIiBoZWlnaHQ9IjEwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICA8cmVjdCB3aWR0aD0iMTAwIiBoZWlnaHQ9IjEwMCIgZmlsbD0iIzAwMCIvPgogIDxyZWN0IHg9IjEwIiB5PSIxMCIgd2lkdGg9IjgwIiBoZWlnaHQ9IjgwIiBmaWxsPSIjZmZmIi8+CiAgPHRleHQgeD0iNTAiIHk9IjU1IiB0ZXh0LWFuY2hvcj0ibWlkZGxlIiBmb250LXNpemU9IjEyIiBmaWxsPSIjMDAwIj5RUjwvdGV4dD4KPC9zdmc+\",\r\n            parentNotified: t.parent_notified || false,\r\n            documentsReady: t.documents_ready || false\r\n          })));\r\n        } else {\r\n          setPendingTransfers([]);\r\n        }\r\n      } catch (error) {\r\n        console.error('Erreur chargement donn√©es transfert:', error);\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    };\r\n\r\n    loadData();\r\n  }, []);\r\n\r\n  const reasonOptions = [\r\n    { value: 'relocation', label: 'D√©m√©nagement' },\r\n    { value: 'school_choice', label: 'Choix d\\'√©tablissement' },\r\n    { value: 'family_reasons', label: 'Raisons familiales' },\r\n    { value: 'academic_reasons', label: 'Raisons p√©dagogiques' },\r\n    { value: 'other', label: 'Autre' }\r\n  ];\r\n\r\n  const getStatusConfig = (status) => {\r\n    const configs = {\r\n      pending: {\r\n        label: 'En attente',\r\n        className: 'bg-warning/10 text-warning',\r\n        icon: 'Clock'\r\n      },\r\n      confirmed: {\r\n        label: 'Confirm√©',\r\n        className: 'bg-success/10 text-success',\r\n        icon: 'CheckCircle'\r\n      },\r\n      cancelled: {\r\n        label: 'Annul√©',\r\n        className: 'bg-error/10 text-error',\r\n        icon: 'XCircle'\r\n      }\r\n    };\r\n    return configs?.[status] || configs?.pending;\r\n  };\r\n\r\n  const generateTransferCode = () => {\r\n    const code = `TRF-${new Date()?.getFullYear()}-${String(Math.floor(Math.random() * 1000))?.padStart(3, '0')}`;\r\n    setTransferCode(code);\r\n    setQrCodeGenerated(true);\r\n  };\r\n\r\n  const handleInitiateTransfer = async () => {\r\n    if (!selectedStudent || !transferReason || !newSchool || !transferDate) {\r\n      alert('Veuillez remplir tous les champs obligatoires');\r\n      return;\r\n    }\r\n\r\n    // Cr√©er via Supabase\r\n    try {\r\n      setLoading(true);\r\n      const newCode = `TRF-${new Date().getFullYear()}-${String(Math.floor(Math.random() * 1000)).padStart(3, '0')}`;\r\n\r\n      // Get current user and school\r\n      let userId = null;\r\n      let schoolId = null;\r\n\r\n      // Essayer avec la session Auth d'abord\r\n      const { data: { user: authUser } } = await supabase.auth.getUser();\r\n      if (authUser) {\r\n        userId = authUser.id;\r\n        const { data: userData } = await supabase\r\n          .from('users')\r\n          .select('current_school_id')\r\n          .eq('id', authUser.id)\r\n          .single();\r\n        schoolId = userData?.current_school_id;\r\n      } else {\r\n        // Fallback : localStorage\r\n        const savedUser = localStorage.getItem('edutrack-user');\r\n        if (savedUser) {\r\n          const userData = JSON.parse(savedUser);\r\n          userId = userData.id;\r\n          schoolId = userData.current_school_id || userData.school_id;\r\n        }\r\n      }\r\n\r\n      if (!userId || !schoolId) {\r\n        throw new Error('Impossible d\\'identifier l\\'utilisateur ou l\\'√©cole');\r\n      }\r\n\r\n      const transferData = {\r\n        student_id: selectedStudent,\r\n        from_school_id: schoolId,\r\n        transfer_reason: transferReason,\r\n        new_school_name: newSchool,\r\n        transfer_date: transferDate,\r\n        transfer_code: newCode,\r\n        status: 'pending',\r\n        requested_by: userId,\r\n        request_date: new Date().toISOString()\r\n      };\r\n\r\n      const result = await supabase\r\n        .from('transfers')\r\n        .insert([transferData])\r\n        .select()\r\n        .single();\r\n\r\n      if (result.error) throw result.error;\r\n\r\n      setTransferCode(newCode);\r\n      setQrCodeGenerated(true);\r\n      alert('Transfert initi√© avec succ√®s !');\r\n\r\n      // Recharger la liste des transferts\r\n      const { data: transfers } = await supabase\r\n        .from('transfers')\r\n        .select(`\r\n          *,\r\n          student:students(first_name, last_name)\r\n        `)\r\n        .eq('from_school_id', schoolId)\r\n        .order('request_date', { ascending: false });\r\n\r\n      if (transfers) {\r\n        setPendingTransfers(transfers.map(t => ({\r\n          id: t.id,\r\n          studentName: `${t.student?.first_name} ${t.student?.last_name}`,\r\n          studentId: t.student_id,\r\n          class: 'N/A',\r\n          transferDate: new Date(t.transfer_date).toLocaleDateString('fr-FR'),\r\n          newSchool: t.new_school_name,\r\n          reason: t.transfer_reason,\r\n          status: t.status,\r\n          transferCode: t.transfer_code,\r\n          qrCode: \"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTAwIiBoZWlnaHQ9IjEwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICA8cmVjdCB3aWR0aD0iMTAwIiBoZWlnaHQ9IjEwMCIgZmlsbD0iIzAwMCIvPgogIDxyZWN0IHg9IjEwIiB5PSIxMCIgd2lkdGg9IjgwIiBoZWlnaHQ9IjgwIiBmaWxsPSIjZmZmIi8+CiAgPHRleHQgeD0iNTAiIHk9IjU1IiB0ZXh0LWFuY2hvcj0ibWlkZGxlIiBmb250LXNpemU9IjEyIiBmaWxsPSIjMDAwIj5RUjwvdGV4dD4KPC9zdmc+\",\r\n          parentNotified: false,\r\n          documentsReady: false\r\n        })));\r\n      }\r\n\r\n      // R√©initialiser le formulaire\r\n      setSelectedStudent('');\r\n      setTransferReason('');\r\n      setNewSchool('');\r\n      setTransferDate('');\r\n    } catch (error) {\r\n      console.error('Erreur cr√©ation transfert:', error);\r\n      alert(`Erreur : ${error.message || 'Impossible de cr√©er le transfert'}`);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleSendConfirmation = async (transferId) => {\r\n    const transfer = pendingTransfers.find(t => t.id === transferId);\r\n    if (!transfer) return;\r\n\r\n    try {\r\n      // Mettre √† jour dans Supabase\r\n      const { error } = await supabase\r\n        .from('transfers')\r\n        .update({ parent_notified: true })\r\n        .eq('id', transferId);\r\n\r\n      if (error) throw error;\r\n\r\n      setPendingTransfers(pendingTransfers.map(t =>\r\n        t.id === transferId ? { ...t, parentNotified: true } : t\r\n      ));\r\n\r\n      alert(`SMS de confirmation envoy√© pour ${transfer.studentName}`);\r\n      // TODO: Impl√©menter l'envoi r√©el de SMS via le service de communication\r\n    } catch (error) {\r\n      console.error('Erreur envoi SMS:', error);\r\n      alert(`Erreur : ${error.message || 'Impossible d\\'envoyer le SMS'}`);\r\n    }\r\n  };\r\n\r\n  const handlePrintDocuments = async (transferId) => {\r\n    const transfer = pendingTransfers.find(t => t.id === transferId);\r\n    if (!transfer) return;\r\n\r\n    try {\r\n      // Mettre √† jour dans Supabase\r\n      const { error } = await supabase\r\n        .from('transfers')\r\n        .update({ documents_ready: true })\r\n        .eq('id', transferId);\r\n\r\n      if (error) throw error;\r\n\r\n      setPendingTransfers(pendingTransfers.map(t =>\r\n        t.id === transferId ? { ...t, documentsReady: true } : t\r\n      ));\r\n\r\n      alert(`Documents pr√™ts pour ${transfer.studentName}`);\r\n      // TODO: G√©n√©rer et imprimer les documents de transfert\r\n    } catch (error) {\r\n      console.error('Erreur impression documents:', error);\r\n      alert(`Erreur : ${error.message || 'Impossible de pr√©parer les documents'}`);\r\n    }\r\n  };\r\n\r\n  const handleCancelTransfer = async (transferId) => {\r\n    const transfer = pendingTransfers.find(t => t.id === transferId);\r\n    if (!transfer) return;\r\n\r\n    const confirmCancel = window.confirm(`√ätes-vous s√ªr de vouloir annuler le transfert de ${transfer.studentName} ?`);\r\n    if (!confirmCancel) return;\r\n\r\n    try {\r\n      // Mettre √† jour le statut dans Supabase\r\n      const { error } = await supabase\r\n        .from('transfers')\r\n        .update({ status: 'cancelled' })\r\n        .eq('id', transferId);\r\n\r\n      if (error) throw error;\r\n\r\n      // Retirer de la liste locale\r\n      setPendingTransfers(pendingTransfers.filter(t => t.id !== transferId));\r\n      alert(`Transfert annul√© pour ${transfer.studentName}`);\r\n    } catch (error) {\r\n      console.error('Erreur annulation transfert:', error);\r\n      alert(`Erreur : ${error.message || 'Impossible d\\'annuler le transfert'}`);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      {/* Header */}\r\n      <div>\r\n        <h2 className=\"font-heading font-heading-bold text-xl text-text-primary\">\r\n          Gestion des Transferts\r\n        </h2>\r\n        <p className=\"font-body font-body-normal text-sm text-text-secondary mt-1\">\r\n          Processus de transfert d'√©l√®ves avec g√©n√©ration de QR codes\r\n        </p>\r\n      </div>\r\n      {/* New Transfer Form */}\r\n      <div className=\"bg-card rounded-lg border border-border p-6\">\r\n        <h3 className=\"font-heading font-heading-semibold text-lg text-text-primary mb-4\">\r\n          Nouveau transfert d'√©l√®ve\r\n        </h3>\r\n\r\n        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4 mb-6\">\r\n          <Select\r\n            label=\"√âl√®ve √† transf√©rer\"\r\n            placeholder=\"S√©lectionner un √©l√®ve\"\r\n            options={students}\r\n            value={selectedStudent}\r\n            onChange={setSelectedStudent}\r\n            required\r\n          />\r\n          <Select\r\n            label=\"Motif du transfert\"\r\n            placeholder=\"S√©lectionner un motif\"\r\n            options={reasonOptions}\r\n            value={transferReason}\r\n            onChange={setTransferReason}\r\n            required\r\n          />\r\n          <Input\r\n            label=\"Nouvel √©tablissement\"\r\n            type=\"text\"\r\n            placeholder=\"Nom de la nouvelle √©cole\"\r\n            value={newSchool}\r\n            onChange={(e) => setNewSchool(e?.target?.value)}\r\n            required\r\n          />\r\n          <Input\r\n            label=\"Date de transfert\"\r\n            type=\"date\"\r\n            value={transferDate}\r\n            onChange={(e) => setTransferDate(e?.target?.value)}\r\n            required\r\n          />\r\n        </div>\r\n\r\n        {qrCodeGenerated && (\r\n          <div className=\"bg-accent/5 rounded-lg border border-accent/20 p-4 mb-4\">\r\n            <div className=\"flex items-center space-x-4\">\r\n              <div className=\"w-20 h-20 bg-white border border-border rounded-lg flex items-center justify-center\">\r\n                <img \r\n                  src=\"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNjAiIGhlaWdodD0iNjAiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CiAgPHJlY3Qgd2lkdGg9IjYwIiBoZWlnaHQ9IjYwIiBmaWxsPSIjMDAwIi8+CiAgPHJlY3QgeD0iNSIgeT0iNSIgd2lkdGg9IjUwIiBoZWlnaHQ9IjUwIiBmaWxsPSIjZmZmIi8+CiAgPHRleHQgeD0iMzAiIHk9IjM1IiB0ZXh0LWFuY2hvcj0ibWlkZGxlIiBmb250LXNpemU9IjgiIGZpbGw9IiMwMDAiPlFSPC90ZXh0Pgo8L3N2Zz4K\"\r\n                  alt=\"QR Code\"\r\n                  className=\"w-16 h-16\"\r\n                />\r\n              </div>\r\n              <div>\r\n                <p className=\"font-heading font-heading-semibold text-sm text-text-primary\">\r\n                  Code de transfert g√©n√©r√©\r\n                </p>\r\n                <p className=\"font-mono text-lg text-primary font-bold\">\r\n                  {transferCode}\r\n                </p>\r\n                <p className=\"font-caption font-caption-normal text-xs text-text-secondary\">\r\n                  Ce QR code sera envoy√© aux parents par SMS\r\n                </p>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        <div className=\"flex justify-end\">\r\n          <Button\r\n            variant=\"default\"\r\n            iconName=\"Send\"\r\n            iconPosition=\"left\"\r\n            onClick={handleInitiateTransfer}\r\n          >\r\n            Initier le transfert\r\n          </Button>\r\n        </div>\r\n      </div>\r\n      {/* Pending Transfers */}\r\n      <div className=\"bg-card rounded-lg border border-border\">\r\n        <div className=\"p-4 border-b border-border\">\r\n          <h3 className=\"font-heading font-heading-semibold text-lg text-text-primary\">\r\n            Transferts en cours ({pendingTransfers?.length})\r\n          </h3>\r\n        </div>\r\n\r\n        <div className=\"divide-y divide-border\">\r\n          {pendingTransfers?.map((transfer) => {\r\n            const statusConfig = getStatusConfig(transfer?.status);\r\n\r\n            return (\r\n              <div key={transfer?.id} className=\"p-6\">\r\n                <div className=\"flex items-start justify-between\">\r\n                  <div className=\"flex items-start space-x-4\">\r\n                    <div className=\"w-16 h-16 bg-muted rounded-lg flex items-center justify-center\">\r\n                      <img \r\n                        src={transfer?.qrCode}\r\n                        alt=\"QR Code\"\r\n                        className=\"w-12 h-12\"\r\n                      />\r\n                    </div>\r\n                    <div>\r\n                      <div className=\"flex items-center space-x-3 mb-2\">\r\n                        <h4 className=\"font-body font-body-semibold text-lg text-text-primary\">\r\n                          {transfer?.studentName}\r\n                        </h4>\r\n                        <span className={`px-2 py-1 rounded-full text-xs font-caption font-caption-normal ${statusConfig?.className}`}>\r\n                          {statusConfig?.label}\r\n                        </span>\r\n                      </div>\r\n                      <div className=\"space-y-1\">\r\n                        <p className=\"font-caption font-caption-normal text-sm text-text-secondary\">\r\n                          <span className=\"font-semibold\">ID:</span> {transfer?.studentId} ‚Ä¢ \r\n                          <span className=\"font-semibold\"> Classe:</span> {transfer?.class}\r\n                        </p>\r\n                        <p className=\"font-caption font-caption-normal text-sm text-text-secondary\">\r\n                          <span className=\"font-semibold\">Vers:</span> {transfer?.newSchool}\r\n                        </p>\r\n                        <p className=\"font-caption font-caption-normal text-sm text-text-secondary\">\r\n                          <span className=\"font-semibold\">Date:</span> {transfer?.transferDate} ‚Ä¢ \r\n                          <span className=\"font-semibold\"> Motif:</span> {transfer?.reason}\r\n                        </p>\r\n                        <p className=\"font-mono text-sm text-primary\">\r\n                          Code: {transfer?.transferCode}\r\n                        </p>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n\r\n                  <div className=\"flex items-center space-x-2\">\r\n                    <Button\r\n                      variant=\"ghost\"\r\n                      size=\"icon\"\r\n                      onClick={() => handleSendConfirmation(transfer?.id)}\r\n                      title=\"Envoyer confirmation SMS\"\r\n                      disabled={!transfer?.parentNotified}\r\n                    >\r\n                      <Icon name=\"MessageSquare\" size={16} />\r\n                    </Button>\r\n                    <Button\r\n                      variant=\"ghost\"\r\n                      size=\"icon\"\r\n                      onClick={() => handlePrintDocuments(transfer?.id)}\r\n                      title=\"Imprimer les documents\"\r\n                    >\r\n                      <Icon name=\"Printer\" size={16} />\r\n                    </Button>\r\n                    <Button\r\n                      variant=\"ghost\"\r\n                      size=\"icon\"\r\n                      onClick={() => handleCancelTransfer(transfer?.id)}\r\n                      title=\"Annuler le transfert\"\r\n                    >\r\n                      <Icon name=\"X\" size={16} />\r\n                    </Button>\r\n                  </div>\r\n                </div>\r\n                {/* Transfer Status Indicators */}\r\n                <div className=\"mt-4 flex items-center space-x-6\">\r\n                  <div className=\"flex items-center space-x-2\">\r\n                    <Icon \r\n                      name={transfer?.parentNotified ? \"CheckCircle\" : \"Clock\"} \r\n                      size={16} \r\n                      className={transfer?.parentNotified ? \"text-success\" : \"text-warning\"}\r\n                    />\r\n                    <span className=\"font-caption font-caption-normal text-xs text-text-secondary\">\r\n                      Parents notifi√©s\r\n                    </span>\r\n                  </div>\r\n                  <div className=\"flex items-center space-x-2\">\r\n                    <Icon \r\n                      name={transfer?.documentsReady ? \"CheckCircle\" : \"Clock\"} \r\n                      size={16} \r\n                      className={transfer?.documentsReady ? \"text-success\" : \"text-warning\"}\r\n                    />\r\n                    <span className=\"font-caption font-caption-normal text-xs text-text-secondary\">\r\n                      Documents pr√™ts\r\n                    </span>\r\n                  </div>\r\n                  <div className=\"flex items-center space-x-2\">\r\n                    <Icon \r\n                      name={transfer?.status === 'confirmed' ? \"CheckCircle\" : \"Clock\"} \r\n                      size={16} \r\n                      className={transfer?.status === 'confirmed' ? \"text-success\" : \"text-warning\"}\r\n                    />\r\n                    <span className=\"font-caption font-caption-normal text-xs text-text-secondary\">\r\n                      Transfert confirm√©\r\n                    </span>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            );\r\n          })}\r\n        </div>\r\n\r\n        {pendingTransfers?.length === 0 && (\r\n          <div className=\"p-8 text-center\">\r\n            <Icon name=\"ArrowRightLeft\" size={48} className=\"text-muted-foreground mx-auto mb-4\" />\r\n            <p className=\"font-body font-body-normal text-text-secondary\">\r\n              Aucun transfert en cours\r\n            </p>\r\n          </div>\r\n        )}\r\n      </div>\r\n      {/* Transfer Statistics */}\r\n      <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\r\n        <div className=\"bg-card rounded-lg border border-border p-4\">\r\n          <div className=\"flex items-center space-x-3\">\r\n            <div className=\"w-10 h-10 bg-primary/10 rounded-lg flex items-center justify-center\">\r\n              <Icon name=\"ArrowRightLeft\" size={20} className=\"text-primary\" />\r\n            </div>\r\n            <div>\r\n              <p className=\"font-heading font-heading-semibold text-lg text-text-primary\">\r\n                {pendingTransfers?.length}\r\n              </p>\r\n              <p className=\"font-caption font-caption-normal text-xs text-text-secondary\">\r\n                Transferts en cours\r\n              </p>\r\n            </div>\r\n          </div>\r\n        </div>\r\n        \r\n        <div className=\"bg-card rounded-lg border border-border p-4\">\r\n          <div className=\"flex items-center space-x-3\">\r\n            <div className=\"w-10 h-10 bg-success/10 rounded-lg flex items-center justify-center\">\r\n              <Icon name=\"CheckCircle\" size={20} className=\"text-success\" />\r\n            </div>\r\n            <div>\r\n              <p className=\"font-heading font-heading-semibold text-lg text-text-primary\">\r\n                {pendingTransfers?.filter(t => t?.status === 'confirmed')?.length}\r\n              </p>\r\n              <p className=\"font-caption font-caption-normal text-xs text-text-secondary\">\r\n                Confirm√©s\r\n              </p>\r\n            </div>\r\n          </div>\r\n        </div>\r\n        \r\n        <div className=\"bg-card rounded-lg border border-border p-4\">\r\n          <div className=\"flex items-center space-x-3\">\r\n            <div className=\"w-10 h-10 bg-warning/10 rounded-lg flex items-center justify-center\">\r\n              <Icon name=\"Clock\" size={20} className=\"text-warning\" />\r\n            </div>\r\n            <div>\r\n              <p className=\"font-heading font-heading-semibold text-lg text-text-primary\">\r\n                {pendingTransfers?.filter(t => t?.status === 'pending')?.length}\r\n              </p>\r\n              <p className=\"font-caption font-caption-normal text-xs text-text-secondary\">\r\n                En attente\r\n              </p>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default TransferWorkflow;","import React, { useState, useEffect } from 'react';\r\nimport Icon from '../../../components/AppIcon';\r\nimport Button from '../../../components/ui/Button';\r\nimport Input from '../../../components/ui/Input';\r\nimport Select from '../../../components/ui/Select';\r\nimport { documentService } from '../../../services/documentService';\r\nimport { supabase } from '../../../lib/supabase';\r\n\r\nconst DocumentsTab = () => {\r\n  const [searchTerm, setSearchTerm] = useState('');\r\n  const [filterCategory, setFilterCategory] = useState('');\r\n  const [selectedDocuments, setSelectedDocuments] = useState([]);\r\n  const [documents, setDocuments] = useState([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState('');\r\n  \r\n  // Tab pour le type de document √† g√©n√©rer\r\n  const [documentTypeTab, setDocumentTypeTab] = useState('student');\r\n  \r\n  // Modal de s√©lection\r\n  const [showModal, setShowModal] = useState(false);\r\n  const [modalType, setModalType] = useState(''); // 'student', 'class', 'public'\r\n  const [documentType, setDocumentType] = useState(''); // 'certificat', 'attestation', 'bulletin'\r\n  const [students, setStudents] = useState([]);\r\n  const [classes, setClasses] = useState([]);\r\n  const [selectedStudent, setSelectedStudent] = useState(null);\r\n  const [selectedClass, setSelectedClass] = useState(null);\r\n\r\n\r\n  const documentCategories = [\r\n    { value: '', label: 'Toutes les cat√©gories' },\r\n    { value: 'certificats', label: 'Certificats de scolarit√©' },\r\n    { value: 'attestations', label: 'Attestations' },\r\n    { value: 'bulletins', label: 'Bulletins scolaires' },\r\n    { value: 'inscriptions', label: 'Dossiers d\\'inscription' },\r\n    { value: 'administratif', label: 'Documents administratifs' }\r\n  ];\r\n\r\n  // Fonction pour charger les documents (d√©finie en dehors du useEffect pour √™tre r√©utilisable)\r\n  const loadDocuments = async () => {\r\n    setLoading(true);\r\n    try {\r\n      // Charger depuis Supabase\r\n      const result = await documentService.getAllSchoolDocuments();\r\n\r\n      if (result.error === 'TABLE_NOT_EXISTS') {\r\n        // Table n'existe pas : afficher un message\r\n        setError('‚ö†Ô∏è La table documents n\\'existe pas encore. Fonctionnalit√© en d√©veloppement.');\r\n        setDocuments([]);\r\n      } else if (result.success) {\r\n        setDocuments(result.documents || []);\r\n      } else {\r\n        console.error('Erreur chargement documents:', result.error);\r\n        setError('Erreur lors du chargement des documents');\r\n        setDocuments([]);\r\n      }\r\n    } catch (error) {\r\n      console.error('Erreur chargement documents:', error);\r\n      setError('Erreur lors du chargement des documents');\r\n      setDocuments([]);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  // Charger les documents au montage du composant\r\n  useEffect(() => {\r\n    loadDocuments();\r\n  }, []);\r\n  \r\n  // Charger les √©l√®ves et classes pour le modal\r\n  useEffect(() => {\r\n    const loadStudentsAndClasses = async () => {\r\n      // R√©cup√©rer le school_id depuis les sources disponibles\r\n      const schoolId = localStorage.getItem('school_id');\r\n\r\n      if (!schoolId) {\r\n        console.warn('‚ö†Ô∏è Pas de school_id trouv√©, impossible de charger les √©l√®ves');\r\n        return;\r\n      }\r\n\r\n      try {\r\n        // Charger les √©l√®ves de l'√©cole\r\n        const { data: studentsData, error: studentsError } = await supabase\r\n          .from('students')\r\n          .select('id, first_name, last_name, class_name')\r\n          .eq('school_id', schoolId)\r\n          .order('last_name');\r\n\r\n        if (!studentsError && studentsData) {\r\n          setStudents(studentsData);\r\n        } else if (studentsError) {\r\n          console.error('Erreur chargement √©l√®ves:', studentsError);\r\n        }\r\n\r\n        // Charger les classes de l'√©cole\r\n        const { data: classesData, error: classesError } = await supabase\r\n          .from('classes')\r\n          .select('id, name, level')\r\n          .eq('school_id', schoolId)\r\n          .order('level');\r\n\r\n        if (!classesError && classesData) {\r\n          setClasses(classesData);\r\n        } else if (classesError) {\r\n          console.error('Erreur chargement classes:', classesError);\r\n        }\r\n      } catch (error) {\r\n        console.error('Exception chargement √©l√®ves/classes:', error);\r\n      }\r\n    };\r\n\r\n    loadStudentsAndClasses();\r\n  }, []);\r\n\r\n  const getStatusColor = (status) => {\r\n    switch (status) {\r\n      case 'generated':\r\n        return 'bg-success/10 text-success border-success/20';\r\n      case 'printed':\r\n        return 'bg-primary/10 text-primary border-primary/20';\r\n      case 'pending':\r\n        return 'bg-warning/10 text-warning border-warning/20';\r\n      case 'incomplete':\r\n        return 'bg-error/10 text-error border-error/20';\r\n      default:\r\n        return 'bg-muted/10 text-muted-foreground border-muted/20';\r\n    }\r\n  };\r\n\r\n  const getStatusLabel = (status) => {\r\n    switch (status) {\r\n      case 'generated':\r\n        return 'G√©n√©r√©';\r\n      case 'printed':\r\n        return 'Imprim√©';\r\n      case 'pending':\r\n        return 'En attente';\r\n      case 'incomplete':\r\n        return 'Incomplet';\r\n      default:\r\n        return 'Inconnu';\r\n    }\r\n  };\r\n\r\n  const handleBatchPrint = () => {\r\n    if (selectedDocuments.length === 0) {\r\n      alert('‚ö†Ô∏è Veuillez s√©lectionner au moins un document √† imprimer');\r\n      return;\r\n    }\r\n\r\n    // Ouvrir chaque document s√©lectionn√© dans un nouvel onglet pour impression\r\n    selectedDocuments.forEach(docId => {\r\n      const doc = documents.find(d => d.id === docId);\r\n      if (doc && doc.file_path) {\r\n        handlePrintDocument(docId);\r\n      }\r\n    });\r\n\r\n    alert(`‚úÖ Ouverture de ${selectedDocuments.length} document(s) pour impression`);\r\n  };\r\n\r\n  const filteredDocuments = documents.filter(doc => {\r\n    const matchesSearch = doc.name.toLowerCase().includes(searchTerm.toLowerCase()) ||\r\n                         doc.studentName.toLowerCase().includes(searchTerm.toLowerCase());\r\n    const matchesCategory = filterCategory === '' || doc.type === filterCategory;\r\n    return matchesSearch && matchesCategory;\r\n  });\r\n\r\n  const handleGenerateDocument = async (type, targetType = 'student') => {\r\n    console.log('Document generation initiated:', type, targetType);\r\n\r\n    // Ouvrir le modal de s√©lection\r\n    setDocumentType(type);\r\n    setModalType(targetType);\r\n    setShowModal(true);\r\n  };\r\n  \r\n  const confirmGenerateDocument = async () => {\r\n    try {\r\n      setLoading(true);\r\n      console.log('üì§ G√©n√©ration du document...', {\r\n        documentType,\r\n        modalType,\r\n        selectedStudent,\r\n        selectedClass\r\n      });\r\n      \r\n      const options = {};\r\n      \r\n      // D√©terminer la visibilit√© selon le type\r\n      if (modalType === 'student' && selectedStudent) {\r\n        options.studentId = selectedStudent;\r\n        options.visibility = 'private';\r\n        options.isPublic = false;\r\n      } else if (modalType === 'class' && selectedClass) {\r\n        options.classId = selectedClass;\r\n        options.visibility = 'class';\r\n        options.isPublic = false;\r\n      } else if (modalType === 'public') {\r\n        options.visibility = 'school';\r\n        options.isPublic = true;\r\n      }\r\n      \r\n      const result = await documentService.generateDocument(documentType, options);\r\n      console.log('üì• R√©sultat:', result);\r\n      \r\n      if (result.success) {\r\n        alert(`‚úÖ Document \"${documentType}\" cr√©√© avec succ√®s !`);\r\n        setShowModal(false);\r\n        await loadDocuments();\r\n      } else {\r\n        console.error('‚ùå Erreur g√©n√©ration:', result.error);\r\n        alert(`‚ùå Erreur : ${result.error || 'Impossible de g√©n√©rer le document'}`);\r\n      }\r\n    } catch (error) {\r\n      console.error('‚ùå Exception g√©n√©ration document:', error);\r\n      alert(`‚ùå Erreur : ${error.message || 'Erreur lors de la g√©n√©ration du document'}`);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const handlePrintDocument = async (documentId) => {\r\n    const doc = documents.find(d => d.id === documentId);\r\n    if (!doc) return;\r\n\r\n    // V√©rifier si le fichier existe\r\n    if (!doc.file_path) {\r\n      alert(`‚ö†Ô∏è Ce document n'a pas encore de fichier associ√©. Il s'agit d'un enregistrement dans la base de donn√©es.`);\r\n      return;\r\n    }\r\n\r\n    // T√©l√©charger et ouvrir pour impression\r\n    handleDownloadDocument(documentId, true);\r\n  };\r\n\r\n  // Fonction pour voir/pr√©visualiser un document (ouvre dans un nouvel onglet)\r\n  const handleViewDocument = async (documentId) => {\r\n    const doc = documents.find(d => d.id === documentId);\r\n    if (!doc) return;\r\n\r\n    // V√©rifier si le fichier existe\r\n    if (!doc.file_path) {\r\n      alert(`‚ö†Ô∏è Ce document n'a pas encore de fichier associ√©. Il s'agit d'un enregistrement dans la base de donn√©es uniquement.`);\r\n      return;\r\n    }\r\n\r\n    try {\r\n      const result = await documentService.downloadDocument(documentId, 'view');\r\n\r\n      if (result.data?.url) {\r\n        // Ouvrir dans un nouvel onglet pour visualisation\r\n        window.open(result.data.url, '_blank');\r\n      } else {\r\n        alert(`‚ùå Erreur : ${result.error || 'Impossible d\\'acc√©der au document'}`);\r\n      }\r\n    } catch (error) {\r\n      console.error('Erreur pr√©visualisation document:', error);\r\n      alert('‚ùå Erreur lors de la pr√©visualisation du document');\r\n    }\r\n  };\r\n\r\n  const handleDownloadDocument = async (documentId, forPrint = false) => {\r\n    const doc = documents.find(d => d.id === documentId);\r\n    if (!doc) return;\r\n\r\n    // V√©rifier si le fichier existe\r\n    if (!doc.file_path) {\r\n      alert(`‚ö†Ô∏è Ce document n'a pas encore de fichier associ√©. Il s'agit d'un enregistrement dans la base de donn√©es uniquement.`);\r\n      return;\r\n    }\r\n\r\n    try {\r\n      const result = await documentService.downloadDocument(documentId, forPrint ? 'print' : 'download');\r\n\r\n      if (result.data?.url) {\r\n        if (forPrint) {\r\n          // Ouvrir dans une nouvelle fen√™tre pour impression\r\n          const printWindow = window.open(result.data.url, '_blank');\r\n          if (printWindow) {\r\n            printWindow.onload = () => {\r\n              printWindow.print();\r\n            };\r\n          } else {\r\n            alert('‚ö†Ô∏è Veuillez autoriser les pop-ups pour imprimer le document');\r\n          }\r\n        } else {\r\n          // T√©l√©charger le fichier\r\n          const link = document.createElement('a');\r\n          link.href = result.data.url;\r\n          link.download = result.data.fileName || doc.name;\r\n          link.target = '_blank';\r\n          document.body.appendChild(link);\r\n          link.click();\r\n          document.body.removeChild(link);\r\n\r\n          alert('‚úÖ T√©l√©chargement lanc√© !');\r\n        }\r\n      } else {\r\n        alert(`‚ùå Erreur : ${result.error || 'Impossible d\\'acc√©der au document'}`);\r\n      }\r\n    } catch (error) {\r\n      console.error('Erreur acc√®s document:', error);\r\n      alert('‚ùå Erreur lors de l\\'acc√®s au document');\r\n    }\r\n  };\r\n\r\n  const handleDeleteDocument = async (documentId) => {\r\n    const doc = documents.find(d => d.id === documentId);\r\n    if (!doc) return;\r\n\r\n    const confirmDelete = window.confirm(`√ätes-vous s√ªr de vouloir supprimer le document \"${doc.name}\" ?`);\r\n    if (!confirmDelete) return;\r\n\r\n    try {\r\n      setLoading(true);\r\n      const result = await documentService.deleteDocument(documentId);\r\n\r\n      if (result.data) {\r\n        alert('‚úÖ Document supprim√© avec succ√®s');\r\n        await loadDocuments();\r\n      } else {\r\n        alert(`‚ùå Erreur : ${result.error || 'Impossible de supprimer le document'}`);\r\n      }\r\n    } catch (error) {\r\n      console.error('Erreur suppression document:', error);\r\n      alert('‚ùå Erreur lors de la suppression du document');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      {/* Header */}\r\n      <div className=\"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4\">\r\n        <div>\r\n          <h2 className=\"font-heading font-heading-bold text-2xl text-text-primary\">\r\n            Gestion des Documents\r\n          </h2>\r\n          <p className=\"font-body font-body-normal text-text-secondary mt-1\">\r\n            G√©n√©ration, impression et gestion des documents administratifs\r\n          </p>\r\n        </div>\r\n        <div className=\"flex items-center space-x-3\">\r\n          <Button\r\n            variant=\"default\"\r\n            iconName=\"Printer\"\r\n            iconPosition=\"left\"\r\n            onClick={handleBatchPrint}\r\n            disabled={selectedDocuments.length === 0}\r\n          >\r\n            Imprimer ({selectedDocuments.length})\r\n          </Button>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Section unifi√©e : G√©n√©rer un nouveau document */}\r\n      <div className=\"bg-card rounded-lg border border-border p-6\">\r\n        <div className=\"flex items-center justify-between mb-4\">\r\n          <h3 className=\"font-heading font-heading-semibold text-lg text-text-primary flex items-center gap-2\">\r\n            <Icon name=\"Plus\" size={20} className=\"text-primary\" />\r\n            G√©n√©rer un nouveau document\r\n          </h3>\r\n        </div>\r\n        \r\n        {/* Tabs pour les types de documents */}\r\n        <div className=\"flex flex-wrap gap-2 mb-4 border-b border-border pb-3\">\r\n          <button\r\n            className={`px-4 py-2 rounded-t-lg text-sm font-medium transition-colors ${\r\n              documentTypeTab === 'student' \r\n                ? 'bg-primary text-white' \r\n                : 'bg-muted text-text-secondary hover:bg-muted/80'\r\n            }`}\r\n            onClick={() => setDocumentTypeTab('student')}\r\n          >\r\n            <span className=\"flex items-center gap-2\">\r\n              <Icon name=\"User\" size={16} />\r\n              Pour un √©l√®ve\r\n            </span>\r\n          </button>\r\n          <button\r\n            className={`px-4 py-2 rounded-t-lg text-sm font-medium transition-colors ${\r\n              documentTypeTab === 'class' \r\n                ? 'bg-primary text-white' \r\n                : 'bg-muted text-text-secondary hover:bg-muted/80'\r\n            }`}\r\n            onClick={() => setDocumentTypeTab('class')}\r\n          >\r\n            <span className=\"flex items-center gap-2\">\r\n              <Icon name=\"Users\" size={16} />\r\n              Pour une classe\r\n            </span>\r\n          </button>\r\n          <button\r\n            className={`px-4 py-2 rounded-t-lg text-sm font-medium transition-colors ${\r\n              documentTypeTab === 'public' \r\n                ? 'bg-primary text-white' \r\n                : 'bg-muted text-text-secondary hover:bg-muted/80'\r\n            }`}\r\n            onClick={() => setDocumentTypeTab('public')}\r\n          >\r\n            <span className=\"flex items-center gap-2\">\r\n              <Icon name=\"Globe\" size={16} />\r\n              Document public\r\n            </span>\r\n          </button>\r\n        </div>\r\n        \r\n        {/* Contenu conditionnel selon le tab */}\r\n        <div className=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3\">\r\n          {documentTypeTab === 'student' && (\r\n            <>\r\n              <Button\r\n                variant=\"outline\"\r\n                iconName=\"FileText\"\r\n                iconPosition=\"left\"\r\n                onClick={() => handleGenerateDocument('certificat_scolarite', 'student')}\r\n                className=\"justify-start h-auto py-3\"\r\n              >\r\n                <span className=\"text-left\">\r\n                  <span className=\"block font-semibold\">Certificat de scolarit√©</span>\r\n                  <span className=\"block text-xs text-text-secondary\">Atteste l'inscription de l'√©l√®ve</span>\r\n                </span>\r\n              </Button>\r\n              <Button\r\n                variant=\"outline\"\r\n                iconName=\"Award\"\r\n                iconPosition=\"left\"\r\n                onClick={() => handleGenerateDocument('certificat_frequentation', 'student')}\r\n                className=\"justify-start h-auto py-3\"\r\n              >\r\n                <span className=\"text-left\">\r\n                  <span className=\"block font-semibold\">Certificat de fr√©quentation</span>\r\n                  <span className=\"block text-xs text-text-secondary\">Atteste l'assiduit√© de l'√©l√®ve</span>\r\n                </span>\r\n              </Button>\r\n              <Button\r\n                variant=\"outline\"\r\n                iconName=\"UserCheck\"\r\n                iconPosition=\"left\"\r\n                onClick={() => handleGenerateDocument('fiche_inscription', 'student')}\r\n                className=\"justify-start h-auto py-3\"\r\n              >\r\n                <span className=\"text-left\">\r\n                  <span className=\"block font-semibold\">Fiche d'inscription</span>\r\n                  <span className=\"block text-xs text-text-secondary\">Donn√©es administratives de l'√©l√®ve</span>\r\n                </span>\r\n              </Button>\r\n              <Button\r\n                variant=\"outline\"\r\n                iconName=\"CreditCard\"\r\n                iconPosition=\"left\"\r\n                onClick={() => handleGenerateDocument('attestation_paiement', 'student')}\r\n                className=\"justify-start h-auto py-3\"\r\n              >\r\n                <span className=\"text-left\">\r\n                  <span className=\"block font-semibold\">Attestation de paiement</span>\r\n                  <span className=\"block text-xs text-text-secondary\">Re√ßu des frais de scolarit√©</span>\r\n                </span>\r\n              </Button>\r\n              <Button\r\n                variant=\"outline\"\r\n                iconName=\"FileCheck\"\r\n                iconPosition=\"left\"\r\n                onClick={() => handleGenerateDocument('autorisation_sortie', 'student')}\r\n                className=\"justify-start h-auto py-3\"\r\n              >\r\n                <span className=\"text-left\">\r\n                  <span className=\"block font-semibold\">Autorisation de sortie</span>\r\n                  <span className=\"block text-xs text-text-secondary\">Pour sorties scolaires</span>\r\n                </span>\r\n              </Button>\r\n              <Button\r\n                variant=\"outline\"\r\n                iconName=\"BookOpen\"\r\n                iconPosition=\"left\"\r\n                onClick={() => handleGenerateDocument('bulletin', 'student')}\r\n                className=\"justify-start h-auto py-3\"\r\n              >\r\n                <span className=\"text-left\">\r\n                  <span className=\"block font-semibold\">Bulletin scolaire</span>\r\n                  <span className=\"block text-xs text-text-secondary\">Impression du bulletin (si disponible)</span>\r\n                </span>\r\n              </Button>\r\n            </>\r\n          )}\r\n          \r\n          {documentTypeTab === 'class' && (\r\n            <>\r\n              <Button\r\n                variant=\"outline\"\r\n                iconName=\"Users\"\r\n                iconPosition=\"left\"\r\n                onClick={() => handleGenerateDocument('liste_eleves', 'class')}\r\n                className=\"justify-start h-auto py-3\"\r\n              >\r\n                <span className=\"text-left\">\r\n                  <span className=\"block font-semibold\">Liste des √©l√®ves</span>\r\n                  <span className=\"block text-xs text-text-secondary\">Effectif complet avec infos</span>\r\n                </span>\r\n              </Button>\r\n              <Button\r\n                variant=\"outline\"\r\n                iconName=\"ClipboardList\"\r\n                iconPosition=\"left\"\r\n                onClick={() => handleGenerateDocument('liste_appel', 'class')}\r\n                className=\"justify-start h-auto py-3\"\r\n              >\r\n                <span className=\"text-left\">\r\n                  <span className=\"block font-semibold\">Liste d'appel</span>\r\n                  <span className=\"block text-xs text-text-secondary\">Pour le suivi des pr√©sences</span>\r\n                </span>\r\n              </Button>\r\n              <Button\r\n                variant=\"outline\"\r\n                iconName=\"Clock\"\r\n                iconPosition=\"left\"\r\n                onClick={() => handleGenerateDocument('emploi_du_temps', 'class')}\r\n                className=\"justify-start h-auto py-3\"\r\n              >\r\n                <span className=\"text-left\">\r\n                  <span className=\"block font-semibold\">Emploi du temps</span>\r\n                  <span className=\"block text-xs text-text-secondary\">Planning hebdomadaire</span>\r\n                </span>\r\n              </Button>\r\n              <Button\r\n                variant=\"outline\"\r\n                iconName=\"FileText\"\r\n                iconPosition=\"left\"\r\n                onClick={() => handleGenerateDocument('certificats_classe', 'class')}\r\n                className=\"justify-start h-auto py-3\"\r\n              >\r\n                <span className=\"text-left\">\r\n                  <span className=\"block font-semibold\">Certificats en lot</span>\r\n                  <span className=\"block text-xs text-text-secondary\">Pour tous les √©l√®ves</span>\r\n                </span>\r\n              </Button>\r\n              <Button\r\n                variant=\"outline\"\r\n                iconName=\"BarChart2\"\r\n                iconPosition=\"left\"\r\n                onClick={() => handleGenerateDocument('statistiques_classe', 'class')}\r\n                className=\"justify-start h-auto py-3\"\r\n              >\r\n                <span className=\"text-left\">\r\n                  <span className=\"block font-semibold\">Statistiques de classe</span>\r\n                  <span className=\"block text-xs text-text-secondary\">Effectifs et r√©partition</span>\r\n                </span>\r\n              </Button>\r\n              <Button\r\n                variant=\"outline\"\r\n                iconName=\"BookOpen\"\r\n                iconPosition=\"left\"\r\n                onClick={() => handleGenerateDocument('bulletin_classe', 'class')}\r\n                className=\"justify-start h-auto py-3\"\r\n              >\r\n                <span className=\"text-left\">\r\n                  <span className=\"block font-semibold\">Bulletins de la classe</span>\r\n                  <span className=\"block text-xs text-text-secondary\">Tous les √©l√®ves (si disponible)</span>\r\n                </span>\r\n              </Button>\r\n            </>\r\n          )}\r\n          \r\n          {documentTypeTab === 'public' && (\r\n            <>\r\n              <Button\r\n                variant=\"outline\"\r\n                iconName=\"FileText\"\r\n                iconPosition=\"left\"\r\n                onClick={() => handleGenerateDocument('reglement_interieur', 'public')}\r\n                className=\"justify-start h-auto py-3\"\r\n              >\r\n                <span className=\"text-left\">\r\n                  <span className=\"block font-semibold\">R√®glement int√©rieur</span>\r\n                  <span className=\"block text-xs text-text-secondary\">R√®gles de l'√©tablissement</span>\r\n                </span>\r\n              </Button>\r\n              <Button\r\n                variant=\"outline\"\r\n                iconName=\"Calendar\"\r\n                iconPosition=\"left\"\r\n                onClick={() => handleGenerateDocument('calendrier_scolaire', 'public')}\r\n                className=\"justify-start h-auto py-3\"\r\n              >\r\n                <span className=\"text-left\">\r\n                  <span className=\"block font-semibold\">Calendrier scolaire</span>\r\n                  <span className=\"block text-xs text-text-secondary\">Vacances et √©v√©nements</span>\r\n                </span>\r\n              </Button>\r\n              <Button\r\n                variant=\"outline\"\r\n                iconName=\"Bell\"\r\n                iconPosition=\"left\"\r\n                onClick={() => handleGenerateDocument('circulaire', 'public')}\r\n                className=\"justify-start h-auto py-3\"\r\n              >\r\n                <span className=\"text-left\">\r\n                  <span className=\"block font-semibold\">Circulaire / Annonce</span>\r\n                  <span className=\"block text-xs text-text-secondary\">Communication aux parents</span>\r\n                </span>\r\n              </Button>\r\n              <Button\r\n                variant=\"outline\"\r\n                iconName=\"Mail\"\r\n                iconPosition=\"left\"\r\n                onClick={() => handleGenerateDocument('convocation', 'public')}\r\n                className=\"justify-start h-auto py-3\"\r\n              >\r\n                <span className=\"text-left\">\r\n                  <span className=\"block font-semibold\">Convocation r√©union</span>\r\n                  <span className=\"block text-xs text-text-secondary\">R√©union parents-enseignants</span>\r\n                </span>\r\n              </Button>\r\n              <Button\r\n                variant=\"outline\"\r\n                iconName=\"AlertTriangle\"\r\n                iconPosition=\"left\"\r\n                onClick={() => handleGenerateDocument('avis_important', 'public')}\r\n                className=\"justify-start h-auto py-3\"\r\n              >\r\n                <span className=\"text-left\">\r\n                  <span className=\"block font-semibold\">Avis important</span>\r\n                  <span className=\"block text-xs text-text-secondary\">Information urgente</span>\r\n                </span>\r\n              </Button>\r\n              <Button\r\n                variant=\"outline\"\r\n                iconName=\"DollarSign\"\r\n                iconPosition=\"left\"\r\n                onClick={() => handleGenerateDocument('avis_paiement', 'public')}\r\n                className=\"justify-start h-auto py-3\"\r\n              >\r\n                <span className=\"text-left\">\r\n                  <span className=\"block font-semibold\">Avis de paiement</span>\r\n                  <span className=\"block text-xs text-text-secondary\">Rappel frais de scolarit√©</span>\r\n                </span>\r\n              </Button>\r\n            </>\r\n          )}\r\n        </div>\r\n      </div>\r\n\r\n      {/* Filtres et recherche int√©gr√©s dans la liste */}\r\n      <div className=\"bg-card rounded-lg border border-border p-6\">\r\n        <div className=\"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4 mb-6\">\r\n          <h3 className=\"font-heading font-heading-semibold text-lg text-text-primary\">\r\n            Documents r√©cents ({filteredDocuments.length})\r\n          </h3>\r\n          <div className=\"flex flex-col sm:flex-row gap-3\">\r\n            <Input\r\n              placeholder=\"Rechercher...\"\r\n              value={searchTerm}\r\n              onChange={(e) => setSearchTerm(e.target.value)}\r\n              iconName=\"Search\"\r\n              iconPosition=\"left\"\r\n              className=\"w-full sm:w-64\"\r\n            />\r\n            <Select\r\n              options={documentCategories}\r\n              value={filterCategory}\r\n              onChange={setFilterCategory}\r\n              placeholder=\"Cat√©gorie\"\r\n              className=\"w-full sm:w-48\"\r\n            />\r\n            <Button variant=\"ghost\" size=\"sm\" className=\"hidden lg:flex\">\r\n              <Icon name=\"Download\" size={16} className=\"mr-2\" />\r\n              Exporter\r\n            </Button>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Table des documents */}\r\n        <div className=\"overflow-x-auto\">\r\n          <table className=\"w-full\">\r\n            <thead>\r\n              <tr className=\"border-b border-border bg-muted/30\">\r\n                <th className=\"text-left py-3 px-4 font-body font-body-semibold text-sm text-text-secondary w-12\">\r\n                  <input\r\n                    type=\"checkbox\"\r\n                    className=\"rounded border-gray-300\"\r\n                    onChange={(e) => {\r\n                      if (e.target.checked) {\r\n                        setSelectedDocuments(filteredDocuments.map(d => d.id));\r\n                      } else {\r\n                        setSelectedDocuments([]);\r\n                      }\r\n                    }}\r\n                    checked={selectedDocuments.length === filteredDocuments.length && filteredDocuments.length > 0}\r\n                  />\r\n                </th>\r\n                <th className=\"text-left py-3 px-4 font-body font-body-semibold text-sm text-text-secondary\">\r\n                  Document\r\n                </th>\r\n                <th className=\"text-left py-3 px-4 font-body font-body-semibold text-sm text-text-secondary\">\r\n                  Type\r\n                </th>\r\n                <th className=\"text-left py-3 px-4 font-body font-body-semibold text-sm text-text-secondary\">\r\n                  √âl√®ve / Classe\r\n                </th>\r\n                <th className=\"text-left py-3 px-4 font-body font-body-semibold text-sm text-text-secondary\">\r\n                  Date\r\n                </th>\r\n                <th className=\"text-left py-3 px-4 font-body font-body-semibold text-sm text-text-secondary\">\r\n                  Statut\r\n                </th>\r\n                <th className=\"text-center py-3 px-4 font-body font-body-semibold text-sm text-text-secondary\">\r\n                  Actions\r\n                </th>\r\n              </tr>\r\n            </thead>\r\n            <tbody>\r\n              {filteredDocuments.map((doc) => (\r\n                <tr key={doc.id} className=\"border-b border-border hover:bg-muted/50 transition-micro\">\r\n                  <td className=\"py-4 px-4\">\r\n                    <input\r\n                      type=\"checkbox\"\r\n                      className=\"rounded border-gray-300\"\r\n                      checked={selectedDocuments.includes(doc.id)}\r\n                      onChange={(e) => {\r\n                        if (e.target.checked) {\r\n                          setSelectedDocuments([...selectedDocuments, doc.id]);\r\n                        } else {\r\n                          setSelectedDocuments(selectedDocuments.filter(id => id !== doc.id));\r\n                        }\r\n                      }}\r\n                    />\r\n                  </td>\r\n                  <td className=\"py-4 px-4\">\r\n                    <div className=\"flex items-center space-x-3\">\r\n                      <div className={`w-10 h-10 rounded-lg flex items-center justify-center ${\r\n                        doc.type === 'certificats' ? 'bg-blue-100' :\r\n                        doc.type === 'attestations' ? 'bg-green-100' :\r\n                        doc.type === 'bulletins' ? 'bg-purple-100' :\r\n                        'bg-gray-100'\r\n                      }`}>\r\n                        <Icon \r\n                          name={\r\n                            doc.type === 'certificats' ? 'FileText' :\r\n                            doc.type === 'attestations' ? 'Shield' :\r\n                            doc.type === 'bulletins' ? 'BookOpen' :\r\n                            'File'\r\n                          } \r\n                          size={20} \r\n                          className={\r\n                            doc.type === 'certificats' ? 'text-blue-600' :\r\n                            doc.type === 'attestations' ? 'text-green-600' :\r\n                            doc.type === 'bulletins' ? 'text-purple-600' :\r\n                            'text-gray-600'\r\n                          }\r\n                        />\r\n                      </div>\r\n                      <div>\r\n                        <div className=\"font-body font-body-semibold text-sm text-text-primary\">\r\n                          {doc.name}\r\n                        </div>\r\n                        <div className=\"font-caption font-caption-normal text-xs text-text-secondary\">\r\n                          {doc.format} {doc.file_size && `‚Ä¢ ${doc.file_size}`}\r\n                        </div>\r\n                      </div>\r\n                    </div>\r\n                  </td>\r\n                  <td className=\"py-4 px-4\">\r\n                    <span className={`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${\r\n                      doc.type === 'certificats' ? 'bg-blue-100 text-blue-700' :\r\n                      doc.type === 'attestations' ? 'bg-green-100 text-green-700' :\r\n                      doc.type === 'bulletins' ? 'bg-purple-100 text-purple-700' :\r\n                      'bg-gray-100 text-gray-700'\r\n                    }`}>\r\n                      {doc.type === 'certificats' ? 'Certificat' :\r\n                       doc.type === 'attestations' ? 'Attestation' :\r\n                       doc.type === 'bulletins' ? 'Bulletin' :\r\n                       doc.type || 'Document'}\r\n                    </span>\r\n                  </td>\r\n                  <td className=\"py-4 px-4\">\r\n                    <div className=\"font-body font-body-normal text-sm text-text-primary\">\r\n                      {doc.studentName || '-'}\r\n                    </div>\r\n                    <div className=\"font-caption font-caption-normal text-xs text-text-secondary\">\r\n                      {doc.class || '-'}\r\n                    </div>\r\n                  </td>\r\n                  <td className=\"py-4 px-4\">\r\n                    <div className=\"font-body font-body-normal text-sm text-text-primary\">\r\n                      {doc.dateCreated}\r\n                    </div>\r\n                  </td>\r\n                  <td className=\"py-4 px-4\">\r\n                    <span className={`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium border ${getStatusColor(doc.status)}`}>\r\n                      {getStatusLabel(doc.status)}\r\n                    </span>\r\n                  </td>\r\n                  <td className=\"py-4 px-4\">\r\n                    <div className=\"flex items-center justify-center space-x-1\">\r\n                      {/* Bouton Voir */}\r\n                      <Button\r\n                        variant=\"ghost\"\r\n                        size=\"sm\"\r\n                        onClick={() => handleViewDocument(doc.id)}\r\n                        title=\"Voir le document\"\r\n                        className=\"hover:bg-blue-50 hover:text-blue-600\"\r\n                      >\r\n                        <Icon name=\"Eye\" size={16} />\r\n                      </Button>\r\n                      {/* Bouton T√©l√©charger */}\r\n                      <Button\r\n                        variant=\"ghost\"\r\n                        size=\"sm\"\r\n                        onClick={() => handleDownloadDocument(doc.id)}\r\n                        title=\"T√©l√©charger\"\r\n                        className=\"hover:bg-green-50 hover:text-green-600\"\r\n                      >\r\n                        <Icon name=\"Download\" size={16} />\r\n                      </Button>\r\n                      {/* Bouton Imprimer */}\r\n                      <Button\r\n                        variant=\"ghost\"\r\n                        size=\"sm\"\r\n                        onClick={() => handlePrintDocument(doc.id)}\r\n                        title=\"Imprimer\"\r\n                        className=\"hover:bg-purple-50 hover:text-purple-600\"\r\n                      >\r\n                        <Icon name=\"Printer\" size={16} />\r\n                      </Button>\r\n                      {/* Bouton Supprimer */}\r\n                      <Button\r\n                        variant=\"ghost\"\r\n                        size=\"sm\"\r\n                        onClick={() => handleDeleteDocument(doc.id)}\r\n                        title=\"Supprimer\"\r\n                        className=\"hover:bg-red-50 hover:text-red-600\"\r\n                      >\r\n                        <Icon name=\"Trash2\" size={16} />\r\n                      </Button>\r\n                    </div>\r\n                  </td>\r\n                </tr>\r\n              ))}\r\n            </tbody>\r\n          </table>\r\n        </div>\r\n\r\n        {filteredDocuments.length === 0 && (\r\n          <div className=\"text-center py-12\">\r\n            <Icon name=\"FileText\" size={48} className=\"text-muted-foreground mx-auto mb-4\" />\r\n            <h3 className=\"font-heading font-heading-semibold text-lg text-text-primary mb-2\">\r\n              Aucun document trouv√©\r\n            </h3>\r\n            <p className=\"font-body font-body-normal text-text-secondary\">\r\n              {searchTerm || filterCategory \r\n                ? 'Aucun document ne correspond √† vos crit√®res de recherche.'\r\n                : 'Commencez par g√©n√©rer un document en utilisant les boutons ci-dessus.'}\r\n            </p>\r\n          </div>\r\n        )}\r\n      </div>\r\n      \r\n      {/* Modal de s√©lection */}\r\n      {showModal && (\r\n        <div className=\"fixed inset-0 bg-black/50 flex items-center justify-center z-50\">\r\n          <div className=\"bg-white rounded-lg p-6 max-w-md w-full mx-4 shadow-xl\">\r\n            <div className=\"flex items-center justify-between mb-4\">\r\n              <h3 className=\"text-xl font-semibold\">\r\n                {modalType === 'student' && 'S√©lectionner un √©l√®ve'}\r\n                {modalType === 'class' && 'S√©lectionner une classe'}\r\n                {modalType === 'public' && 'Document public'}\r\n              </h3>\r\n              <button\r\n                onClick={() => {\r\n                  setShowModal(false);\r\n                  setSelectedStudent(null);\r\n                  setSelectedClass(null);\r\n                }}\r\n                className=\"text-gray-400 hover:text-gray-600\"\r\n              >\r\n                <Icon name=\"X\" size={20} />\r\n              </button>\r\n            </div>\r\n            \r\n            <div className=\"mb-2 text-sm text-gray-500\">\r\n              Type de document : <span className=\"font-medium text-gray-700\">{documentType}</span>\r\n            </div>\r\n            \r\n            {modalType === 'student' && (\r\n              <div className=\"mb-4\">\r\n                <label className=\"block text-sm font-medium mb-2\">√âl√®ve</label>\r\n                <select\r\n                  className=\"w-full border border-gray-300 rounded-lg px-3 py-2\"\r\n                  value={selectedStudent || ''}\r\n                  onChange={(e) => setSelectedStudent(e.target.value)}\r\n                >\r\n                  <option value=\"\">-- S√©lectionner un √©l√®ve --</option>\r\n                  {students.map(student => (\r\n                    <option key={student.id} value={student.id}>\r\n                      {student.last_name} {student.first_name} - {student.class_name}\r\n                    </option>\r\n                  ))}\r\n                </select>\r\n              </div>\r\n            )}\r\n            \r\n            {modalType === 'class' && (\r\n              <div className=\"mb-4\">\r\n                <label className=\"block text-sm font-medium mb-2\">Classe</label>\r\n                <select\r\n                  className=\"w-full border border-gray-300 rounded-lg px-3 py-2\"\r\n                  value={selectedClass || ''}\r\n                  onChange={(e) => setSelectedClass(e.target.value)}\r\n                >\r\n                  <option value=\"\">-- S√©lectionner une classe --</option>\r\n                  {classes.map(cls => (\r\n                    <option key={cls.id} value={cls.id}>\r\n                      {cls.name} ({cls.level})\r\n                    </option>\r\n                  ))}\r\n                </select>\r\n              </div>\r\n            )}\r\n            \r\n            {modalType === 'public' && (\r\n              <p className=\"mb-4 text-gray-600\">\r\n                Ce document sera visible par tous les parents et √©l√®ves de l'√©cole.\r\n              </p>\r\n            )}\r\n            \r\n            <div className=\"flex justify-end gap-3\">\r\n              <Button\r\n                variant=\"outline\"\r\n                onClick={() => {\r\n                  setShowModal(false);\r\n                  setSelectedStudent(null);\r\n                  setSelectedClass(null);\r\n                }}\r\n              >\r\n                Annuler\r\n              </Button>\r\n              <Button\r\n                variant=\"default\"\r\n                onClick={confirmGenerateDocument}\r\n                disabled={\r\n                  (modalType === 'student' && !selectedStudent) ||\r\n                  (modalType === 'class' && !selectedClass)\r\n                }\r\n              >\r\n                G√©n√©rer\r\n              </Button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default DocumentsTab;","// Service de gestion du planning et des √©v√©nements scolaires\r\n\r\nimport { supabase } from '../lib/supabase';\r\nimport { getCurrentSchoolId } from './cardService';\r\n\r\nclass PlanningService {\r\n  constructor() {\r\n    this.events = [];\r\n    this.nextId = 1;\r\n  }\r\n\r\n  // Obtenir tous les √©v√©nements avec filtres\r\n  async getAllEvents(filters = {}) {\r\n    try {\r\n      const schoolId = await getCurrentSchoolId();\r\n\r\n      if (!schoolId) {\r\n        return {\r\n          events: [],\r\n          statistics: { total: 0, upcoming: 0, today: 0, confirmed: 0, pending: 0, cancelled: 0 }\r\n        };\r\n      }\r\n\r\n      // R√©cup√©rer les √©tudiants r√©els pour g√©n√©rer des √©v√©nements\r\n      const { data: studentsData, error } = await supabase\r\n        .from('students')\r\n        .select('id, user_id, first_name, last_name, created_at')\r\n        .eq('school_id', schoolId)\r\n        .eq('is_active', true)\r\n        .order('created_at', { ascending: false })\r\n        .limit(10);\r\n\r\n      if (error) {\r\n        throw error;\r\n      }\r\n\r\n      if (!studentsData || studentsData.length === 0) {\r\n        return {\r\n          events: [],\r\n          statistics: { total: 0, upcoming: 0, today: 0, confirmed: 0, pending: 0, cancelled: 0 }\r\n        };\r\n      }\r\n\r\n      // G√©n√©rer des √©v√©nements bas√©s sur les vrais √©tudiants\r\n      const events = [];\r\n      studentsData.forEach((student, index) => {\r\n        const eventTypes = ['parent_meeting', 'meeting', 'school_event', 'inscription'];\r\n        const statuses = ['confirmed', 'scheduled', 'pending'];\r\n\r\n        const numEvents = Math.floor(Math.random() * 2) + 1;\r\n\r\n        for (let i = 0; i < numEvents; i++) {\r\n          const eventDate = new Date();\r\n          eventDate.setDate(eventDate.getDate() + (index * 2 + i + 1));\r\n\r\n          const eventType = eventTypes[i % eventTypes.length];\r\n          const startHour = 8 + (index + i) % 8;\r\n\r\n          events.push({\r\n            id: events.length + 1,\r\n            title: this.generateEventTitle(eventType, student),\r\n            type: eventType,\r\n            date: eventDate.toISOString().split('T')[0],\r\n            startTime: `${startHour.toString().padStart(2, '0')}:00`,\r\n            endTime: `${(startHour + 1).toString().padStart(2, '0')}:00`,\r\n            duration: 60,\r\n            status: statuses[i % statuses.length],\r\n            description: this.generateEventDescription(eventType, student),\r\n            attendees: this.generateAttendees(eventType, student),\r\n            location: 'Bureau secr√©tariat',\r\n            priority: ['high', 'medium', 'low'][i % 3],\r\n            studentId: student.user_id || student.id,\r\n            studentName: `${student.first_name} ${student.last_name}`,\r\n            studentClass: 'Non assign√©',\r\n            createdBy: 'secretary',\r\n            reminders: [\r\n              { type: 'email', time: '1 day before', sent: false }\r\n            ],\r\n            parentPhone: `+237 6XX XX XX ${(index + 10).toString().padStart(2, '0')}`,\r\n            parentEmail: `${student.first_name.toLowerCase()}.parent@email.com`\r\n          });\r\n        }\r\n      });\r\n\r\n      // Appliquer les filtres\r\n      let filteredEvents = this.applyFilters(events, filters);\r\n\r\n      // Calculer les statistiques\r\n      const statistics = this.calculateStatistics(filteredEvents);\r\n\r\n      return {\r\n        events: filteredEvents,\r\n        statistics\r\n      };\r\n\r\n    } catch (error) {\r\n      console.error('Erreur getAllEvents:', error);\r\n      return {\r\n        events: [],\r\n        statistics: { total: 0, upcoming: 0, today: 0, confirmed: 0, pending: 0, cancelled: 0 }\r\n      };\r\n    }\r\n  }\r\n\r\n  // Appliquer les filtres aux √©v√©nements\r\n  applyFilters(events, filters) {\r\n    let filteredEvents = [...events];\r\n\r\n    // Filtrer par type\r\n    if (filters.type && filters.type !== '') {\r\n      filteredEvents = filteredEvents.filter(event => event.type === filters.type);\r\n    }\r\n\r\n    // Filtrer par statut\r\n    if (filters.status && filters.status !== '') {\r\n      filteredEvents = filteredEvents.filter(event => event.status === filters.status);\r\n    }\r\n\r\n    // Filtrer par date\r\n    if (filters.startDate) {\r\n      filteredEvents = filteredEvents.filter(event => \r\n        new Date(event.date) >= new Date(filters.startDate)\r\n      );\r\n    }\r\n\r\n    if (filters.endDate) {\r\n      filteredEvents = filteredEvents.filter(event => \r\n        new Date(event.date) <= new Date(filters.endDate)\r\n      );\r\n    }\r\n\r\n    // Filtrer par classe\r\n    if (filters.studentClass) {\r\n      filteredEvents = filteredEvents.filter(event => \r\n        event.studentClass === filters.studentClass\r\n      );\r\n    }\r\n\r\n    // Recherche par texte\r\n    if (filters.search) {\r\n      const searchLower = filters.search.toLowerCase();\r\n      filteredEvents = filteredEvents.filter(event =>\r\n        event.title.toLowerCase().includes(searchLower) ||\r\n        event.description.toLowerCase().includes(searchLower) ||\r\n        event.location.toLowerCase().includes(searchLower) ||\r\n        (event.studentName && event.studentName.toLowerCase().includes(searchLower))\r\n      );\r\n    }\r\n\r\n    // Trier par date et heure\r\n    filteredEvents.sort((a, b) => {\r\n      const dateA = new Date(`${a.date} ${a.startTime}`);\r\n      const dateB = new Date(`${b.date} ${b.startTime}`);\r\n      return dateA - dateB;\r\n    });\r\n\r\n    return filteredEvents;\r\n  }\r\n\r\n  // Fonctions utilitaires pour la g√©n√©ration d'√©v√©nements\r\n  generateEventTitle(eventType, student) {\r\n    const titles = {\r\n      parent_meeting: `Rendez-vous - Parents de ${student.first_name} ${student.last_name}`,\r\n      meeting: `R√©union p√©dagogique - ${student.first_name}`,\r\n      school_event: `√âv√©nement scolaire - Classe de ${student.first_name}`,\r\n      inscription: `Inscription - ${student.first_name} ${student.last_name}`\r\n    };\r\n    return titles[eventType] || `√âv√©nement - ${student.first_name} ${student.last_name}`;\r\n  }\r\n\r\n  generateEventDescription(eventType, student) {\r\n    const descriptions = {\r\n      parent_meeting: `Entretien concernant ${student.first_name} ${student.last_name} - Suivi scolaire`,\r\n      meeting: `R√©union d'√©quipe p√©dagogique concernant la classe`,\r\n      school_event: `√âv√©nement organis√© pour la classe`,\r\n      inscription: `Finalisation inscription de ${student.first_name} ${student.last_name}`\r\n    };\r\n    return descriptions[eventType] || `√âv√©nement concernant ${student.first_name} ${student.last_name}`;\r\n  }\r\n\r\n  generateAttendees(eventType, student) {\r\n    const attendees = {\r\n      parent_meeting: [`Parents de ${student.first_name}`, 'Enseignant', 'Secr√©taire'],\r\n      meeting: ['Direction', '√âquipe p√©dagogique', 'Secr√©taire'],\r\n      school_event: ['√âl√®ves', 'Parents', 'Enseignants'],\r\n      inscription: [`Parents de ${student.first_name}`, 'Secr√©taire', 'Direction']\r\n    };\r\n    return attendees[eventType] || ['Participants'];\r\n  }\r\n\r\n  calculateStatistics(events) {\r\n    const today = new Date().toISOString().split('T')[0];\r\n    \r\n    return {\r\n      total: events.length,\r\n      upcoming: events.filter(e => new Date(e.date) >= new Date(today)).length,\r\n      today: events.filter(e => e.date === today).length,\r\n      confirmed: events.filter(e => e.status === 'confirmed').length,\r\n      pending: events.filter(e => e.status === 'pending').length,\r\n      cancelled: events.filter(e => e.status === 'cancelled').length\r\n    };\r\n  }\r\n\r\n  // Cr√©er un nouvel √©v√©nement\r\n  async createEvent(eventData) {\r\n    await this.delay(500);\r\n\r\n    const newEvent = {\r\n      id: this.nextId++,\r\n      ...eventData,\r\n      status: eventData.status || 'scheduled',\r\n      createdBy: 'secretary',\r\n      createdAt: new Date().toISOString(),\r\n      reminders: eventData.reminders || []\r\n    };\r\n\r\n    this.events.push(newEvent);\r\n    return { success: true, event: newEvent };\r\n  }\r\n\r\n  // Modifier un √©v√©nement\r\n  async updateEvent(eventId, updates) {\r\n    await this.delay(400);\r\n\r\n    const eventIndex = this.events.findIndex(e => e.id === eventId);\r\n    if (eventIndex === -1) {\r\n      throw new Error('√âv√©nement non trouv√©');\r\n    }\r\n\r\n    this.events[eventIndex] = {\r\n      ...this.events[eventIndex],\r\n      ...updates,\r\n      updatedAt: new Date().toISOString()\r\n    };\r\n\r\n    return { success: true, event: this.events[eventIndex] };\r\n  }\r\n\r\n  // Supprimer un √©v√©nement\r\n  async deleteEvent(eventId) {\r\n    await this.delay(300);\r\n\r\n    const eventIndex = this.events.findIndex(e => e.id === eventId);\r\n    if (eventIndex === -1) {\r\n      throw new Error('√âv√©nement non trouv√©');\r\n    }\r\n\r\n    const deletedEvent = this.events.splice(eventIndex, 1)[0];\r\n    return { success: true, event: deletedEvent };\r\n  }\r\n\r\n  // Confirmer un √©v√©nement\r\n  async confirmEvent(eventId) {\r\n    return this.updateEvent(eventId, { status: 'confirmed' });\r\n  }\r\n\r\n  // Annuler un √©v√©nement\r\n  async cancelEvent(eventId, reason = '') {\r\n    return this.updateEvent(eventId, { \r\n      status: 'cancelled', \r\n      cancellationReason: reason,\r\n      cancelledAt: new Date().toISOString()\r\n    });\r\n  }\r\n\r\n  // Obtenir √©v√©nements par date\r\n  async getEventsByDate(date) {\r\n    await this.delay(200);\r\n    return this.events.filter(event => event.date === date);\r\n  }\r\n\r\n  // Obtenir √©v√©nements de la semaine\r\n  async getWeekEvents(startDate) {\r\n    await this.delay(300);\r\n    const start = new Date(startDate);\r\n    const end = new Date(start);\r\n    end.setDate(start.getDate() + 6);\r\n\r\n    return this.events.filter(event => {\r\n      const eventDate = new Date(event.date);\r\n      return eventDate >= start && eventDate <= end;\r\n    });\r\n  }\r\n\r\n  // V√©rifier disponibilit√©s\r\n  async checkAvailability(date, startTime, endTime, excludeEventId = null) {\r\n    await this.delay(200);\r\n    \r\n    const conflicts = this.events.filter(event => {\r\n      if (excludeEventId && event.id === excludeEventId) return false;\r\n      if (event.date !== date) return false;\r\n      if (event.status === 'cancelled') return false;\r\n\r\n      const eventStart = this.timeToMinutes(event.startTime);\r\n      const eventEnd = this.timeToMinutes(event.endTime);\r\n      const checkStart = this.timeToMinutes(startTime);\r\n      const checkEnd = this.timeToMinutes(endTime);\r\n\r\n      // V√©rifier le chevauchement\r\n      return (checkStart < eventEnd && checkEnd > eventStart);\r\n    });\r\n\r\n    return {\r\n      available: conflicts.length === 0,\r\n      conflicts: conflicts\r\n    };\r\n  }\r\n\r\n  // Envoyer rappels\r\n  async sendReminders(eventId) {\r\n    await this.delay(400);\r\n    \r\n    const event = this.events.find(e => e.id === eventId);\r\n    if (!event) {\r\n      throw new Error('√âv√©nement non trouv√©');\r\n    }\r\n\r\n    // Simuler l'envoi des rappels\r\n    const sentReminders = [];\r\n    \r\n    if (event.parentEmail) {\r\n      sentReminders.push({\r\n        type: 'email',\r\n        recipient: event.parentEmail,\r\n        sentAt: new Date().toISOString()\r\n      });\r\n    }\r\n\r\n    if (event.parentPhone) {\r\n      sentReminders.push({\r\n        type: 'sms',\r\n        recipient: event.parentPhone,\r\n        sentAt: new Date().toISOString()\r\n      });\r\n    }\r\n\r\n    // Mettre √† jour l'√©v√©nement\r\n    event.reminders.forEach(reminder => {\r\n      reminder.sent = true;\r\n      reminder.sentAt = new Date().toISOString();\r\n    });\r\n\r\n    return { success: true, sentReminders };\r\n  }\r\n\r\n  // Calculer statistiques\r\n  calculateStatistics(events) {\r\n    const today = new Date().toISOString().split('T')[0];\r\n    const thisWeek = new Date();\r\n    thisWeek.setDate(thisWeek.getDate() + 7);\r\n    const thisWeekStr = thisWeek.toISOString().split('T')[0];\r\n\r\n    return {\r\n      total: events.length,\r\n      today: events.filter(e => e.date === today).length,\r\n      thisWeek: events.filter(e => e.date >= today && e.date <= thisWeekStr).length,\r\n      byStatus: {\r\n        confirmed: events.filter(e => e.status === 'confirmed').length,\r\n        scheduled: events.filter(e => e.status === 'scheduled').length,\r\n        pending: events.filter(e => e.status === 'pending').length,\r\n        cancelled: events.filter(e => e.status === 'cancelled').length\r\n      },\r\n      byType: {\r\n        parent_meeting: events.filter(e => e.type === 'parent_meeting').length,\r\n        meeting: events.filter(e => e.type === 'meeting').length,\r\n        school_event: events.filter(e => e.type === 'school_event').length,\r\n        training: events.filter(e => e.type === 'training').length,\r\n        official_meeting: events.filter(e => e.type === 'official_meeting').length,\r\n        inscription: events.filter(e => e.type === 'inscription').length,\r\n        interview: events.filter(e => e.type === 'interview').length,\r\n        holiday: events.filter(e => e.type === 'holiday').length\r\n      },\r\n      pendingConfirmations: events.filter(e => e.status === 'pending').length,\r\n      upcomingThisWeek: events.filter(e => \r\n        e.date >= today && \r\n        e.date <= thisWeekStr && \r\n        e.status !== 'cancelled'\r\n      ).length\r\n    };\r\n  }\r\n\r\n  // Utilitaires\r\n  timeToMinutes(timeStr) {\r\n    const [hours, minutes] = timeStr.split(':').map(Number);\r\n    return hours * 60 + minutes;\r\n  }\r\n\r\n  delay(ms) {\r\n    return new Promise(resolve => setTimeout(resolve, ms));\r\n  }\r\n\r\n  // Exporter planning\r\n  async exportPlanning(format = 'csv', filters = {}) {\r\n    const { events } = await this.getAllEvents(filters);\r\n    \r\n    if (format === 'csv') {\r\n      const headers = [\r\n        'Date', 'Heure', 'Titre', 'Type', 'Statut', 'Lieu', \r\n        'Participants', 'Description', 'Priorit√©', 'Dur√©e (min)'\r\n      ];\r\n      \r\n      const rows = events.map(event => [\r\n        event.date,\r\n        event.startTime,\r\n        event.title,\r\n        this.getTypeLabel(event.type),\r\n        this.getStatusLabel(event.status),\r\n        event.location,\r\n        event.attendees.join('; '),\r\n        event.description,\r\n        event.priority,\r\n        event.duration\r\n      ]);\r\n\r\n      return [headers, ...rows];\r\n    }\r\n    \r\n    return events;\r\n  }\r\n\r\n  getTypeLabel(type) {\r\n    const labels = {\r\n      parent_meeting: 'Rendez-vous parents',\r\n      meeting: 'R√©union',\r\n      school_event: '√âv√©nement scolaire',\r\n      training: 'Formation',\r\n      official_meeting: 'Conseil officiel',\r\n      inscription: 'Inscription',\r\n      interview: 'Entretien',\r\n      holiday: 'Vacances'\r\n    };\r\n    return labels[type] || type;\r\n  }\r\n\r\n  getStatusLabel(status) {\r\n    const labels = {\r\n      confirmed: 'Confirm√©',\r\n      scheduled: 'Programm√©',  \r\n      pending: 'En attente',\r\n      cancelled: 'Annul√©'\r\n    };\r\n    return labels[status] || status;\r\n  }\r\n}\r\n\r\nconst planningService = new PlanningService();\r\nexport default planningService;","import React, { useState, useEffect } from 'react';\r\nimport { X, Calendar, Clock, MapPin, Users, FileText, AlertTriangle } from 'lucide-react';\r\nimport Button from '../../../components/ui/Button';\r\nimport Input from '../../../components/ui/Input';\r\nimport Select from '../../../components/ui/Select';\r\nimport planningService from '../../../services/planningService';\r\n\r\nexport const EventModal = ({ isOpen, onClose, event = null, onSuccess }) => {\r\n  const [loading, setLoading] = useState(false);\r\n  const [errors, setErrors] = useState({});\r\n  const [availabilityCheck, setAvailabilityCheck] = useState(null);\r\n  \r\n  const [formData, setFormData] = useState({\r\n    title: '',\r\n    type: 'parent_meeting',\r\n    date: '',\r\n    startTime: '',\r\n    endTime: '',\r\n    location: '',\r\n    description: '',\r\n    priority: 'medium',\r\n    attendees: [''],\r\n    studentName: '',\r\n    studentClass: '',\r\n    parentPhone: '',\r\n    parentEmail: '',\r\n    notes: '',\r\n    reminders: [\r\n      { type: 'email', time: '1 day before', enabled: true },\r\n      { type: 'sms', time: '2 hours before', enabled: false }\r\n    ]\r\n  });\r\n\r\n  useEffect(() => {\r\n    if (event) {\r\n      setFormData({\r\n        title: event.title || '',\r\n        type: event.type || 'parent_meeting',\r\n        date: event.date || '',\r\n        startTime: event.startTime || '',\r\n        endTime: event.endTime || '',\r\n        location: event.location || '',\r\n        description: event.description || '',\r\n        priority: event.priority || 'medium',\r\n        attendees: event.attendees || [''],\r\n        studentName: event.studentName || '',\r\n        studentClass: event.studentClass || '',\r\n        parentPhone: event.parentPhone || '',\r\n        parentEmail: event.parentEmail || '',\r\n        notes: event.notes || '',\r\n        reminders: event.reminders || [\r\n          { type: 'email', time: '1 day before', enabled: true },\r\n          { type: 'sms', time: '2 hours before', enabled: false }\r\n        ]\r\n      });\r\n    } else {\r\n      // Reset form for new event\r\n      setFormData({\r\n        title: '',\r\n        type: 'parent_meeting',\r\n        date: '',\r\n        startTime: '',\r\n        endTime: '',\r\n        location: 'Bureau secr√©tariat',\r\n        description: '',\r\n        priority: 'medium',\r\n        attendees: [''],\r\n        studentName: '',\r\n        studentClass: '',\r\n        parentPhone: '',\r\n        parentEmail: '',\r\n        notes: '',\r\n        reminders: [\r\n          { type: 'email', time: '1 day before', enabled: true },\r\n          { type: 'sms', time: '2 hours before', enabled: false }\r\n        ]\r\n      });\r\n    }\r\n    setErrors({});\r\n    setAvailabilityCheck(null);\r\n  }, [event, isOpen]);\r\n\r\n  const eventTypes = [\r\n    { value: 'parent_meeting', label: 'Rendez-vous parents' },\r\n    { value: 'meeting', label: 'R√©union p√©dagogique' },\r\n    { value: 'school_event', label: '√âv√©nement scolaire' },\r\n    { value: 'training', label: 'Formation' },\r\n    { value: 'official_meeting', label: 'Conseil officiel' },\r\n    { value: 'inscription', label: 'Inscription' },\r\n    { value: 'interview', label: 'Entretien' },\r\n    { value: 'holiday', label: 'Vacances scolaires' }\r\n  ];\r\n\r\n  const priorities = [\r\n    { value: 'low', label: 'Faible' },\r\n    { value: 'medium', label: 'Normal' },\r\n    { value: 'high', label: 'Urgent' }\r\n  ];\r\n\r\n  const classes = [\r\n    { value: '', label: 'S√©lectionner une classe' },\r\n    { value: 'CE1', label: 'CE1' },\r\n    { value: 'CE2', label: 'CE2' },\r\n    { value: 'CM1', label: 'CM1' },\r\n    { value: 'CM2', label: 'CM2' }\r\n  ];\r\n\r\n  const commonLocations = [\r\n    { value: 'Bureau secr√©tariat', label: 'Bureau secr√©tariat' },\r\n    { value: 'Bureau direction', label: 'Bureau direction' },\r\n    { value: 'Salle des professeurs', label: 'Salle des professeurs' },\r\n    { value: 'Salle polyvalente', label: 'Salle polyvalente' },\r\n    { value: 'Salle de classe', label: 'Salle de classe' },\r\n    { value: 'Cour de r√©cr√©ation', label: 'Cour de r√©cr√©ation' },\r\n    { value: 'Ext√©rieur', label: 'Sortie/Ext√©rieur' }\r\n  ];\r\n\r\n  const handleInputChange = (field, value) => {\r\n    setFormData(prev => ({\r\n      ...prev,\r\n      [field]: value\r\n    }));\r\n\r\n    // Clear error for this field\r\n    if (errors[field]) {\r\n      setErrors(prev => ({\r\n        ...prev,\r\n        [field]: null\r\n      }));\r\n    }\r\n  };\r\n\r\n  const handleAttendeesChange = (index, value) => {\r\n    const newAttendees = [...formData.attendees];\r\n    newAttendees[index] = value;\r\n    setFormData(prev => ({\r\n      ...prev,\r\n      attendees: newAttendees\r\n    }));\r\n  };\r\n\r\n  const addAttendee = () => {\r\n    setFormData(prev => ({\r\n      ...prev,\r\n      attendees: [...prev.attendees, '']\r\n    }));\r\n  };\r\n\r\n  const removeAttendee = (index) => {\r\n    if (formData.attendees.length > 1) {\r\n      const newAttendees = formData.attendees.filter((_, i) => i !== index);\r\n      setFormData(prev => ({\r\n        ...prev,\r\n        attendees: newAttendees\r\n      }));\r\n    }\r\n  };\r\n\r\n  const handleReminderToggle = (index, enabled) => {\r\n    const newReminders = [...formData.reminders];\r\n    newReminders[index].enabled = enabled;\r\n    setFormData(prev => ({\r\n      ...prev,\r\n      reminders: newReminders\r\n    }));\r\n  };\r\n\r\n  const checkAvailability = async () => {\r\n    if (!formData.date || !formData.startTime || !formData.endTime) return;\r\n\r\n    try {\r\n      const result = await planningService.checkAvailability(\r\n        formData.date,\r\n        formData.startTime,\r\n        formData.endTime,\r\n        event?.id\r\n      );\r\n      setAvailabilityCheck(result);\r\n    } catch (error) {\r\n      console.error('Erreur v√©rification disponibilit√©:', error);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    const timeoutId = setTimeout(() => {\r\n      checkAvailability();\r\n    }, 500);\r\n\r\n    return () => clearTimeout(timeoutId);\r\n  }, [formData.date, formData.startTime, formData.endTime]);\r\n\r\n  const calculateDuration = () => {\r\n    if (!formData.startTime || !formData.endTime) return 0;\r\n    \r\n    const start = new Date(`2000-01-01 ${formData.startTime}`);\r\n    const end = new Date(`2000-01-01 ${formData.endTime}`);\r\n    return Math.round((end - start) / (1000 * 60));\r\n  };\r\n\r\n  const validateForm = () => {\r\n    const newErrors = {};\r\n\r\n    if (!formData.title.trim()) newErrors.title = 'Le titre est requis';\r\n    if (!formData.date) newErrors.date = 'La date est requise';\r\n    if (!formData.startTime) newErrors.startTime = 'L\\'heure de d√©but est requise';\r\n    if (!formData.endTime) newErrors.endTime = 'L\\'heure de fin est requise';\r\n    if (!formData.location.trim()) newErrors.location = 'Le lieu est requis';\r\n\r\n    // V√©rifier que l'heure de fin est apr√®s l'heure de d√©but\r\n    if (formData.startTime && formData.endTime) {\r\n      const start = new Date(`2000-01-01 ${formData.startTime}`);\r\n      const end = new Date(`2000-01-01 ${formData.endTime}`);\r\n      if (end <= start) {\r\n        newErrors.endTime = 'L\\'heure de fin doit √™tre apr√®s l\\'heure de d√©but';\r\n      }\r\n    }\r\n\r\n    // V√©rifier que la date n'est pas dans le pass√©\r\n    if (formData.date) {\r\n      const selectedDate = new Date(formData.date);\r\n      const today = new Date();\r\n      today.setHours(0, 0, 0, 0);\r\n      if (selectedDate < today) {\r\n        newErrors.date = 'La date ne peut pas √™tre dans le pass√©';\r\n      }\r\n    }\r\n\r\n    // Validation sp√©cifique pour rendez-vous parents\r\n    if (formData.type === 'parent_meeting') {\r\n      if (!formData.studentName.trim()) newErrors.studentName = 'Le nom de l\\'√©l√®ve est requis';\r\n      if (!formData.parentPhone.trim() && !formData.parentEmail.trim()) {\r\n        newErrors.parentPhone = 'Au moins un moyen de contact parent est requis';\r\n      }\r\n    }\r\n\r\n    setErrors(newErrors);\r\n    return Object.keys(newErrors).length === 0;\r\n  };\r\n\r\n  const handleSubmit = async (e) => {\r\n    e.preventDefault();\r\n    \r\n    if (!validateForm()) return;\r\n\r\n    setLoading(true);\r\n    try {\r\n      const eventData = {\r\n        ...formData,\r\n        duration: calculateDuration(),\r\n        attendees: formData.attendees.filter(a => a.trim() !== ''),\r\n        reminders: formData.reminders.filter(r => r.enabled)\r\n      };\r\n\r\n      if (event) {\r\n        await planningService.updateEvent(event.id, eventData);\r\n      } else {\r\n        await planningService.createEvent(eventData);\r\n      }\r\n\r\n      onSuccess && onSuccess();\r\n      onClose();\r\n    } catch (error) {\r\n      console.error('Erreur sauvegarde √©v√©nement:', error);\r\n      setErrors({ submit: 'Erreur lors de la sauvegarde' });\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  if (!isOpen) return null;\r\n\r\n  return (\r\n    <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4\">\r\n      <div className=\"bg-white rounded-lg shadow-xl w-full max-w-4xl max-h-[90vh] overflow-hidden\">\r\n        {/* Header */}\r\n        <div className=\"flex items-center justify-between p-4 border-b\">\r\n          <div>\r\n            <h2 className=\"text-lg font-semibold text-gray-900 flex items-center gap-2\">\r\n              <Calendar className=\"w-5 h-5\" />\r\n              {event ? 'Modifier l\\'√©v√©nement' : 'Cr√©er un √©v√©nement'}\r\n            </h2>\r\n            <p className=\"text-sm text-gray-600 mt-1\">\r\n              Planification et gestion des rendez-vous\r\n            </p>\r\n          </div>\r\n          <button\r\n            onClick={onClose}\r\n            className=\"text-gray-400 hover:text-gray-600 transition-colors\"\r\n          >\r\n            <X className=\"w-6 h-6\" />\r\n          </button>\r\n        </div>\r\n\r\n        {/* Form */}\r\n        <form onSubmit={handleSubmit} className=\"flex-1 overflow-y-auto\">\r\n          <div className=\"p-4 space-y-6\">\r\n            {/* Informations g√©n√©rales */}\r\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n              <div className=\"md:col-span-2\">\r\n                <label className=\"block text-sm font-medium text-gray-700 mb-1\">\r\n                  Titre de l'√©v√©nement *\r\n                </label>\r\n                <Input\r\n                  value={formData.title}\r\n                  onChange={(e) => handleInputChange('title', e.target.value)}\r\n                  placeholder=\"Ex: Rendez-vous avec M. et Mme Dupont\"\r\n                  error={errors.title}\r\n                />\r\n              </div>\r\n\r\n              <div>\r\n                <label className=\"block text-sm font-medium text-gray-700 mb-1\">\r\n                  Type d'√©v√©nement *\r\n                </label>\r\n                <Select\r\n                  options={eventTypes}\r\n                  value={formData.type}\r\n                  onChange={(value) => handleInputChange('type', value)}\r\n                />\r\n              </div>\r\n\r\n              <div>\r\n                <label className=\"block text-sm font-medium text-gray-700 mb-1\">\r\n                  Priorit√©\r\n                </label>\r\n                <Select\r\n                  options={priorities}\r\n                  value={formData.priority}\r\n                  onChange={(value) => handleInputChange('priority', value)}\r\n                />\r\n              </div>\r\n            </div>\r\n\r\n            {/* Date et heure */}\r\n            <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\r\n              <div>\r\n                <label className=\"block text-sm font-medium text-gray-700 mb-1\">\r\n                  Date *\r\n                </label>\r\n                <Input\r\n                  type=\"date\"\r\n                  value={formData.date}\r\n                  onChange={(e) => handleInputChange('date', e.target.value)}\r\n                  error={errors.date}\r\n                />\r\n              </div>\r\n\r\n              <div>\r\n                <label className=\"block text-sm font-medium text-gray-700 mb-1\">\r\n                  Heure de d√©but *\r\n                </label>\r\n                <Input\r\n                  type=\"time\"\r\n                  value={formData.startTime}\r\n                  onChange={(e) => handleInputChange('startTime', e.target.value)}\r\n                  error={errors.startTime}\r\n                />\r\n              </div>\r\n\r\n              <div>\r\n                <label className=\"block text-sm font-medium text-gray-700 mb-1\">\r\n                  Heure de fin *\r\n                </label>\r\n                <Input\r\n                  type=\"time\"\r\n                  value={formData.endTime}\r\n                  onChange={(e) => handleInputChange('endTime', e.target.value)}\r\n                  error={errors.endTime}\r\n                />\r\n                {calculateDuration() > 0 && (\r\n                  <p className=\"text-xs text-gray-500 mt-1\">\r\n                    Dur√©e: {calculateDuration()} minutes\r\n                  </p>\r\n                )}\r\n              </div>\r\n            </div>\r\n\r\n            {/* V√©rification disponibilit√© */}\r\n            {availabilityCheck && (\r\n              <div className={`p-3 rounded-lg border ${\r\n                availabilityCheck.available \r\n                  ? 'border-green-200 bg-green-50 text-green-800'\r\n                  : 'border-red-200 bg-red-50 text-red-800'\r\n              }`}>\r\n                <div className=\"flex items-center gap-2\">\r\n                  {availabilityCheck.available ? (\r\n                    <>\r\n                      <div className=\"w-2 h-2 bg-green-500 rounded-full\"></div>\r\n                      <span className=\"text-sm font-medium\">Cr√©neau disponible</span>\r\n                    </>\r\n                  ) : (\r\n                    <>\r\n                      <AlertTriangle className=\"w-4 h-4\" />\r\n                      <span className=\"text-sm font-medium\">\r\n                        Conflit d√©tect√© ({availabilityCheck.conflicts.length} √©v√©nement(s))\r\n                      </span>\r\n                    </>\r\n                  )}\r\n                </div>\r\n                {!availabilityCheck.available && (\r\n                  <div className=\"mt-2 text-xs\">\r\n                    {availabilityCheck.conflicts.map(conflict => (\r\n                      <div key={conflict.id}>\r\n                        ‚Ä¢ {conflict.title} ({conflict.startTime} - {conflict.endTime})\r\n                      </div>\r\n                    ))}\r\n                  </div>\r\n                )}\r\n              </div>\r\n            )}\r\n\r\n            {/* Lieu */}\r\n            <div>\r\n              <label className=\"block text-sm font-medium text-gray-700 mb-1\">\r\n                Lieu *\r\n              </label>\r\n              <Select\r\n                options={commonLocations}\r\n                value={formData.location}\r\n                onChange={(value) => handleInputChange('location', value)}\r\n                placeholder=\"Choisir un lieu...\"\r\n              />\r\n              {errors.location && (\r\n                <p className=\"text-red-500 text-xs mt-1\">{errors.location}</p>\r\n              )}\r\n            </div>\r\n\r\n            {/* Informations sp√©cifiques aux rendez-vous parents */}\r\n            {formData.type === 'parent_meeting' && (\r\n              <div className=\"p-4 bg-blue-50 rounded-lg border border-blue-200\">\r\n                <h4 className=\"font-medium text-blue-900 mb-3\">Informations √©l√®ve et parents</h4>\r\n                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n                  <div>\r\n                    <label className=\"block text-sm font-medium text-gray-700 mb-1\">\r\n                      Nom de l'√©l√®ve *\r\n                    </label>\r\n                    <Input\r\n                      value={formData.studentName}\r\n                      onChange={(e) => handleInputChange('studentName', e.target.value)}\r\n                      placeholder=\"Ex: Marie Dupont\"\r\n                      error={errors.studentName}\r\n                    />\r\n                  </div>\r\n\r\n                  <div>\r\n                    <label className=\"block text-sm font-medium text-gray-700 mb-1\">\r\n                      Classe\r\n                    </label>\r\n                    <Select\r\n                      options={classes}\r\n                      value={formData.studentClass}\r\n                      onChange={(value) => handleInputChange('studentClass', value)}\r\n                    />\r\n                  </div>\r\n\r\n                  <div>\r\n                    <label className=\"block text-sm font-medium text-gray-700 mb-1\">\r\n                      T√©l√©phone parent\r\n                    </label>\r\n                    <Input\r\n                      value={formData.parentPhone}\r\n                      onChange={(e) => handleInputChange('parentPhone', e.target.value)}\r\n                      placeholder=\"06.12.34.56.78\"\r\n                      error={errors.parentPhone}\r\n                    />\r\n                  </div>\r\n\r\n                  <div>\r\n                    <label className=\"block text-sm font-medium text-gray-700 mb-1\">\r\n                      Email parent\r\n                    </label>\r\n                    <Input\r\n                      type=\"email\"\r\n                      value={formData.parentEmail}\r\n                      onChange={(e) => handleInputChange('parentEmail', e.target.value)}\r\n                      placeholder=\"parent@email.com\"\r\n                    />\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            )}\r\n\r\n            {/* Participants */}\r\n            <div>\r\n              <label className=\"block text-sm font-medium text-gray-700 mb-2\">\r\n                Participants\r\n              </label>\r\n              {formData.attendees.map((attendee, index) => (\r\n                <div key={index} className=\"flex items-center gap-2 mb-2\">\r\n                  <Input\r\n                    value={attendee}\r\n                    onChange={(e) => handleAttendeesChange(index, e.target.value)}\r\n                    placeholder=\"Nom du participant\"\r\n                    className=\"flex-1\"\r\n                  />\r\n                  {formData.attendees.length > 1 && (\r\n                    <Button\r\n                      type=\"button\"\r\n                      variant=\"ghost\"\r\n                      size=\"sm\"\r\n                      onClick={() => removeAttendee(index)}\r\n                    >\r\n                      <X className=\"w-4 h-4\" />\r\n                    </Button>\r\n                  )}\r\n                </div>\r\n              ))}\r\n              <Button\r\n                type=\"button\"\r\n                variant=\"outline\"\r\n                size=\"sm\"\r\n                onClick={addAttendee}\r\n                className=\"mt-2\"\r\n              >\r\n                Ajouter un participant\r\n              </Button>\r\n            </div>\r\n\r\n            {/* Description */}\r\n            <div>\r\n              <label className=\"block text-sm font-medium text-gray-700 mb-1\">\r\n                Description\r\n              </label>\r\n              <textarea\r\n                value={formData.description}\r\n                onChange={(e) => handleInputChange('description', e.target.value)}\r\n                rows={3}\r\n                className=\"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\r\n                placeholder=\"D√©tails de l'√©v√©nement...\"\r\n              />\r\n            </div>\r\n\r\n            {/* Notes */}\r\n            <div>\r\n              <label className=\"block text-sm font-medium text-gray-700 mb-1\">\r\n                Notes internes\r\n              </label>\r\n              <textarea\r\n                value={formData.notes}\r\n                onChange={(e) => handleInputChange('notes', e.target.value)}\r\n                rows={2}\r\n                className=\"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\r\n                placeholder=\"Notes priv√©es pour l'√©quipe...\"\r\n              />\r\n            </div>\r\n\r\n            {/* Rappels */}\r\n            <div>\r\n              <label className=\"block text-sm font-medium text-gray-700 mb-2\">\r\n                Rappels automatiques\r\n              </label>\r\n              <div className=\"space-y-2\">\r\n                {formData.reminders.map((reminder, index) => (\r\n                  <div key={index} className=\"flex items-center gap-3 p-2 border rounded\">\r\n                    <input\r\n                      type=\"checkbox\"\r\n                      checked={reminder.enabled}\r\n                      onChange={(e) => handleReminderToggle(index, e.target.checked)}\r\n                      className=\"rounded\"\r\n                    />\r\n                    <span className=\"text-sm\">\r\n                      {reminder.type === 'email' ? 'üìß' : 'üì±'} {reminder.type.toUpperCase()} - {reminder.time}\r\n                    </span>\r\n                  </div>\r\n                ))}\r\n              </div>\r\n            </div>\r\n\r\n            {errors.submit && (\r\n              <div className=\"text-red-600 text-sm\">{errors.submit}</div>\r\n            )}\r\n          </div>\r\n\r\n          {/* Footer */}\r\n          <div className=\"flex items-center justify-end gap-3 p-4 border-t bg-gray-50\">\r\n            <Button\r\n              type=\"button\"\r\n              variant=\"outline\"\r\n              onClick={onClose}\r\n              disabled={loading}\r\n            >\r\n              Annuler\r\n            </Button>\r\n            <Button\r\n              type=\"submit\"\r\n              disabled={loading || (availabilityCheck && !availabilityCheck.available)}\r\n              loading={loading}\r\n            >\r\n              {event ? 'Modifier' : 'Cr√©er'} l'√©v√©nement\r\n            </Button>\r\n          </div>\r\n        </form>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default EventModal;","import React, { useState, useEffect } from 'react';\r\nimport { X, ChevronLeft, ChevronRight, Calendar, Clock, MapPin } from 'lucide-react';\r\nimport Button from '../../../components/ui/Button';\r\nimport planningService from '../../../services/planningService';\r\n\r\nexport const PlanningCalendarModal = ({ isOpen, onClose, onEventSelect }) => {\r\n  const [currentDate, setCurrentDate] = useState(new Date());\r\n  const [events, setEvents] = useState([]);\r\n  const [loading, setLoading] = useState(false);\r\n  const [selectedDate, setSelectedDate] = useState(null);\r\n  const [hoveredDate, setHoveredDate] = useState(null);\r\n\r\n  useEffect(() => {\r\n    if (isOpen) {\r\n      loadMonthEvents();\r\n    }\r\n  }, [isOpen, currentDate]);\r\n\r\n  const loadMonthEvents = async () => {\r\n    setLoading(true);\r\n    try {\r\n      const startDate = new Date(currentDate.getFullYear(), currentDate.getMonth(), 1);\r\n      const endDate = new Date(currentDate.getFullYear(), currentDate.getMonth() + 1, 0);\r\n      \r\n      const { events: monthEvents } = await planningService.getAllEvents({\r\n        startDate: startDate.toISOString().split('T')[0],\r\n        endDate: endDate.toISOString().split('T')[0]\r\n      });\r\n      \r\n      setEvents(monthEvents);\r\n    } catch (error) {\r\n      console.error('Erreur chargement √©v√©nements:', error);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const navigateMonth = (direction) => {\r\n    const newDate = new Date(currentDate);\r\n    newDate.setMonth(newDate.getMonth() + direction);\r\n    setCurrentDate(newDate);\r\n    setSelectedDate(null);\r\n  };\r\n\r\n  const goToToday = () => {\r\n    setCurrentDate(new Date());\r\n    setSelectedDate(null);\r\n  };\r\n\r\n  const generateCalendarDays = () => {\r\n    const year = currentDate.getFullYear();\r\n    const month = currentDate.getMonth();\r\n    \r\n    const firstDay = new Date(year, month, 1);\r\n    const lastDay = new Date(year, month + 1, 0);\r\n    const startDate = new Date(firstDay);\r\n    \r\n    // Commencer au lundi de la semaine contenant le 1er du mois\r\n    const dayOfWeek = firstDay.getDay();\r\n    const mondayOffset = dayOfWeek === 0 ? 6 : dayOfWeek - 1;\r\n    startDate.setDate(startDate.getDate() - mondayOffset);\r\n    \r\n    const days = [];\r\n    const current = new Date(startDate);\r\n    \r\n    // G√©n√©rer 6 semaines (42 jours)\r\n    for (let i = 0; i < 42; i++) {\r\n      days.push(new Date(current));\r\n      current.setDate(current.getDate() + 1);\r\n    }\r\n    \r\n    return days;\r\n  };\r\n\r\n  const getEventsForDate = (date) => {\r\n    const dateStr = date.toISOString().split('T')[0];\r\n    return events.filter(event => event.date === dateStr);\r\n  };\r\n\r\n  const getEventTypeColor = (type) => {\r\n    const colors = {\r\n      parent_meeting: 'bg-blue-100 text-blue-700 border-blue-200',\r\n      meeting: 'bg-purple-100 text-purple-700 border-purple-200',\r\n      school_event: 'bg-green-100 text-green-700 border-green-200',\r\n      training: 'bg-orange-100 text-orange-700 border-orange-200',\r\n      official_meeting: 'bg-red-100 text-red-700 border-red-200',\r\n      inscription: 'bg-yellow-100 text-yellow-700 border-yellow-200',\r\n      interview: 'bg-indigo-100 text-indigo-700 border-indigo-200',\r\n      holiday: 'bg-gray-100 text-gray-700 border-gray-200'\r\n    };\r\n    return colors[type] || colors.parent_meeting;\r\n  };\r\n\r\n  const getStatusIndicator = (status) => {\r\n    const indicators = {\r\n      confirmed: '‚úÖ',\r\n      scheduled: 'üìÖ',\r\n      pending: '‚è≥',\r\n      cancelled: '‚ùå'\r\n    };\r\n    return indicators[status] || indicators.scheduled;\r\n  };\r\n\r\n  const formatMonthYear = () => {\r\n    return currentDate.toLocaleDateString('fr-FR', { \r\n      month: 'long', \r\n      year: 'numeric' \r\n    });\r\n  };\r\n\r\n  const isToday = (date) => {\r\n    const today = new Date();\r\n    return date.toDateString() === today.toDateString();\r\n  };\r\n\r\n  const isCurrentMonth = (date) => {\r\n    return date.getMonth() === currentDate.getMonth();\r\n  };\r\n\r\n  const handleDateClick = (date) => {\r\n    const dateEvents = getEventsForDate(date);\r\n    if (dateEvents.length > 0) {\r\n      setSelectedDate(date);\r\n    }\r\n  };\r\n\r\n  const handleEventClick = (event) => {\r\n    onEventSelect && onEventSelect(event);\r\n    onClose();\r\n  };\r\n\r\n  const weekDays = ['Lun', 'Mar', 'Mer', 'Jeu', 'Ven', 'Sam', 'Dim'];\r\n  const calendarDays = generateCalendarDays();\r\n\r\n  if (!isOpen) return null;\r\n\r\n  return (\r\n    <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4\">\r\n      <div className=\"bg-white rounded-lg shadow-xl w-full max-w-6xl max-h-[90vh] overflow-hidden\">\r\n        {/* Header */}\r\n        <div className=\"flex items-center justify-between p-4 border-b\">\r\n          <div>\r\n            <h2 className=\"text-lg font-semibold text-gray-900 flex items-center gap-2\">\r\n              <Calendar className=\"w-5 h-5\" />\r\n              Calendrier Planning\r\n            </h2>\r\n            <p className=\"text-sm text-gray-600 mt-1\">\r\n              Vue mensuelle des √©v√©nements et rendez-vous\r\n            </p>\r\n          </div>\r\n          <button\r\n            onClick={onClose}\r\n            className=\"text-gray-400 hover:text-gray-600 transition-colors\"\r\n          >\r\n            <X className=\"w-6 h-6\" />\r\n          </button>\r\n        </div>\r\n\r\n        <div className=\"flex h-[600px]\">\r\n          {/* Calendrier principal */}\r\n          <div className=\"flex-1 flex flex-col\">\r\n            {/* Navigation mois */}\r\n            <div className=\"flex items-center justify-between p-4 border-b bg-gray-50\">\r\n              <div className=\"flex items-center gap-2\">\r\n                <Button\r\n                  variant=\"outline\"\r\n                  size=\"sm\"\r\n                  onClick={() => navigateMonth(-1)}\r\n                >\r\n                  <ChevronLeft className=\"w-4 h-4\" />\r\n                </Button>\r\n                <Button\r\n                  variant=\"outline\"\r\n                  size=\"sm\"\r\n                  onClick={() => navigateMonth(1)}\r\n                >\r\n                  <ChevronRight className=\"w-4 h-4\" />\r\n                </Button>\r\n                <h3 className=\"text-lg font-semibold text-gray-900 ml-4 capitalize\">\r\n                  {formatMonthYear()}\r\n                </h3>\r\n              </div>\r\n              <Button\r\n                variant=\"outline\"\r\n                size=\"sm\"\r\n                onClick={goToToday}\r\n              >\r\n                Aujourd'hui\r\n              </Button>\r\n            </div>\r\n\r\n            {/* En-t√™tes jours de la semaine */}\r\n            <div className=\"grid grid-cols-7 border-b bg-gray-50\">\r\n              {weekDays.map(day => (\r\n                <div key={day} className=\"p-2 text-center text-sm font-medium text-gray-700 border-r last:border-r-0\">\r\n                  {day}\r\n                </div>\r\n              ))}\r\n            </div>\r\n\r\n            {/* Grille du calendrier */}\r\n            <div className=\"flex-1 grid grid-cols-7 auto-rows-fr\">\r\n              {calendarDays.map((date, index) => {\r\n                const dayEvents = getEventsForDate(date);\r\n                const isCurrentMonthDay = isCurrentMonth(date);\r\n                const isTodayDate = isToday(date);\r\n                \r\n                return (\r\n                  <div\r\n                    key={index}\r\n                    className={`border-r border-b last:border-r-0 p-1 cursor-pointer transition-colors ${\r\n                      !isCurrentMonthDay \r\n                        ? 'bg-gray-50 text-gray-400' \r\n                        : hoveredDate?.toDateString() === date.toDateString()\r\n                        ? 'bg-blue-50'\r\n                        : 'bg-white hover:bg-gray-50'\r\n                    } ${\r\n                      selectedDate?.toDateString() === date.toDateString() \r\n                        ? 'bg-blue-100 ring-2 ring-blue-500' \r\n                        : ''\r\n                    }`}\r\n                    onClick={() => handleDateClick(date)}\r\n                    onMouseEnter={() => setHoveredDate(date)}\r\n                    onMouseLeave={() => setHoveredDate(null)}\r\n                  >\r\n                    <div className={`text-sm font-medium mb-1 ${\r\n                      isTodayDate \r\n                        ? 'bg-blue-600 text-white rounded-full w-6 h-6 flex items-center justify-center' \r\n                        : ''\r\n                    }`}>\r\n                      {date.getDate()}\r\n                    </div>\r\n                    \r\n                    <div className=\"space-y-1\">\r\n                      {dayEvents.slice(0, 3).map(event => (\r\n                        <div\r\n                          key={event.id}\r\n                          className={`text-xs px-1 py-0.5 rounded border truncate ${getEventTypeColor(event.type)}`}\r\n                          title={`${event.title} (${event.startTime})`}\r\n                        >\r\n                          <span className=\"mr-1\">{getStatusIndicator(event.status)}</span>\r\n                          {event.title}\r\n                        </div>\r\n                      ))}\r\n                      {dayEvents.length > 3 && (\r\n                        <div className=\"text-xs text-gray-500\">\r\n                          +{dayEvents.length - 3} autres\r\n                        </div>\r\n                      )}\r\n                    </div>\r\n                  </div>\r\n                );\r\n              })}\r\n            </div>\r\n          </div>\r\n\r\n          {/* Sidebar d√©tails */}\r\n          <div className=\"w-80 border-l bg-gray-50 flex flex-col\">\r\n            <div className=\"p-4 border-b bg-white\">\r\n              <h4 className=\"font-medium text-gray-900\">\r\n                {selectedDate ? (\r\n                  <>√âv√©nements du {selectedDate.toLocaleDateString('fr-FR')}</>\r\n                ) : (\r\n                  'S√©lectionnez une date'\r\n                )}\r\n              </h4>\r\n            </div>\r\n\r\n            <div className=\"flex-1 overflow-y-auto p-4 space-y-3\">\r\n              {selectedDate ? (\r\n                getEventsForDate(selectedDate).length > 0 ? (\r\n                  getEventsForDate(selectedDate).map(event => (\r\n                    <div\r\n                      key={event.id}\r\n                      className=\"bg-white border rounded-lg p-3 cursor-pointer hover:shadow-md transition-shadow\"\r\n                      onClick={() => handleEventClick(event)}\r\n                    >\r\n                      <div className=\"flex items-start justify-between mb-2\">\r\n                        <h5 className=\"font-medium text-gray-900\">{event.title}</h5>\r\n                        <span className=\"text-lg\">{getStatusIndicator(event.status)}</span>\r\n                      </div>\r\n                      \r\n                      <div className=\"space-y-1 text-sm text-gray-600\">\r\n                        <div className=\"flex items-center gap-2\">\r\n                          <Clock className=\"w-4 h-4\" />\r\n                          <span>{event.startTime} - {event.endTime}</span>\r\n                        </div>\r\n                        <div className=\"flex items-center gap-2\">\r\n                          <MapPin className=\"w-4 h-4\" />\r\n                          <span>{event.location}</span>\r\n                        </div>\r\n                      </div>\r\n\r\n                      <p className=\"text-xs text-gray-500 mt-2 line-clamp-2\">\r\n                        {event.description}\r\n                      </p>\r\n\r\n                      <div className={`inline-block mt-2 px-2 py-1 rounded text-xs border ${getEventTypeColor(event.type)}`}>\r\n                        {planningService.getTypeLabel(event.type)}\r\n                      </div>\r\n                    </div>\r\n                  ))\r\n                ) : (\r\n                  <div className=\"text-center text-gray-500 py-8\">\r\n                    <Calendar className=\"w-12 h-12 mx-auto mb-3 text-gray-300\" />\r\n                    <p>Aucun √©v√©nement ce jour</p>\r\n                  </div>\r\n                )\r\n              ) : (\r\n                <div className=\"text-center text-gray-500 py-8\">\r\n                  <p>Cliquez sur une date pour voir les √©v√©nements</p>\r\n                </div>\r\n              )}\r\n            </div>\r\n\r\n            {/* L√©gende */}\r\n            <div className=\"p-4 border-t bg-white\">\r\n              <h5 className=\"font-medium text-gray-900 mb-2\">L√©gende</h5>\r\n              <div className=\"space-y-1 text-xs\">\r\n                <div className=\"flex items-center gap-2\">\r\n                  <span>‚úÖ</span> Confirm√©\r\n                </div>\r\n                <div className=\"flex items-center gap-2\">\r\n                  <span>üìÖ</span> Programm√©\r\n                </div>\r\n                <div className=\"flex items-center gap-2\">\r\n                  <span>‚è≥</span> En attente\r\n                </div>\r\n                <div className=\"flex items-center gap-2\">\r\n                  <span>‚ùå</span> Annul√©\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default PlanningCalendarModal;","import React, { useState, useEffect } from 'react';\r\nimport { X, BarChart3, Calendar, Users, Clock, TrendingUp, Download } from 'lucide-react';\r\nimport Button from '../../../components/ui/Button';\r\nimport Select from '../../../components/ui/Select';\r\nimport planningService from '../../../services/planningService';\r\n\r\nexport const PlanningAnalyticsModal = ({ isOpen, onClose }) => {\r\n  const [events, setEvents] = useState([]);\r\n  const [statistics, setStatistics] = useState({});\r\n  const [loading, setLoading] = useState(false);\r\n  const [period, setPeriod] = useState('month');\r\n\r\n  useEffect(() => {\r\n    if (isOpen) {\r\n      loadAnalytics();\r\n    }\r\n  }, [isOpen, period]);\r\n\r\n  const loadAnalytics = async () => {\r\n    setLoading(true);\r\n    try {\r\n      const now = new Date();\r\n      const periodDate = new Date();\r\n      \r\n      switch(period) {\r\n        case 'week':\r\n          periodDate.setDate(now.getDate() - 7);\r\n          break;\r\n        case 'month':\r\n          periodDate.setMonth(now.getMonth() - 1);\r\n          break;\r\n        case 'quarter':\r\n          periodDate.setMonth(now.getMonth() - 3);\r\n          break;\r\n        case 'year':\r\n          periodDate.setFullYear(now.getFullYear() - 1);\r\n          break;\r\n        default:\r\n          periodDate.setMonth(now.getMonth() - 1);\r\n      }\r\n\r\n      const filters = {\r\n        startDate: periodDate.toISOString().split('T')[0],\r\n        endDate: now.toISOString().split('T')[0]\r\n      };\r\n\r\n      const data = await planningService.getAllEvents(filters);\r\n      setEvents(data.events || []);\r\n      setStatistics(data.statistics || {});\r\n    } catch (error) {\r\n      console.error('Erreur chargement analytics:', error);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const getPeriodLabel = () => {\r\n    const labels = {\r\n      'week': 'Derni√®re semaine',\r\n      'month': 'Dernier mois', \r\n      'quarter': 'Dernier trimestre',\r\n      'year': 'Derni√®re ann√©e'\r\n    };\r\n    return labels[period] || 'Dernier mois';\r\n  };\r\n\r\n  const periodOptions = [\r\n    { value: 'week', label: 'Derni√®re semaine' },\r\n    { value: 'month', label: 'Dernier mois' },\r\n    { value: 'quarter', label: 'Dernier trimestre' },\r\n    { value: 'year', label: 'Derni√®re ann√©e' }\r\n  ];\r\n\r\n  const exportReport = () => {\r\n    if (!events.length) return;\r\n\r\n    const reportData = [\r\n      ['RAPPORT D\\'ANALYSE DU PLANNING'],\r\n      [''],\r\n      ['P√©riode:', getPeriodLabel()],\r\n      ['Date de g√©n√©ration:', new Date().toLocaleDateString('fr-FR')],\r\n      [''],\r\n      ['R√âSUM√â G√âN√âRAL'],\r\n      ['Nombre total d\\'√©v√©nements:', statistics.total || 0],\r\n      ['√âv√©nements aujourd\\'hui:', statistics.today || 0],\r\n      ['√âv√©nements cette semaine:', statistics.thisWeek || 0],\r\n      ['Confirmations en attente:', statistics.pendingConfirmations || 0],\r\n      [''],\r\n      ['R√âPARTITION PAR TYPE'],\r\n      ['Rendez-vous parents:', statistics.byType?.parent_meeting || 0],\r\n      ['R√©unions p√©dagogiques:', statistics.byType?.meeting || 0],\r\n      ['√âv√©nements scolaires:', statistics.byType?.school_event || 0],\r\n      ['Formations:', statistics.byType?.training || 0],\r\n      ['Conseils officiels:', statistics.byType?.official_meeting || 0],\r\n      ['Inscriptions:', statistics.byType?.inscription || 0],\r\n      ['Entretiens:', statistics.byType?.interview || 0],\r\n      [''],\r\n      ['R√âPARTITION PAR STATUT'],\r\n      ['Confirm√©s:', statistics.byStatus?.confirmed || 0],\r\n      ['Programm√©s:', statistics.byStatus?.scheduled || 0],\r\n      ['En attente:', statistics.byStatus?.pending || 0],\r\n      ['Annul√©s:', statistics.byStatus?.cancelled || 0]\r\n    ];\r\n\r\n    const csvContent = reportData.map(row => row.join(',')).join('\\n');\r\n    const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });\r\n    const url = URL.createObjectURL(blob);\r\n    const a = document.createElement('a');\r\n    a.href = url;\r\n    a.download = `analyse_planning_${period}_${new Date().toISOString().split('T')[0]}.csv`;\r\n    document.body.appendChild(a);\r\n    a.click();\r\n    document.body.removeChild(a);\r\n    URL.revokeObjectURL(url);\r\n  };\r\n\r\n  const calculateTrendData = () => {\r\n    if (!events.length) return { trend: 0, message: 'Aucune donn√©e' };\r\n\r\n    const now = new Date();\r\n    const weekAgo = new Date();\r\n    weekAgo.setDate(now.getDate() - 7);\r\n\r\n    const thisWeekEvents = events.filter(e => new Date(e.date) >= weekAgo).length;\r\n    const previousWeekEvents = events.filter(e => {\r\n      const eventDate = new Date(e.date);\r\n      const twoWeeksAgo = new Date();\r\n      twoWeeksAgo.setDate(now.getDate() - 14);\r\n      return eventDate >= twoWeeksAgo && eventDate < weekAgo;\r\n    }).length;\r\n\r\n    if (previousWeekEvents === 0) {\r\n      return { trend: thisWeekEvents > 0 ? 100 : 0, message: 'Nouvelle activit√©' };\r\n    }\r\n\r\n    const trend = ((thisWeekEvents - previousWeekEvents) / previousWeekEvents) * 100;\r\n    const message = trend > 0 ? 'En hausse' : trend < 0 ? 'En baisse' : 'Stable';\r\n    \r\n    return { trend: Math.round(trend), message };\r\n  };\r\n\r\n  const getTypeColor = (type) => {\r\n    const colors = {\r\n      parent_meeting: 'bg-blue-100 text-blue-800',\r\n      meeting: 'bg-purple-100 text-purple-800',\r\n      school_event: 'bg-green-100 text-green-800',\r\n      training: 'bg-orange-100 text-orange-800',\r\n      official_meeting: 'bg-red-100 text-red-800',\r\n      inscription: 'bg-yellow-100 text-yellow-800',\r\n      interview: 'bg-indigo-100 text-indigo-800',\r\n      holiday: 'bg-gray-100 text-gray-800'\r\n    };\r\n    return colors[type] || colors.parent_meeting;\r\n  };\r\n\r\n  if (!isOpen) return null;\r\n\r\n  const trendData = calculateTrendData();\r\n\r\n  return (\r\n    <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4\">\r\n      <div className=\"bg-white rounded-lg shadow-xl w-full max-w-5xl max-h-[90vh] overflow-hidden\">\r\n        {/* Header */}\r\n        <div className=\"flex items-center justify-between p-4 border-b\">\r\n          <div>\r\n            <h2 className=\"text-lg font-semibold text-gray-900 flex items-center gap-2\">\r\n              <BarChart3 className=\"w-5 h-5\" />\r\n              Analyses du Planning\r\n            </h2>\r\n            <p className=\"text-sm text-gray-600 mt-1\">\r\n              Statistiques et tendances des √©v√©nements\r\n            </p>\r\n          </div>\r\n          \r\n          <div className=\"flex items-center gap-2\">\r\n            <Button\r\n              variant=\"outline\"\r\n              size=\"sm\"\r\n              onClick={exportReport}\r\n              disabled={!events.length}\r\n              className=\"flex items-center gap-2\"\r\n            >\r\n              <Download className=\"w-4 h-4\" />\r\n              Exporter\r\n            </Button>\r\n            <button\r\n              onClick={onClose}\r\n              className=\"text-gray-400 hover:text-gray-600 transition-colors\"\r\n            >\r\n              <X className=\"w-6 h-6\" />\r\n            </button>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Filter */}\r\n        <div className=\"p-4 border-b bg-gray-50\">\r\n          <div className=\"flex items-center gap-4\">\r\n            <label className=\"text-sm font-medium text-gray-700\">\r\n              P√©riode d'analyse:\r\n            </label>\r\n            <Select\r\n              value={period}\r\n              onChange={setPeriod}\r\n              options={periodOptions}\r\n              className=\"w-48\"\r\n            />\r\n          </div>\r\n        </div>\r\n\r\n        {/* Content */}\r\n        <div className=\"flex-1 overflow-y-auto p-4\">\r\n          {loading && (\r\n            <div className=\"flex items-center justify-center py-12\">\r\n              <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600\"></div>\r\n              <span className=\"ml-2 text-gray-600\">Calcul des analyses...</span>\r\n            </div>\r\n          )}\r\n\r\n          {!loading && (\r\n            <div className=\"space-y-6\">\r\n              {/* M√©triques principales */}\r\n              <div>\r\n                <h3 className=\"text-lg font-medium text-gray-900 mb-4\">\r\n                  R√©sum√© - {getPeriodLabel()}\r\n                </h3>\r\n                <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4\">\r\n                  <div className=\"bg-blue-50 rounded-lg p-4 border border-blue-200\">\r\n                    <div className=\"flex items-center justify-between\">\r\n                      <div>\r\n                        <p className=\"text-sm text-blue-600\">Total √âv√©nements</p>\r\n                        <p className=\"text-2xl font-bold text-blue-900\">\r\n                          {statistics.total || 0}\r\n                        </p>\r\n                      </div>\r\n                      <Calendar className=\"w-8 h-8 text-blue-500\" />\r\n                    </div>\r\n                  </div>\r\n\r\n                  <div className=\"bg-green-50 rounded-lg p-4 border border-green-200\">\r\n                    <div className=\"flex items-center justify-between\">\r\n                      <div>\r\n                        <p className=\"text-sm text-green-600\">Cette Semaine</p>\r\n                        <p className=\"text-2xl font-bold text-green-900\">\r\n                          {statistics.thisWeek || 0}\r\n                        </p>\r\n                      </div>\r\n                      <Clock className=\"w-8 h-8 text-green-500\" />\r\n                    </div>\r\n                  </div>\r\n\r\n                  <div className=\"bg-yellow-50 rounded-lg p-4 border border-yellow-200\">\r\n                    <div className=\"flex items-center justify-between\">\r\n                      <div>\r\n                        <p className=\"text-sm text-yellow-600\">√Ä Confirmer</p>\r\n                        <p className=\"text-2xl font-bold text-yellow-900\">\r\n                          {statistics.pendingConfirmations || 0}\r\n                        </p>\r\n                      </div>\r\n                      <Users className=\"w-8 h-8 text-yellow-500\" />\r\n                    </div>\r\n                  </div>\r\n\r\n                  <div className=\"bg-purple-50 rounded-lg p-4 border border-purple-200\">\r\n                    <div className=\"flex items-center justify-between\">\r\n                      <div>\r\n                        <p className=\"text-sm text-purple-600\">Tendance</p>\r\n                        <p className=\"text-lg font-bold text-purple-900 flex items-center gap-1\">\r\n                          {trendData.trend > 0 && <TrendingUp className=\"w-4 h-4\" />}\r\n                          {trendData.trend === 0 && <span className=\"w-4 h-4 text-center\">-</span>}\r\n                          {trendData.trend < 0 && <TrendingUp className=\"w-4 h-4 rotate-180\" />}\r\n                          {Math.abs(trendData.trend)}%\r\n                        </p>\r\n                        <p className=\"text-xs text-purple-600\">{trendData.message}</p>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n\r\n              {/* R√©partition par type */}\r\n              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\r\n                <div className=\"bg-white rounded-lg border p-4\">\r\n                  <h4 className=\"font-medium text-gray-900 mb-3\">R√©partition par Type</h4>\r\n                  <div className=\"space-y-2\">\r\n                    {Object.entries(statistics.byType || {}).map(([type, count]) => (\r\n                      <div key={type} className=\"flex justify-between items-center\">\r\n                        <div className=\"flex items-center gap-2\">\r\n                          <span className={`px-2 py-1 rounded text-xs ${getTypeColor(type)}`}>\r\n                            {planningService.getTypeLabel(type)}\r\n                          </span>\r\n                        </div>\r\n                        <div className=\"flex items-center gap-2\">\r\n                          <div className=\"w-20 bg-gray-200 rounded-full h-2\">\r\n                            <div \r\n                              className=\"bg-blue-500 h-2 rounded-full\"\r\n                              style={{ width: `${((count / (statistics.total || 1)) * 100)}%` }}\r\n                            ></div>\r\n                          </div>\r\n                          <span className=\"text-sm font-medium w-8 text-right\">{count}</span>\r\n                        </div>\r\n                      </div>\r\n                    ))}\r\n                  </div>\r\n                </div>\r\n\r\n                {/* R√©partition par statut */}\r\n                <div className=\"bg-white rounded-lg border p-4\">\r\n                  <h4 className=\"font-medium text-gray-900 mb-3\">R√©partition par Statut</h4>\r\n                  <div className=\"space-y-2\">\r\n                    {Object.entries(statistics.byStatus || {}).map(([status, count]) => {\r\n                      const statusColors = {\r\n                        confirmed: 'bg-green-500',\r\n                        scheduled: 'bg-blue-500',\r\n                        pending: 'bg-yellow-500',\r\n                        cancelled: 'bg-red-500'\r\n                      };\r\n                      const statusLabels = {\r\n                        confirmed: 'Confirm√©s',\r\n                        scheduled: 'Programm√©s',\r\n                        pending: 'En attente',\r\n                        cancelled: 'Annul√©s'\r\n                      };\r\n                      \r\n                      return (\r\n                        <div key={status} className=\"flex justify-between items-center\">\r\n                          <span className=\"text-sm text-gray-600\">{statusLabels[status]}</span>\r\n                          <div className=\"flex items-center gap-2\">\r\n                            <div className=\"w-20 bg-gray-200 rounded-full h-2\">\r\n                              <div \r\n                                className={`${statusColors[status]} h-2 rounded-full`}\r\n                                style={{ width: `${((count / (statistics.total || 1)) * 100)}%` }}\r\n                              ></div>\r\n                            </div>\r\n                            <span className=\"text-sm font-medium w-8 text-right\">{count}</span>\r\n                          </div>\r\n                        </div>\r\n                      );\r\n                    })}\r\n                  </div>\r\n                </div>\r\n              </div>\r\n\r\n              {/* Planning de la semaine */}\r\n              {statistics.thisWeek > 0 && (\r\n                <div className=\"bg-white rounded-lg border p-4\">\r\n                  <h4 className=\"font-medium text-gray-900 mb-3\">√âv√©nements Cette Semaine</h4>\r\n                  <div className=\"space-y-2\">\r\n                    {events\r\n                      .filter(e => {\r\n                        const eventDate = new Date(e.date);\r\n                        const now = new Date();\r\n                        const weekStart = new Date(now);\r\n                        weekStart.setDate(now.getDate() - now.getDay() + 1);\r\n                        const weekEnd = new Date(weekStart);\r\n                        weekEnd.setDate(weekStart.getDate() + 6);\r\n                        return eventDate >= weekStart && eventDate <= weekEnd;\r\n                      })\r\n                      .sort((a, b) => new Date(a.date) - new Date(b.date))\r\n                      .slice(0, 10)\r\n                      .map(event => (\r\n                        <div key={event.id} className=\"flex items-center justify-between p-2 bg-gray-50 rounded\">\r\n                          <div className=\"flex items-center gap-3\">\r\n                            <div className=\"text-sm font-medium text-gray-900\">\r\n                              {new Date(event.date).toLocaleDateString('fr-FR', { weekday: 'short', day: 'numeric' })}\r\n                            </div>\r\n                            <div className=\"text-sm text-gray-600\">{event.startTime}</div>\r\n                            <div className=\"text-sm text-gray-900\">{event.title}</div>\r\n                          </div>\r\n                          <span className={`px-2 py-1 rounded text-xs ${getTypeColor(event.type)}`}>\r\n                            {planningService.getTypeLabel(event.type)}\r\n                          </span>\r\n                        </div>\r\n                      ))}\r\n                  </div>\r\n                </div>\r\n              )}\r\n            </div>\r\n          )}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default PlanningAnalyticsModal;","import React, { useState, useEffect } from 'react';\r\nimport Icon from '../../../components/AppIcon';\r\nimport Button from '../../../components/ui/Button';\r\nimport Input from '../../../components/ui/Input';\r\nimport Select from '../../../components/ui/Select';\r\nimport { useToast, ToastContainer } from '../../../components/ui/Toast';\r\nimport planningService from '../../../services/planningService';\r\nimport EventModal from './EventModal';\r\nimport PlanningCalendarModal from './PlanningCalendarModal';\r\nimport PlanningAnalyticsModal from './PlanningAnalyticsModal';\r\n\r\nconst PlanningTab = () => {\r\n  const { toasts, showSuccess, showError, showInfo, removeToast } = useToast();\r\n\r\n  const [selectedDate, setSelectedDate] = useState(new Date()?.toISOString()?.split('T')?.[0]);\r\n  const [viewMode, setViewMode] = useState('list');\r\n  const [filterType, setFilterType] = useState('');\r\n  const [filterStatus, setFilterStatus] = useState('');\r\n  const [filterClass, setFilterClass] = useState('');\r\n  const [searchTerm, setSearchTerm] = useState('');\r\n  \r\n  // √âtats pour les donn√©es\r\n  const [events, setEvents] = useState([]);\r\n  const [statistics, setStatistics] = useState({});\r\n  const [loading, setLoading] = useState(true);\r\n  \r\n  // √âtats pour les modals\r\n  const [showEventModal, setShowEventModal] = useState(false);\r\n  const [showCalendarModal, setShowCalendarModal] = useState(false);\r\n  const [showAnalyticsModal, setShowAnalyticsModal] = useState(false);\r\n  const [selectedEvent, setSelectedEvent] = useState(null);\r\n\r\n  useEffect(() => {\r\n    loadEvents();\r\n  }, [filterType, filterStatus, filterClass, searchTerm, selectedDate]);\r\n\r\n  const loadEvents = async () => {\r\n    setLoading(true);\r\n    try {\r\n      const filters = {\r\n        type: filterType,\r\n        status: filterStatus,\r\n        studentClass: filterClass,\r\n        search: searchTerm\r\n      };\r\n\r\n      const data = await planningService.getAllEvents(filters, 'production');\r\n      setEvents(data.events || []);\r\n      setStatistics(data.statistics || {});\r\n    } catch (error) {\r\n      console.error('Erreur chargement √©v√©nements:', error);\r\n      showError('Erreur lors du chargement des √©v√©nements');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const eventTypes = [\r\n    { value: '', label: 'Tous les √©v√©nements' },\r\n    { value: 'parent_meeting', label: 'Rendez-vous parents' },\r\n    { value: 'meeting', label: 'R√©unions p√©dagogiques' },\r\n    { value: 'school_event', label: '√âv√©nements scolaires' },\r\n    { value: 'training', label: 'Formations' },\r\n    { value: 'official_meeting', label: 'Conseils officiels' },\r\n    { value: 'inscription', label: 'Inscriptions' },\r\n    { value: 'interview', label: 'Entretiens' },\r\n    { value: 'holiday', label: 'Vacances scolaires' }\r\n  ];\r\n\r\n  const statusOptions = [\r\n    { value: '', label: 'Tous les statuts' },\r\n    { value: 'confirmed', label: 'Confirm√©' },\r\n    { value: 'scheduled', label: 'Programm√©' },\r\n    { value: 'pending', label: 'En attente' },\r\n    { value: 'cancelled', label: 'Annul√©' }\r\n  ];\r\n\r\n  const classOptions = [\r\n    { value: '', label: 'Toutes les classes' },\r\n    { value: 'CE1', label: 'CE1' },\r\n    { value: 'CE2', label: 'CE2' },\r\n    { value: 'CM1', label: 'CM1' },\r\n    { value: 'CM2', label: 'CM2' }\r\n  ];\r\n\r\n  const viewModes = [\r\n    { value: 'list', label: 'Liste' },\r\n    { value: 'calendar', label: 'Calendrier' },\r\n    { value: 'week', label: 'Semaine' }\r\n  ];\r\n\r\n  // Gestion des actions\r\n  const handleCreateEvent = () => {\r\n    setSelectedEvent(null);\r\n    setShowEventModal(true);\r\n  };\r\n\r\n  const handleEditEvent = (event) => {\r\n    setSelectedEvent(event);\r\n    setShowEventModal(true);\r\n  };\r\n\r\n  const handleConfirmEvent = async (eventId) => {\r\n    try {\r\n      await planningService.confirmEvent(eventId);\r\n      showSuccess('√âv√©nement confirm√© avec succ√®s');\r\n      loadEvents();\r\n    } catch (error) {\r\n      showError('Erreur lors de la confirmation');\r\n    }\r\n  };\r\n\r\n  const handleCancelEvent = async (eventId) => {\r\n    if (window.confirm('√ätes-vous s√ªr de vouloir annuler cet √©v√©nement ?')) {\r\n      try {\r\n        await planningService.cancelEvent(eventId, 'Annul√© par le secr√©tariat');\r\n        showSuccess('√âv√©nement annul√©');\r\n        loadEvents();\r\n      } catch (error) {\r\n        showError('Erreur lors de l\\'annulation');\r\n      }\r\n    }\r\n  };\r\n\r\n  const handleSendReminder = async (eventId) => {\r\n    try {\r\n      await planningService.sendReminders(eventId);\r\n      showSuccess('Rappels envoy√©s avec succ√®s');\r\n    } catch (error) {\r\n      showError('Erreur lors de l\\'envoi des rappels');\r\n    }\r\n  };\r\n\r\n  const handleEventModalSuccess = () => {\r\n    showSuccess(selectedEvent ? '√âv√©nement modifi√© avec succ√®s' : '√âv√©nement cr√©√© avec succ√®s');\r\n    loadEvents();\r\n    setShowEventModal(false);\r\n  };\r\n\r\n  const handleShowCalendar = () => {\r\n    setShowCalendarModal(true);\r\n  };\r\n\r\n  const handleEventSelect = (event) => {\r\n    setSelectedEvent(event);\r\n    setShowEventModal(true);\r\n  };\r\n\r\n  const handleExportPlanning = async () => {\r\n    try {\r\n      const filters = {\r\n        type: filterType,\r\n        status: filterStatus,\r\n        studentClass: filterClass,\r\n        search: searchTerm\r\n      };\r\n      \r\n      const csvData = await planningService.exportPlanning('csv', filters);\r\n      const csvContent = csvData.map(row => row.join(',')).join('\\n');\r\n      const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });\r\n      const url = URL.createObjectURL(blob);\r\n      const a = document.createElement('a');\r\n      a.href = url;\r\n      a.download = `planning_${new Date().toISOString().split('T')[0]}.csv`;\r\n      document.body.appendChild(a);\r\n      a.click();\r\n      document.body.removeChild(a);\r\n      URL.revokeObjectURL(url);\r\n      \r\n      showSuccess('Planning export√© avec succ√®s');\r\n    } catch (error) {\r\n      showError('Erreur lors de l\\'export');\r\n    }\r\n  };\r\n\r\n  const getStatusConfig = (status) => {\r\n    const configs = {\r\n      confirmed: {\r\n        label: 'Confirm√©',\r\n        className: 'bg-success/10 text-success border-success/20',\r\n        icon: 'CheckCircle'\r\n      },\r\n      scheduled: {\r\n        label: 'Programm√©',\r\n        className: 'bg-primary/10 text-primary border-primary/20',\r\n        icon: 'Calendar'\r\n      },\r\n      pending: {\r\n        label: 'En attente',\r\n        className: 'bg-warning/10 text-warning border-warning/20',\r\n        icon: 'Clock'\r\n      },\r\n      cancelled: {\r\n        label: 'Annul√©',\r\n        className: 'bg-error/10 text-error border-error/20',\r\n        icon: 'XCircle'\r\n      }\r\n    };\r\n    return configs?.[status] || configs?.scheduled;\r\n  }; \r\n\r\n  const getTypeConfig = (type) => {\r\n    const configs = {\r\n      meeting: {\r\n        label: 'Rendez-vous',\r\n        className: 'bg-blue-100 text-blue-600',\r\n        icon: 'Users'\r\n      },\r\n      event: {\r\n        label: '√âv√©nement',\r\n        className: 'bg-purple-100 text-purple-600',\r\n        icon: 'Star'  \r\n      },\r\n      admin: {\r\n        label: 'Administratif',\r\n        className: 'bg-orange-100 text-orange-600',\r\n        icon: 'FileText'\r\n      },\r\n      holiday: {\r\n        label: 'Vacances',\r\n        className: 'bg-green-100 text-green-600',\r\n        icon: 'Sun'\r\n      }\r\n    };\r\n    return configs?.[type] || configs?.admin;\r\n  };\r\n\r\n  const getPriorityConfig = (priority) => {\r\n    const configs = {\r\n      high: {\r\n        label: 'Urgent',\r\n        className: 'bg-red-100 text-red-600',\r\n        icon: 'AlertTriangle'\r\n      },\r\n      medium: {\r\n        label: 'Normal',\r\n        className: 'bg-yellow-100 text-yellow-600',\r\n        icon: 'Circle'\r\n      },\r\n      low: {\r\n        label: 'Faible',\r\n        className: 'bg-gray-100 text-gray-600',\r\n        icon: 'Minus'\r\n      }\r\n    };\r\n    return configs?.[priority] || configs?.medium;\r\n  };\r\n\r\n  // Calculer des statistiques rapides bas√©es sur les donn√©es charg√©es\r\n  const todayEvents = events.filter(event => event.date === new Date().toISOString().split('T')[0]);\r\n  const upcomingEvents = events.filter(event => new Date(event.date) > new Date() && event.status !== 'cancelled');\r\n\r\n  return (\r\n    <div className=\"space-y-4\">\r\n      <ToastContainer toasts={toasts} removeToast={removeToast} />\r\n\r\n      {/* Header */}\r\n      <div className=\"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-3\">\r\n        <div>\r\n          <h2 className=\"font-heading font-heading-bold text-lg text-text-primary\">\r\n            Planning & √âv√©nements\r\n          </h2>\r\n          <p className=\"font-body font-body-normal text-xs text-text-secondary mt-0.5\">\r\n            Gestion des rendez-vous, √©v√©nements scolaires et t√¢ches administratives\r\n          </p>\r\n        </div>\r\n        <div className=\"flex items-center space-x-1.5\">\r\n          <Button\r\n            variant=\"outline\"\r\n            size=\"sm\"\r\n            iconName=\"Calendar\"\r\n            iconPosition=\"left\"\r\n            onClick={handleShowCalendar}\r\n          >\r\n            Calendrier\r\n          </Button>\r\n          <Button\r\n            variant=\"outline\"\r\n            size=\"sm\"\r\n            iconName=\"BarChart3\"\r\n            iconPosition=\"left\"\r\n            onClick={() => setShowAnalyticsModal(true)}\r\n            disabled={loading}\r\n          >\r\n            Analyses\r\n          </Button>\r\n          <Button\r\n            variant=\"outline\"\r\n            size=\"sm\"\r\n            iconName=\"Download\"\r\n            iconPosition=\"left\"\r\n            onClick={handleExportPlanning}\r\n            disabled={loading}\r\n          >\r\n            Export\r\n          </Button>\r\n          <Button\r\n            variant=\"default\"\r\n            size=\"sm\"\r\n            iconName=\"Plus\"\r\n            iconPosition=\"left\"\r\n            onClick={handleCreateEvent}\r\n            disabled={loading}\r\n          >\r\n            Nouveau\r\n          </Button>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Quick Overview */}\r\n      <div className=\"grid grid-cols-2 md:grid-cols-4 gap-3\">\r\n        <div className=\"bg-card rounded border border-border p-3\">\r\n          <div className=\"flex items-center space-x-2\">\r\n            <div className=\"w-8 h-8 bg-primary/10 rounded flex items-center justify-center\">\r\n              <Icon name=\"Clock\" size={16} className=\"text-primary\" />\r\n            </div>\r\n            <div>\r\n              <p className=\"font-heading font-heading-semibold text-sm text-text-primary\">\r\n                {todayEvents.length}\r\n              </p>\r\n              <p className=\"font-caption font-caption-normal text-xs text-text-secondary\">\r\n                Aujourd'hui\r\n              </p>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"bg-card rounded border border-border p-3\">\r\n          <div className=\"flex items-center space-x-2\">\r\n            <div className=\"w-8 h-8 bg-success/10 rounded flex items-center justify-center\">\r\n              <Icon name=\"Calendar\" size={16} className=\"text-success\" />\r\n            </div>\r\n            <div>\r\n              <p className=\"font-heading font-heading-semibold text-sm text-text-primary\">\r\n                {statistics.thisWeek || 0}\r\n              </p>\r\n              <p className=\"font-caption font-caption-normal text-xs text-text-secondary\">\r\n                Cette semaine\r\n              </p>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"bg-card rounded border border-border p-3\">\r\n          <div className=\"flex items-center space-x-2\">\r\n            <div className=\"w-8 h-8 bg-warning/10 rounded flex items-center justify-center\">\r\n              <Icon name=\"Users\" size={16} className=\"text-warning\" />\r\n            </div>\r\n            <div>\r\n              <p className=\"font-heading font-heading-semibold text-sm text-text-primary\">\r\n                {statistics.pendingConfirmations || 0}\r\n              </p>\r\n              <p className=\"font-caption font-caption-normal text-xs text-text-secondary\">\r\n                √Ä confirmer\r\n              </p>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"bg-card rounded border border-border p-3\">\r\n          <div className=\"flex items-center space-x-2\">\r\n            <div className=\"w-8 h-8 bg-error/10 rounded flex items-center justify-center\">\r\n              <Icon name=\"AlertTriangle\" size={16} className=\"text-error\" />\r\n            </div>\r\n            <div>\r\n              <p className=\"font-heading font-heading-semibold text-sm text-text-primary\">\r\n                {events.filter(e => e.type === 'parent_meeting').length}\r\n              </p>\r\n              <p className=\"font-caption font-caption-normal text-xs text-text-secondary\">\r\n                RDV parents\r\n              </p>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Filters */}\r\n      <div className=\"bg-card rounded border border-border p-3\">\r\n        <div className=\"grid grid-cols-1 md:grid-cols-5 gap-3\">\r\n          <Input\r\n            type=\"search\"\r\n            placeholder=\"Rechercher...\"\r\n            value={searchTerm}\r\n            onChange={(e) => setSearchTerm(e?.target?.value)}\r\n          />\r\n          <Select\r\n            options={eventTypes}\r\n            value={filterType}\r\n            onChange={setFilterType}\r\n            placeholder=\"Type d'√©v√©nement\"\r\n          />\r\n          <Select\r\n            options={statusOptions}\r\n            value={filterStatus}\r\n            onChange={setFilterStatus}\r\n            placeholder=\"Statut\"\r\n          />\r\n          <Select\r\n            options={classOptions}\r\n            value={filterClass}\r\n            onChange={setFilterClass}\r\n            placeholder=\"Classe\"\r\n          />\r\n          <Select\r\n            options={viewModes}\r\n            value={viewMode}\r\n            onChange={setViewMode}\r\n            placeholder=\"Affichage\"\r\n          />\r\n        </div>\r\n      </div>\r\n\r\n      {/* Events List */}\r\n      <div className=\"bg-card rounded border border-border p-4\">\r\n        <div className=\"flex items-center justify-between mb-4\">\r\n          <h3 className=\"font-heading font-heading-semibold text-lg text-text-primary\">\r\n            √âv√©nements & Rendez-vous ({events.length})\r\n          </h3>\r\n          <Button \r\n            variant=\"ghost\" \r\n            size=\"sm\"\r\n            onClick={() => loadEvents()}\r\n            disabled={loading}\r\n          >\r\n            <Icon name=\"RotateCcw\" size={16} className=\"mr-2\" />\r\n            Actualiser\r\n          </Button>\r\n        </div>\r\n\r\n        {loading && (\r\n          <div className=\"flex items-center justify-center py-8\">\r\n            <div className=\"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600\"></div>\r\n            <span className=\"ml-2 text-gray-600\">Chargement...</span>\r\n          </div>\r\n        )}\r\n\r\n        {!loading && (\r\n          <div className=\"space-y-3\">\r\n            {events.map((event) => {\r\n            const statusConfig = getStatusConfig(event.status);\r\n            const typeConfig = getTypeConfig(event.type);\r\n            const priorityConfig = getPriorityConfig(event.priority);\r\n            \r\n            return (\r\n              <div key={event.id} className=\"border border-border rounded p-3 hover:bg-muted/50 transition-micro\">\r\n                <div className=\"flex items-start justify-between\">\r\n                  <div className=\"flex-1\">\r\n                    <div className=\"flex items-center flex-wrap gap-2 mb-2\">\r\n                      <h4 className=\"font-body font-body-semibold text-base text-text-primary\">\r\n                        {event.title}\r\n                      </h4>\r\n                      <span className={`inline-flex items-center px-2 py-1 rounded text-xs font-medium ${typeConfig.className}`}>\r\n                        <Icon name={typeConfig.icon} size={12} className=\"mr-1\" />\r\n                        {typeConfig.label}\r\n                      </span>\r\n                      <span className={`inline-flex items-center px-2 py-1 rounded text-xs font-medium border ${statusConfig.className}`}>\r\n                        <Icon name={statusConfig.icon} size={12} className=\"mr-1\" />\r\n                        {statusConfig.label}\r\n                      </span>\r\n                      {event.priority === 'high' && (\r\n                        <span className={`inline-flex items-center px-2 py-1 rounded text-xs font-medium ${priorityConfig.className}`}>\r\n                          <Icon name={priorityConfig.icon} size={12} className=\"mr-1\" />\r\n                          {priorityConfig.label}\r\n                        </span>\r\n                      )}\r\n                    </div>\r\n                    \r\n                    <div className=\"grid grid-cols-1 md:grid-cols-2 gap-3 text-sm\">\r\n                      <div className=\"space-y-1\">\r\n                        <div className=\"flex items-center space-x-2 text-text-secondary\">\r\n                          <Icon name=\"Calendar\" size={14} />\r\n                          <span>{event.date} √† {event.startTime}</span>\r\n                        </div>\r\n                        <div className=\"flex items-center space-x-2 text-text-secondary\">\r\n                          <Icon name=\"Clock\" size={14} />\r\n                          <span>Dur√©e: {event.duration} min</span>\r\n                        </div>\r\n                        <div className=\"flex items-center space-x-2 text-text-secondary\">\r\n                          <Icon name=\"MapPin\" size={14} />\r\n                          <span>{event.location}</span>\r\n                        </div>\r\n                        {event.studentName && (\r\n                          <div className=\"flex items-center space-x-2 text-text-secondary\">\r\n                            <Icon name=\"User\" size={14} />\r\n                            <span>{event.studentName} ({event.studentClass})</span>\r\n                          </div>\r\n                        )}\r\n                      </div>\r\n                      \r\n                      <div className=\"space-y-1\">\r\n                        <div className=\"text-text-primary\">\r\n                          <p className=\"text-text-secondary text-xs line-clamp-2\">{event.description}</p>\r\n                        </div>\r\n                        {event.attendees && event.attendees.length > 0 && (\r\n                          <div className=\"text-text-secondary text-xs\">\r\n                            <strong>Participants:</strong> {event.attendees.slice(0, 2).join(', ')}\r\n                            {event.attendees.length > 2 && ` +${event.attendees.length - 2} autres`}\r\n                          </div>\r\n                        )}\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                  \r\n                  <div className=\"flex items-center space-x-1 ml-3\">\r\n                    <Button\r\n                      variant=\"ghost\"\r\n                      size=\"xs\"\r\n                      onClick={() => handleEditEvent(event)}\r\n                      title=\"Modifier\"\r\n                    >\r\n                      <Icon name=\"Edit\" size={14} />\r\n                    </Button>\r\n                    {event.status === 'pending' && (\r\n                      <Button\r\n                        variant=\"ghost\"\r\n                        size=\"xs\"\r\n                        onClick={() => handleConfirmEvent(event.id)}\r\n                        title=\"Confirmer\"\r\n                        className=\"text-green-600 hover:text-green-700\"\r\n                      >\r\n                        <Icon name=\"CheckCircle\" size={14} />\r\n                      </Button>\r\n                    )}\r\n                    {(event.type === 'parent_meeting' && event.status === 'confirmed') && (\r\n                      <Button\r\n                        variant=\"ghost\"\r\n                        size=\"xs\"\r\n                        onClick={() => handleSendReminder(event.id)}\r\n                        title=\"Envoyer rappel\"\r\n                        className=\"text-blue-600 hover:text-blue-700\"\r\n                      >\r\n                        <Icon name=\"Mail\" size={14} />\r\n                      </Button>\r\n                    )}\r\n                    <Button\r\n                      variant=\"ghost\"\r\n                      size=\"xs\"\r\n                      onClick={() => handleCancelEvent(event.id)}\r\n                      title=\"Annuler\"\r\n                      className=\"text-red-600 hover:text-red-700\"\r\n                    >\r\n                      <Icon name=\"XCircle\" size={14} />\r\n                    </Button>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            );\r\n          })}\r\n          </div>\r\n        )}\r\n\r\n        {!loading && events.length === 0 && (\r\n          <div className=\"text-center py-8\">\r\n            <Icon name=\"Calendar\" size={32} className=\"text-muted-foreground mx-auto mb-3\" />\r\n            <h3 className=\"font-heading font-heading-semibold text-base text-text-primary mb-2\">\r\n              Aucun √©v√©nement programm√©\r\n            </h3>\r\n            <p className=\"font-body font-body-normal text-sm text-text-secondary mb-4\">\r\n              Aucun √©v√©nement ne correspond √† vos crit√®res.\r\n            </p>\r\n            <Button\r\n              variant=\"outline\"\r\n              size=\"sm\"\r\n              onClick={handleCreateEvent}\r\n              iconName=\"Plus\"\r\n              iconPosition=\"left\"\r\n            >\r\n              Cr√©er le premier √©v√©nement\r\n            </Button>\r\n          </div>\r\n        )}\r\n      </div>\r\n\r\n      {/* Modals */}\r\n      <EventModal\r\n        isOpen={showEventModal}\r\n        onClose={() => {\r\n          setShowEventModal(false);\r\n          setSelectedEvent(null);\r\n        }}\r\n        event={selectedEvent}\r\n        onSuccess={handleEventModalSuccess}\r\n      />\r\n\r\n      <PlanningCalendarModal\r\n        isOpen={showCalendarModal}\r\n        onClose={() => setShowCalendarModal(false)}\r\n        onEventSelect={handleEventSelect}\r\n      />\r\n\r\n      <PlanningAnalyticsModal\r\n        isOpen={showAnalyticsModal}\r\n        onClose={() => setShowAnalyticsModal(false)}\r\n      />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default PlanningTab;","import React, { useState, useEffect } from 'react';\r\nimport { supabase } from '../../../lib/supabase';\r\nimport Icon from '../../../components/AppIcon';\r\nimport Button from '../../../components/ui/Button';\r\nimport Input from '../../../components/ui/Input';\r\nimport Select from '../../../components/ui/Select';\r\nimport { Checkbox } from '../../../components/ui/Checkbox';\r\n\r\nconst TasksTab = () => {\r\n  const [filterPriority, setFilterPriority] = useState('');\r\n  const [filterStatus, setFilterStatus] = useState('');\r\n  const [searchTerm, setSearchTerm] = useState('');\r\n  const [showAddTaskModal, setShowAddTaskModal] = useState(false);\r\n  const [showEditTaskModal, setShowEditTaskModal] = useState(false);\r\n  const [editingTask, setEditingTask] = useState(null);\r\n  const [showUrgentCallsModal, setShowUrgentCallsModal] = useState(false);\r\n  const [loading, setLoading] = useState(true);\r\n  const [newTask, setNewTask] = useState({\r\n    title: '',\r\n    description: '',\r\n    priority: 'medium',\r\n    dueDate: '',\r\n    dueTime: '',\r\n    category: 'general',\r\n    contact: '',\r\n    studentRelated: ''\r\n  });\r\n\r\n  const priorityOptions = [\r\n    { value: '', label: 'Toutes les priorit√©s' },\r\n    { value: 'urgent', label: 'Urgent' },\r\n    { value: 'high', label: 'Important' },\r\n    { value: 'medium', label: 'Normal' },\r\n    { value: 'low', label: 'Faible' }\r\n  ];\r\n\r\n  const statusOptions = [\r\n    { value: '', label: 'Tous les statuts' },\r\n    { value: 'pending', label: '√Ä faire' },\r\n    { value: 'in_progress', label: 'En cours' },\r\n    { value: 'completed', label: 'Termin√©' },\r\n    { value: 'cancelled', label: 'Annul√©' }\r\n  ];\r\n\r\n  const [tasks, setTasks] = useState([]);\r\n\r\n  // Charger les t√¢ches au montage\r\n  useEffect(() => {\r\n    loadTasks();\r\n  }, []);\r\n\r\n  const loadTasks = async () => {\r\n    try {\r\n      setLoading(true);\r\n      const savedUser = localStorage.getItem('edutrack-user');\r\n      const userData = savedUser ? JSON.parse(savedUser) : null;\r\n      const schoolId = userData?.current_school_id;\r\n\r\n      if (!schoolId) {\r\n        console.warn('‚ö†Ô∏è Pas d\\'√©cole associ√©e');\r\n        setTasks([]);\r\n        setLoading(false);\r\n        return;\r\n      }\r\n\r\n      // Charger les t√¢ches depuis Supabase\r\n      const { data, error } = await supabase\r\n        .from('tasks')\r\n        .select('*')\r\n        .eq('school_id', schoolId)\r\n        .order('due_date', { ascending: true });\r\n\r\n      if (error) {\r\n        console.error('Erreur chargement t√¢ches:', error);\r\n        // Si la table n'existe pas encore, utiliser un tableau vide\r\n        setTasks([]);\r\n      } else {\r\n        // Transformer les donn√©es Supabase au format attendu\r\n        const formattedTasks = data.map(task => ({\r\n          id: task.id,\r\n          title: task.title,\r\n          description: task.description,\r\n          priority: task.priority,\r\n          status: task.status,\r\n          dueDate: task.due_date,\r\n          dueTime: task.due_time,\r\n          category: task.category,\r\n          assignedTo: \"Secr√©tariat\",\r\n          studentRelated: task.student_related || \"\",\r\n          contact: task.contact || \"\",\r\n          estimatedDuration: task.estimated_duration || \"\"\r\n        }));\r\n        setTasks(formattedTasks);\r\n      }\r\n    } catch (error) {\r\n      console.error('Exception chargement t√¢ches:', error);\r\n      setTasks([]);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const getPriorityConfig = (priority) => {\r\n    const configs = {\r\n      urgent: {\r\n        label: 'Urgent',\r\n        className: 'bg-red-100 text-red-600 border-red-200',\r\n        icon: 'AlertTriangle'\r\n      },\r\n      high: {\r\n        label: 'Important',\r\n        className: 'bg-orange-100 text-orange-600 border-orange-200',\r\n        icon: 'ArrowUp'\r\n      },\r\n      medium: {\r\n        label: 'Normal',\r\n        className: 'bg-blue-100 text-blue-600 border-blue-200',\r\n        icon: 'Circle'\r\n      },\r\n      low: {\r\n        label: 'Faible',\r\n        className: 'bg-gray-100 text-gray-600 border-gray-200',\r\n        icon: 'ArrowDown'\r\n      }\r\n    };\r\n    return configs?.[priority] || configs?.medium;\r\n  };\r\n\r\n  const getStatusConfig = (status) => {\r\n    const configs = {\r\n      pending: {\r\n        label: '√Ä faire',\r\n        className: 'bg-yellow-100 text-yellow-600 border-yellow-200',\r\n        icon: 'Clock'\r\n      },\r\n      in_progress: {\r\n        label: 'En cours',\r\n        className: 'bg-blue-100 text-blue-600 border-blue-200',\r\n        icon: 'Play'\r\n      },\r\n      completed: {\r\n        label: 'Termin√©',\r\n        className: 'bg-green-100 text-green-600 border-green-200',\r\n        icon: 'CheckCircle'\r\n      },\r\n      cancelled: {\r\n        label: 'Annul√©',\r\n        className: 'bg-gray-100 text-gray-600 border-gray-200',\r\n        icon: 'XCircle'\r\n      }\r\n    };\r\n    return configs?.[status] || configs?.pending;\r\n  };\r\n\r\n  const getCategoryConfig = (category) => {\r\n    const configs = {\r\n      appels: {\r\n        label: 'Appels',\r\n        className: 'bg-purple-100 text-purple-600',\r\n        icon: 'Phone'\r\n      },\r\n      documents: {\r\n        label: 'Documents',\r\n        className: 'bg-blue-100 text-blue-600',\r\n        icon: 'FileText'\r\n      },\r\n      paiements: {\r\n        label: 'Paiements',\r\n        className: 'bg-green-100 text-green-600',\r\n        icon: 'CreditCard'\r\n      },\r\n      planning: {\r\n        label: 'Planning',\r\n        className: 'bg-orange-100 text-orange-600',\r\n        icon: 'Calendar'\r\n      },\r\n      inscriptions: {\r\n        label: 'Inscriptions',\r\n        className: 'bg-pink-100 text-pink-600',\r\n        icon: 'UserPlus'\r\n      }\r\n    };\r\n    return configs?.[category] || configs?.documents;\r\n  };\r\n\r\n  const filteredTasks = tasks.filter(task => {\r\n    const matchesSearch = task.title.toLowerCase().includes(searchTerm.toLowerCase()) ||\r\n                         task.description.toLowerCase().includes(searchTerm.toLowerCase());\r\n    const matchesPriority = filterPriority === '' || task.priority === filterPriority;\r\n    const matchesStatus = filterStatus === '' || task.status === filterStatus;\r\n    return matchesSearch && matchesPriority && matchesStatus;\r\n  });\r\n\r\n  const handleTaskStatusChange = async (taskId, newStatus) => {\r\n    try {\r\n      const updateData = {\r\n        status: newStatus,\r\n        updated_at: new Date().toISOString()\r\n      };\r\n\r\n      // Si le statut est \"completed\", enregistrer la date de compl√©tion\r\n      if (newStatus === 'completed') {\r\n        updateData.completed_at = new Date().toISOString();\r\n      }\r\n\r\n      const { error } = await supabase\r\n        .from('tasks')\r\n        .update(updateData)\r\n        .eq('id', taskId);\r\n\r\n      if (error) {\r\n        console.error('Erreur mise √† jour statut:', error);\r\n        alert('Erreur lors de la mise √† jour du statut');\r\n        return;\r\n      }\r\n\r\n      // Mettre √† jour l'√©tat local\r\n      setTasks(tasks.map(task => \r\n        task.id === taskId ? { ...task, status: newStatus } : task\r\n      ));\r\n\r\n      console.log('‚úÖ Statut de la t√¢che mis √† jour');\r\n    } catch (error) {\r\n      console.error('Exception mise √† jour statut:', error);\r\n      alert('Erreur lors de la mise √† jour du statut');\r\n    }\r\n  };\r\n\r\n  const handleAddTask = () => {\r\n    setShowAddTaskModal(true);\r\n  };\r\n\r\n  const handleSaveNewTask = async () => {\r\n    if (!newTask.title || !newTask.description) {\r\n      alert('Veuillez remplir le titre et la description');\r\n      return;\r\n    }\r\n\r\n    try {\r\n      const savedUser = localStorage.getItem('edutrack-user');\r\n      const userData = savedUser ? JSON.parse(savedUser) : null;\r\n      const schoolId = userData?.current_school_id;\r\n      const userId = userData?.id;\r\n\r\n      if (!schoolId) {\r\n        alert('Erreur: Pas d\\'√©cole associ√©e');\r\n        return;\r\n      }\r\n\r\n      const { data, error } = await supabase\r\n        .from('tasks')\r\n        .insert({\r\n          title: newTask.title,\r\n          description: newTask.description,\r\n          priority: newTask.priority,\r\n          status: 'pending',\r\n          due_date: newTask.dueDate || null,\r\n          due_time: newTask.dueTime || null,\r\n          category: newTask.category,\r\n          school_id: schoolId,\r\n          assigned_to_user_id: userId,\r\n          student_related: newTask.studentRelated || null,\r\n          contact: newTask.contact || null,\r\n          estimated_duration: '30 min',\r\n          created_by_user_id: userId\r\n        })\r\n        .select()\r\n        .single();\r\n\r\n      if (error) {\r\n        console.error('Erreur cr√©ation t√¢che:', error);\r\n        alert('Erreur lors de la cr√©ation de la t√¢che: ' + error.message);\r\n        return;\r\n      }\r\n\r\n      // Recharger les t√¢ches\r\n      await loadTasks();\r\n\r\n      // R√©initialiser le formulaire\r\n      setNewTask({\r\n        title: '',\r\n        description: '',\r\n        priority: 'medium',\r\n        dueDate: '',\r\n        dueTime: '',\r\n        category: 'general',\r\n        contact: '',\r\n        studentRelated: ''\r\n      });\r\n      setShowAddTaskModal(false);\r\n      \r\n      console.log('‚úÖ T√¢che cr√©√©e avec succ√®s:', data);\r\n    } catch (error) {\r\n      console.error('Exception cr√©ation t√¢che:', error);\r\n      alert('Erreur lors de la cr√©ation de la t√¢che');\r\n    }\r\n  };\r\n\r\n  const handleShowUrgentCalls = () => {\r\n    setShowUrgentCallsModal(true);\r\n  };\r\n\r\n  const handleEditTask = (taskId) => {\r\n    const taskToEdit = tasks.find(task => task.id === taskId);\r\n    if (!taskToEdit) {\r\n      alert('T√¢che introuvable');\r\n      return;\r\n    }\r\n\r\n    // Charger les donn√©es de la t√¢che dans le formulaire\r\n    setEditingTask(taskToEdit);\r\n    setNewTask({\r\n      title: taskToEdit.title || '',\r\n      description: taskToEdit.description || '',\r\n      priority: taskToEdit.priority || 'medium',\r\n      dueDate: taskToEdit.dueDate || '',\r\n      dueTime: taskToEdit.dueTime || '',\r\n      category: taskToEdit.category || 'general',\r\n      contact: taskToEdit.contact || '',\r\n      studentRelated: taskToEdit.studentRelated || ''\r\n    });\r\n    setShowEditTaskModal(true);\r\n  };\r\n\r\n  const handleSaveEditTask = async () => {\r\n    if (!editingTask) return;\r\n\r\n    // Validation\r\n    if (!newTask.title.trim()) {\r\n      alert('Le titre est obligatoire');\r\n      return;\r\n    }\r\n    if (!newTask.dueDate) {\r\n      alert('La date d\\'√©ch√©ance est obligatoire');\r\n      return;\r\n    }\r\n\r\n    try {\r\n      const { data, error } = await supabase\r\n        .from('tasks')\r\n        .update({\r\n          title: newTask.title.trim(),\r\n          description: newTask.description.trim(),\r\n          priority: newTask.priority,\r\n          due_date: newTask.dueDate,\r\n          due_time: newTask.dueTime || null,\r\n          category: newTask.category,\r\n          contact: newTask.contact.trim() || null,\r\n          student_related: newTask.studentRelated.trim() || null,\r\n          updated_at: new Date().toISOString()\r\n        })\r\n        .eq('id', editingTask.id)\r\n        .select()\r\n        .single();\r\n\r\n      if (error) {\r\n        console.error('Erreur mise √† jour t√¢che:', error);\r\n        alert('Erreur lors de la mise √† jour de la t√¢che');\r\n        return;\r\n      }\r\n\r\n      console.log('‚úÖ T√¢che mise √† jour avec succ√®s:', data);\r\n      \r\n      // Recharger les t√¢ches\r\n      await loadTasks();\r\n      \r\n      // Fermer le modal et r√©initialiser\r\n      setShowEditTaskModal(false);\r\n      setEditingTask(null);\r\n      setNewTask({\r\n        title: '',\r\n        description: '',\r\n        priority: 'medium',\r\n        dueDate: '',\r\n        dueTime: '',\r\n        category: 'general',\r\n        contact: '',\r\n        studentRelated: ''\r\n      });\r\n    } catch (error) {\r\n      console.error('Exception mise √† jour t√¢che:', error);\r\n      alert('Erreur lors de la mise √† jour de la t√¢che');\r\n    }\r\n  };\r\n\r\n  const handleDeleteTask = async (taskId) => {\r\n    if (!confirm('√ätes-vous s√ªr de vouloir supprimer cette t√¢che ?')) {\r\n      return;\r\n    }\r\n\r\n    try {\r\n      const { error } = await supabase\r\n        .from('tasks')\r\n        .delete()\r\n        .eq('id', taskId);\r\n\r\n      if (error) {\r\n        console.error('Erreur suppression t√¢che:', error);\r\n        alert('Erreur lors de la suppression de la t√¢che');\r\n        return;\r\n      }\r\n\r\n      // Supprimer de l'√©tat local\r\n      setTasks(tasks.filter(task => task.id !== taskId));\r\n      console.log('‚úÖ T√¢che supprim√©e avec succ√®s');\r\n    } catch (error) {\r\n      console.error('Exception suppression t√¢che:', error);\r\n      alert('Erreur lors de la suppression de la t√¢che');\r\n    }\r\n  };\r\n\r\n  const handleCallContact = (contact) => {\r\n    // Simulation d'un appel\r\n    window.open(`tel:${contact}`, '_self');\r\n  };\r\n\r\n  const stats = {\r\n    pending: tasks.filter(t => t.status === 'pending').length,\r\n    urgent: tasks.filter(t => t.priority === 'urgent').length,\r\n    today: tasks.filter(t => t.dueDate === new Date().toISOString().split('T')[0]).length,\r\n    completed: tasks.filter(t => t.status === 'completed').length\r\n  };\r\n\r\n  // Indicateur de chargement\r\n  if (loading) {\r\n    return (\r\n      <div className=\"flex items-center justify-center py-12\">\r\n        <div className=\"text-center\">\r\n          <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4\"></div>\r\n          <p className=\"text-text-secondary\">Chargement des t√¢ches...</p>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      {/* Header */}\r\n      <div className=\"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4\">\r\n        <div>\r\n          <h2 className=\"font-heading font-heading-bold text-2xl text-text-primary\">\r\n            T√¢ches Quotidiennes\r\n          </h2>\r\n          <p className=\"font-body font-body-normal text-text-secondary mt-1\">\r\n            Gestion des t√¢ches administratives et suivi des actions prioritaires\r\n          </p>\r\n        </div>\r\n        <div className=\"flex items-center space-x-3\">\r\n          <Button\r\n            variant=\"outline\"\r\n            iconName=\"Phone\"\r\n            iconPosition=\"left\"\r\n            onClick={handleShowUrgentCalls}\r\n          >\r\n            Appels urgents\r\n          </Button>\r\n          <Button\r\n            variant=\"default\"\r\n            iconName=\"Plus\"\r\n            iconPosition=\"left\"\r\n            onClick={handleAddTask}\r\n          >\r\n            Nouvelle t√¢che\r\n          </Button>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Quick Stats */}\r\n      <div className=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4\">\r\n        <div className=\"bg-card rounded-lg border border-border p-4\">\r\n          <div className=\"flex items-center space-x-3\">\r\n            <div className=\"w-12 h-12 bg-warning/10 rounded-lg flex items-center justify-center\">\r\n              <Icon name=\"Clock\" size={24} className=\"text-warning\" />\r\n            </div>\r\n            <div>\r\n              <p className=\"font-heading font-heading-bold text-2xl text-text-primary\">\r\n                {stats.pending}\r\n              </p>\r\n              <p className=\"font-caption font-caption-normal text-sm text-text-secondary\">\r\n                T√¢ches en attente\r\n              </p>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"bg-card rounded-lg border border-border p-4\">\r\n          <div className=\"flex items-center space-x-3\">\r\n            <div className=\"w-12 h-12 bg-error/10 rounded-lg flex items-center justify-center\">\r\n              <Icon name=\"AlertTriangle\" size={24} className=\"text-error\" />\r\n            </div>\r\n            <div>\r\n              <p className=\"font-heading font-heading-bold text-2xl text-text-primary\">\r\n                {stats.urgent}\r\n              </p>\r\n              <p className=\"font-caption font-caption-normal text-sm text-text-secondary\">\r\n                T√¢ches urgentes\r\n              </p>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"bg-card rounded-lg border border-border p-4\">\r\n          <div className=\"flex items-center space-x-3\">\r\n            <div className=\"w-12 h-12 bg-primary/10 rounded-lg flex items-center justify-center\">\r\n              <Icon name=\"Calendar\" size={24} className=\"text-primary\" />\r\n            </div>\r\n            <div>\r\n              <p className=\"font-heading font-heading-bold text-2xl text-text-primary\">\r\n                {stats.today}\r\n              </p>\r\n              <p className=\"font-caption font-caption-normal text-sm text-text-secondary\">\r\n                √âchues aujourd'hui\r\n              </p>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"bg-card rounded-lg border border-border p-4\">\r\n          <div className=\"flex items-center space-x-3\">\r\n            <div className=\"w-12 h-12 bg-success/10 rounded-lg flex items-center justify-center\">\r\n              <Icon name=\"CheckCircle\" size={24} className=\"text-success\" />\r\n            </div>\r\n            <div>\r\n              <p className=\"font-heading font-heading-bold text-2xl text-text-primary\">\r\n                {stats.completed}\r\n              </p>\r\n              <p className=\"font-caption font-caption-normal text-sm text-text-secondary\">\r\n                Termin√©es\r\n              </p>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Filters */}\r\n      <div className=\"bg-card rounded-lg border border-border p-6\">\r\n        <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\r\n          <Input\r\n            placeholder=\"Rechercher une t√¢che...\"\r\n            value={searchTerm}\r\n            onChange={(e) => setSearchTerm(e.target.value)}\r\n          />\r\n          <Select\r\n            options={priorityOptions}\r\n            value={filterPriority}\r\n            onChange={setFilterPriority}\r\n            placeholder=\"Filtrer par priorit√©\"\r\n          />\r\n          <Select\r\n            options={statusOptions}\r\n            value={filterStatus}\r\n            onChange={setFilterStatus}\r\n            placeholder=\"Filtrer par statut\"\r\n          />\r\n        </div>\r\n      </div>\r\n\r\n      {/* Tasks List */}\r\n      <div className=\"bg-card rounded-lg border border-border p-6\">\r\n        <div className=\"flex items-center justify-between mb-6\">\r\n          <h3 className=\"font-heading font-heading-semibold text-lg text-text-primary\">\r\n            Liste des t√¢ches ({filteredTasks.length})\r\n          </h3>\r\n          <div className=\"flex items-center space-x-2\">\r\n            <Button variant=\"ghost\" size=\"sm\">\r\n              <Icon name=\"Download\" size={16} className=\"mr-2\" />\r\n              Exporter\r\n            </Button>\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"space-y-4\">\r\n          {filteredTasks.map((task) => {\r\n            const priorityConfig = getPriorityConfig(task.priority);\r\n            const statusConfig = getStatusConfig(task.status);\r\n            const categoryConfig = getCategoryConfig(task.category);\r\n            \r\n            return (\r\n              <div key={task.id} className=\"border border-border rounded-lg p-4 hover:bg-muted/50 transition-micro\">\r\n                <div className=\"flex items-start justify-between\">\r\n                  <div className=\"flex-1\">\r\n                    <div className=\"flex items-center space-x-3 mb-2\">\r\n                      <Checkbox\r\n                        checked={task.status === 'completed'}\r\n                        onChange={(checked) => handleTaskStatusChange(task.id, checked ? 'completed' : 'pending')}\r\n                      />\r\n                      <h4 className={`font-body font-body-semibold text-lg ${task.status === 'completed' ? 'line-through text-text-secondary' : 'text-text-primary'}`}>\r\n                        {task.title}\r\n                      </h4>\r\n                      <span className={`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${categoryConfig.className}`}>\r\n                        <Icon name={categoryConfig.icon} size={12} className=\"mr-1\" />\r\n                        {categoryConfig.label}\r\n                      </span>\r\n                      <span className={`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium border ${priorityConfig.className}`}>\r\n                        <Icon name={priorityConfig.icon} size={12} className=\"mr-1\" />\r\n                        {priorityConfig.label}\r\n                      </span>\r\n                      <span className={`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium border ${statusConfig.className}`}>\r\n                        <Icon name={statusConfig.icon} size={12} className=\"mr-1\" />\r\n                        {statusConfig.label}\r\n                      </span>\r\n                    </div>\r\n                    \r\n                    <p className=\"text-text-secondary mb-3\">{task.description}</p>\r\n                    \r\n                    <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm\">\r\n                      <div className=\"space-y-1\">\r\n                        <div className=\"flex items-center space-x-2 text-text-secondary\">\r\n                          <Icon name=\"Calendar\" size={16} />\r\n                          <span>√âch√©ance: {task.dueDate} √† {task.dueTime}</span>\r\n                        </div>\r\n                        <div className=\"flex items-center space-x-2 text-text-secondary\">\r\n                          <Icon name=\"Clock\" size={16} />\r\n                          <span>Dur√©e estim√©e: {task.estimatedDuration}</span>\r\n                        </div>\r\n                        {task.contact && (\r\n                          <div className=\"flex items-center space-x-2 text-text-secondary\">\r\n                            <Icon name=\"Phone\" size={16} />\r\n                            <span>{task.contact}</span>\r\n                            <Button\r\n                              variant=\"ghost\"\r\n                              size=\"sm\"\r\n                              onClick={() => handleCallContact(task.contact)}\r\n                              className=\"p-1 h-6 w-6\"\r\n                            >\r\n                              <Icon name=\"ExternalLink\" size={12} />\r\n                            </Button>\r\n                          </div>\r\n                        )}\r\n                      </div>\r\n                      \r\n                      <div className=\"space-y-1\">\r\n                        <div className=\"flex items-center space-x-2 text-text-secondary\">\r\n                          <Icon name=\"User\" size={16} />\r\n                          <span>Assign√© √†: {task.assignedTo}</span>\r\n                        </div>\r\n                        {task.studentRelated && (\r\n                          <div className=\"flex items-center space-x-2 text-text-secondary\">\r\n                            <Icon name=\"Users\" size={16} />\r\n                            <span>Concern√©: {task.studentRelated}</span>\r\n                          </div>\r\n                        )}\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                  \r\n                  <div className=\"flex items-center space-x-2 ml-4\">\r\n                    <Button\r\n                      variant=\"ghost\"\r\n                      size=\"sm\"\r\n                      onClick={() => handleEditTask(task.id)}\r\n                      title=\"Modifier\"\r\n                    >\r\n                      <Icon name=\"Edit\" size={16} />\r\n                    </Button>\r\n                    {task.status === 'pending' && (\r\n                      <Button\r\n                        variant=\"ghost\"\r\n                        size=\"sm\"\r\n                        onClick={() => handleTaskStatusChange(task.id, 'in_progress')}\r\n                        title=\"Commencer\"\r\n                      >\r\n                        <Icon name=\"Play\" size={16} />\r\n                      </Button>\r\n                    )}\r\n                    {task.status === 'in_progress' && (\r\n                      <Button\r\n                        variant=\"ghost\"\r\n                        size=\"sm\"\r\n                        onClick={() => handleTaskStatusChange(task.id, 'completed')}\r\n                        title=\"Terminer\"\r\n                      >\r\n                        <Icon name=\"CheckCircle\" size={16} />\r\n                      </Button>\r\n                    )}\r\n                    <Button\r\n                      variant=\"ghost\"\r\n                      size=\"sm\"\r\n                      onClick={() => handleDeleteTask(task.id)}\r\n                      title=\"Supprimer\"\r\n                    >\r\n                      <Icon name=\"Trash2\" size={16} />\r\n                    </Button>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            );\r\n          })}\r\n        </div>\r\n\r\n        {filteredTasks.length === 0 && (\r\n          <div className=\"text-center py-12\">\r\n            <Icon name=\"CheckCircle\" size={48} className=\"text-muted-foreground mx-auto mb-4\" />\r\n            <h3 className=\"font-heading font-heading-semibold text-lg text-text-primary mb-2\">\r\n              Aucune t√¢che trouv√©e\r\n            </h3>\r\n            <p className=\"font-body font-body-normal text-text-secondary\">\r\n              Aucune t√¢che ne correspond √† vos crit√®res de recherche.\r\n            </p>\r\n          </div>\r\n        )}\r\n      </div>\r\n\r\n      {/* Modal Nouvelle T√¢che */}\r\n      {showAddTaskModal && (\r\n        <div className=\"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4\">\r\n          <div className=\"bg-card rounded-lg border border-border max-w-2xl w-full max-h-[90vh] overflow-y-auto\">\r\n            <div className=\"flex items-center justify-between p-6 border-b border-border\">\r\n              <h3 className=\"font-heading font-heading-semibold text-lg text-text-primary\">\r\n                Cr√©er une nouvelle t√¢che\r\n              </h3>\r\n              <Button\r\n                variant=\"ghost\"\r\n                size=\"icon\"\r\n                onClick={() => setShowAddTaskModal(false)}\r\n              >\r\n                <Icon name=\"X\" size={20} />\r\n              </Button>\r\n            </div>\r\n            \r\n            <div className=\"p-6 space-y-4\">\r\n              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n                <div className=\"md:col-span-2\">\r\n                  <Input\r\n                    label=\"Titre de la t√¢che\"\r\n                    placeholder=\"Ex: Appeler les parents de...\"\r\n                    value={newTask.title}\r\n                    onChange={(e) => setNewTask(prev => ({ ...prev, title: e.target.value }))}\r\n                    required\r\n                  />\r\n                </div>\r\n                <div className=\"md:col-span-2\">\r\n                  <Input\r\n                    label=\"Description\"\r\n                    placeholder=\"D√©tails de la t√¢che √† effectuer\"\r\n                    value={newTask.description}\r\n                    onChange={(e) => setNewTask(prev => ({ ...prev, description: e.target.value }))}\r\n                    required\r\n                  />\r\n                </div>\r\n                <Select\r\n                  label=\"Priorit√©\"\r\n                  options={[\r\n                    { value: 'urgent', label: 'Urgent' },\r\n                    { value: 'high', label: 'Important' },\r\n                    { value: 'medium', label: 'Normal' },\r\n                    { value: 'low', label: 'Faible' }\r\n                  ]}\r\n                  value={newTask.priority}\r\n                  onChange={(value) => setNewTask(prev => ({ ...prev, priority: value }))}\r\n                />\r\n                <Select\r\n                  label=\"Cat√©gorie\"\r\n                  options={[\r\n                    { value: 'appels', label: 'Appels' },\r\n                    { value: 'documents', label: 'Documents' },\r\n                    { value: 'paiements', label: 'Paiements' },\r\n                    { value: 'inscriptions', label: 'Inscriptions' },\r\n                    { value: 'planning', label: 'Planning' },\r\n                    { value: 'general', label: 'G√©n√©ral' }\r\n                  ]}\r\n                  value={newTask.category}\r\n                  onChange={(value) => setNewTask(prev => ({ ...prev, category: value }))}\r\n                />\r\n                <Input\r\n                  label=\"Date d'√©ch√©ance\"\r\n                  type=\"date\"\r\n                  value={newTask.dueDate}\r\n                  onChange={(e) => setNewTask(prev => ({ ...prev, dueDate: e.target.value }))}\r\n                />\r\n                <Input\r\n                  label=\"Heure d'√©ch√©ance\"\r\n                  type=\"time\"\r\n                  value={newTask.dueTime}\r\n                  onChange={(e) => setNewTask(prev => ({ ...prev, dueTime: e.target.value }))}\r\n                />\r\n                <Input\r\n                  label=\"√âl√®ve concern√© (optionnel)\"\r\n                  placeholder=\"Ex: Marie Dubois - CM2\"\r\n                  value={newTask.studentRelated}\r\n                  onChange={(e) => setNewTask(prev => ({ ...prev, studentRelated: e.target.value }))}\r\n                />\r\n                <Input\r\n                  label=\"Contact (optionnel)\"\r\n                  placeholder=\"+237 6XX XX XX XX\"\r\n                  value={newTask.contact}\r\n                  onChange={(e) => setNewTask(prev => ({ ...prev, contact: e.target.value }))}\r\n                />\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"flex gap-3 p-6 border-t border-border\">\r\n              <Button variant=\"default\" onClick={handleSaveNewTask}>\r\n                Cr√©er la t√¢che\r\n              </Button>\r\n              <Button variant=\"outline\" onClick={() => setShowAddTaskModal(false)}>\r\n                Annuler\r\n              </Button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Modal Modifier T√¢che */}\r\n      {showEditTaskModal && (\r\n        <div className=\"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4\">\r\n          <div className=\"bg-card rounded-lg border border-border max-w-2xl w-full max-h-[90vh] overflow-y-auto\">\r\n            <div className=\"flex items-center justify-between p-6 border-b border-border\">\r\n              <h3 className=\"font-heading font-heading-semibold text-lg text-text-primary\">\r\n                Modifier la t√¢che\r\n              </h3>\r\n              <Button\r\n                variant=\"ghost\"\r\n                size=\"icon\"\r\n                onClick={() => {\r\n                  setShowEditTaskModal(false);\r\n                  setEditingTask(null);\r\n                }}\r\n              >\r\n                <Icon name=\"X\" size={20} />\r\n              </Button>\r\n            </div>\r\n            \r\n            <div className=\"p-6 space-y-4\">\r\n              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n                <div className=\"md:col-span-2\">\r\n                  <Input\r\n                    label=\"Titre de la t√¢che\"\r\n                    placeholder=\"Ex: Appeler les parents de...\"\r\n                    value={newTask.title}\r\n                    onChange={(e) => setNewTask(prev => ({ ...prev, title: e.target.value }))}\r\n                    required\r\n                  />\r\n                </div>\r\n                <div className=\"md:col-span-2\">\r\n                  <Input\r\n                    label=\"Description\"\r\n                    placeholder=\"D√©tails de la t√¢che √† effectuer\"\r\n                    value={newTask.description}\r\n                    onChange={(e) => setNewTask(prev => ({ ...prev, description: e.target.value }))}\r\n                    required\r\n                  />\r\n                </div>\r\n                <Select\r\n                  label=\"Priorit√©\"\r\n                  options={[\r\n                    { value: 'urgent', label: 'Urgent' },\r\n                    { value: 'high', label: 'Important' },\r\n                    { value: 'medium', label: 'Normal' },\r\n                    { value: 'low', label: 'Faible' }\r\n                  ]}\r\n                  value={newTask.priority}\r\n                  onChange={(value) => setNewTask(prev => ({ ...prev, priority: value }))}\r\n                />\r\n                <Select\r\n                  label=\"Cat√©gorie\"\r\n                  options={[\r\n                    { value: 'appels', label: 'Appels' },\r\n                    { value: 'documents', label: 'Documents' },\r\n                    { value: 'paiements', label: 'Paiements' },\r\n                    { value: 'inscriptions', label: 'Inscriptions' },\r\n                    { value: 'planning', label: 'Planning' },\r\n                    { value: 'general', label: 'G√©n√©ral' }\r\n                  ]}\r\n                  value={newTask.category}\r\n                  onChange={(value) => setNewTask(prev => ({ ...prev, category: value }))}\r\n                />\r\n                <Input\r\n                  label=\"Date d'√©ch√©ance\"\r\n                  type=\"date\"\r\n                  value={newTask.dueDate}\r\n                  onChange={(e) => setNewTask(prev => ({ ...prev, dueDate: e.target.value }))}\r\n                />\r\n                <Input\r\n                  label=\"Heure d'√©ch√©ance\"\r\n                  type=\"time\"\r\n                  value={newTask.dueTime}\r\n                  onChange={(e) => setNewTask(prev => ({ ...prev, dueTime: e.target.value }))}\r\n                />\r\n                <Input\r\n                  label=\"√âl√®ve concern√© (optionnel)\"\r\n                  placeholder=\"Ex: Marie Dubois - CM2\"\r\n                  value={newTask.studentRelated}\r\n                  onChange={(e) => setNewTask(prev => ({ ...prev, studentRelated: e.target.value }))}\r\n                />\r\n                <Input\r\n                  label=\"Contact (optionnel)\"\r\n                  placeholder=\"+237 6XX XX XX XX\"\r\n                  value={newTask.contact}\r\n                  onChange={(e) => setNewTask(prev => ({ ...prev, contact: e.target.value }))}\r\n                />\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"flex gap-3 p-6 border-t border-border\">\r\n              <Button variant=\"default\" onClick={handleSaveEditTask}>\r\n                Enregistrer les modifications\r\n              </Button>\r\n              <Button \r\n                variant=\"outline\" \r\n                onClick={() => {\r\n                  setShowEditTaskModal(false);\r\n                  setEditingTask(null);\r\n                }}\r\n              >\r\n                Annuler\r\n              </Button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Modal Appels Urgents */}\r\n      {showUrgentCallsModal && (\r\n        <div className=\"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4\">\r\n          <div className=\"bg-card rounded-lg border border-border max-w-md w-full\">\r\n            <div className=\"flex items-center justify-between p-6 border-b border-border\">\r\n              <h3 className=\"font-heading font-heading-semibold text-lg text-text-primary\">\r\n                Appels Urgents\r\n              </h3>\r\n              <Button\r\n                variant=\"ghost\"\r\n                size=\"icon\"\r\n                onClick={() => setShowUrgentCallsModal(false)}\r\n              >\r\n                <Icon name=\"X\" size={20} />\r\n              </Button>\r\n            </div>\r\n            \r\n            <div className=\"p-6\">\r\n              <div className=\"space-y-3\">\r\n                {tasks\r\n                  .filter(task => task.priority === 'urgent' && task.contact && task.status === 'pending')\r\n                  .map((task) => (\r\n                    <div key={task.id} className=\"flex items-center justify-between p-3 bg-muted/30 rounded-lg\">\r\n                      <div className=\"flex-1\">\r\n                        <p className=\"font-body font-body-medium text-sm text-text-primary\">\r\n                          {task.title}\r\n                        </p>\r\n                        <p className=\"font-caption font-caption-normal text-xs text-text-secondary\">\r\n                          {task.contact}\r\n                        </p>\r\n                      </div>\r\n                      <Button\r\n                        variant=\"outline\"\r\n                        size=\"sm\"\r\n                        iconName=\"Phone\"\r\n                        onClick={() => handleCallContact(task.contact)}\r\n                      >\r\n                        Appeler\r\n                      </Button>\r\n                    </div>\r\n                  ))}\r\n                \r\n                {tasks.filter(task => task.priority === 'urgent' && task.contact && task.status === 'pending').length === 0 && (\r\n                  <div className=\"text-center py-8\">\r\n                    <Icon name=\"Phone\" size={32} className=\"text-muted-foreground mx-auto mb-3\" />\r\n                    <p className=\"font-body font-body-normal text-text-secondary\">\r\n                      Aucun appel urgent en cours\r\n                    </p>\r\n                  </div>\r\n                )}\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"flex gap-3 p-6 border-t border-border\">\r\n              <Button variant=\"outline\" onClick={() => setShowUrgentCallsModal(false)}>\r\n                Fermer\r\n              </Button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default TasksTab;","import { supabase } from '../lib/supabase';\r\nimport { getCurrentSchoolId } from './cardService';\r\n\r\n// V√©rifier si on est en mode production\r\nconst isProductionMode = () => {\r\n  // Mode PRODUCTION - utilisation exclusive des donn√©es Supabase\r\n  console.log('SchoolYearService: Mode PRODUCTION - utilisation exclusive des donn√©es Supabase');\r\n  return true;\r\n};\r\n\r\nclass SchoolYearService {\r\n  // Obtenir toutes les demandes d'inscription pour l'√©cole actuelle\r\n  async getEnrollmentRequests() {\r\n    console.log('SchoolYearService: Mode production forc√© - r√©cup√©ration des vraies donn√©es');\r\n\r\n    try {\r\n      const schoolId = await getCurrentSchoolId();\r\n      if (!schoolId) {\r\n        console.log('SchoolYearService: Aucun ID d\\'√©cole trouv√© - retour de donn√©es vides');\r\n        return [];\r\n      }\r\n\r\n      console.log('SchoolYearService: Recherche des demandes pour l\\'√©cole:', schoolId);\r\n\r\n      const { data, error } = await supabase\r\n        .from('enrollment_requests')\r\n        .select('*')\r\n        .eq('school_id', schoolId)\r\n        .order('submitted_date', { ascending: false });\r\n\r\n      if (error) {\r\n        console.error('SchoolYearService: Erreur lors de la r√©cup√©ration des demandes d\\'inscription:', error);\r\n        return [];\r\n      }\r\n\r\n      console.log('SchoolYearService: Demandes d\\'inscription r√©cup√©r√©es:', data?.length || 0, 'demandes');\r\n      if (data && data.length > 0) {\r\n        console.log('SchoolYearService: Premi√®re demande:', data[0]);\r\n      } else {\r\n        console.log('SchoolYearService: Aucune demande trouv√©e - base vide');\r\n      }\r\n\r\n      return data || [];\r\n    } catch (error) {\r\n      console.error('SchoolYearService: Erreur dans getEnrollmentRequests:', error);\r\n      return [];\r\n    }\r\n  }\r\n\r\n  // Obtenir les r√©inscriptions (demandes de type redoublement et nouvelles inscriptions d'√©tudiants existants)\r\n  async getReinscriptions() {\r\n    console.log('SchoolYearService: Mode production forc√© - r√©cup√©ration des r√©inscriptions');\r\n\r\n    try {\r\n      const schoolId = await getCurrentSchoolId();\r\n      if (!schoolId) {\r\n        console.log('SchoolYearService: Aucun ID d\\'√©cole pour les r√©inscriptions');\r\n        return [];\r\n      }\r\n\r\n      console.log('SchoolYearService: Recherche des r√©inscriptions pour l\\'√©cole:', schoolId);\r\n\r\n      // R√©cup√©rer les demandes de redoublement et les nouvelles inscriptions avec student_id existant\r\n      const { data, error } = await supabase\r\n        .from('enrollment_requests')\r\n        .select('*, students(first_name, last_name)')\r\n        .eq('school_id', schoolId)\r\n        .or('request_type.eq.redoublement,and(request_type.eq.nouvelle_inscription,student_id.not.is.null)')\r\n        .order('submitted_date', { ascending: false });\r\n\r\n      if (error) {\r\n        console.error('SchoolYearService: Erreur lors de la r√©cup√©ration des r√©inscriptions:', error);\r\n        return [];\r\n      }\r\n\r\n      console.log('SchoolYearService: R√©inscriptions trouv√©es:', data?.length || 0);\r\n\r\n      // Transformer les donn√©es pour correspondre au format attendu\r\n      const reinscriptions = (data || []).map(request => ({\r\n        id: request.id,\r\n        studentName: request.students \r\n          ? `${request.students.first_name} ${request.students.last_name}`\r\n          : `${request.student_first_name} ${request.student_last_name}`,\r\n        parentName: request.parent_name || 'Non sp√©cifi√©',\r\n        currentClass: request.current_class || 'Non d√©finie',\r\n        requestedClass: request.requested_class,\r\n        status: this.mapRequestStatusToReinscriptionStatus(request.status),\r\n        submittedDate: new Date(request.submitted_date).toLocaleDateString('fr-FR'),\r\n        reason: request.reason,\r\n        teacherRecommendation: request.teacher_recommendation,\r\n        type: request.request_type,\r\n        priority: request.priority\r\n      }));\r\n\r\n      console.log('SchoolYearService: R√©inscriptions format√©es:', reinscriptions.length);\r\n      if (reinscriptions.length > 0) {\r\n        console.log('SchoolYearService: Premi√®re r√©inscription:', reinscriptions[0]);\r\n      }\r\n\r\n      return reinscriptions;\r\n    } catch (error) {\r\n      console.error('SchoolYearService: Erreur dans getReinscriptions:', error);\r\n      return [];\r\n    }\r\n  }\r\n\r\n  // Obtenir les nouvelles inscriptions (demandes sans student_id)\r\n  async getNewInscriptions() {\r\n    console.log('SchoolYearService: Mode production forc√© - r√©cup√©ration des nouvelles inscriptions');\r\n\r\n    try {\r\n      const schoolId = await getCurrentSchoolId();\r\n      if (!schoolId) {\r\n        console.log('SchoolYearService: Aucun ID d\\'√©cole pour les nouvelles inscriptions');\r\n        return [];\r\n      }\r\n\r\n      console.log('SchoolYearService: Recherche des nouvelles inscriptions pour l\\'√©cole:', schoolId);\r\n\r\n      const { data, error } = await supabase\r\n        .from('enrollment_requests')\r\n        .select('*')\r\n        .eq('school_id', schoolId)\r\n        .eq('request_type', 'nouvelle_inscription')\r\n        .is('student_id', null)\r\n        .order('submitted_date', { ascending: false });\r\n\r\n      if (error) {\r\n        console.error('SchoolYearService: Erreur lors de la r√©cup√©ration des nouvelles inscriptions:', error);\r\n        return [];\r\n      }\r\n\r\n      console.log('SchoolYearService: Nouvelles inscriptions trouv√©es:', data?.length || 0);\r\n\r\n      // Transformer les donn√©es pour correspondre au format attendu\r\n      const newInscriptions = (data || []).map(request => ({\r\n        id: request.id,\r\n        studentName: `${request.student_first_name} ${request.student_last_name}`,\r\n        parentName: request.parent_name || 'Non sp√©cifi√©',\r\n        parentPhone: request.parent_phone,\r\n        parentEmail: request.parent_email,\r\n        requestedClass: request.requested_class,\r\n        birthDate: request.student_birth_date \r\n          ? new Date(request.student_birth_date).toLocaleDateString('fr-FR')\r\n          : null,\r\n        status: this.mapRequestStatusToInscriptionStatus(request.status),\r\n        submittedDate: new Date(request.submitted_date).toLocaleDateString('fr-FR'),\r\n        documents: JSON.parse(request.documents || '[]'),\r\n        reason: request.reason,\r\n        priority: request.priority,\r\n        previousSchool: request.previous_school\r\n      }));\r\n\r\n      console.log('SchoolYearService: Nouvelles inscriptions format√©es:', newInscriptions.length);\r\n      if (newInscriptions.length > 0) {\r\n        console.log('SchoolYearService: Premi√®re nouvelle inscription:', newInscriptions[0]);\r\n      }\r\n\r\n      return newInscriptions;\r\n    } catch (error) {\r\n      console.error('SchoolYearService: Erreur dans getNewInscriptions:', error);\r\n      return [];\r\n    }\r\n  }\r\n\r\n  // Obtenir les √©tudiants actuels pour les passages de classe\r\n  async getCurrentStudents() {\r\n    if (!isProductionMode()) {\r\n      console.log('SchoolYearService: Mode d√©mo - retour de donn√©es vides pour √©tudiants actuels');\r\n      return {};\r\n    }\r\n\r\n    try {\r\n      const schoolId = await getCurrentSchoolId();\r\n      if (!schoolId) {\r\n        return {};\r\n      }\r\n\r\n      const { data, error } = await supabase\r\n        .from('students')\r\n        .select('*')\r\n        .eq('school_id', schoolId)\r\n        .eq('status', 'active');\r\n\r\n      if (error) {\r\n        console.error('Erreur lors de la r√©cup√©ration des √©tudiants actuels:', error);\r\n        return {};\r\n      }\r\n\r\n      // Grouper les √©tudiants par classe\r\n      const studentsByClass = {};\r\n      (data || []).forEach(student => {\r\n        const currentClass = student.current_class || 'Non d√©finie';\r\n        if (!studentsByClass[currentClass]) {\r\n          studentsByClass[currentClass] = [];\r\n        }\r\n        \r\n        studentsByClass[currentClass].push({\r\n          id: student.id,\r\n          name: `${student.first_name} ${student.last_name}`,\r\n          currentClass: student.current_class,\r\n          status: 'en_attente', // Statut par d√©faut pour passage de classe\r\n          nextClass: this.getNextClass(student.current_class),\r\n          academicResults: student.academic_results || {},\r\n          attendance: student.attendance_rate || null,\r\n          behavior: student.behavior_notes || null\r\n        });\r\n      });\r\n\r\n      console.log('SchoolYearService: √âtudiants actuels r√©cup√©r√©s:', Object.keys(studentsByClass).length, 'classes');\r\n      return studentsByClass;\r\n    } catch (error) {\r\n      console.error('Erreur dans getCurrentStudents:', error);\r\n      return {};\r\n    }\r\n  }\r\n\r\n  // Mettre √† jour le statut d'une demande d'inscription\r\n  async updateEnrollmentRequestStatus(requestId, status, notes = null) {\r\n    if (!isProductionMode()) {\r\n      console.log('SchoolYearService: Mode d√©mo - simulation de mise √† jour de statut');\r\n      return { success: true };\r\n    }\r\n\r\n    try {\r\n      const updateData = {\r\n        status: this.mapStatusToRequestStatus(status),\r\n        reviewed_date: new Date().toISOString(),\r\n        validation_notes: notes\r\n      };\r\n\r\n      const { error } = await supabase\r\n        .from('enrollment_requests')\r\n        .update(updateData)\r\n        .eq('id', requestId);\r\n\r\n      if (error) {\r\n        console.error('Erreur lors de la mise √† jour du statut:', error);\r\n        return { success: false, error };\r\n      }\r\n\r\n      console.log('SchoolYearService: Statut mis √† jour avec succ√®s pour la demande:', requestId);\r\n      return { success: true };\r\n    } catch (error) {\r\n      console.error('Erreur dans updateEnrollmentRequestStatus:', error);\r\n      return { success: false, error };\r\n    }\r\n  }\r\n\r\n  // Cr√©er une nouvelle demande d'inscription\r\n  async createEnrollmentRequest(requestData) {\r\n    if (!isProductionMode()) {\r\n      console.log('SchoolYearService: Mode d√©mo - simulation de cr√©ation de demande');\r\n      return { success: true, id: 'demo-id' };\r\n    }\r\n\r\n    try {\r\n      const schoolId = await getCurrentSchoolId();\r\n      if (!schoolId) {\r\n        return { success: false, error: '√âcole non trouv√©e' };\r\n      }\r\n\r\n      const { data, error } = await supabase\r\n        .from('enrollment_requests')\r\n        .insert({\r\n          ...requestData,\r\n          school_id: schoolId,\r\n          submitted_date: new Date().toISOString()\r\n        })\r\n        .select()\r\n        .single();\r\n\r\n      if (error) {\r\n        console.error('Erreur lors de la cr√©ation de la demande:', error);\r\n        return { success: false, error };\r\n      }\r\n\r\n      console.log('SchoolYearService: Demande cr√©√©e avec succ√®s:', data.id);\r\n      return { success: true, data };\r\n    } catch (error) {\r\n      console.error('Erreur dans createEnrollmentRequest:', error);\r\n      return { success: false, error };\r\n    }\r\n  }\r\n\r\n  // Utilitaires de mapping des statuts\r\n  mapRequestStatusToReinscriptionStatus(requestStatus) {\r\n    const mapping = {\r\n      'en_attente': 'en_attente',\r\n      'en_revision': 'en_revision',\r\n      'approuvee': 'confirme',\r\n      'refusee': 'refuse'\r\n    };\r\n    return mapping[requestStatus] || 'en_attente';\r\n  }\r\n\r\n  mapRequestStatusToInscriptionStatus(requestStatus) {\r\n    const mapping = {\r\n      'en_attente': 'soumis',\r\n      'en_revision': 'en_revision',\r\n      'approuvee': 'accepte',\r\n      'refusee': 'refuse'\r\n    };\r\n    return mapping[requestStatus] || 'soumis';\r\n  }\r\n\r\n  mapStatusToRequestStatus(status) {\r\n    const mapping = {\r\n      'en_attente': 'en_attente',\r\n      'en_revision': 'en_revision',\r\n      'confirme': 'approuvee',\r\n      'accepte': 'approuvee',\r\n      'refuse': 'refusee',\r\n      'soumis': 'en_attente'\r\n    };\r\n    return mapping[status] || 'en_attente';\r\n  }\r\n\r\n  // D√©terminer la classe suivante\r\n  getNextClass(currentClass) {\r\n    const classProgression = {\r\n      'SIL': 'CP',\r\n      'CP': 'CE1',\r\n      'CE1': 'CE2',\r\n      'CE2': 'CM1',\r\n      'CM1': 'CM2',\r\n      'CM2': 'Sixi√®me'\r\n    };\r\n    return classProgression[currentClass] || currentClass;\r\n  }\r\n\r\n  // Obtenir les statistiques de l'ann√©e scolaire\r\n  async getSchoolYearStatistics() {\r\n    console.log('SchoolYearService: Mode production forc√© - calcul des statistiques');\r\n\r\n    try {\r\n      const schoolId = await getCurrentSchoolId();\r\n      if (!schoolId) {\r\n        console.log('SchoolYearService: Aucun ID d\\'√©cole pour les statistiques');\r\n        return {\r\n          totalRequests: 0,\r\n          pendingRequests: 0,\r\n          approvedRequests: 0,\r\n          rejectedRequests: 0,\r\n          reinscriptions: 0,\r\n          newInscriptions: 0,\r\n          transfers: 0\r\n        };\r\n      }\r\n\r\n      console.log('SchoolYearService: Calcul des statistiques pour l\\'√©cole:', schoolId);\r\n\r\n      const { data, error } = await supabase\r\n        .from('enrollment_requests')\r\n        .select('status, request_type')\r\n        .eq('school_id', schoolId);\r\n\r\n      if (error) {\r\n        console.error('SchoolYearService: Erreur lors de la r√©cup√©ration des statistiques:', error);\r\n        return {\r\n          totalRequests: 0,\r\n          pendingRequests: 0,\r\n          approvedRequests: 0,\r\n          rejectedRequests: 0,\r\n          reinscriptions: 0,\r\n          newInscriptions: 0,\r\n          transfers: 0\r\n        };\r\n      }\r\n\r\n      const stats = (data || []).reduce((acc, request) => {\r\n        acc.totalRequests++;\r\n        \r\n        // Compteurs par statut\r\n        switch (request.status) {\r\n          case 'en_attente':\r\n          case 'en_revision':\r\n            acc.pendingRequests++;\r\n            break;\r\n          case 'approuvee':\r\n            acc.approvedRequests++;\r\n            break;\r\n          case 'refusee':\r\n            acc.rejectedRequests++;\r\n            break;\r\n        }\r\n\r\n        // Compteurs par type\r\n        switch (request.request_type) {\r\n          case 'redoublement':\r\n            acc.reinscriptions++;\r\n            break;\r\n          case 'nouvelle_inscription':\r\n            acc.newInscriptions++;\r\n            break;\r\n          case 'transfert':\r\n            acc.transfers++;\r\n            break;\r\n        }\r\n\r\n        return acc;\r\n      }, {\r\n        totalRequests: 0,\r\n        pendingRequests: 0,\r\n        approvedRequests: 0,\r\n        rejectedRequests: 0,\r\n        reinscriptions: 0,\r\n        newInscriptions: 0,\r\n        transfers: 0\r\n      });\r\n\r\n      console.log('SchoolYearService: Statistiques calcul√©es:', stats);\r\n      return stats;\r\n    } catch (error) {\r\n      console.error('Erreur dans getSchoolYearStatistics:', error);\r\n      return {\r\n        totalRequests: 0,\r\n        pendingRequests: 0,\r\n        approvedRequests: 0,\r\n        rejectedRequests: 0,\r\n        reinscriptions: 0,\r\n        newInscriptions: 0,\r\n        transfers: 0\r\n      };\r\n    }\r\n  }\r\n}\r\n\r\nexport const schoolYearService = new SchoolYearService();\r\nexport default schoolYearService;","import React, { useState, useEffect } from 'react';\r\nimport Icon from '../../../components/AppIcon';\r\nimport Button from '../../../components/ui/Button';\r\nimport Input from '../../../components/ui/Input';\r\nimport Select from '../../../components/ui/Select';\r\nimport schoolYearService from '../../../services/schoolYearService';\r\n\r\nconst SchoolYearTab = () => {\r\n  const [activeSection, setActiveSection] = useState('dashboard');\r\n  const [currentSchoolYear] = useState('2024-2025');\r\n  const [nextSchoolYear] = useState('2025-2026');\r\n  const [loading, setLoading] = useState(true);\r\n\r\n  // √âtats pour les donn√©es r√©elles\r\n  const [studentsData, setStudentsData] = useState({});\r\n  const [reinscriptions, setReinscriptions] = useState([]);\r\n  const [newInscriptions, setNewInscriptions] = useState([]);\r\n  const [statistics, setStatistics] = useState({\r\n    totalRequests: 0,\r\n    pendingRequests: 0,\r\n    approvedRequests: 0,\r\n    rejectedRequests: 0,\r\n    reinscriptions: 0,\r\n    newInscriptions: 0,\r\n    transfers: 0\r\n  });\r\n\r\n  // Chargement des donn√©es au montage du composant\r\n  useEffect(() => {\r\n    const loadSchoolYearData = async () => {\r\n      try {\r\n        setLoading(true);\r\n\r\n        const [studentsRes, reinscriptionsRes, newInscriptionsRes, statisticsRes] = await Promise.all([\r\n          schoolYearService.getCurrentStudents(),\r\n          schoolYearService.getReinscriptions(),\r\n          schoolYearService.getNewInscriptions(),\r\n          schoolYearService.getSchoolYearStatistics()\r\n        ]);\r\n\r\n        setStudentsData(studentsRes);\r\n        setReinscriptions(reinscriptionsRes);\r\n        setNewInscriptions(newInscriptionsRes);\r\n        setStatistics(statisticsRes);\r\n      } catch (error) {\r\n        console.error('Erreur lors du chargement des donn√©es de l\\'ann√©e scolaire:', error);\r\n        setStudentsData({});\r\n        setReinscriptions([]);\r\n        setNewInscriptions([]);\r\n        setStatistics({\r\n          totalRequests: 0,\r\n          pendingRequests: 0,\r\n          approvedRequests: 0,\r\n          rejectedRequests: 0,\r\n          reinscriptions: 0,\r\n          newInscriptions: 0,\r\n          transfers: 0\r\n        });\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    };\r\n\r\n    loadSchoolYearData();\r\n  }, []);\r\n\r\n  // Gestionnaire de mise √† jour de statut\r\n  const handleStatusUpdate = async (requestId, newStatus, notes = null) => {\r\n    try {\r\n      const result = await schoolYearService.updateEnrollmentRequestStatus(requestId, newStatus, notes);\r\n      if (result.success) {\r\n        // Recharger les donn√©es apr√®s mise √† jour\r\n        const [reinscriptionsRes, newInscriptionsRes] = await Promise.all([\r\n          schoolYearService.getReinscriptions(),\r\n          schoolYearService.getNewInscriptions()\r\n        ]);\r\n        setReinscriptions(reinscriptionsRes);\r\n        setNewInscriptions(newInscriptionsRes);\r\n      } else {\r\n        console.error('Erreur lors de la mise √† jour du statut:', result.error);\r\n      }\r\n    } catch (error) {\r\n      console.error('Erreur lors de la mise √† jour du statut:', error);\r\n    }\r\n  };\r\n\r\n  // Afficher un indicateur de chargement\r\n  if (loading) {\r\n    return (\r\n      <div className=\"flex items-center justify-center h-64\">\r\n        <div className=\"flex items-center space-x-2 text-text-secondary\">\r\n          <Icon name=\"Loader2\" size={20} className=\"animate-spin\" />\r\n          <span>Chargement des donn√©es de l'ann√©e scolaire...</span>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  const getStatusBadge = (status) => {\r\n    const statusConfig = {\r\n      'en_preparation': { label: 'En pr√©paration', className: 'bg-blue/10 text-blue' },\r\n      'en_attente': { label: 'En attente', className: 'bg-warning/10 text-warning' },\r\n      'soumis_validation': { label: 'Soumis validation', className: 'bg-orange/10 text-orange' },\r\n      'confirme': { label: 'Confirm√©', className: 'bg-success/10 text-success' },\r\n      'valide': { label: 'Valid√©', className: 'bg-success/10 text-success' },\r\n      'passe': { label: 'Passe', className: 'bg-success/10 text-success' },\r\n      'redouble': { label: 'Redouble', className: 'bg-warning/10 text-warning' },\r\n      'sortant': { label: 'Sortant', className: 'bg-muted text-muted-foreground' }\r\n    };\r\n    \r\n    const config = statusConfig[status] || statusConfig['en_preparation'];\r\n    return (\r\n      <span className={`px-2 py-1 rounded-full text-xs font-caption font-caption-normal ${config.className}`}>\r\n        {config.label}\r\n      </span>\r\n    );\r\n  };\r\n\r\n  const sections = [\r\n    { id: 'dashboard', label: 'Vue d\\'ensemble', icon: 'BarChart3' },\r\n    { id: 'reinscriptions', label: 'R√©inscriptions', icon: 'RotateCcw' },\r\n    { id: 'nouvelles', label: 'Nouvelles inscriptions', icon: 'UserPlus' },\r\n    { id: 'passages', label: 'Passages de classe', icon: 'TrendingUp' },\r\n    { id: 'preparation', label: 'Pr√©paration ann√©e', icon: 'Calendar' }\r\n  ];\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      {/* Header avec ann√©e scolaire */}\r\n      <div className=\"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4\">\r\n        <div>\r\n          <h2 className=\"font-heading font-heading-bold text-xl text-text-primary\">\r\n            Transition d'Ann√©e Scolaire\r\n          </h2>\r\n          <p className=\"text-sm text-text-secondary mt-1\">\r\n            {currentSchoolYear} ‚Üí {nextSchoolYear}\r\n          </p>\r\n        </div>\r\n        <div className=\"flex items-center space-x-3\">\r\n          <div className=\"bg-primary/10 px-3 py-2 rounded-lg\">\r\n            <span className=\"text-sm font-medium text-primary\">\r\n              üìÖ P√©riode de transition active\r\n            </span>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Navigation sections */}\r\n      <div className=\"border-b border-border\">\r\n        <nav className=\"flex space-x-8\">\r\n          {sections.map((section) => (\r\n            <button\r\n              key={section.id}\r\n              onClick={() => setActiveSection(section.id)}\r\n              className={`flex items-center space-x-2 py-4 px-1 border-b-2 font-medium text-sm transition-colors ${\r\n                activeSection === section.id\r\n                  ? 'border-primary text-primary'\r\n                  : 'border-transparent text-text-secondary hover:text-text-primary hover:border-border'\r\n              }`}\r\n            >\r\n              <Icon name={section.icon} size={16} />\r\n              <span>{section.label}</span>\r\n            </button>\r\n          ))}\r\n        </nav>\r\n      </div>\r\n\r\n      {/* Dashboard Overview */}\r\n      {activeSection === 'dashboard' && (\r\n        <div className=\"space-y-6\">\r\n          <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6\">\r\n            <div className=\"bg-card rounded-lg border border-border p-4\">\r\n              <div className=\"flex items-center space-x-3\">\r\n                <div className=\"w-10 h-10 bg-success/10 rounded-lg flex items-center justify-center\">\r\n                  <Icon name=\"CheckCircle\" size={20} className=\"text-success\" />\r\n                </div>\r\n                <div>\r\n                  <p className=\"font-heading font-heading-semibold text-lg text-text-primary\">\r\n                    {statistics.approvedRequests}\r\n                  </p>\r\n                  <p className=\"font-caption font-caption-normal text-xs text-text-secondary\">\r\n                    Demandes approuv√©es\r\n                  </p>\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"bg-card rounded-lg border border-border p-4\">\r\n              <div className=\"flex items-center space-x-3\">\r\n                <div className=\"w-10 h-10 bg-warning/10 rounded-lg flex items-center justify-center\">\r\n                  <Icon name=\"Clock\" size={20} className=\"text-warning\" />\r\n                </div>\r\n                <div>\r\n                  <p className=\"font-heading font-heading-semibold text-lg text-text-primary\">\r\n                    {statistics.pendingRequests}\r\n                  </p>\r\n                  <p className=\"font-caption font-caption-normal text-xs text-text-secondary\">\r\n                    En attente de traitement\r\n                  </p>\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"bg-card rounded-lg border border-border p-4\">\r\n              <div className=\"flex items-center space-x-3\">\r\n                <div className=\"w-10 h-10 bg-primary/10 rounded-lg flex items-center justify-center\">\r\n                  <Icon name=\"UserPlus\" size={20} className=\"text-primary\" />\r\n                </div>\r\n                <div>\r\n                  <p className=\"font-heading font-heading-semibold text-lg text-text-primary\">\r\n                    {statistics.newInscriptions}\r\n                  </p>\r\n                  <p className=\"font-caption font-caption-normal text-xs text-text-secondary\">\r\n                    Nouvelles demandes\r\n                  </p>\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"bg-card rounded-lg border border-border p-4\">\r\n              <div className=\"flex items-center space-x-3\">\r\n                <div className=\"w-10 h-10 bg-blue/10 rounded-lg flex items-center justify-center\">\r\n                  <Icon name=\"TrendingUp\" size={20} className=\"text-blue\" />\r\n                </div>\r\n                <div>\r\n                  <p className=\"font-heading font-heading-semibold text-lg text-text-primary\">\r\n                    {Object.values(studentsData).flat().filter(s => s.status === 'passe').length}\r\n                  </p>\r\n                  <p className=\"font-caption font-caption-normal text-xs text-text-secondary\">\r\n                    Passages de classe\r\n                  </p>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          {/* Workflow Status */}\r\n          <div className=\"bg-card rounded-lg border border-border p-6\">\r\n            <h3 className=\"font-heading font-heading-semibold text-lg text-text-primary mb-4\">\r\n              √âtat du Processus de Transition\r\n            </h3>\r\n            <div className=\"space-y-4\">\r\n              <div className=\"flex items-center justify-between p-4 bg-success/5 border border-success/20 rounded-lg\">\r\n                <div className=\"flex items-center space-x-3\">\r\n                  <Icon name=\"CheckCircle\" size={20} className=\"text-success\" />\r\n                  <div>\r\n                    <p className=\"font-medium text-text-primary\">Collecte des r√©inscriptions</p>\r\n                    <p className=\"text-sm text-text-secondary\">Phase en cours</p>\r\n                  </div>\r\n                </div>\r\n                <span className=\"text-sm font-medium text-success\">En cours</span>\r\n              </div>\r\n\r\n              <div className=\"flex items-center justify-between p-4 bg-muted/30 border border-border rounded-lg\">\r\n                <div className=\"flex items-center space-x-3\">\r\n                  <Icon name=\"Clock\" size={20} className=\"text-muted-foreground\" />\r\n                  <div>\r\n                    <p className=\"font-medium text-text-primary\">Validation par le Principal</p>\r\n                    <p className=\"text-sm text-text-secondary\">En attente de soumission</p>\r\n                  </div>\r\n                </div>\r\n                <span className=\"text-sm font-medium text-muted-foreground\">En attente</span>\r\n              </div>\r\n\r\n              <div className=\"flex items-center justify-between p-4 bg-muted/30 border border-border rounded-lg\">\r\n                <div className=\"flex items-center space-x-3\">\r\n                  <Icon name=\"Calendar\" size={20} className=\"text-muted-foreground\" />\r\n                  <div>\r\n                    <p className=\"font-medium text-text-primary\">Pr√©paration nouvelle ann√©e</p>\r\n                    <p className=\"text-sm text-text-secondary\">D√©marrera apr√®s validation</p>\r\n                  </div>\r\n                </div>\r\n                <span className=\"text-sm font-medium text-muted-foreground\">√Ä venir</span>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Section R√©inscriptions */}\r\n      {activeSection === 'reinscriptions' && (\r\n        <div className=\"space-y-6\">\r\n          <div className=\"flex items-center justify-between\">\r\n            <h3 className=\"font-heading font-heading-semibold text-lg text-text-primary\">\r\n              Suivi des R√©inscriptions\r\n            </h3>\r\n            <Button>\r\n              <Icon name=\"Send\" size={16} className=\"mr-2\" />\r\n              Envoyer rappels\r\n            </Button>\r\n          </div>\r\n\r\n          <div className=\"bg-card rounded-lg border border-border overflow-hidden\">\r\n            <div className=\"overflow-x-auto\">\r\n              <table className=\"w-full\">\r\n                <thead className=\"bg-muted/30\">\r\n                  <tr>\r\n                    <th className=\"px-4 py-3 text-left text-xs font-medium text-text-secondary uppercase tracking-wider\">\r\n                      √âl√®ve\r\n                    </th>\r\n                    <th className=\"px-4 py-3 text-left text-xs font-medium text-text-secondary uppercase tracking-wider\">\r\n                      Parent\r\n                    </th>\r\n                    <th className=\"px-4 py-3 text-left text-xs font-medium text-text-secondary uppercase tracking-wider\">\r\n                      Classe\r\n                    </th>\r\n                    <th className=\"px-4 py-3 text-left text-xs font-medium text-text-secondary uppercase tracking-wider\">\r\n                      Statut\r\n                    </th>\r\n                    <th className=\"px-4 py-3 text-left text-xs font-medium text-text-secondary uppercase tracking-wider\">\r\n                      Actions\r\n                    </th>\r\n                  </tr>\r\n                </thead>\r\n                <tbody className=\"divide-y divide-border\">\r\n                  {reinscriptions.length === 0 ? (\r\n                    <tr>\r\n                      <td colSpan=\"5\" className=\"px-4 py-8 text-center text-text-secondary\">\r\n                        <div className=\"flex flex-col items-center space-y-2\">\r\n                          <Icon name=\"Users\" size={24} className=\"text-muted-foreground\" />\r\n                          <span>Aucune demande de r√©inscription en cours</span>\r\n                        </div>\r\n                      </td>\r\n                    </tr>\r\n                  ) : (\r\n                    reinscriptions.map((reinscription) => (\r\n                      <tr key={reinscription.id} className=\"hover:bg-muted/20\">\r\n                        <td className=\"px-4 py-3\">\r\n                          <div className=\"flex items-center space-x-3\">\r\n                            <div className=\"w-8 h-8 bg-primary/10 rounded-full flex items-center justify-center\">\r\n                              <Icon name=\"User\" size={14} className=\"text-primary\" />\r\n                            </div>\r\n                            <span className=\"font-medium text-text-primary\">\r\n                              {reinscription.studentName}\r\n                            </span>\r\n                          </div>\r\n                        </td>\r\n                        <td className=\"px-4 py-3 text-text-secondary\">\r\n                          {reinscription.parentName}\r\n                        </td>\r\n                        <td className=\"px-4 py-3 text-text-secondary\">\r\n                          {reinscription.currentClass ? `${reinscription.currentClass} ‚Üí ${reinscription.requestedClass}` : reinscription.requestedClass}\r\n                        </td>\r\n                        <td className=\"px-4 py-3\">\r\n                          {getStatusBadge(reinscription.status)}\r\n                        </td>\r\n                        <td className=\"px-4 py-3\">\r\n                          <div className=\"flex items-center space-x-2\">\r\n                            {reinscription.status === 'en_attente' && (\r\n                              <Button \r\n                                variant=\"outline\" \r\n                                size=\"sm\"\r\n                                onClick={() => handleStatusUpdate(reinscription.id, 'confirme')}\r\n                              >\r\n                                <Icon name=\"Check\" size={14} className=\"mr-1\" />\r\n                                Confirmer\r\n                              </Button>\r\n                            )}\r\n                            <Button variant=\"ghost\" size=\"sm\">\r\n                              <Icon name=\"Eye\" size={14} />\r\n                            </Button>\r\n                          </div>\r\n                        </td>\r\n                      </tr>\r\n                    ))\r\n                  )}\r\n                </tbody>\r\n              </table>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Section Nouvelles Inscriptions */}\r\n      {activeSection === 'nouvelles' && (\r\n        <div className=\"space-y-6\">\r\n          <div className=\"flex items-center justify-between\">\r\n            <h3 className=\"font-heading font-heading-semibold text-lg text-text-primary\">\r\n              Nouvelles Inscriptions\r\n            </h3>\r\n            <Button>\r\n              <Icon name=\"Send\" size={16} className=\"mr-2\" />\r\n              Soumettre au Principal\r\n            </Button>\r\n          </div>\r\n\r\n          <div className=\"bg-card rounded-lg border border-border overflow-hidden\">\r\n            <div className=\"overflow-x-auto\">\r\n              <table className=\"w-full\">\r\n                <thead className=\"bg-muted/30\">\r\n                  <tr>\r\n                    <th className=\"px-4 py-3 text-left text-xs font-medium text-text-secondary uppercase tracking-wider\">\r\n                      √âl√®ve\r\n                    </th>\r\n                    <th className=\"px-4 py-3 text-left text-xs font-medium text-text-secondary uppercase tracking-wider\">\r\n                      Parent\r\n                    </th>\r\n                    <th className=\"px-4 py-3 text-left text-xs font-medium text-text-secondary uppercase tracking-wider\">\r\n                      Classe demand√©e\r\n                    </th>\r\n                    <th className=\"px-4 py-3 text-left text-xs font-medium text-text-secondary uppercase tracking-wider\">\r\n                      Statut\r\n                    </th>\r\n                    <th className=\"px-4 py-3 text-left text-xs font-medium text-text-secondary uppercase tracking-wider\">\r\n                      Actions\r\n                    </th>\r\n                  </tr>\r\n                </thead>\r\n                <tbody className=\"divide-y divide-border\">\r\n                  {newInscriptions.length === 0 ? (\r\n                    <tr>\r\n                      <td colSpan=\"5\" className=\"px-4 py-8 text-center text-text-secondary\">\r\n                        <div className=\"flex flex-col items-center space-y-2\">\r\n                          <Icon name=\"UserPlus\" size={24} className=\"text-muted-foreground\" />\r\n                          <span>Aucune nouvelle inscription en cours</span>\r\n                        </div>\r\n                      </td>\r\n                    </tr>\r\n                  ) : (\r\n                    newInscriptions.map((inscription) => (\r\n                      <tr key={inscription.id} className=\"hover:bg-muted/20\">\r\n                        <td className=\"px-4 py-3\">\r\n                          <div className=\"flex items-center space-x-3\">\r\n                            <div className=\"w-8 h-8 bg-success/10 rounded-full flex items-center justify-center\">\r\n                              <Icon name=\"UserPlus\" size={14} className=\"text-success\" />\r\n                            </div>\r\n                            <div>\r\n                              <span className=\"font-medium text-text-primary\">\r\n                                {inscription.studentName}\r\n                              </span>\r\n                              {inscription.birthDate && (\r\n                                <p className=\"text-xs text-text-secondary\">\r\n                                  N√©(e) le {inscription.birthDate}\r\n                                </p>\r\n                              )}\r\n                            </div>\r\n                          </div>\r\n                        </td>\r\n                        <td className=\"px-4 py-3\">\r\n                          <div>\r\n                            <div className=\"text-text-primary\">{inscription.parentName}</div>\r\n                            {inscription.parentPhone && (\r\n                              <div className=\"text-xs text-text-secondary\">{inscription.parentPhone}</div>\r\n                            )}\r\n                            {inscription.parentEmail && (\r\n                              <div className=\"text-xs text-text-secondary\">{inscription.parentEmail}</div>\r\n                            )}\r\n                          </div>\r\n                        </td>\r\n                        <td className=\"px-4 py-3\">\r\n                          <span className=\"px-2 py-1 bg-primary/10 text-primary rounded text-sm\">\r\n                            {inscription.requestedClass}\r\n                          </span>\r\n                          {inscription.previousSchool && (\r\n                            <p className=\"text-xs text-text-secondary mt-1\">\r\n                              De: {inscription.previousSchool}\r\n                            </p>\r\n                          )}\r\n                        </td>\r\n                        <td className=\"px-4 py-3\">\r\n                          {getStatusBadge(inscription.status)}\r\n                        </td>\r\n                        <td className=\"px-4 py-3\">\r\n                          <div className=\"flex items-center space-x-2\">\r\n                            {inscription.status === 'soumis' && (\r\n                              <Button \r\n                                variant=\"outline\" \r\n                                size=\"sm\"\r\n                                onClick={() => handleStatusUpdate(inscription.id, 'accepte')}\r\n                              >\r\n                                <Icon name=\"Check\" size={14} className=\"mr-1\" />\r\n                                Accepter\r\n                              </Button>\r\n                            )}\r\n                            <Button variant=\"ghost\" size=\"sm\">\r\n                              <Icon name=\"Eye\" size={14} />\r\n                            </Button>\r\n                          </div>\r\n                        </td>\r\n                      </tr>\r\n                    ))\r\n                  )}\r\n                </tbody>\r\n              </table>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Section Passages de classe */}\r\n      {activeSection === 'passages' && (\r\n        <div className=\"space-y-6\">\r\n          <div className=\"flex items-center justify-between\">\r\n            <h3 className=\"font-heading font-heading-semibold text-lg text-text-primary\">\r\n              Pr√©paration Passages de Classe\r\n            </h3>\r\n            <div className=\"text-sm text-text-secondary\">\r\n              En attente de validation du Principal\r\n            </div>\r\n          </div>\r\n\r\n          {Object.entries(studentsData).length === 0 ? (\r\n            <div className=\"bg-card rounded-lg border border-border p-8 text-center\">\r\n              <Icon name=\"Users\" size={32} className=\"text-muted-foreground mx-auto mb-4\" />\r\n              <h4 className=\"font-heading font-heading-medium text-base text-text-primary mb-2\">\r\n                Aucun √©tudiant trouv√©\r\n              </h4>\r\n              <p className=\"text-text-secondary\">\r\n                Les passages de classe seront pr√©par√©s une fois que les √©tudiants seront ajout√©s au syst√®me.\r\n              </p>\r\n            </div>\r\n          ) : (\r\n            Object.entries(studentsData).map(([classe, students]) => (\r\n              <div key={classe} className=\"bg-card rounded-lg border border-border p-4\">\r\n                <h4 className=\"font-heading font-heading-medium text-base text-text-primary mb-4\">\r\n                  Classe {classe.toUpperCase()} - {students.length} √©l√®ve{students.length > 1 ? 's' : ''}\r\n                </h4>\r\n                <div className=\"space-y-3\">\r\n                  {students.map((student) => (\r\n                    <div key={student.id} className=\"flex items-center justify-between p-3 bg-background rounded-lg\">\r\n                      <div className=\"flex items-center space-x-3\">\r\n                        <div className=\"w-8 h-8 bg-primary/10 rounded-full flex items-center justify-center\">\r\n                          <Icon name=\"User\" size={14} className=\"text-primary\" />\r\n                        </div>\r\n                        <span className=\"font-medium text-text-primary\">\r\n                          {student.name}\r\n                        </span>\r\n                      </div>\r\n                      <div className=\"flex items-center space-x-3\">\r\n                        <span className=\"text-sm text-text-secondary\">\r\n                          ‚Üí {student.nextClass}\r\n                        </span>\r\n                        {getStatusBadge(student.status)}\r\n                      </div>\r\n                    </div>\r\n                  ))}\r\n                </div>\r\n              </div>\r\n            ))\r\n          )}\r\n        </div>\r\n      )}\r\n\r\n      {/* Section Pr√©paration */}\r\n      {activeSection === 'preparation' && (\r\n        <div className=\"space-y-6\">\r\n          <h3 className=\"font-heading font-heading-semibold text-lg text-text-primary\">\r\n            Pr√©paration Ann√©e {nextSchoolYear}\r\n          </h3>\r\n\r\n          <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\r\n            <div className=\"bg-card rounded-lg border border-border p-4\">\r\n              <h4 className=\"font-heading font-heading-medium text-base text-text-primary mb-4\">\r\n                Documents √† pr√©parer\r\n              </h4>\r\n              <div className=\"space-y-3\">\r\n                {[\r\n                  'Listes de classe provisoires',\r\n                  'Certificats de scolarit√©',\r\n                  'Attestations de fin d\\'ann√©e',\r\n                  'Dossiers de passage'\r\n                ].map((doc, index) => (\r\n                  <div key={index} className=\"flex items-center space-x-3\">\r\n                    <Icon name=\"FileText\" size={16} className=\"text-muted-foreground\" />\r\n                    <span className=\"text-sm text-text-secondary\">{doc}</span>\r\n                  </div>\r\n                ))}\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"bg-card rounded-lg border border-border p-4\">\r\n              <h4 className=\"font-heading font-heading-medium text-base text-text-primary mb-4\">\r\n                Prochaines √©tapes\r\n              </h4>\r\n              <div className=\"space-y-3\">\r\n                {[\r\n                  { \r\n                    text: 'Finaliser les r√©inscriptions', \r\n                    completed: statistics.approvedRequests > 0,\r\n                    count: statistics.approvedRequests \r\n                  },\r\n                  { \r\n                    text: 'Traiter nouvelles inscriptions', \r\n                    completed: statistics.newInscriptions > 0,\r\n                    count: statistics.newInscriptions \r\n                  },\r\n                  { \r\n                    text: 'Soumettre au Principal', \r\n                    completed: false,\r\n                    count: statistics.totalRequests \r\n                  },\r\n                  { \r\n                    text: 'Attendre la validation', \r\n                    completed: false,\r\n                    count: 0 \r\n                  }\r\n                ].map((etape, index) => (\r\n                  <div key={index} className=\"flex items-center justify-between\">\r\n                    <div className=\"flex items-center space-x-3\">\r\n                      <div className={`w-4 h-4 rounded-full flex items-center justify-center ${\r\n                        etape.completed ? 'bg-success' : 'bg-muted'\r\n                      }`}>\r\n                        {etape.completed ? (\r\n                          <Icon name=\"Check\" size={10} className=\"text-white\" />\r\n                        ) : (\r\n                          <span className=\"text-xs font-medium text-muted-foreground\">{index + 1}</span>\r\n                        )}\r\n                      </div>\r\n                      <span className={`text-sm ${etape.completed ? 'text-text-primary' : 'text-text-secondary'}`}>\r\n                        {etape.text}\r\n                      </span>\r\n                    </div>\r\n                    {etape.count > 0 && (\r\n                      <span className=\"text-xs bg-primary/10 text-primary px-2 py-1 rounded\">\r\n                        {etape.count}\r\n                      </span>\r\n                    )}\r\n                  </div>\r\n                ))}\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default SchoolYearTab;","import React, { useState, useEffect } from 'react';\nimport { useSearchParams } from 'react-router-dom';\nimport { supabase } from '../../lib/supabase';\nimport Header from '../../components/ui/Header';\nimport Sidebar from '../../components/ui/Sidebar';\nimport Icon from '../../components/AppIcon';\nimport Button from '../../components/ui/Button';\nimport { useAuth } from '../../contexts/AuthContext';\n\n// Import all tab components\nimport StudentManagementTab from './components/StudentManagementTab';\nimport TeacherManagementTab from './components/TeacherManagementTab';\nimport StudentCardTab from './components/StudentCardTab';\nimport JustificationTab from './components/JustificationTab';\nimport PaymentTab from './components/PaymentTab';\nimport NotificationCenter from './components/NotificationCenter';\nimport TransferWorkflow from './components/TransferWorkflow';\nimport DocumentsTab from './components/DocumentsTab';\nimport PlanningTab from './components/PlanningTab';\nimport TasksTab from './components/TasksTab';\nimport SchoolYearTab from './components/SchoolYearTab';\n\nconst SecretaryDashboard = () => {\n  const [searchParams] = useSearchParams();\n  const [activeTab, setActiveTab] = useState('tasks');\n  const [isSidebarCollapsed, setIsSidebarCollapsed] = useState(false);\n  \n  // R√©cup√©rer les informations de l'utilisateur connect√©\n  const { user } = useAuth();\n  const [secretaryName, setSecretaryName] = useState('');\n  const [stats, setStats] = useState({\n    totalStudents: 0,\n    pendingJustifications: 0,\n    latePayments: 0,\n    urgentCalls: 0\n  });\n  const [loadingStats, setLoadingStats] = useState(true);\n\n  // D√©terminer si on est en mode d√©mo et charger le nom de la secr√©taire\n  useEffect(() => {\n    const loadUserData = async () => {\n      try {\n        // 1. D'abord, r√©cup√©rer l'utilisateur authentifi√© depuis Supabase\n        const { data: { user: authUser } } = await supabase.auth.getUser();\n        \n        if (authUser) {\n          console.log('üîê Utilisateur Supabase Auth:', authUser.email, 'ID:', authUser.id);\n          \n          // 2. R√©cup√©rer les donn√©es compl√®tes depuis la table users\n          const { data: userData, error } = await supabase\n            .from('users')\n            .select(`\n              id,\n              email,\n              full_name,\n              role,\n              current_school_id,\n              school:schools!users_current_school_id_fkey(id, name)\n            `)\n            .eq('id', authUser.id)\n            .single();\n            \n          if (error) {\n            console.error('‚ùå Erreur chargement donn√©es utilisateur:', error);\n            // Fallback sur localStorage si erreur Supabase\n            loadFromLocalStorage();\n            return;\n          }\n          \n          console.log('‚úÖ Donn√©es utilisateur depuis Supabase:', userData);\n          console.log('üéØ EMAIL ATTENDU: pensezy.si@gmail.com');\n          console.log('üìß EMAIL TROUV√â:', userData.email);\n          console.log('üë§ R√îLE ATTENDU: secretary');  \n          console.log('üé≠ R√îLE TROUV√â:', userData.role);\n          \n          // 3. V√âRIFICATION CRITIQUE : Est-ce bien le bon compte ?\n          if (userData.email !== 'pensezy.si@gmail.com') {\n            console.error('‚ùå PROBL√àME MAJEUR: Mauvais utilisateur connect√© !');\n            console.error('   Attendu: pensezy.si@gmail.com');\n            console.error('   Trouv√©:', userData.email);\n            console.error('   üîí D√âCONNEXION REQUISE');\n            \n            // Forcer la d√©connexion car mauvais compte\n            await supabase.auth.signOut();\n            localStorage.removeItem('edutrack-user');\n            window.location.href = '/staff-login';\n            return;\n          }\n          \n          // 4. V√©rifier que c'est bien un compte secr√©taire\n          if (userData.role !== 'secretary') {\n            console.error('‚ùå R√îLE INCORRECT:', userData.role, 'au lieu de secretary');\n          }\n          \n          // 5. Debug: Lister tous les secr√©taires pour voir s'il en existe\n          console.log('üîç Liste de tous les secr√©taires dans la base:');\n          const { data: allSecretaries, error: secError } = await supabase\n            .from('secretaries')\n            .select('id, first_name, last_name, user_id, users:user_id(email, role)')\n            .order('id');\n            \n          console.log('üìã Secr√©taires trouv√©s:', allSecretaries);\n          if (secError) console.error('‚ùå Erreur liste secr√©taires:', secError);\n          \n          // 6. Debug: Lister tous les utilisateurs pour voir les emails\n          const { data: allUsers, error: usersError } = await supabase\n            .from('users')\n            .select('id, email, role, full_name')\n            .order('email');\n            \n          console.log('üìã Tous les utilisateurs:', allUsers);\n          if (usersError) console.error('‚ùå Erreur liste utilisateurs:', usersError);\n\n          // 4. Charger le nom complet depuis la table secretaries\n          if (userData.id) {\n            console.log('üîç Recherche secr√©taire avec user_id:', userData.id);\n            \n            const { data: secretaryData, error: secretaryError } = await supabase\n              .from('secretaries')\n              .select('first_name, last_name, id')\n              .eq('user_id', userData.id)\n              .single();\n\n            console.log('üìä R√©sultat requ√™te secretaries:', { secretaryData, error: secretaryError });\n\n            if (secretaryData && !secretaryError) {\n              const fullName = `${secretaryData.first_name} ${secretaryData.last_name}`;\n              setSecretaryName(fullName);\n              console.log('üë§ Nom secr√©taire trouv√©:', fullName);\n            } else {\n              // Fallback sur userData de la table users\n              const fullName = userData.full_name || userData.email;\n              setSecretaryName(fullName);\n              console.log('ÔøΩ Nom depuis users:', fullName);\n            }\n          }\n        } else {\n          console.log('‚ùå Aucun utilisateur authentifi√©, fallback localStorage');\n          loadFromLocalStorage();\n        }\n      } catch (error) {\n        console.error('‚ùå Erreur loadUserData:', error);\n        loadFromLocalStorage();\n      }\n    };\n\n    const loadFromLocalStorage = () => {\n      const savedUser = localStorage.getItem('edutrack-user');\n      if (savedUser) {\n        try {\n          const userData = JSON.parse(savedUser);\n          console.log('‚úÖ Mode PRODUCTION (localStorage):', userData.school_name || '√âcole', '- R√¥le:', userData.role);\n          setSecretaryName(userData.full_name || userData.email || 'Secr√©taire');\n        } catch (e) {\n          console.error('Erreur lecture session:', e);\n          setSecretaryName('Secr√©taire');\n        }\n      }\n    };\n\n    loadUserData();\n  }, [user]);\n\n  // Charger les statistiques r√©elles depuis Supabase\n  useEffect(() => {\n    const loadStats = async () => {\n      try {\n        setLoadingStats(true);\n        const savedUser = localStorage.getItem('edutrack-user');\n        const userData = savedUser ? JSON.parse(savedUser) : null;\n        const schoolId = userData?.current_school_id;\n\n        if (!schoolId) {\n          console.warn('‚ö†Ô∏è Pas d\\'√©cole associ√©e');\n          setLoadingStats(false);\n          return;\n        }\n\n        // Compter les √©l√®ves\n        const { count: studentCount, error: studentError } = await supabase\n          .from('students')\n          .select('*', { count: 'exact', head: true })\n          .eq('school_id', schoolId)\n          .eq('is_active', true);\n\n        if (studentError) {\n          console.error('Erreur chargement √©l√®ves:', studentError);\n        }\n\n        setStats({\n          totalStudents: studentCount || 0,\n          pendingJustifications: 0, // √Ä impl√©menter quand table existe\n          latePayments: 0, // √Ä impl√©menter quand table existe\n          urgentCalls: 0 // √Ä impl√©menter quand table existe\n        });\n\n      } catch (error) {\n        console.error('Erreur chargement statistiques:', error);\n      } finally {\n        setLoadingStats(false);\n      }\n    };\n\n    loadStats();\n  }, []);\n\n  // G√©rer la navigation via les param√®tres URL\n  useEffect(() => {\n    const tabParam = searchParams.get('tab');\n    const validTabs = ['students', 'teachers', 'cards', 'justifications', 'payments', 'communications', 'transfers', 'documents', 'planning', 'tasks', 'schoolyear'];\n    if (tabParam && validTabs.includes(tabParam)) {\n      setActiveTab(tabParam);\n    }\n  }, [searchParams]);\n\n  const tabs = [\n    {\n      id: 'tasks',\n      label: 'T√¢ches',\n      icon: 'CheckSquare',\n      component: TasksTab,\n      description: 'Actions du jour'\n    },\n    {\n      id: 'students',\n      label: '√âl√®ves',\n      icon: 'Users',\n      component: StudentManagementTab,\n      description: 'Inscriptions'\n    },\n    {\n      id: 'teachers',\n      label: 'Enseignants',\n      icon: 'GraduationCap',\n      component: TeacherManagementTab,\n      description: 'Comptes prof'\n    },\n    {\n      id: 'cards',\n      label: 'Cartes',\n      icon: 'CreditCard',\n      component: StudentCardTab,\n      description: 'Cartes scolaires'\n    },\n    {\n      id: 'justifications',\n      label: 'Absences',\n      icon: 'FileCheck',\n      component: JustificationTab,\n      description: 'Justificatifs'\n    },\n    {\n      id: 'payments',\n      label: 'Paiements',\n      icon: 'Banknote',\n      component: PaymentTab,\n      description: 'Frais scolaires'\n    },\n    {\n      id: 'planning',\n      label: 'Planning',\n      icon: 'Calendar',\n      component: PlanningTab,\n      description: 'Rendez-vous'\n    },\n    {\n      id: 'schoolyear',\n      label: 'Ann√©e Scolaire',\n      icon: 'RotateCcw',\n      component: SchoolYearTab,\n      description: 'Transition d\\'ann√©e'\n    },\n    {\n      id: 'communications',\n      label: 'Communication',\n      icon: 'MessageCircle',\n      component: NotificationCenter,\n      description: 'SMS & emails'\n    }\n  ];\n\n  const secondaryTabs = [\n    {\n      id: 'documents',\n      label: 'Documents',\n      icon: 'FileText',\n      component: DocumentsTab,\n      description: 'Certificats'\n    },\n    {\n      id: 'transfers',\n      label: 'Transferts',\n      icon: 'ArrowRightLeft',\n      component: TransferWorkflow,\n      description: 'Changements d\\'√©cole'\n    }\n  ];\n\n  const allTabs = [...tabs, ...secondaryTabs];\n  const currentTab = allTabs?.find(tab => tab?.id === activeTab);\n  const ActiveComponent = currentTab?.component;\n\n  const quickStats = [\n    {\n      label: '√âl√®ves inscrits',\n      value: loadingStats ? '...' : stats.totalStudents.toString(),\n      icon: 'Users',\n      color: 'text-success',\n      bgColor: 'bg-success/10'\n    },\n    {\n      label: 'Justificatifs en attente',\n      value: loadingStats ? '...' : stats.pendingJustifications.toString(),\n      icon: 'FileText',\n      color: 'text-warning',\n      bgColor: 'bg-warning/10'\n    },\n    {\n      label: 'Paiements en retard',\n      value: loadingStats ? '...' : stats.latePayments.toString(),\n      icon: 'CreditCard',\n      color: 'text-error',\n      bgColor: 'bg-error/10'\n    },\n    {\n      label: 'Appels parents urgents',\n      value: loadingStats ? '...' : stats.urgentCalls.toString(),\n      icon: 'Phone',\n      color: 'text-primary',\n      bgColor: 'bg-primary/10'\n    }\n  ];\n\n  return (\n    <div className=\"min-h-screen bg-gradient-to-br from-gray-50 via-blue-50/30 to-indigo-50/30\">\n      {/* Header */}\n      <Header \n        userRole={user?.role || \"secretary\"} \n        userName={secretaryName || user?.full_name || user?.name || \"Secr√©taire\"}\n        onToggleSidebar={() => setIsSidebarCollapsed(!isSidebarCollapsed)}\n      />\n      {/* Sidebar */}\n      <Sidebar \n        userRole={user?.role || \"secretary\"}\n        isCollapsed={isSidebarCollapsed}\n        onToggle={() => setIsSidebarCollapsed(!isSidebarCollapsed)}\n      />\n      {/* Main Content */}\n      <main className={`pt-20 sm:pt-16 transition-all duration-state ${\n        isSidebarCollapsed ? 'lg:ml-16' : 'lg:ml-64'\n      }`}>\n        <div className=\"px-2 sm:px-4 lg:px-6 py-2 sm:py-3 space-y-2 sm:space-y-3 w-full overflow-x-hidden\">\n          {/* Dashboard Header - Ultra Compact */}\n          <div className=\"mb-4\">\n            <div className=\"bg-gradient-to-r from-blue-600 via-indigo-600 to-purple-600 rounded-xl shadow-lg p-4 text-white\">\n              <div className=\"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-3\">\n                <div>\n                  <div className=\"inline-flex items-center px-2 py-0.5 bg-white/20 backdrop-blur-sm rounded-full text-xs font-medium mb-2\">\n                    <span className=\"w-1.5 h-1.5 bg-green-400 rounded-full mr-1.5 animate-pulse\"></span>\n                    En ligne\n                  </div>\n                  <h1 className=\"font-heading font-heading-bold text-2xl mb-1\">\n                    Bienvenue, {secretaryName || 'Secr√©taire'} üëã\n                  </h1>\n                  <p className=\"font-body font-body-normal text-blue-100 text-sm\">\n                    Tableau de Bord Secr√©tariat - Gestion administrative compl√®te\n                  </p>\n                </div>\n                <div className=\"flex items-center space-x-3\">\n                  <div className=\"text-right bg-white/10 backdrop-blur-sm rounded-lg p-3 border border-white/20\">\n                    <p className=\"font-body font-body-semibold text-xs mb-0.5\">\n                      {new Date()?.toLocaleDateString('fr-FR', { \n                        weekday: 'long', \n                        year: 'numeric', \n                        month: 'long', \n                        day: 'numeric' \n                      })}\n                    </p>\n                    <p className=\"font-caption font-caption-normal text-xs text-blue-200 flex items-center justify-end\">\n                      <Icon name=\"Calendar\" size={12} className=\"mr-1\" />\n                      Ann√©e scolaire 2025-2026\n                    </p>\n                  </div>\n                </div>\n              </div>\n            </div>\n          </div>\n\n          {/* Quick Stats - Modernis√©es avec gradients */}\n          <div className=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3 sm:gap-4 mb-4 sm:mb-6\">\n            {quickStats?.map((stat, index) => {\n              const gradientColors = [\n                'from-blue-50 to-indigo-50 border-blue-200',\n                'from-green-50 to-emerald-50 border-green-200',\n                'from-amber-50 to-orange-50 border-amber-200',\n                'from-purple-50 to-pink-50 border-purple-200'\n              ];\n              const iconGradients = [\n                'from-blue-600 to-indigo-600',\n                'from-green-600 to-emerald-600',\n                'from-amber-500 to-orange-500',\n                'from-purple-600 to-pink-600'\n              ];\n              const textColors = [\n                'text-blue-900',\n                'text-green-900',\n                'text-amber-900',\n                'text-purple-900'\n              ];\n              const subtitleColors = [\n                'text-blue-700',\n                'text-green-700',\n                'text-amber-700',\n                'text-purple-700'\n              ];\n              \n              return (\n                <div \n                  key={index} \n                  className={`group bg-gradient-to-br ${gradientColors[index]} border-2 rounded-2xl p-3 sm:p-4 lg:p-5 hover:shadow-xl hover:scale-105 transition-all duration-300 shadow-lg`}\n                >\n                  <div className=\"flex items-center justify-between mb-2 sm:mb-3\">\n                    <div className={`w-10 h-10 sm:w-12 sm:h-12 lg:w-14 lg:h-14 bg-gradient-to-br ${iconGradients[index]} rounded-xl flex items-center justify-center group-hover:scale-110 transition-transform duration-300 shadow-md`}>\n                      <Icon name={stat?.icon} size={18} className=\"text-white\" />\n                    </div>\n                  </div>\n                  <div>\n                    <p className={`text-xl sm:text-2xl lg:text-3xl font-bold ${textColors[index]} mb-1`}>\n                      {stat?.value}\n                    </p>\n                    <p className={`text-xs sm:text-sm font-semibold ${subtitleColors[index]}`}>\n                      {stat?.label}\n                    </p>\n                  </div>\n                </div>\n              );\n            })}\n          </div>\n\n          {/* Tab Navigation - Modernis√© & Sticky */}\n          <div className=\"sticky top-16 z-40 bg-white rounded-2xl shadow-xl border-2 border-gray-200 mb-6 backdrop-blur-xl bg-white/95\">\n            {/* Desktop Tab Navigation - Compact Grid */}\n            <div className=\"hidden lg:block p-4\">\n              <div className=\"flex items-center mb-3\">\n                <div className=\"w-1 h-6 bg-gradient-to-b from-blue-600 to-indigo-600 rounded-full mr-2\"></div>\n                <h2 className=\"font-heading font-heading-bold text-base text-text-primary\">\n                  Modules de Gestion\n                </h2>\n              </div>\n\n              {/* Main Tabs - Compact Grid */}\n              <div className=\"grid grid-cols-2 lg:grid-cols-4 gap-3 mb-4\">\n                {tabs?.map((tab) => (\n                  <button\n                    key={tab?.id}\n                    onClick={() => setActiveTab(tab?.id)}\n                    className={`group relative overflow-hidden rounded-xl p-3 transition-all duration-300 ${\n                      activeTab === tab?.id\n                        ? 'bg-gradient-to-br from-blue-600 to-indigo-600 text-white shadow-lg'\n                        : 'bg-gray-50 hover:bg-gray-100 border border-gray-200 hover:border-blue-300 hover:shadow-md'\n                    }`}\n                  >\n                    {/* Badge notification */}\n                    {tab?.badge && (\n                      <span className={`absolute top-2 right-2 w-5 h-5 flex items-center justify-center text-xs font-bold rounded-full ${\n                        activeTab === tab?.id \n                          ? 'bg-white text-blue-600 shadow-sm' \n                          : 'bg-red-500 text-white'\n                      }`}>\n                        {tab?.badge}\n                      </span>\n                    )}\n                    \n                    <div className=\"flex items-center space-x-3\">\n                      <div className={`w-10 h-10 rounded-lg flex items-center justify-center transition-all duration-300 flex-shrink-0 ${\n                        activeTab === tab?.id\n                          ? 'bg-white/20 backdrop-blur-sm'\n                          : 'bg-white group-hover:bg-blue-50 shadow-sm'\n                      }`}>\n                        <Icon \n                          name={tab?.icon} \n                          size={20} \n                          className={activeTab === tab?.id ? 'text-white' : 'text-blue-600'}\n                        />\n                      </div>\n                      <div className=\"text-left flex-1 min-w-0\">\n                        <p className={`font-body font-body-semibold text-sm truncate ${\n                          activeTab === tab?.id ? 'text-white' : 'text-text-primary'\n                        }`}>\n                          {tab?.label}\n                        </p>\n                        <p className={`font-caption font-caption-normal text-xs truncate ${\n                          activeTab === tab?.id ? 'text-blue-100' : 'text-text-secondary'\n                        }`}>\n                          {tab?.description}\n                        </p>\n                      </div>\n                    </div>\n\n                    {/* Active indicator */}\n                    {activeTab === tab?.id && (\n                      <div className=\"absolute bottom-0 left-0 right-0 h-1 bg-white rounded-full\"></div>\n                    )}\n                  </button>\n                ))}\n              </div>\n              \n              {/* Secondary Tabs - Compact Pills */}\n              <div className=\"flex flex-wrap gap-2 pt-3 border-t border-gray-200\">\n                <span className=\"text-xs font-medium text-text-secondary px-2 py-1 flex items-center\">\n                  <Icon name=\"Grid\" size={14} className=\"mr-1\" />\n                  Autres modules :\n                </span>\n                {secondaryTabs?.map((tab) => (\n                  <button\n                    key={tab?.id}\n                    onClick={() => setActiveTab(tab?.id)}\n                    className={`flex items-center space-x-2 px-4 py-2 rounded-full text-sm transition-all duration-300 ${\n                      activeTab === tab?.id\n                        ? 'bg-gradient-to-r from-blue-600 to-indigo-600 text-white shadow-md' \n                        : 'bg-gray-100 hover:bg-gray-200 text-text-secondary hover:text-text-primary border border-gray-300 hover:border-blue-400'\n                    }`}\n                  >\n                    <Icon name={tab?.icon} size={16} />\n                    <span className=\"font-body font-body-medium\">{tab?.label}</span>\n                  </button>\n                ))}\n              </div>\n            </div>\n\n            {/* Mobile Tab Navigation - Modernis√© */}\n            <div className=\"lg:hidden p-4\">\n              <div className=\"relative\">\n                <div className=\"absolute left-4 top-1/2 transform -translate-y-1/2 pointer-events-none\">\n                  <Icon name=\"Layers\" size={18} className=\"text-blue-600\" />\n                </div>\n                <select\n                  value={activeTab}\n                  onChange={(e) => setActiveTab(e?.target?.value)}\n                  className=\"w-full appearance-none bg-gradient-to-r from-blue-50 to-indigo-50 border-2 border-blue-200 rounded-xl pl-12 pr-10 py-3 font-body font-body-semibold text-sm text-text-primary focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all\"\n                >\n                  <optgroup label=\"üìã Fonctions principales\">\n                    {tabs?.map((tab) => (\n                      <option key={tab?.id} value={tab?.id}>\n                        {tab?.label} - {tab?.description}\n                      </option>\n                    ))}\n                  </optgroup>\n                  <optgroup label=\"‚öôÔ∏è Autres fonctions\">\n                    {secondaryTabs?.map((tab) => (\n                      <option key={tab?.id} value={tab?.id}>\n                        {tab?.label} - {tab?.description}\n                      </option>\n                    ))}\n                  </optgroup>\n                </select>\n                <div className=\"absolute right-4 top-1/2 transform -translate-y-1/2 pointer-events-none\">\n                  <Icon name=\"ChevronDown\" size={18} className=\"text-blue-600\" />\n                </div>\n              </div>\n            </div>\n\n            {/* Tab Content */}\n            <div className=\"p-6 animate-fadeIn\">\n              {ActiveComponent && <ActiveComponent />}\n            </div>\n          </div>\n\n          {/* Quick Actions Footer - Modernis√© */}\n          <div className=\"bg-gradient-to-br from-amber-50 via-orange-50 to-red-50 rounded-2xl border-2 border-amber-300 p-6 shadow-lg hover:shadow-xl transition-shadow\">\n            <div className=\"flex items-center mb-6\">\n              <div className=\"w-12 h-12 bg-gradient-to-br from-amber-500 to-orange-500 rounded-xl flex items-center justify-center mr-3 shadow-md\">\n                <Icon name=\"Zap\" size={24} className=\"text-white\" />\n              </div>\n              <div>\n                <h3 className=\"text-lg font-semibold text-amber-900\">\n                  Actions Rapides\n                </h3>\n                <p className=\"text-xs text-amber-700\">Raccourcis pour vos t√¢ches courantes</p>\n              </div>\n            </div>\n            <div className=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4\">\n              <Button\n                variant=\"outline\"\n                iconName=\"CheckSquare\"\n                iconPosition=\"left\"\n                onClick={() => setActiveTab('tasks')}\n                className=\"justify-start bg-white hover:bg-gradient-to-r hover:from-green-50 hover:to-emerald-50 border-2 border-green-200 hover:border-green-400 hover:shadow-lg hover:scale-105 transition-all duration-300 py-6 group rounded-xl\"\n              >\n                <span className=\"font-semibold group-hover:text-green-700\">\n                  Mes t√¢ches du jour\n                </span>\n              </Button>\n              <Button\n                variant=\"outline\"\n                iconName=\"Phone\"\n                iconPosition=\"left\"\n                onClick={() => setActiveTab('justifications')}\n                className=\"justify-start bg-white hover:bg-gradient-to-r hover:from-blue-50 hover:to-indigo-50 border-2 border-blue-200 hover:border-blue-400 hover:shadow-lg hover:scale-105 transition-all duration-300 py-6 group rounded-xl\"\n              >\n                <span className=\"font-semibold group-hover:text-blue-700\">\n                  Appels parents urgents\n                </span>\n              </Button>\n              <Button\n                variant=\"outline\"\n                iconName=\"Calendar\"\n                iconPosition=\"left\"\n                onClick={() => setActiveTab('planning')}\n                className=\"justify-start bg-white hover:bg-gradient-to-r hover:from-purple-50 hover:to-pink-50 border-2 border-purple-200 hover:border-purple-400 hover:shadow-lg hover:scale-105 transition-all duration-300 py-6 group rounded-xl\"\n              >\n                <span className=\"font-semibold group-hover:text-purple-700\">\n                  Planning rendez-vous\n                </span>\n              </Button>\n              <Button\n                variant=\"outline\"\n                iconName=\"FileText\"\n                iconPosition=\"left\"\n                onClick={() => setActiveTab('documents')}\n                className=\"justify-start bg-white hover:bg-gradient-to-r hover:from-orange-50 hover:to-red-50 border-2 border-orange-200 hover:border-orange-400 hover:shadow-lg hover:scale-105 transition-all duration-300 py-6 group rounded-xl\"\n              >\n                <span className=\"font-semibold group-hover:text-orange-700\">\n                  Certificats √† imprimer\n                </span>\n              </Button>\n            </div>\n          </div>\n        </div>\n      </main>\n    </div>\n  );\n};\n\nexport default SecretaryDashboard;"],"names":["parentMultiSchoolService","term","searchLower","parents","error","supabase","parent","students","studentsError","relations","student","email","phone","query","conditions","ParentSearchSelector","onParentSelect","onCreateNew","selectedParent","searchTerm","onSearchChange","searchResults","setSearchResults","useState","loading","setLoading","showResults","setShowResults","useEffect","searchParents","results","checkForDuplicate","existing","jsxs","jsx","Input","e","Icon","relation","idx","Button","result","StudentManagementTab","setSearchTerm","filterClass","setFilterClass","filterStatus","setFilterStatus","showAddModal","setShowAddModal","showProfileModal","setShowProfileModal","showTransferModal","setShowTransferModal","selectedStudent","setSelectedStudent","currentSchool","setCurrentSchool","schoolClasses","setSchoolClasses","currentStep","setCurrentStep","inscriptionMode","setInscriptionMode","selectedExistingParent","setSelectedExistingParent","parentSearchTerm","setParentSearchTerm","familyData","setFamilyData","newStudent","setNewStudent","setStudents","loadSchoolData","loadStudents","savedUser","userData","schoolId","schoolData","schoolError","schoolClassesList","className","index","defaultClasses","getDefaultClassesBySchoolType","schoolType","studentsData","parentIds","s","id","parentsMap","parentsData","parentsError","acc","formattedStudents","parentInfo","classOptions","cls","statusOptions","generateSecurePassword","chars","password","i","generateLoginCredentials","firstName","lastName","type","clean","str","primaryLogin","secondaryLogin","customUsername","prefix","baseFirstName","baseLastName","random","generateUserId","number","nextStep","prevStep","resetWorkflow","addStudent","prev","removeStudent","_","generateAccountsData","cleanPhone","studentsWithAccounts","loginCreds","parentLoginCreds","parentPassword","parentUserId","getStatusBadge","status","statusConfig","config","filteredStudents","matchesSearch","_b","_a","_d","_c","_f","_e","matchesClass","matchesStatus","handleTransferStudent","studentId","handleViewProfile","handleAddStudent","handleUpdateStudentStatus","newStatus","handleConfirmTransfer","Select","Image","step","React","updatedStudents","value","TeacherSearchSelector","onTeacherSelect","selectedTeacher","allTeachers","setAllTeachers","isLoading","setIsLoading","teachers","formattedResults","teacher","handleSelectChange","selectedId","t","getSpecializationsBadges","specializations","spec","getAssignmentSummary","a","assignment","Checkbox","checked","indeterminate","disabled","required","label","description","size","props","ref","checkboxId","sizeClasses","cn","Check","Minus","CheckboxGroup","children","TeacherAssignmentManager","onAssignmentComplete","onCancel","availableClasses","setAvailableClasses","availableSubjects","setAvailableSubjects","showAddSubjectModal","setShowAddSubjectModal","newSubject","setNewSubject","assignmentData","setAssignmentData","hoursPerSubject","setHoursPerSubject","studentCountsByClass","formattedClasses","defaultSubjects","getDefaultSubjectsBySchoolType","customSubjects","name","allSubjectsMap","subject","allSubjects","subjectsByType","totalHours","hoursForThisSubject","handleSubjectChange","subjectName","isChecked","handleHoursChange","hours","numHours","handleClassChange","c","handleAddSubject","fetchError","updatedCustomSubjects","updateError","newSubjectObj","handleSubmit","teacherId","authData","authError","userError","teacherData","teacherError","academicYears","yearError","academicYearId","existingTeacher","checkError","newTeacherData","teacherCreateError","assignments","getHoursForSubject","data","getSelectedClassesInfo","selectedClasses","totalStudents","sum","classInfo","TeacherManagementTab","filterSubject","setFilterSubject","showEditModal","setShowEditModal","showDeleteModal","setShowDeleteModal","setSelectedTeacher","showMultiSchoolAssignment","setShowMultiSchoolAssignment","assignationMode","setAssignationMode","selectedExistingTeacher","setSelectedExistingTeacher","teacherSearchTerm","setTeacherSearchTerm","schoolSubjects","setSchoolSubjects","newTeacher","setNewTeacher","setTeachers","loadTeachers","assignError","allTeachersError","userIds","users","teachersWithoutAssignment","user","u","teacherIds","teachersError","teacherToUserMap","userMap","teacherMap","userId","weeklyHours","formattedTeachers","subjectOptions","resetMultiSchoolWorkflow","handleMultiSchoolAssignment","filteredTeachers","matchesSubject","handleEditTeacher","handleUpdateTeacher","validatePassword","handleDeleteTeacher","handleConfirmDelete","handleToggleStatus","toggleSubjectSelection","currentSubjects","toggleClassSelection","currentClasses","_g","tempTeacher","getCurrentSchoolId","cardService","studentIds","card","studentClasses","attendancesData","att","CardGenerationModal","isOpen","onClose","onCardGenerated","setStep","availableStudents","setAvailableStudents","isGenerating","setIsGenerating","setError","loadAvailableStudents","err","handleStudentSelect","handleGenerateCard","newCard","handleClose","handleBackToSearch","Fragment","StudentCardTab","selectedCards","setSelectedCards","showPreview","setShowPreview","previewCard","setPreviewCard","showGenerationModal","setShowGenerationModal","studentCards","setStudentCards","successMessage","setSuccessMessage","loadCards","cards","timer","filteredCards","handleCardGenerated","handleValidateCard","cardId","updatedCard","handlePrintCard","handleBulkPrint","updatedCards","handleRegenerateCard","handleBulkValidate","validatableCards","handlePreviewCard","toggleCardSelection","absenceService","notifications","notificationTypes","statuses","messages","numNotifications","notifDate","b","AbsenceJustificationModal","absence","onAbsenceUpdated","justificationReason","setJustificationReason","customReason","setCustomReason","documents","setDocuments","isSubmitting","setIsSubmitting","predefinedReasons","justificationData","r","updatedAbsence","handleFileUpload","newDocuments","file","removeDocument","docId","doc","formatFileSize","bytes","k","sizes","NewAbsenceModal","onAbsenceCreated","absenceData","setAbsenceData","absenceTypes","durationOptions","handleAbsenceDataChange","field","newAbsenceData","newAbsence","NotificationHistoryModal","notificationHistory","setNotificationHistory","loadNotificationHistory","history","getNotificationIcon","getNotificationColor","configs","notification","JustificationTab","selectedDate","setSelectedDate","selectedAbsences","setSelectedAbsences","showJustificationModal","setShowJustificationModal","showNewAbsenceModal","setShowNewAbsenceModal","showNotificationHistoryModal","setShowNotificationHistoryModal","selectedAbsence","setSelectedAbsence","loadAbsences","absences","getStatusConfig","getTypeConfig","filteredAbsences","handleCallParent","absenceId","callData","handleJustifyAbsence","handleAbsenceUpdated","handleAbsenceCreated","handleSendReminder","message","handleBulkReminders","handleBulkJustify","justifiableAbsences","toggleAbsenceSelection","stats","allIds","typeConfig","Toast","duration","isVisible","setIsVisible","isLeaving","setIsLeaving","getToastConfig","CheckCircle","AlertCircle","AlertTriangle","Info","X","ToastContainer","toasts","removeToast","toast","useToast","setToasts","addToast","paymentService","payments","baseAmount","amountPaid","statistics","payment","PaymentRegistrationModal","onPaymentRecorded","selectedPayment","feeTypes","setFeeTypes","paymentData","setPaymentData","paymentMethods","currentMonth","periodOptions","loadInitialData","initializeWithExistingPayment","studentsResult","feeTypesResult","handlePaymentDataChange","selectedFeeType","validatePaymentData","paymentSubmissionData","fee","ReceiptModal","paymentId","studentData","receipt","setReceipt","printRef","useRef","loadReceiptData","receiptData","handlePrint","sanitizedContent","DOMPurify","printWindow","handleDownload","blob","url","formatCurrency","amount","formatDate","dateString","Eye","Download","Printer","PaymentHistoryModal","studentName","onViewReceipt","setPayments","filteredPayments","setFilteredPayments","summary","setSummary","filters","setFilters","showFilters","setShowFilters","loadPaymentHistory","applyFilters","historyData","filtered","handleFilterChange","key","clearFilters","exportHistory","csvContent","getStatusText","getStatusColor","Calendar","Filter","Search","Receipt","PaymentCalendarModal","currentDate","setCurrentDate","viewMode","setViewMode","loadPayments","getDaysInMonth","date","year","month","firstDay","startDate","days","day","getPaymentsForDate","dateStr","colors","getStatusIcon","Clock","navigateMonth","direction","newDate","monthNames","dayNames","today","ChevronLeft","ChevronRight","isCurrentMonth","isToday","dayPayments","isSelected","PaymentAnalyticsModal","analytics","setAnalytics","period","setPeriod","selectedClass","setSelectedClass","loadAnalytics","calculateAnalytics","paymentsData","p","now","periodDate","periodPayments","totalAmount","totalPaid","totalOutstanding","completedPayments","pendingPayments","overduePayments","partialPayments","classAnalysis","collectionRate","onTimePayments","punctualityRate","exportReport","getPeriodLabel","method","row","BarChart3","DollarSign","TrendingUp","TrendingDown","PaymentTab","showSuccess","showError","showInfo","filterPeriod","setFilterPeriod","bulkReminderLoading","setBulkReminderLoading","setStats","showRegistrationModal","setShowRegistrationModal","showReceiptModal","setShowReceiptModal","showHistoryModal","setShowHistoryModal","showCalendarModal","setShowCalendarModal","showAnalyticsModal","setShowAnalyticsModal","selectedPaymentId","setSelectedPaymentId","inlineNotification","setInlineNotification","_i","_h","_l","_k","_j","_m","matchesPeriod","_n","handleMarkAsPaid","unpaidPayments","handleExportReport","reportData","handleViewHistory","handleViewReceipt","handleNewPayment","handleShowCalendar","isOverdue","CommunicationService","parentKey","parentsList","communications","comm","recipientsData","recipientNames","template","messageData","communicationData","templateData","templateRecord","weekAgo","communicationService","NotificationCenter","selectedTab","setSelectedTab","messageType","setMessageType","setMessage","setSubject","selectedTemplate","setSelectedTemplate","recipients","setRecipients","sending","setSending","setParents","sentMessages","setSentMessages","templates","setTemplates","parentsRes","historyRes","templatesRes","defaultTemplates","handleTemplateChange","templateValue","searchParent","setSearchParent","filteredParents","handleSelectAll","handleRecipientToggle","parentId","handleSendMessage","getTypeIcon","msg","m","TransferWorkflow","transferReason","setTransferReason","newSchool","setNewSchool","transferDate","setTransferDate","qrCodeGenerated","setQrCodeGenerated","transferCode","setTransferCode","pendingTransfers","setPendingTransfers","authUser","transfers","transfersError","reasonOptions","handleInitiateTransfer","newCode","transferData","handleSendConfirmation","transferId","transfer","handlePrintDocuments","handleCancelTransfer","DocumentsTab","filterCategory","setFilterCategory","selectedDocuments","setSelectedDocuments","documentTypeTab","setDocumentTypeTab","showModal","setShowModal","modalType","setModalType","documentType","setDocumentType","classes","setClasses","documentCategories","loadDocuments","documentService","classesData","classesError","getStatusLabel","handleBatchPrint","d","handlePrintDocument","filteredDocuments","matchesCategory","handleGenerateDocument","targetType","confirmGenerateDocument","options","documentId","handleDownloadDocument","handleViewDocument","forPrint","link","handleDeleteDocument","PlanningService","events","eventTypes","numEvents","eventDate","eventType","startHour","filteredEvents","event","dateA","dateB","eventData","newEvent","eventId","updates","eventIndex","reason","start","end","startTime","endTime","excludeEventId","conflicts","eventStart","eventEnd","checkStart","checkEnd","sentReminders","reminder","thisWeek","thisWeekStr","timeStr","minutes","ms","resolve","format","headers","rows","planningService","EventModal","onSuccess","errors","setErrors","availabilityCheck","setAvailabilityCheck","formData","setFormData","priorities","commonLocations","handleInputChange","handleAttendeesChange","newAttendees","addAttendee","removeAttendee","handleReminderToggle","enabled","newReminders","checkAvailability","timeoutId","calculateDuration","validateForm","newErrors","conflict","attendee","PlanningCalendarModal","onEventSelect","setEvents","hoveredDate","setHoveredDate","loadMonthEvents","endDate","monthEvents","goToToday","generateCalendarDays","dayOfWeek","mondayOffset","current","getEventsForDate","getEventTypeColor","getStatusIndicator","indicators","formatMonthYear","handleDateClick","handleEventClick","weekDays","calendarDays","dayEvents","isCurrentMonthDay","isTodayDate","MapPin","PlanningAnalyticsModal","setStatistics","calculateTrendData","thisWeekEvents","previousWeekEvents","twoWeeksAgo","trend","getTypeColor","trendData","Users","count","statusColors","statusLabels","weekStart","weekEnd","PlanningTab","filterType","setFilterType","showEventModal","setShowEventModal","selectedEvent","setSelectedEvent","loadEvents","viewModes","handleCreateEvent","handleEditEvent","handleConfirmEvent","handleCancelEvent","handleEventModalSuccess","handleEventSelect","handleExportPlanning","getPriorityConfig","priority","todayEvents","priorityConfig","TasksTab","filterPriority","setFilterPriority","showAddTaskModal","setShowAddTaskModal","showEditTaskModal","setShowEditTaskModal","editingTask","setEditingTask","showUrgentCallsModal","setShowUrgentCallsModal","newTask","setNewTask","priorityOptions","tasks","setTasks","loadTasks","formattedTasks","task","getCategoryConfig","category","filteredTasks","matchesPriority","handleTaskStatusChange","taskId","updateData","handleAddTask","handleSaveNewTask","handleShowUrgentCalls","handleEditTask","taskToEdit","handleSaveEditTask","handleDeleteTask","handleCallContact","contact","categoryConfig","isProductionMode","SchoolYearService","reinscriptions","request","newInscriptions","studentsByClass","currentClass","requestId","notes","requestData","requestStatus","schoolYearService","SchoolYearTab","activeSection","setActiveSection","currentSchoolYear","nextSchoolYear","setStudentsData","setReinscriptions","setNewInscriptions","studentsRes","reinscriptionsRes","newInscriptionsRes","statisticsRes","handleStatusUpdate","sections","section","reinscription","inscription","classe","etape","SecretaryDashboard","searchParams","useSearchParams","activeTab","setActiveTab","isSidebarCollapsed","setIsSidebarCollapsed","useAuth","secretaryName","setSecretaryName","loadingStats","setLoadingStats","loadUserData","loadFromLocalStorage","allSecretaries","secError","allUsers","usersError","secretaryData","secretaryError","fullName","studentCount","studentError","tabParam","tabs","secondaryTabs","allTabs","currentTab","tab","ActiveComponent","quickStats","Header","Sidebar","stat","gradientColors","iconGradients","textColors","subtitleColors"],"mappings":"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"}