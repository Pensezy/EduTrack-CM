import{j as e}from"./contexts-fbpOeTmm.js";import{r as w,i as se}from"./react-vendor-CFDIsUAY.js";import{H as re,S as te}from"./Sidebar-Q0ML3SY6.js";import{I as d,a as Z,B as J}from"./index-BPV3rumr.js";import{s as $}from"./services-CdXttHtG.js";import"./ui-vendor-BrXTGbgA.js";import"./supabase-CIvuJI4W.js";const y={currentParentId:null,setUserContext(s){this.currentParentId=s,console.log("ðŸ” Contexte parent dÃ©fini:",s)},ensureContext(){if(!this.currentParentId)throw new Error("Contexte utilisateur parent non dÃ©fini")},getParentProfile:async s=>{try{s&&y.setUserContext(s),y.ensureContext();const{data:m,error:i}=await $.from("users").select("id, email, full_name, phone, role, is_active").eq("id",y.currentParentId).eq("role","parent").single();if(i)throw i;return{data:m,error:null}}catch(m){return console.error("âŒ Erreur rÃ©cupÃ©ration profil parent:",m),{data:null,error:m}}},getChildren:async s=>{try{s&&y.setUserContext(s),y.ensureContext(),console.log("ðŸ“š RÃ©cupÃ©ration enfants pour parent USER ID:",y.currentParentId);const{data:m,error:i}=await $.from("parents").select("id").eq("user_id",y.currentParentId).single();if(i)throw console.error("âŒ Erreur rÃ©cupÃ©ration ID parent:",i),i;if(!m)return console.error("âŒ Aucun parent trouvÃ© pour user_id:",y.currentParentId),{data:[],error:null};const b=m.id;console.log("âœ… ID parent dans table parents:",b);const{data:o,error:n}=await $.from("parent_students").select(`
          relationship,
          is_primary,
          students!inner (
            id,
            matricule,
            full_name,
            gender,
            date_of_birth,
            photo_url,
            is_active,
            classes (
              id,
              name,
              level,
              section
            ),
            schools (
              id,
              name,
              code,
              type,
              city,
              country
            )
          )
        `).eq("parent_id",b).eq("students.is_active",!0);if(n)throw console.error("âŒ Erreur Supabase:",n),n;console.log("ðŸ“¦ DonnÃ©es brutes reÃ§ues:",o);const x=(o==null?void 0:o.map(c=>{var h,t;const a=c.students;return a?{id:a.id,matricule:a.matricule,full_name:a.full_name,name:a.full_name,gender:a.gender,date_of_birth:a.date_of_birth,birth_date:a.date_of_birth,photo_url:a.photo_url,photo:a.photo_url,is_active:a.is_active,class:a.classes,class_name:(h=a.classes)==null?void 0:h.name,school:a.schools,schoolId:(t=a.schools)==null?void 0:t.id,relationship:c.relationship,is_primary:c.is_primary,averageGrade:0,attendanceRate:0,unreadNotifications:0,pendingPayments:0}:null}).filter(c=>c!==null))||[];return console.log(`âœ… ${x.length} enfant(s) trouvÃ©(s) et formatÃ©(s):`,x),{data:x,error:null}}catch(m){return console.error("âŒ Erreur rÃ©cupÃ©ration enfants:",m),{data:[],error:m}}},getChildGrades:async s=>{try{y.ensureContext(),console.log("ðŸ“ RÃ©cupÃ©ration notes pour enfant:",s);const{data:m,error:i}=await $.from("parent_students").select("student_id").eq("parent_id",y.currentParentId).eq("student_id",s).single();if(i||!m)throw new Error("AccÃ¨s non autorisÃ© Ã  cet enfant");const{data:b,error:o}=await $.from("grades").select(`
          id,
          grade,
          max_grade,
          coefficient,
          grade_type,
          date,
          comment,
          subject:subjects (
            id,
            name,
            code
          ),
          teacher:users!grades_teacher_id_fkey (
            full_name
          )
        `).eq("student_id",s).order("date",{ascending:!1});if(o)throw o;const n=(b==null?void 0:b.map(x=>{var c,a,h;return{id:x.id,subject:((c=x.subject)==null?void 0:c.name)||"MatiÃ¨re inconnue",subject_code:((a=x.subject)==null?void 0:a.code)||"",grade:x.grade,max_grade:x.max_grade||20,coefficient:x.coefficient||1,grade_type:x.grade_type||"ContrÃ´le",date:x.date,teacher_name:((h=x.teacher)==null?void 0:h.full_name)||"Enseignant",comment:x.comment,average:x.grade,trend:"stable"}}))||[];return console.log(`âœ… ${n.length} note(s) trouvÃ©e(s)`),{data:n,error:null}}catch(m){return console.error("âŒ Erreur rÃ©cupÃ©ration notes:",m),{data:[],error:m}}},getChildAttendance:async s=>{try{y.ensureContext(),console.log("ðŸ“… RÃ©cupÃ©ration prÃ©sences pour enfant:",s);const{data:m,error:i}=await $.from("parent_students").select("student_id").eq("parent_id",y.currentParentId).eq("student_id",s).single();if(i||!m)throw new Error("AccÃ¨s non autorisÃ© Ã  cet enfant");const{data:b,error:o}=await $.from("absences").select(`
          id,
          absence_date,
          absence_type,
          justified,
          justification,
          created_at
        `).eq("student_id",s).order("absence_date",{ascending:!1});if(o)throw o;const n={};return b==null||b.forEach(x=>{const c=x.justified?"excused":x.absence_type==="late"?"late":"absent";n[x.absence_date]={status:c,justification:x.justification}}),console.log(`âœ… ${Object.keys(n).length} enregistrement(s) de prÃ©sence`),{data:n,error:null}}catch(m){return console.error("âŒ Erreur rÃ©cupÃ©ration prÃ©sences:",m),{data:{},error:m}}},getChildPayments:async s=>{try{y.ensureContext(),console.log("ðŸ’° RÃ©cupÃ©ration paiements pour enfant:",s);const{data:m,error:i}=await $.from("parent_students").select("student_id").eq("parent_id",y.currentParentId).eq("student_id",s).single();if(i||!m)throw new Error("AccÃ¨s non autorisÃ© Ã  cet enfant");const{data:b,error:o}=await $.from("payments").select(`
          id,
          type,
          description,
          amount,
          currency,
          status,
          due_date,
          paid_date,
          payment_method,
          created_at
        `).eq("student_id",s).order("created_at",{ascending:!1});if(o)throw o;return console.log(`âœ… ${(b==null?void 0:b.length)||0} paiement(s) trouvÃ©(s)`),{data:b||[],error:null}}catch(m){return console.error("âŒ Erreur rÃ©cupÃ©ration paiements:",m),{data:[],error:m}}},getChildNotifications:async s=>{try{y.ensureContext(),console.log("ðŸ”” RÃ©cupÃ©ration notifications pour enfant:",s);const{data:m,error:i}=await $.from("parent_students").select("student_id").eq("parent_id",y.currentParentId).eq("student_id",s).single();if(i||!m)throw new Error("AccÃ¨s non autorisÃ© Ã  cet enfant");const{data:b,error:o}=await $.from("students").select("user_id").eq("id",s).single();if(o||!(b!=null&&b.user_id))return console.warn("âš ï¸ Aucun user_id trouvÃ© pour cet Ã©tudiant"),{data:[],error:null};const{data:n,error:x}=await $.from("user_notifications").select(`
          id,
          title,
          message,
          type,
          priority,
          is_read,
          metadata,
          created_at,
          school:schools (
            name
          )
        `).eq("user_id",b.user_id).order("created_at",{ascending:!1}).limit(50);if(x)throw x;const c=(n==null?void 0:n.map(a=>{var h;return{id:a.id,title:a.title,message:a.message,type:a.type,priority:a.priority||"medium",school_name:((h=a.school)==null?void 0:h.name)||"",created_at:a.created_at,read:a.is_read||!1,metadata:a.metadata||{}}}))||[];return console.log(`âœ… ${c.length} notification(s) trouvÃ©e(s)`),{data:c,error:null}}catch(m){return console.error("âŒ Erreur rÃ©cupÃ©ration notifications:",m),{data:[],error:m}}},getUpcomingEvents:async s=>{try{s&&y.setUserContext(s),y.ensureContext(),console.log("ðŸ“† RÃ©cupÃ©ration Ã©vÃ©nements pour parent:",y.currentParentId);const{data:m,error:i}=await $.from("parent_students").select("student_id").eq("parent_id",y.currentParentId);if(i)throw i;const b=(m==null?void 0:m.map(c=>c.student_id))||[];if(b.length===0)return{data:[],error:null};const{data:o,error:n}=await $.from("events").select(`
          id,
          title,
          description,
          event_date,
          start_time,
          end_time,
          location,
          type,
          status,
          school:schools (
            name
          ),
          student:students (
            full_name
          )
        `).in("student_id",b).gte("event_date",new Date().toISOString().split("T")[0]).order("event_date",{ascending:!0}).limit(20);if(n)throw n;const x=(o==null?void 0:o.map(c=>{var a,h;return{id:c.id,title:c.title,description:c.description,school_name:((a=c.school)==null?void 0:a.name)||"",child_name:((h=c.student)==null?void 0:h.full_name)||"",event_date:c.event_date,start_time:c.start_time,end_time:c.end_time,location:c.location,type:c.type,status:c.status||"upcoming"}}))||[];return console.log(`âœ… ${x.length} Ã©vÃ©nement(s) Ã  venir`),{data:x,error:null}}catch(m){return console.error("âŒ Erreur rÃ©cupÃ©ration Ã©vÃ©nements:",m),{data:[],error:m}}},getSchools:async s=>{try{s&&y.setUserContext(s),y.ensureContext(),console.log("ðŸ« RÃ©cupÃ©ration Ã©coles pour parent USER ID:",y.currentParentId);const{data:m,error:i}=await $.from("parents").select("id").eq("user_id",y.currentParentId).single();if(i)throw console.error("âŒ Erreur rÃ©cupÃ©ration ID parent:",i),i;if(!m)return console.error("âŒ Aucun parent trouvÃ© pour user_id:",y.currentParentId),{data:[],error:null};const b=m.id;console.log("âœ… ID parent dans table parents:",b);const{data:o,error:n}=await $.from("parent_students").select(`
          students (
            schools (
              id,
              name,
              code,
              type,
              city,
              country
            )
          )
        `).eq("parent_id",b);if(n)throw console.error("âŒ Erreur Supabase:",n),n;console.log("ðŸ“¦ DonnÃ©es Ã©coles brutes:",o);const x=new Map;o==null||o.forEach(a=>{var t;const h=(t=a.students)==null?void 0:t.schools;if(h&&!x.has(h.id))x.set(h.id,{...h,childrenCount:1});else if(h){const l=x.get(h.id);l.childrenCount+=1}});const c=Array.from(x.values());return console.log(`âœ… ${c.length} Ã©cole(s) trouvÃ©e(s):`,c),{data:c,error:null}}catch(m){return console.error("âŒ Erreur rÃ©cupÃ©ration Ã©coles:",m),{data:[],error:m}}},markNotificationAsRead:async s=>{try{y.ensureContext();const{data:m,error:i}=await $.from("user_notifications").update({is_read:!0,read_at:new Date().toISOString()}).eq("id",s).select().single();if(i)throw i;return{data:m,error:null}}catch(m){return console.error("âŒ Erreur marquage notification:",m),{data:null,error:m}}}},ae=()=>{const[s,m]=w.useState(null),[i,b]=w.useState(!0),[o,n]=w.useState(null),[x,c]=w.useState([]),[a,h]=w.useState(null),[t,l]=w.useState(null),[f,A]=w.useState({}),[p,E]=w.useState({}),[k,D]=w.useState({}),[U,v]=w.useState({}),[r,_]=w.useState([]),[S,q]=w.useState([]),[R,M]=w.useState({profile:!1,children:!1,grades:!1,attendance:!1,payments:!1,notifications:!1,events:!1,schools:!1}),[z,T]=w.useState({});w.useEffect(()=>{(async()=>{try{const{data:{user:N},error:C}=await $.auth.getUser();if(C)throw C;m(N)}catch(N){console.error("Erreur rÃ©cupÃ©ration utilisateur:",N)}finally{b(!1)}})()},[]);const G=async()=>{if(!i){M(u=>({...u,profile:!0})),T(u=>({...u,profile:null}));try{y.setUserContext&&(s!=null&&s.id)&&y.setUserContext(s.id);const u=await y.getParentProfile(s==null?void 0:s.id);if(u.error)throw u.error;n(u.data)}catch(u){console.error("Erreur chargement profil parent:",u),T(N=>({...N,profile:u}))}finally{M(u=>({...u,profile:!1}))}}},P=async()=>{if(console.log("ðŸŽ¯ loadChildren appelÃ© - user:",s==null?void 0:s.id),i){console.log("â¸ï¸ loadChildren bloquÃ© - utilisateur en cours de chargement");return}M(u=>({...u,children:!0})),T(u=>({...u,children:null}));try{console.log("ðŸ”§ Service: PRODUCTION (Supabase)"),y.setUserContext&&(s!=null&&s.id)?(console.log("ðŸ”‘ Initialisation contexte avec parentId:",s.id),y.setUserContext(s.id)):console.error("âŒ Pas de parentId disponible !");const u=s==null?void 0:s.id;console.log("ðŸ“ž Appel getChildren avec parentId:",u);const N=await y.getChildren(u);if(console.log("ðŸ“¦ RÃ©sultat getChildren:",N),N.error)throw N.error;const C=N.data||[];console.log("ðŸ‘¶ Enfants chargÃ©s:",C.length),c(C),C.length>0&&!a&&(console.log("âœ… SÃ©lection automatique du premier enfant"),h(C[0]),C[0].school_id&&l({id:C[0].school_id}))}catch(u){console.error("âŒ Erreur chargement enfants:",u),T(N=>({...N,children:u}))}finally{M(u=>({...u,children:!1}))}},F=async(u,N=null)=>{if(i||!u)return;const C=`${u}_${N||"all"}`;M(g=>({...g,grades:!0})),T(g=>({...g,grades:null}));try{const g=await y.getChildGrades(u,N);if(g.error)throw g.error;A(I=>({...I,[C]:g.data}))}catch(g){console.error("Erreur chargement notes:",g),T(I=>({...I,grades:g}))}finally{M(g=>({...g,grades:!1}))}},H=async(u,N=null)=>{if(i||!u)return;const C=`${u}_${N||"all"}`;M(g=>({...g,attendance:!0})),T(g=>({...g,attendance:null}));try{const g=await y.getChildAttendance(u,N);if(g.error)throw g.error;E(I=>({...I,[C]:g.data}))}catch(g){console.error("Erreur chargement assiduitÃ©:",g),T(I=>({...I,attendance:g}))}finally{M(g=>({...g,attendance:!1}))}},B=async(u,N=null)=>{if(i||!u)return;const C=`${u}_${N||"all"}`;M(g=>({...g,payments:!0})),T(g=>({...g,payments:null}));try{const g=await y.getChildPayments(u,N);if(g.error)throw g.error;D(I=>({...I,[C]:g.data}))}catch(g){console.error("Erreur chargement paiements:",g),T(I=>({...I,payments:g}))}finally{M(g=>({...g,payments:!1}))}},L=async(u,N=null)=>{if(i||!u)return;const C=`${u}_${N||"all"}`;M(g=>({...g,notifications:!0})),T(g=>({...g,notifications:null}));try{const g=await y.getChildNotifications(u,N);if(g.error)throw g.error;v(I=>({...I,[C]:g.data}))}catch(g){console.error("Erreur chargement notifications:",g),T(I=>({...I,notifications:g}))}finally{M(g=>({...g,notifications:!1}))}},X=async()=>{if(!i){M(u=>({...u,events:!0})),T(u=>({...u,events:null}));try{const u=await y.getUpcomingEvents();if(u.error)throw u.error;_(u.data||[])}catch(u){console.error("Erreur chargement Ã©vÃ©nements:",u),T(N=>({...N,events:u}))}finally{M(u=>({...u,events:!1}))}}},V=async()=>{if(!i){M(u=>({...u,schools:!0})),T(u=>({...u,schools:null}));try{const u=s==null?void 0:s.id,N=await y.getSchools(u);if(N.error)throw N.error;q(N.data||[])}catch(u){console.error("Erreur chargement Ã©coles:",u),T(N=>({...N,schools:u}))}finally{M(u=>({...u,schools:!1}))}}},j=async u=>{try{await y.markNotificationAsRead(u),v(N=>{const C={...N};return Object.keys(C).forEach(g=>{Array.isArray(C[g])&&(C[g]=C[g].map(I=>I.id===u?{...I,read:!0}:I))}),C})}catch(N){console.error("Erreur marquage notification:",N)}};return w.useEffect(()=>{!i&&s&&(console.log("ðŸš€ Chargement donnÃ©es parent depuis Supabase"),G(),P(),V(),X())},[i,s]),w.useEffect(()=>{a&&!i&&(console.log("ðŸ‘¶ Chargement donnÃ©es enfant sÃ©lectionnÃ©:",a.id),F(a.id,t==null?void 0:t.id),H(a.id,t==null?void 0:t.id),B(a.id,t==null?void 0:t.id),L(a.id,t==null?void 0:t.id))},[a,t,i]),{parentProfile:o,children:x,selectedChild:a,selectedSchool:t,gradesData:f,attendanceData:p,paymentData:k,notificationsData:U,upcomingEvents:r,schools:S,user:s,loading:R,userLoading:i,errors:z,setSelectedChild:h,setSelectedSchool:l,loadParentProfile:G,loadChildren:P,loadChildGrades:F,loadChildAttendance:H,loadChildPayments:B,loadChildNotifications:L,loadUpcomingEvents:X,loadSchools:V,markNotificationAsRead:j,isAnyLoading:Object.values(R).some(Boolean)||i,hasErrors:Object.values(z).some(Boolean)}},Y=({children:s,schools:m,selectedChild:i,selectedSchool:b,onChildSelect:o,onSchoolChange:n,getChildrenBySchool:x,onManageChild:c})=>e.jsxs("div",{className:"bg-white rounded-2xl shadow-lg border-2 border-gray-200 p-8",children:[e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4 mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2.5 rounded-xl bg-gradient-to-br from-indigo-500 to-purple-600 shadow-md",children:e.jsx(d,{name:"Users",size:24,className:"text-white"})}),e.jsx("h2",{className:"font-display font-bold text-2xl text-gray-900",children:"SÃ©lection Enfant & Ã‰cole"})]}),(m==null?void 0:m.length)>1&&e.jsxs("div",{className:"flex items-center gap-3 bg-gradient-to-br from-blue-50 to-indigo-50 px-4 py-3 rounded-xl border-2 border-blue-200",children:[e.jsx("div",{className:"p-1.5 rounded-lg bg-gradient-to-br from-blue-500 to-indigo-600 shadow-sm",children:e.jsx(d,{name:"School",size:18,className:"text-white"})}),e.jsxs("select",{value:b||"",onChange:a=>{var h;return n((h=a==null?void 0:a.target)==null?void 0:h.value)},className:"px-4 py-2 bg-white border-2 border-blue-200 rounded-lg font-body-bold text-sm text-gray-900 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"",children:"Toutes les Ã©coles"}),m==null?void 0:m.map(a=>e.jsx("option",{value:a==null?void 0:a.id,children:a==null?void 0:a.name},a==null?void 0:a.id))]})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:s==null?void 0:s.map(a=>{if(!(!b||(a==null?void 0:a.schoolId)===b))return null;const t=(i==null?void 0:i.id)===(a==null?void 0:a.id);return e.jsxs("div",{className:`relative p-5 rounded-2xl border-2 transition-all duration-200 group cursor-pointer ${t?"border-indigo-500 bg-gradient-to-br from-indigo-50 to-purple-50 shadow-xl scale-105":"border-gray-200 hover:border-indigo-300 hover:shadow-lg hover:scale-102"}`,onClick:()=>o(a),children:[t&&e.jsx("div",{className:"absolute -top-2 -right-2 w-8 h-8 bg-gradient-to-br from-indigo-500 to-purple-600 rounded-xl flex items-center justify-center shadow-md",children:e.jsx(d,{name:"Check",size:18,className:"text-white"})}),e.jsx("button",{onClick:l=>{l.stopPropagation(),c==null||c(a)},className:"absolute top-3 right-3 p-2 bg-white hover:bg-gray-100 border-2 border-gray-200 rounded-lg shadow-md transition-all opacity-0 group-hover:opacity-100 hover:scale-110",title:"GÃ©rer cet enfant",children:e.jsx(d,{name:"Settings",size:16,className:"text-gray-600"})}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:(a==null?void 0:a.photo)||"https://via.placeholder.com/64",alt:a==null?void 0:a.name,className:`w-16 h-16 rounded-xl object-cover border-2 transition-all ${t?"border-indigo-500":"border-gray-200 group-hover:border-indigo-300"}`}),(a==null?void 0:a.unreadNotifications)>0&&e.jsx("div",{className:"absolute -top-1 -right-1 w-6 h-6 bg-gradient-to-br from-red-500 to-rose-600 rounded-full flex items-center justify-center shadow-md",children:e.jsx("span",{className:"font-display font-bold text-xs text-white",children:a==null?void 0:a.unreadNotifications})})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"font-display font-bold text-lg text-gray-900 mb-1 truncate",children:a==null?void 0:a.name}),e.jsxs("p",{className:"font-body-medium text-sm text-gray-600 mb-1",children:[a==null?void 0:a.class," â€¢ ",a==null?void 0:a.matricule]}),e.jsx("p",{className:"font-body-medium text-xs text-gray-500 truncate",children:a==null?void 0:a.school}),e.jsxs("div",{className:"flex items-center gap-3 mt-3",children:[(a==null?void 0:a.averageGrade)>0&&e.jsxs("div",{className:"flex items-center gap-1 px-2 py-1 bg-green-100 rounded-lg",children:[e.jsx(d,{name:"TrendingUp",size:12,className:"text-green-600"}),e.jsxs("span",{className:"font-body-bold text-xs text-green-700",children:[a==null?void 0:a.averageGrade,"/20"]})]}),(a==null?void 0:a.attendanceRate)>0&&e.jsxs("div",{className:"flex items-center gap-1 px-2 py-1 bg-blue-100 rounded-lg",children:[e.jsx(d,{name:"Calendar",size:12,className:"text-blue-600"}),e.jsxs("span",{className:"font-body-bold text-xs text-blue-700",children:[a==null?void 0:a.attendanceRate,"%"]})]}),(a==null?void 0:a.pendingPayments)>0&&e.jsxs("div",{className:"flex items-center gap-1 px-2 py-1 bg-orange-100 rounded-lg",children:[e.jsx(d,{name:"CreditCard",size:12,className:"text-orange-600"}),e.jsx("span",{className:"font-body-bold text-xs text-orange-700",children:a==null?void 0:a.pendingPayments})]})]})]})]})]},a==null?void 0:a.id)})}),(s==null?void 0:s.length)===0&&e.jsxs("div",{className:"text-center py-12 bg-gradient-to-br from-gray-50 to-white rounded-2xl border-2 border-gray-200",children:[e.jsx("div",{className:"w-20 h-20 mx-auto mb-4 rounded-2xl bg-gradient-to-br from-gray-400 to-gray-600 flex items-center justify-center shadow-md",children:e.jsx(d,{name:"Users",size:40,className:"text-white"})}),e.jsx("p",{className:"font-body-bold text-gray-700 text-lg",children:"Aucun enfant trouvÃ© pour cette Ã©cole"})]})]}),W=({child:s})=>{if(!s)return null;const m=n=>n>=16?"from-green-500 to-emerald-600":n>=14?"from-blue-500 to-indigo-600":n>=12?"from-orange-500 to-amber-600":"from-red-500 to-rose-600",i=n=>n>=16?"text-green-700":n>=14?"text-blue-700":n>=12?"text-orange-700":"text-red-700",b=n=>n>=95?"from-green-500 to-emerald-600":n>=90?"from-blue-500 to-indigo-600":n>=85?"from-orange-500 to-amber-600":"from-red-500 to-rose-600",o=n=>n>=95?"text-green-700":n>=90?"text-blue-700":n>=85?"text-orange-700":"text-red-700";return e.jsx("div",{className:"bg-gradient-to-br from-indigo-600 to-purple-600 rounded-2xl shadow-xl p-8 text-white",children:e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-6",children:[e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:(s==null?void 0:s.photo)||"https://via.placeholder.com/80",alt:s==null?void 0:s.name,className:"w-24 h-24 rounded-2xl object-cover border-4 border-white/30 shadow-lg backdrop-blur-sm"}),e.jsx("div",{className:"absolute -bottom-2 -right-2 w-8 h-8 bg-gradient-to-br from-green-500 to-emerald-600 rounded-xl border-2 border-white flex items-center justify-center shadow-md",children:e.jsx(d,{name:"User",size:16,className:"text-white"})})]}),e.jsxs("div",{children:[e.jsx("h2",{className:"font-display font-bold text-3xl mb-3",children:s==null?void 0:s.name}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2 bg-white/20 backdrop-blur-sm rounded-lg px-3 py-1.5",children:[e.jsx(d,{name:"GraduationCap",size:16}),e.jsx("span",{className:"font-body-bold text-sm",children:(s==null?void 0:s.class)||"Classe non renseignÃ©e"})]}),e.jsxs("div",{className:"flex items-center gap-2 bg-white/20 backdrop-blur-sm rounded-lg px-3 py-1.5",children:[e.jsx(d,{name:"Hash",size:16}),e.jsx("span",{className:"font-body-medium text-sm",children:(s==null?void 0:s.matricule)||"Matricule non renseignÃ©"})]}),e.jsxs("div",{className:"flex items-center gap-2 bg-white/20 backdrop-blur-sm rounded-lg px-3 py-1.5",children:[e.jsx(d,{name:"School",size:16}),e.jsx("span",{className:"font-body-medium text-sm",children:(s==null?void 0:s.school)||"Ã‰cole non renseignÃ©e"})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-white rounded-2xl p-5 shadow-lg text-center hover:scale-105 transition-transform",children:[e.jsx("div",{className:`w-12 h-12 mx-auto mb-3 rounded-xl bg-gradient-to-br ${m((s==null?void 0:s.averageGrade)||0)} flex items-center justify-center shadow-md`,children:e.jsx(d,{name:"TrendingUp",size:24,className:"text-white"})}),e.jsxs("div",{className:`font-display font-bold text-2xl ${i((s==null?void 0:s.averageGrade)||0)}`,children:[(s==null?void 0:s.averageGrade)||0,"/20"]}),e.jsx("p",{className:"font-body-medium text-xs text-gray-600 mt-2",children:"Moyenne gÃ©nÃ©rale"})]}),e.jsxs("div",{className:"bg-white rounded-2xl p-5 shadow-lg text-center hover:scale-105 transition-transform",children:[e.jsx("div",{className:`w-12 h-12 mx-auto mb-3 rounded-xl bg-gradient-to-br ${b((s==null?void 0:s.attendanceRate)||0)} flex items-center justify-center shadow-md`,children:e.jsx(d,{name:"Calendar",size:24,className:"text-white"})}),e.jsxs("div",{className:`font-display font-bold text-2xl ${o((s==null?void 0:s.attendanceRate)||0)}`,children:[(s==null?void 0:s.attendanceRate)||0,"%"]}),e.jsx("p",{className:"font-body-medium text-xs text-gray-600 mt-2",children:"Taux de prÃ©sence"})]}),e.jsxs("div",{className:"bg-white rounded-2xl p-5 shadow-lg text-center hover:scale-105 transition-transform",children:[e.jsx("div",{className:`w-12 h-12 mx-auto mb-3 rounded-xl ${(s==null?void 0:s.unreadNotifications)>0?"bg-gradient-to-br from-orange-500 to-amber-600":"bg-gray-300"} flex items-center justify-center shadow-md`,children:e.jsx(d,{name:"Bell",size:24,className:"text-white"})}),e.jsx("div",{className:`font-display font-bold text-2xl ${(s==null?void 0:s.unreadNotifications)>0?"text-orange-700":"text-gray-500"}`,children:(s==null?void 0:s.unreadNotifications)||0}),e.jsx("p",{className:"font-body-medium text-xs text-gray-600 mt-2",children:"Notifications"})]}),e.jsxs("div",{className:"bg-white rounded-2xl p-5 shadow-lg text-center hover:scale-105 transition-transform",children:[e.jsx("div",{className:`w-12 h-12 mx-auto mb-3 rounded-xl ${(s==null?void 0:s.pendingPayments)>0?"bg-gradient-to-br from-red-500 to-rose-600":"bg-gradient-to-br from-green-500 to-emerald-600"} flex items-center justify-center shadow-md`,children:e.jsx(d,{name:"CreditCard",size:24,className:"text-white"})}),e.jsx("div",{className:`font-display font-bold text-2xl ${(s==null?void 0:s.pendingPayments)>0?"text-red-700":"text-green-700"}`,children:(s==null?void 0:s.pendingPayments)||0}),e.jsx("p",{className:"font-body-medium text-xs text-gray-600 mt-2",children:"Paiements dus"})]})]})]})})},Q=({attendance:s,childName:m})=>{var E,k,D,U,v;const[i,b]=w.useState(null),o=r=>{switch(r){case"present":return e.jsx(d,{name:"Check",size:14,className:"text-success"});case"absent":return e.jsx(d,{name:"X",size:14,className:"text-error"});case"late":return e.jsx(d,{name:"Clock",size:14,className:"text-warning"});case"excused":return e.jsx(d,{name:"FileText",size:14,className:"text-primary"});default:return e.jsx(d,{name:"Minus",size:14,className:"text-muted-foreground"})}},n=r=>{switch(r){case"present":return"bg-success text-white";case"absent":return"bg-error text-white";case"late":return"bg-warning text-white";case"excused":return"bg-primary text-white";default:return"bg-muted text-muted-foreground"}},x=r=>{switch(r){case"present":return"PrÃ©sent(e)";case"absent":return"Absent(e)";case"late":return"En retard";case"excused":return"ExcusÃ©(e)";default:return"Non renseignÃ©"}},c=(Object==null?void 0:Object.keys(s))||[],a=c==null?void 0:c.length,h=(E=c==null?void 0:c.filter(r=>(s==null?void 0:s[r])==="present"))==null?void 0:E.length,t=(k=c==null?void 0:c.filter(r=>(s==null?void 0:s[r])==="absent"))==null?void 0:k.length,l=(D=c==null?void 0:c.filter(r=>(s==null?void 0:s[r])==="late"))==null?void 0:D.length,f=(U=c==null?void 0:c.filter(r=>(s==null?void 0:s[r])==="excused"))==null?void 0:U.length,A=a>0?(h+f)/a*100:0,p=(v=c==null?void 0:c.sort((r,_)=>new Date(_)-new Date(r)))==null?void 0:v.slice(0,14);return e.jsxs("div",{className:"bg-white rounded-2xl shadow-xl border-2 border-gray-200 p-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-8",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2.5 rounded-xl bg-gradient-to-br from-blue-500 to-indigo-600 shadow-md",children:e.jsx(d,{name:"Calendar",size:24,className:"text-white"})}),e.jsx("h3",{className:"font-display font-bold text-2xl text-gray-900",children:"Suivi des PrÃ©sences"})]}),e.jsxs("div",{className:"flex items-center gap-2 px-4 py-2.5 bg-gradient-to-br from-green-500 to-emerald-600 rounded-xl shadow-md",children:[e.jsx(d,{name:"TrendingUp",size:18,className:"text-white"}),e.jsxs("span",{className:"font-body-bold text-sm text-white",children:[A==null?void 0:A.toFixed(1),"%"]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4 mb-8",children:[e.jsxs("div",{className:"text-center p-5 bg-gradient-to-br from-green-500 to-emerald-600 rounded-xl shadow-lg text-white hover:scale-105 transition-transform",children:[e.jsx(d,{name:"Check",size:24,className:"mx-auto mb-2"}),e.jsx("div",{className:"font-display font-bold text-2xl",children:h}),e.jsx("p",{className:"font-body-medium text-xs mt-1 text-white/90",children:"PrÃ©sent(e)"})]}),e.jsxs("div",{className:"text-center p-5 bg-gradient-to-br from-red-500 to-rose-600 rounded-xl shadow-lg text-white hover:scale-105 transition-transform",children:[e.jsx(d,{name:"X",size:24,className:"mx-auto mb-2"}),e.jsx("div",{className:"font-display font-bold text-2xl",children:t}),e.jsx("p",{className:"font-body-medium text-xs mt-1 text-white/90",children:"Absent(e)"})]}),e.jsxs("div",{className:"text-center p-5 bg-gradient-to-br from-orange-500 to-amber-600 rounded-xl shadow-lg text-white hover:scale-105 transition-transform",children:[e.jsx(d,{name:"Clock",size:24,className:"mx-auto mb-2"}),e.jsx("div",{className:"font-display font-bold text-2xl",children:l}),e.jsx("p",{className:"font-body-medium text-xs mt-1 text-white/90",children:"Retards"})]}),e.jsxs("div",{className:"text-center p-5 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-xl shadow-lg text-white hover:scale-105 transition-transform",children:[e.jsx(d,{name:"FileText",size:24,className:"mx-auto mb-2"}),e.jsx("div",{className:"font-display font-bold text-2xl",children:f}),e.jsx("p",{className:"font-body-medium text-xs mt-1 text-white/90",children:"ExcusÃ©(e)"})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-heading font-heading-semibold text-lg text-card-foreground mb-4",children:"Derniers jours de classe"}),e.jsx("div",{className:"grid grid-cols-7 gap-2",children:p==null?void 0:p.map(r=>{var R;const _=s==null?void 0:s[r],S=new Date(r),q=((R=new Date)==null?void 0:R.toDateString())===(S==null?void 0:S.toDateString());return e.jsxs("div",{onClick:()=>b(i===r?null:r),className:`relative p-2 rounded-lg border-2 cursor-pointer transition-all duration-200 ${i===r?"border-primary shadow-md":"border-border hover:border-primary/50"} ${q?"ring-2 ring-primary/30":""}`,children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"font-caption font-caption-normal text-xs text-muted-foreground mb-1",children:S==null?void 0:S.toLocaleDateString("fr-FR",{weekday:"short"})}),e.jsx("div",{className:"font-body font-body-semibold text-sm text-card-foreground mb-2",children:S==null?void 0:S.getDate()}),e.jsx("div",{className:`w-6 h-6 rounded-full flex items-center justify-center mx-auto ${n(_)}`,children:o(_)})]}),i===r&&e.jsxs("div",{className:"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-3 py-2 bg-gray-900 text-white text-xs rounded-lg whitespace-nowrap z-10",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"font-caption font-caption-semibold",children:S==null?void 0:S.toLocaleDateString("fr-FR",{weekday:"long",day:"numeric",month:"long"})}),e.jsx("div",{className:"font-caption font-caption-normal mt-1",children:x(_)})]}),e.jsx("div",{className:"absolute top-full left-1/2 transform -translate-x-1/2 border-4 border-transparent border-t-gray-900"})]})]},r)})}),e.jsxs("div",{className:"flex flex-wrap items-center justify-center gap-4 mt-6 p-5 bg-gradient-to-r from-gray-100 to-gray-50 rounded-xl border-2 border-gray-200",children:[e.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 bg-white rounded-lg shadow-sm",children:[e.jsx("div",{className:"w-5 h-5 bg-gradient-to-br from-green-500 to-emerald-600 rounded-full flex items-center justify-center",children:e.jsx(d,{name:"Check",size:12,className:"text-white"})}),e.jsx("span",{className:"font-body-bold text-xs text-gray-700",children:"PrÃ©sent(e)"})]}),e.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 bg-white rounded-lg shadow-sm",children:[e.jsx("div",{className:"w-5 h-5 bg-gradient-to-br from-red-500 to-rose-600 rounded-full flex items-center justify-center",children:e.jsx(d,{name:"X",size:12,className:"text-white"})}),e.jsx("span",{className:"font-body-bold text-xs text-gray-700",children:"Absent(e)"})]}),e.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 bg-white rounded-lg shadow-sm",children:[e.jsx("div",{className:"w-5 h-5 bg-gradient-to-br from-orange-500 to-amber-600 rounded-full flex items-center justify-center",children:e.jsx(d,{name:"Clock",size:12,className:"text-white"})}),e.jsx("span",{className:"font-body-bold text-xs text-gray-700",children:"En retard"})]}),e.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 bg-white rounded-lg shadow-sm",children:[e.jsx("div",{className:"w-5 h-5 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-full flex items-center justify-center",children:e.jsx(d,{name:"FileText",size:12,className:"text-white"})}),e.jsx("span",{className:"font-body-bold text-xs text-gray-700",children:"ExcusÃ©(e)"})]})]})]}),a===0&&e.jsxs("div",{className:"text-center py-12 px-4 bg-gradient-to-br from-gray-50 to-gray-100 rounded-xl border-2 border-gray-200",children:[e.jsx("div",{className:"p-4 rounded-2xl bg-gradient-to-br from-blue-500 to-indigo-600 w-20 h-20 flex items-center justify-center mx-auto mb-4 shadow-lg",children:e.jsx(d,{name:"Calendar",size:40,className:"text-white"})}),e.jsx("p",{className:"font-body-bold text-base text-gray-700",children:"Aucune donnÃ©e de prÃ©sence disponible"})]})]})},K=({grades:s})=>{const m=n=>{switch(n){case"up":return e.jsx(d,{name:"TrendingUp",size:14,className:"text-success"});case"down":return e.jsx(d,{name:"TrendingDown",size:14,className:"text-error"});default:return e.jsx(d,{name:"Minus",size:14,className:"text-muted-foreground"})}},i=n=>n>=16?"text-success":n>=14?"text-primary":n>=12?"text-warning":"text-error",b=n=>n>=16?"bg-success/10":n>=14?"bg-primary/10":n>=12?"bg-warning/10":"bg-error/10",o=(s==null?void 0:s.length)>0?(s==null?void 0:s.reduce((n,x)=>n+(x==null?void 0:x.average)*(x==null?void 0:x.coefficient),0))/(s==null?void 0:s.reduce((n,x)=>n+(x==null?void 0:x.coefficient),0)):0;return e.jsxs("div",{className:"bg-white rounded-2xl shadow-xl border-2 border-gray-200 p-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-8",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2.5 rounded-xl bg-gradient-to-br from-purple-500 to-pink-600 shadow-md",children:e.jsx(d,{name:"BookOpen",size:24,className:"text-white"})}),e.jsx("h3",{className:"font-display font-bold text-2xl text-gray-900",children:"AperÃ§u des Notes"})]}),e.jsxs("div",{className:"flex items-center gap-2 px-4 py-2.5 bg-gradient-to-br from-purple-500 to-pink-600 rounded-xl shadow-md text-white",children:[e.jsx(d,{name:"BarChart3",size:18}),e.jsxs("span",{className:"font-body-bold text-sm",children:[o==null?void 0:o.toFixed(1),"/20"]})]})]}),e.jsxs("div",{className:"space-y-4",children:[s==null?void 0:s.map(n=>{var x,c,a,h;return e.jsxs("div",{className:"bg-gradient-to-br from-gray-50 to-gray-100 border-2 border-gray-200 rounded-xl p-5 hover:shadow-lg transition-all",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("h4",{className:"font-heading font-heading-semibold text-lg text-card-foreground",children:n==null?void 0:n.subject}),e.jsxs("span",{className:"px-2 py-1 bg-muted rounded text-xs font-caption font-caption-semibold text-muted-foreground",children:["Coeff. ",n==null?void 0:n.coefficient]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[m(n==null?void 0:n.trend),e.jsxs("div",{className:`font-heading font-heading-bold text-xl ${i(n==null?void 0:n.average)}`,children:[n==null?void 0:n.average,"/20"]})]})]}),e.jsx("div",{className:"w-full bg-muted rounded-full h-2 mb-3",children:e.jsx("div",{className:`h-2 rounded-full transition-all duration-300 ${(n==null?void 0:n.average)>=16?"bg-success":(n==null?void 0:n.average)>=14?"bg-primary":(n==null?void 0:n.average)>=12?"bg-warning":"bg-error"}`,style:{width:`${(n==null?void 0:n.average)/20*100}%`}})}),(n==null?void 0:n.lastGrade)&&e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-body font-body-normal text-muted-foreground",children:"DerniÃ¨re Ã©valuation:"}),e.jsxs("span",{className:`font-body font-body-semibold px-2 py-1 rounded ${b((x=n==null?void 0:n.lastGrade)==null?void 0:x.value)}`,children:[(c=n==null?void 0:n.lastGrade)==null?void 0:c.value,"/20 (",(a=n==null?void 0:n.lastGrade)==null?void 0:a.type,")"]})]}),e.jsx("span",{className:"font-caption font-caption-normal text-muted-foreground",children:(h=n==null?void 0:n.lastGrade)==null?void 0:h.date})]})]},n==null?void 0:n.id)}),(s==null?void 0:s.length)===0&&e.jsxs("div",{className:"text-center py-12 px-4 bg-gradient-to-br from-purple-50 to-pink-50 rounded-xl border-2 border-purple-200",children:[e.jsx("div",{className:"p-4 rounded-2xl bg-gradient-to-br from-purple-500 to-pink-600 w-20 h-20 flex items-center justify-center mx-auto mb-4 shadow-lg",children:e.jsx(d,{name:"BookOpen",size:40,className:"text-white"})}),e.jsx("p",{className:"font-body-bold text-base text-gray-700",children:"Aucune note disponible pour le moment"})]})]})]})},O=({payments:s})=>{var a,h;const m=t=>{switch(t){case"completed":return"text-success";case"pending":return"text-warning";case"overdue":return"text-error";default:return"text-muted-foreground"}},i=t=>{switch(t){case"completed":return"bg-success/10";case"pending":return"bg-warning/10";case"overdue":return"bg-error/10";default:return"bg-muted/10"}},b=t=>{switch(t){case"completed":return"PayÃ©";case"pending":return"En attente";case"overdue":return"En retard";default:return"Inconnu"}},o=t=>{var l;return(l=new Intl.NumberFormat("fr-FR",{style:"currency",currency:"XAF",minimumFractionDigits:0}))==null?void 0:l.format(t)},n=t=>{var l;return(l=new Date(t))==null?void 0:l.toLocaleDateString("fr-FR",{day:"numeric",month:"long",year:"numeric"})},x=((a=s==null?void 0:s.filter(t=>(t==null?void 0:t.status)==="pending"))==null?void 0:a.reduce((t,l)=>t+(l==null?void 0:l.amount),0))||0,c=((h=s==null?void 0:s.filter(t=>(t==null?void 0:t.status)==="completed"))==null?void 0:h.reduce((t,l)=>t+(l==null?void 0:l.amount),0))||0;return e.jsxs("div",{className:"bg-white rounded-2xl shadow-xl border-2 border-gray-200 p-8",children:[e.jsx("div",{className:"flex items-center justify-between mb-8",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2.5 rounded-xl bg-gradient-to-br from-orange-500 to-amber-600 shadow-md",children:e.jsx(d,{name:"CreditCard",size:24,className:"text-white"})}),e.jsx("h3",{className:"font-display font-bold text-2xl text-gray-900",children:"Statut des Paiements"})]})}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 mb-8",children:[e.jsxs("div",{className:"bg-gradient-to-br from-green-500 to-emerald-600 rounded-xl p-6 text-center shadow-lg text-white hover:scale-105 transition-transform",children:[e.jsx(d,{name:"CheckCircle",size:28,className:"mx-auto mb-3"}),e.jsx("div",{className:"font-display font-bold text-2xl",children:o(c)}),e.jsx("p",{className:"font-body-medium text-sm mt-1 text-white/90",children:"Montant payÃ©"})]}),e.jsxs("div",{className:"bg-gradient-to-br from-orange-500 to-amber-600 rounded-xl p-6 text-center shadow-lg text-white hover:scale-105 transition-transform",children:[e.jsx(d,{name:"Clock",size:28,className:"mx-auto mb-3"}),e.jsx("div",{className:"font-display font-bold text-2xl",children:o(x)}),e.jsx("p",{className:"font-body-medium text-sm mt-1 text-white/90",children:"Montant en attente"})]})]}),e.jsxs("div",{className:"space-y-4",children:[s==null?void 0:s.map(t=>e.jsxs("div",{className:"bg-gradient-to-br from-gray-50 to-gray-100 border-2 border-gray-200 rounded-xl p-5 hover:shadow-lg transition-all",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-3 h-3 rounded-full ${(t==null?void 0:t.status)==="completed"?"bg-success":(t==null?void 0:t.status)==="pending"?"bg-warning":"bg-error"}`}),e.jsx("h4",{className:"font-heading font-heading-semibold text-lg text-card-foreground",children:t==null?void 0:t.type})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"font-heading font-heading-bold text-xl text-card-foreground",children:o(t==null?void 0:t.amount)}),e.jsx("span",{className:`px-2 py-1 rounded text-xs font-caption font-caption-semibold ${i(t==null?void 0:t.status)} ${m(t==null?void 0:t.status)}`,children:b(t==null?void 0:t.status)})]})]}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsx("p",{className:"font-body font-body-normal text-muted-foreground",children:t==null?void 0:t.description}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(d,{name:"Building",size:14,className:"text-muted-foreground"}),e.jsx("span",{className:"font-caption font-caption-normal text-muted-foreground",children:t==null?void 0:t.provider})]}),e.jsx("span",{className:"font-caption font-caption-normal text-muted-foreground",children:(t==null?void 0:t.status)==="completed"&&(t!=null&&t.paidDate)?`PayÃ© le ${n(t==null?void 0:t.paidDate)}`:`Ã‰chÃ©ance: ${n(t==null?void 0:t.dueDate)}`})]})]}),(t==null?void 0:t.status)==="pending"&&e.jsx("div",{className:"mt-4 pt-3 border-t-2 border-gray-200",children:e.jsxs("button",{className:"w-full bg-gradient-to-br from-orange-500 to-amber-600 hover:from-orange-600 hover:to-amber-700 text-white font-body-bold py-3 px-4 rounded-xl transition-all hover:scale-105 shadow-lg flex items-center justify-center gap-2",children:[e.jsx(d,{name:"Smartphone",size:18}),"Payer via Mobile Money"]})})]},t==null?void 0:t.id)),(s==null?void 0:s.length)===0&&e.jsxs("div",{className:"text-center py-12 px-4 bg-gradient-to-br from-orange-50 to-amber-50 rounded-xl border-2 border-orange-200",children:[e.jsx("div",{className:"p-4 rounded-2xl bg-gradient-to-br from-orange-500 to-amber-600 w-20 h-20 flex items-center justify-center mx-auto mb-4 shadow-lg",children:e.jsx(d,{name:"CreditCard",size:40,className:"text-white"})}),e.jsx("p",{className:"font-body-bold text-base text-gray-700",children:"Aucun paiement en cours"})]})]}),x>0&&e.jsx("div",{className:"mt-6 p-4 bg-primary/5 border border-primary/20 rounded-lg",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(d,{name:"Info",size:16,className:"text-primary mt-0.5"}),e.jsxs("div",{className:"text-sm",children:[e.jsx("p",{className:"font-body font-body-semibold text-primary mb-1",children:"Paiement Mobile Money"}),e.jsx("p",{className:"font-body font-body-normal text-muted-foreground",children:"Vous pouvez effectuer vos paiements via MTN Mobile Money ou Orange Money. Les reÃ§us de paiement sont gÃ©nÃ©rÃ©s automatiquement aprÃ¨s confirmation."})]})]})})]})},ee=({notifications:s,childName:m})=>{var p,E,k,D,U,v;const[i,b]=w.useState("all"),[o,n]=w.useState(null),x=r=>{switch(r){case"grades":return e.jsx(d,{name:"BookOpen",size:16,className:"text-success"});case"absences":return e.jsx(d,{name:"Calendar",size:16,className:"text-error"});case"payments":return e.jsx(d,{name:"CreditCard",size:16,className:"text-warning"});case"meetings":return e.jsx(d,{name:"Users",size:16,className:"text-primary"});case"announcements":return e.jsx(d,{name:"Megaphone",size:16,className:"text-accent-foreground"});default:return e.jsx(d,{name:"Bell",size:16,className:"text-muted-foreground"})}},c=r=>{switch(r){case"grades":return"bg-success/10";case"absences":return"bg-error/10";case"payments":return"bg-warning/10";case"meetings":return"bg-primary/10";case"announcements":return"bg-accent/10";default:return"bg-muted/10"}},a=r=>{switch(r){case"high":return"border-l-error";case"medium":return"border-l-warning";case"low":return"border-l-success";default:return"border-l-muted"}},h=r=>{switch(r){case"grades":return"Notes";case"absences":return"Absences";case"payments":return"Paiements";case"meetings":return"RÃ©unions";case"announcements":return"Annonces";default:return"Autre"}},t=(s==null?void 0:s.filter(r=>i==="all"||(r==null?void 0:r.type)===i))||[],l=((p=s==null?void 0:s.filter(r=>!(r!=null&&r.read)))==null?void 0:p.length)||0,f=[{value:"all",label:"Toutes",count:(s==null?void 0:s.length)||0},{value:"grades",label:"Notes",count:((E=s==null?void 0:s.filter(r=>(r==null?void 0:r.type)==="grades"))==null?void 0:E.length)||0},{value:"absences",label:"Absences",count:((k=s==null?void 0:s.filter(r=>(r==null?void 0:r.type)==="absences"))==null?void 0:k.length)||0},{value:"payments",label:"Paiements",count:((D=s==null?void 0:s.filter(r=>(r==null?void 0:r.type)==="payments"))==null?void 0:D.length)||0},{value:"meetings",label:"RÃ©unions",count:((U=s==null?void 0:s.filter(r=>(r==null?void 0:r.type)==="meetings"))==null?void 0:U.length)||0}],A=r=>{var _;return(_=new Date(r))==null?void 0:_.toLocaleDateString("fr-FR",{day:"numeric",month:"long",hour:"2-digit",minute:"2-digit"})};return e.jsxs("div",{className:"bg-white rounded-2xl shadow-xl border-2 border-gray-200 p-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-8",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2.5 rounded-xl bg-gradient-to-br from-cyan-500 to-teal-600 shadow-md",children:e.jsx(d,{name:"MessageSquare",size:24,className:"text-white"})}),e.jsx("h3",{className:"font-display font-bold text-2xl text-gray-900",children:"Centre de Communication"})]}),e.jsxs("div",{className:"flex items-center gap-2 px-4 py-2.5 bg-gradient-to-br from-cyan-500 to-teal-600 rounded-xl shadow-md text-white",children:[e.jsx(d,{name:"Bell",size:18}),e.jsxs("span",{className:"font-body-bold text-sm",children:[l," non lu",l>1?"s":""]})]})]}),e.jsx("div",{className:"flex flex-wrap gap-2 mb-6",children:f==null?void 0:f.map(r=>e.jsxs("button",{onClick:()=>b(r==null?void 0:r.value),className:`px-4 py-2.5 rounded-xl font-body-bold text-sm transition-all hover:scale-105 ${i===(r==null?void 0:r.value)?"bg-gradient-to-br from-cyan-500 to-teal-600 text-white shadow-lg":"bg-gray-100 text-gray-700 hover:bg-gray-200 border-2 border-gray-200"}`,children:[r==null?void 0:r.label,(r==null?void 0:r.count)>0&&e.jsx("span",{className:`ml-2 px-2 py-1 rounded-full text-xs font-bold ${i===(r==null?void 0:r.value)?"bg-white/20 text-white":"bg-gray-300 text-gray-700"}`,children:r==null?void 0:r.count})]},r==null?void 0:r.value))}),e.jsxs("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:[t==null?void 0:t.map(r=>e.jsx("div",{onClick:()=>n((o==null?void 0:o.id)===(r==null?void 0:r.id)?null:r),className:`border-l-4 ${a(r==null?void 0:r.priority)} bg-gradient-to-r from-white to-gray-50 rounded-xl p-4 cursor-pointer transition-all hover:shadow-lg border-2 border-gray-200 ${r!=null&&r.read?"":"ring-2 ring-cyan-300"} ${(o==null?void 0:o.id)===(r==null?void 0:r.id)?"shadow-xl scale-[1.02]":""}`,children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:`p-2 rounded-lg ${c(r==null?void 0:r.type)}`,children:x(r==null?void 0:r.type)}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h4",{className:"font-heading font-heading-semibold text-base text-card-foreground truncate",children:r==null?void 0:r.title}),e.jsxs("div",{className:"flex items-center gap-2 ml-3",children:[!(r!=null&&r.read)&&e.jsx("div",{className:"w-2 h-2 bg-primary rounded-full"}),e.jsx("span",{className:"font-caption font-caption-normal text-xs text-muted-foreground whitespace-nowrap",children:A(r==null?void 0:r.date)})]})]}),e.jsx("p",{className:"font-body font-body-normal text-sm text-muted-foreground mb-3 line-clamp-2",children:r==null?void 0:r.message}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`px-2 py-1 rounded text-xs font-caption font-caption-semibold ${c(r==null?void 0:r.type)}`,children:h(r==null?void 0:r.type)}),e.jsx("span",{className:"font-caption font-caption-normal text-xs text-muted-foreground",children:r==null?void 0:r.school})]}),e.jsx("div",{className:"flex items-center gap-1",children:e.jsx(d,{name:(o==null?void 0:o.id)===(r==null?void 0:r.id)?"ChevronUp":"ChevronDown",size:14,className:"text-muted-foreground"})})]}),(o==null?void 0:o.id)===(r==null?void 0:r.id)&&e.jsxs("div",{className:"mt-4 pt-3 border-t border-border",children:[e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"font-body font-body-semibold text-muted-foreground",children:"Ã‰cole:"}),e.jsx("span",{className:"font-body font-body-normal text-card-foreground",children:r==null?void 0:r.school})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"font-body font-body-semibold text-muted-foreground",children:"PrioritÃ©:"}),e.jsx("span",{className:`font-body font-body-normal capitalize ${(r==null?void 0:r.priority)==="high"?"text-error":(r==null?void 0:r.priority)==="medium"?"text-warning":"text-success"}`,children:(r==null?void 0:r.priority)==="high"?"Haute":(r==null?void 0:r.priority)==="medium"?"Moyenne":"Faible"})]})]}),e.jsxs("div",{className:"flex gap-2 mt-4",children:[e.jsx("button",{className:"flex-1 bg-primary text-white font-caption font-caption-semibold py-2 px-3 rounded-lg hover:bg-primary/90 transition-colors",children:"Marquer comme lu"}),e.jsx("button",{className:"px-3 py-2 border border-border rounded-lg hover:bg-muted/20 transition-colors",children:e.jsx(d,{name:"Archive",size:14,className:"text-muted-foreground"})})]})]})]})]})},r==null?void 0:r.id)),(t==null?void 0:t.length)===0&&e.jsxs("div",{className:"text-center py-8",children:[e.jsx(d,{name:"Inbox",size:48,className:"text-muted-foreground mx-auto mb-3"}),e.jsx("p",{className:"font-body font-body-normal text-muted-foreground",children:i==="all"?"Aucune notification":`Aucune notification de type "${(v=f==null?void 0:f.find(r=>(r==null?void 0:r.value)===i))==null?void 0:v.label}"`})]})]}),(s==null?void 0:s.length)>0&&e.jsxs("div",{className:"mt-6 p-3 bg-muted/10 rounded-lg border border-border",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(d,{name:"MessageSquare",size:14,className:"text-primary"}),e.jsx("span",{className:"font-caption font-caption-semibold text-sm text-primary",children:"Historique SMS"})]}),e.jsxs("p",{className:"font-caption font-caption-normal text-xs text-muted-foreground mt-1",children:["Toutes les notifications importantes sont Ã©galement envoyÃ©es par SMS au ",m?`parent de ${m}`:"parent","."]})]})]})},ne=({events:s,selectedSchool:m,selectedChild:i})=>{const b=l=>{switch(l){case"meeting":return e.jsx(d,{name:"Users",size:20,className:"text-primary"});case"ceremony":return e.jsx(d,{name:"Award",size:20,className:"text-success"});case"excursion":return e.jsx(d,{name:"MapPin",size:20,className:"text-warning"});case"exam":return e.jsx(d,{name:"FileText",size:20,className:"text-error"});default:return e.jsx(d,{name:"Calendar",size:20,className:"text-muted-foreground"})}},o=l=>{switch(l){case"meeting":return"bg-primary/10";case"ceremony":return"bg-success/10";case"excursion":return"bg-warning/10";case"exam":return"bg-error/10";default:return"bg-muted/10"}},n=l=>{switch(l){case"meeting":return"RÃ©union";case"ceremony":return"CÃ©rÃ©monie";case"excursion":return"Sortie";case"exam":return"Examen";default:return"Ã‰vÃ©nement"}},x=(s==null?void 0:s.filter(l=>{if(m&&i)return(l==null?void 0:l.school)===(i==null?void 0:i.school);if(m){const f=l==null?void 0:l.school;return(f==null?void 0:f.includes(m))||(l==null?void 0:l.child)===(i==null?void 0:i.name)}return!0}))||[],c=x==null?void 0:x.sort((l,f)=>new Date(l==null?void 0:l.date)-new Date(f==null?void 0:f.date)),a=l=>{const f=new Date(l),p=f-new Date,E=Math.ceil(p/(1e3*60*60*24));let k=f==null?void 0:f.toLocaleDateString("fr-FR",{weekday:"long",day:"numeric",month:"long"});return E===0?k="Aujourd'hui":E===1?k="Demain":E>0&&E<=7&&(k=`Dans ${E} jour${E>1?"s":""}`),k},h=l=>l==null?void 0:l.substring(0,5),t=l=>{const p=new Date(l)-new Date;return Math.ceil(p/(1e3*60*60*24))};return e.jsxs("div",{className:"bg-white rounded-2xl shadow-xl border-2 border-gray-200 p-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-8",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2.5 rounded-xl bg-gradient-to-br from-indigo-500 to-purple-600 shadow-md",children:e.jsx(d,{name:"Calendar",size:24,className:"text-white"})}),e.jsx("h3",{className:"font-display font-bold text-2xl text-gray-900",children:"Ã‰vÃ©nements Ã  Venir"})]}),e.jsxs("div",{className:"flex items-center gap-2 px-4 py-2.5 bg-gradient-to-br from-indigo-500 to-purple-600 rounded-xl shadow-md text-white",children:[e.jsx(d,{name:"Star",size:18}),e.jsx("span",{className:"font-body-bold text-sm",children:c==null?void 0:c.length})]})]}),i&&e.jsx("div",{className:"mb-6 p-4 bg-gradient-to-br from-indigo-50 to-purple-50 rounded-xl border-2 border-indigo-200 shadow-sm",children:e.jsxs("p",{className:"font-body-medium text-sm text-gray-700",children:["Ã‰vÃ©nements concernant ",e.jsx("span",{className:"font-body-bold text-indigo-700",children:i==null?void 0:i.name})," Ã ",e.jsxs("span",{className:"font-body-bold text-indigo-700",children:[" ",i==null?void 0:i.school]})]})}),e.jsxs("div",{className:"space-y-4",children:[c==null?void 0:c.map(l=>{const f=t(l==null?void 0:l.date),A=f<=2,p=f<0;return e.jsx("div",{className:`border-l-4 rounded-xl p-5 transition-all border-2 hover:scale-[1.02] ${p?"border-l-gray-400 border-gray-200 bg-gray-50 opacity-60":A?"border-l-red-500 border-red-200 bg-gradient-to-r from-red-50 to-rose-50 shadow-lg":"border-l-indigo-500 border-indigo-200 bg-gradient-to-r from-indigo-50 to-purple-50 shadow-md"}`,children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:`p-3 rounded-lg ${o(l==null?void 0:l.type)} ${p?"opacity-60":""}`,children:b(l==null?void 0:l.type)}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsx("h4",{className:"font-heading font-heading-semibold text-lg text-card-foreground",children:l==null?void 0:l.title}),e.jsxs("div",{className:"text-right ml-3",children:[A&&!p&&e.jsxs("div",{className:"inline-flex items-center gap-1 px-2 py-1 bg-error/10 text-error rounded-full mb-1",children:[e.jsx(d,{name:"AlertCircle",size:12}),e.jsx("span",{className:"font-caption font-caption-semibold text-xs",children:"Urgent"})]}),e.jsx("div",{className:`font-caption font-caption-semibold text-xs ${p?"text-muted-foreground":"text-primary"}`,children:a(l==null?void 0:l.date)})]})]}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(d,{name:"User",size:14,className:"text-muted-foreground"}),e.jsxs("span",{className:"font-body font-body-normal text-muted-foreground",children:["ConcernÃ©: ",e.jsx("span",{className:"font-body-semibold",children:l==null?void 0:l.child})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(d,{name:"School",size:14,className:"text-muted-foreground"}),e.jsx("span",{className:"font-body font-body-normal text-muted-foreground",children:l==null?void 0:l.school})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(d,{name:"Clock",size:14,className:"text-muted-foreground"}),e.jsx("span",{className:"font-body font-body-normal text-muted-foreground",children:h(l==null?void 0:l.time)})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(d,{name:"MapPin",size:14,className:"text-muted-foreground"}),e.jsx("span",{className:"font-body font-body-normal text-muted-foreground",children:l==null?void 0:l.location})]})]}),e.jsxs("div",{className:"flex items-center justify-between pt-2",children:[e.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-caption font-caption-semibold ${o(l==null?void 0:l.type)}`,children:n(l==null?void 0:l.type)}),!p&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{className:"px-3 py-1 bg-primary/10 text-primary hover:bg-primary/20 rounded-lg transition-colors",children:[e.jsx(d,{name:"Bell",size:12,className:"inline mr-1"}),"Rappel"]}),e.jsxs("button",{className:"px-3 py-1 bg-success/10 text-success hover:bg-success/20 rounded-lg transition-colors",children:[e.jsx(d,{name:"Calendar",size:12,className:"inline mr-1"}),"Agenda"]})]})]})]})]})]})},l==null?void 0:l.id)}),(c==null?void 0:c.length)===0&&e.jsxs("div",{className:"text-center py-8",children:[e.jsx(d,{name:"Calendar",size:48,className:"text-muted-foreground mx-auto mb-3"}),e.jsxs("p",{className:"font-body font-body-normal text-muted-foreground",children:["Aucun Ã©vÃ©nement programmÃ©",i&&` pour ${i==null?void 0:i.name}`]})]})]}),(c==null?void 0:c.length)>0&&e.jsx("div",{className:"mt-6 p-4 bg-accent/5 border border-accent/20 rounded-lg",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(d,{name:"Calendar",size:16,className:"text-accent-foreground mt-0.5"}),e.jsxs("div",{className:"text-sm",children:[e.jsx("p",{className:"font-body font-body-semibold text-accent-foreground mb-1",children:"Synchronisation Calendrier"}),e.jsx("p",{className:"font-body font-body-normal text-muted-foreground",children:"Vous pouvez synchroniser ces Ã©vÃ©nements avec votre calendrier personnel et recevoir des rappels automatiques."})]})]})})]})},oe=({parentGlobalId:s,children:m=[],schools:i=[],isLoading:b=!1})=>{var x,c,a,h;const[o,n]=w.useState(null);return w.useEffect(()=>{m.length>0&&!o&&n(m[0])},[m]),b?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 rounded-2xl p-10 border-2 border-blue-200 shadow-xl text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-4 border-blue-200 border-t-blue-600 mx-auto mb-4"}),e.jsx("span",{className:"text-blue-900 font-display font-bold",children:"Chargement de vos enfants..."})]})}):m.length===0?e.jsxs("div",{className:"text-center py-12 bg-gradient-to-br from-gray-50 to-white rounded-2xl border-2 border-gray-200 p-10 shadow-md",children:[e.jsx("div",{className:"w-20 h-20 mx-auto mb-6 rounded-2xl bg-gradient-to-br from-gray-400 to-gray-600 flex items-center justify-center shadow-md",children:e.jsx(d,{name:"Users",size:40,className:"text-white"})}),e.jsx("h3",{className:"text-xl font-display font-bold text-gray-800 mb-2",children:"Aucun enfant trouvÃ©"}),e.jsx("p",{className:"text-gray-600",children:"Contactez le secrÃ©tariat pour inscrire vos enfants."})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-gradient-to-br from-blue-600 to-indigo-600 rounded-2xl shadow-xl p-8 text-white",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-16 h-16 bg-white/20 backdrop-blur-sm rounded-2xl flex items-center justify-center text-4xl shadow-lg",children:"ðŸ«"}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-display font-bold",children:"Vos Enfants Multi-Ã‰tablissements"}),e.jsx("p",{className:"text-blue-100 mt-1",children:"Un seul compte pour tous vos enfants dans diffÃ©rentes Ã©coles"})]})]}),e.jsxs("div",{className:"bg-white/20 backdrop-blur-sm rounded-xl px-6 py-4 shadow-md border border-white/30",children:[e.jsx("div",{className:"text-3xl font-display font-bold",children:m.length}),e.jsx("div",{className:"text-sm text-blue-100 mt-1",children:"Enfant(s)"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-white/20 backdrop-blur-sm rounded-xl p-4 text-center border border-white/30 shadow-md",children:[e.jsx("div",{className:"text-2xl font-display font-bold",children:(i==null?void 0:i.length)||new Set(m.map(t=>{var l;return t.schoolId||((l=t.school)==null?void 0:l.id)})).size}),e.jsx("div",{className:"text-sm text-blue-100 mt-1",children:"Ã‰tablissement(s)"})]}),e.jsxs("div",{className:"bg-white/20 backdrop-blur-sm rounded-xl p-4 text-center border border-white/30 shadow-md",children:[e.jsx("div",{className:"text-2xl font-display font-bold",children:new Set(m.map(t=>{var l;return typeof t.school=="object"?(l=t.school)==null?void 0:l.name:t.school})).size}),e.jsx("div",{className:"text-sm text-blue-100 mt-1",children:"Ã‰cole(s) diffÃ©rente(s)"})]}),e.jsxs("div",{className:"bg-white/20 backdrop-blur-sm rounded-xl p-4 text-center border border-white/30 shadow-md",children:[e.jsx("div",{className:"text-2xl font-display font-bold",children:m.filter(t=>t.averageGrade>0).length}),e.jsx("div",{className:"text-sm text-blue-100 mt-1",children:"Avec notes"})]})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:m.map((t,l)=>{var k,D;const f=t.full_name||t.name||`${t.firstName||""} ${t.lastName||""}`,A=f.charAt(0).toUpperCase(),p=typeof t.class=="object"?(k=t.class)==null?void 0:k.name:t.class,E=typeof t.school=="object"?(D=t.school)==null?void 0:D.name:t.school;return e.jsxs("div",{onClick:()=>n(t),className:`group rounded-2xl p-5 cursor-pointer transition-all duration-300 border-2 shadow-md hover:shadow-xl hover:scale-102 ${(o==null?void 0:o.id)===t.id?"border-blue-500 bg-gradient-to-br from-blue-50 to-indigo-50":"border-gray-200 bg-white hover:border-blue-300"}`,children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-14 h-14 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-xl flex items-center justify-center text-white font-display font-bold text-xl shadow-md group-hover:scale-110 transition-transform",children:A}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-display font-bold text-gray-900",children:f}),e.jsx("p",{className:"text-sm text-gray-600 font-body-medium",children:p||"Classe non renseignÃ©e"})]})]}),(o==null?void 0:o.id)===t.id&&e.jsx("div",{className:"p-1.5 bg-blue-500 rounded-lg shadow-md",children:e.jsx(d,{name:"Check",size:18,className:"text-white"})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center text-sm bg-gray-50 rounded-lg p-2",children:[e.jsx("div",{className:"p-1 bg-indigo-100 rounded-md mr-2",children:e.jsx(d,{name:"School",size:14,className:"text-indigo-600"})}),e.jsx("span",{className:"font-body-bold text-gray-800",children:E||"Ã‰cole non renseignÃ©e"})]}),t.matricule&&e.jsxs("div",{className:"flex items-center text-sm bg-gray-50 rounded-lg p-2",children:[e.jsx("div",{className:"p-1 bg-purple-100 rounded-md mr-2",children:e.jsx(d,{name:"Tag",size:14,className:"text-purple-600"})}),e.jsx("span",{className:"font-body-medium text-gray-700",children:t.matricule})]})]}),(t.averageGrade>0||t.attendanceRate>0)&&e.jsxs("div",{className:"mt-4 pt-4 border-t-2 border-gray-100 flex justify-between",children:[t.averageGrade>0&&e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-lg font-display font-bold text-blue-600",children:[t.averageGrade.toFixed(1),"/20"]}),e.jsx("div",{className:"text-xs text-gray-500",children:"Moyenne"})]}),t.attendanceRate>0&&e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-lg font-display font-bold text-green-600",children:[t.attendanceRate,"%"]}),e.jsx("div",{className:"text-xs text-gray-500",children:"PrÃ©sence"})]})]})]},t.id||l)})}),o&&e.jsxs("div",{className:"bg-white border-2 border-gray-200 rounded-2xl p-8 shadow-lg",children:[e.jsx("div",{className:"flex items-center justify-between mb-8",children:e.jsxs("div",{className:"flex items-center space-x-5",children:[e.jsx("div",{className:"w-20 h-20 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-2xl flex items-center justify-center text-white text-2xl font-display font-bold shadow-md",children:(o.full_name||o.name||"?").charAt(0).toUpperCase()}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-display font-bold text-gray-900",children:o.full_name||o.name||"Nom non disponible"}),e.jsxs("p",{className:"text-gray-600 font-body-medium mt-1",children:[typeof o.class=="object"?(x=o.class)==null?void 0:x.name:o.class," â€¢ ",typeof o.school=="object"?(c=o.school)==null?void 0:c.name:o.school]}),o.matricule&&e.jsxs("p",{className:"text-sm text-gray-500 mt-1 flex items-center gap-2",children:[e.jsx(d,{name:"Tag",size:14}),"Matricule: ",o.matricule]})]})]})}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-8",children:[o.averageGrade>0&&e.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 rounded-xl p-4 text-center border-2 border-blue-200",children:[e.jsxs("div",{className:"text-2xl font-display font-bold text-blue-600",children:[o.averageGrade.toFixed(1),"/20"]}),e.jsx("div",{className:"text-sm text-gray-600 mt-1",children:"Moyenne gÃ©nÃ©rale"})]}),o.attendanceRate>0&&e.jsxs("div",{className:"bg-gradient-to-br from-green-50 to-emerald-50 rounded-xl p-4 text-center border-2 border-green-200",children:[e.jsxs("div",{className:"text-2xl font-display font-bold text-green-600",children:[o.attendanceRate,"%"]}),e.jsx("div",{className:"text-sm text-gray-600 mt-1",children:"Taux de prÃ©sence"})]}),o.unreadNotifications>0&&e.jsxs("div",{className:"bg-gradient-to-br from-orange-50 to-amber-50 rounded-xl p-4 text-center border-2 border-orange-200",children:[e.jsx("div",{className:"text-2xl font-display font-bold text-orange-600",children:o.unreadNotifications}),e.jsx("div",{className:"text-sm text-gray-600 mt-1",children:"Notifications"})]}),o.pendingPayments>0&&e.jsxs("div",{className:"bg-gradient-to-br from-red-50 to-rose-50 rounded-xl p-4 text-center border-2 border-red-200",children:[e.jsx("div",{className:"text-2xl font-display font-bold text-red-600",children:o.pendingPayments}),e.jsx("div",{className:"text-sm text-gray-600 mt-1",children:"Paiements en attente"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 rounded-2xl p-6 border-2 border-blue-200",children:[e.jsxs("h3",{className:"font-display font-bold text-xl text-blue-900 mb-4 flex items-center gap-2",children:[e.jsx(d,{name:"School",size:24,className:"text-blue-600"}),"Informations Scolaires"]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"bg-white rounded-lg p-3",children:[e.jsx("span",{className:"text-sm text-gray-500",children:"Ã‰tablissement:"}),e.jsx("p",{className:"font-body-bold text-gray-900",children:typeof o.school=="object"?(a=o.school)==null?void 0:a.name:o.school||"Non renseignÃ©"})]}),e.jsxs("div",{className:"bg-white rounded-lg p-3",children:[e.jsx("span",{className:"text-sm text-gray-500",children:"Classe:"}),e.jsx("p",{className:"font-body-bold text-gray-900",children:typeof o.class=="object"?(h=o.class)==null?void 0:h.name:o.class||"Non renseignÃ©e"})]})]})]}),e.jsxs("div",{className:"bg-gradient-to-br from-purple-50 to-pink-50 rounded-2xl p-6 border-2 border-purple-200",children:[e.jsxs("h3",{className:"font-display font-bold text-xl text-purple-900 mb-4 flex items-center gap-2",children:[e.jsx(d,{name:"Bell",size:24,className:"text-purple-600"}),"Suivi et Notifications"]}),e.jsxs("div",{className:"space-y-3",children:[o.email&&e.jsxs("div",{className:"bg-white rounded-lg p-3",children:[e.jsx("span",{className:"text-sm text-gray-500",children:"Email:"}),e.jsx("p",{className:"font-body-bold text-gray-900",children:o.email})]}),o.phone&&e.jsxs("div",{className:"bg-white rounded-lg p-3",children:[e.jsx("span",{className:"text-sm text-gray-500",children:"TÃ©lÃ©phone:"}),e.jsx("p",{className:"font-body-bold text-gray-900",children:o.phone})]}),!o.email&&!o.phone&&e.jsxs("div",{className:"bg-white rounded-lg p-3 text-center text-gray-500",children:[e.jsx(d,{name:"Info",size:20,className:"mx-auto mb-2"}),e.jsx("p",{className:"text-sm",children:"Aucune information de contact disponible"})]})]})]})]})]})]})},le=({child:s,isOpen:m,onClose:i,onUpdate:b})=>{const[o,n]=w.useState("info"),[x,c]=w.useState(!1),[a,h]=w.useState(""),[t,l]=w.useState(""),[f,A]=w.useState(!1),[p,E]=w.useState((s==null?void 0:s.phone)||"");if(!m||!s)return null;const k=async()=>{if(!a){alert("Veuillez saisir un nouveau mot de passe");return}if(a.length<8){alert("Le mot de passe doit contenir au moins 8 caractÃ¨res");return}if(a!==t){alert("Les mots de passe ne correspondent pas");return}c(!0);try{const r="https://lbqwbnclknwszdnlxaxz.supabase.co/functions/v1/update-student-password",{data:{session:_}}=await $.auth.getSession();if(!_){alert("âŒ Vous devez Ãªtre connectÃ© pour effectuer cette action");return}const S=await fetch(r,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${_.access_token}`,apikey:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImxicXdibmNsa253c3pkbmx4YXh6Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjE0ODMwNzEsImV4cCI6MjA3NzA1OTA3MX0.Jy7Vx_satR9CUGqMWSydr7Z6mwODNDTp3dD5PGmLq1w"},body:JSON.stringify({student_user_id:s.user_id,new_password:a,parent_user_id:_.user.id})}),q=await S.json();if(!S.ok)throw new Error(q.error||"Erreur lors du changement de mot de passe");alert(`âœ… Mot de passe modifiÃ© avec succÃ¨s pour ${s.full_name}

Nouveau mot de passe: ${a}

âš ï¸ Communiquez ce mot de passe Ã  votre enfant de maniÃ¨re sÃ©curisÃ©e.`),h(""),l(""),i()}catch(v){console.error("Erreur changement mot de passe:",v),v.message.includes("fetch")||v.message.includes("404")?alert(`âš ï¸ Service de modification de mot de passe non disponible

Pour modifier le mot de passe de ${s.full_name}, veuillez:

1. Contacter l'Ã©tablissement
2. Ou demander Ã  l'administrateur de dÃ©ployer la fonction Supabase

Nouveau mot de passe souhaitÃ©: ${a}

Instructions de dÃ©ploiement dans supabase/functions/update-student-password/`):alert(`âŒ Erreur: ${v.message}`)}finally{c(!1)}},D=async()=>{c(!0);try{const{error:v}=await $.from("users").update({phone:p}).eq("id",s.user_id);if(v)throw v;alert(`âœ… Informations mises Ã  jour pour ${s.full_name}`),b==null||b(),i()}catch(v){console.error("Erreur mise Ã  jour info:",v),alert(`âŒ Erreur: ${v.message}`)}finally{c(!1)}},U=()=>{const r="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789!@#$%";let _="";for(let S=0;S<12;S++)_+=r.charAt(Math.floor(Math.random()*r.length));h(_),l(_)};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"sticky top-0 bg-white border-b px-6 py-4 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-primary/10 flex items-center justify-center mr-3",children:e.jsx(d,{name:"User",size:24,className:"text-primary"})}),e.jsxs("div",{children:[e.jsxs("h2",{className:"text-xl font-semibold text-gray-900",children:["GÃ©rer ",s.full_name]}),e.jsxs("p",{className:"text-sm text-gray-500",children:[s.class_name," â€¢ ",s.matricule||"N/A"]})]})]}),e.jsx("button",{onClick:i,className:"p-2 hover:bg-gray-100 rounded-full transition-colors",children:e.jsx(d,{name:"X",size:20,className:"text-gray-500"})})]}),e.jsx("div",{className:"border-b px-6",children:e.jsxs("div",{className:"flex space-x-4",children:[e.jsxs("button",{onClick:()=>n("info"),className:`py-3 px-4 border-b-2 font-medium transition-colors ${o==="info"?"border-primary text-primary":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[e.jsx(d,{name:"Info",size:16,className:"inline mr-2"}),"Informations"]}),e.jsxs("button",{onClick:()=>n("password"),className:`py-3 px-4 border-b-2 font-medium transition-colors ${o==="password"?"border-primary text-primary":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[e.jsx(d,{name:"Lock",size:16,className:"inline mr-2"}),"Mot de passe"]})]})}),e.jsxs("div",{className:"p-6",children:[o==="info"&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx(d,{name:"Info",size:20,className:"text-blue-600 mr-3 flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"text-sm text-blue-800",children:[e.jsx("p",{className:"font-medium",children:"Informations de l'Ã©lÃ¨ve"}),e.jsx("p",{className:"mt-1",children:"Ces informations sont gÃ©rÃ©es par l'Ã©tablissement. Vous pouvez mettre Ã  jour le numÃ©ro de tÃ©lÃ©phone de contact."})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nom complet"}),e.jsx("div",{className:"px-3 py-2 bg-gray-50 border border-gray-200 rounded-lg text-gray-700",children:s.full_name})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Matricule"}),e.jsx("div",{className:"px-3 py-2 bg-gray-50 border border-gray-200 rounded-lg text-gray-700",children:s.matricule||"Non assignÃ©"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Classe"}),e.jsx("div",{className:"px-3 py-2 bg-gray-50 border border-gray-200 rounded-lg text-gray-700",children:s.class_name||"Non assignÃ©"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email de connexion"}),e.jsx("div",{className:"px-3 py-2 bg-gray-50 border border-gray-200 rounded-lg text-gray-700 text-sm",children:s.email||"Non assignÃ©"})]}),e.jsx("div",{className:"md:col-span-2",children:e.jsx(Z,{label:"TÃ©lÃ©phone de contact",value:p,onChange:v=>E(v.target.value),placeholder:"+237 6XX XXX XXX",helperText:"NumÃ©ro pour contacter l'Ã©lÃ¨ve"})})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t",children:[e.jsx(J,{variant:"outline",onClick:i,children:"Annuler"}),e.jsx(J,{onClick:D,disabled:x,children:x?"Enregistrement...":"Enregistrer"})]})]}),o==="password"&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-amber-50 border border-amber-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx(d,{name:"AlertTriangle",size:20,className:"text-amber-600 mr-3 flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"text-sm text-amber-800",children:[e.jsx("p",{className:"font-medium",children:"Modification du mot de passe"}),e.jsx("p",{className:"mt-1",children:"AprÃ¨s modification, votre enfant devra utiliser ce nouveau mot de passe pour se connecter. Assurez-vous de bien le noter et de le communiquer Ã  votre enfant."})]})]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(Z,{label:"Nouveau mot de passe *",type:f?"text":"password",value:a,onChange:v=>h(v.target.value),placeholder:"Minimum 8 caractÃ¨res",helperText:"Utilisez un mot de passe fort avec lettres, chiffres et caractÃ¨res spÃ©ciaux"}),e.jsx("button",{type:"button",onClick:()=>A(!f),className:"absolute right-3 top-9 text-gray-500 hover:text-gray-700 transition-colors",children:e.jsx(d,{name:f?"EyeOff":"Eye",size:18})})]}),e.jsx(Z,{label:"Confirmer le mot de passe *",type:f?"text":"password",value:t,onChange:v=>l(v.target.value),placeholder:"Retapez le mot de passe"}),e.jsxs(J,{variant:"outline",onClick:U,className:"w-full",children:[e.jsx(d,{name:"RefreshCw",size:16,className:"mr-2"}),"GÃ©nÃ©rer un mot de passe alÃ©atoire"]})]}),a&&e.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:[e.jsx("p",{className:"text-sm font-medium text-green-800 mb-2",children:"Nouveau mot de passe Ã  communiquer :"}),e.jsx("div",{className:"bg-white px-3 py-2 rounded border border-green-300 font-mono text-sm",children:a}),e.jsx("p",{className:"text-xs text-green-700 mt-2",children:"âš ï¸ Notez ce mot de passe dans un endroit sÃ»r avant de valider"})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t",children:[e.jsx(J,{variant:"outline",onClick:i,children:"Annuler"}),e.jsx(J,{onClick:k,disabled:x||!a||a!==t,children:x?"Modification...":"Modifier le mot de passe"})]})]})]})]})})},be=()=>{var B,L,X,V;const[s]=se(),m=s.get("tab")||"dashboard",[i,b]=w.useState(!1),[o,n]=w.useState(new Date),[x,c]=w.useState("traditional"),[a,h]=w.useState(null),[t,l]=w.useState(!1),{parentProfile:f,children:A,selectedChild:p,selectedSchool:E,gradesData:k,attendanceData:D,paymentData:U,notificationsData:v,upcomingEvents:r,schools:_,isLoading:S,handleChildSelect:q,handleSchoolChange:R,getUnreadCount:M}=ae(),z={id:(f==null?void 0:f.id)||"parent-loading",name:(f==null?void 0:f.full_name)||"Chargement...",phone:(f==null?void 0:f.phone)||"",children:A.map(j=>{var u,N,C,g;return{id:j.id,user_id:j.user_id,name:j.full_name||j.name,full_name:j.full_name||j.name,matricule:j.matricule,class:typeof j.class=="object"?(u=j.class)==null?void 0:u.name:j.class,class_name:typeof j.class=="object"?(N=j.class)==null?void 0:N.name:j.class,school:typeof j.school=="object"?(C=j.school)==null?void 0:C.name:j.school,schoolId:typeof j.school=="object"?(g=j.school)==null?void 0:g.id:j.schoolId,photo:j.photo_url||j.photo,email:j.email,phone:j.phone,averageGrade:j.averageGrade||0,attendanceRate:j.attendanceRate||0,unreadNotifications:j.unreadNotifications||0,pendingPayments:j.pendingPayments||0}})};w.useEffect(()=>{const j=setInterval(()=>{n(new Date)},1e3);return()=>clearInterval(j)},[]);const T=()=>{const j=o==null?void 0:o.getHours();return j<12?"Bonjour":j<18?"Bon aprÃ¨s-midi":"Bonsoir"},G=()=>_.map(j=>({id:j.id,name:j.name})),P=z.children.find(j=>j.id===(p==null?void 0:p.id)),F=j=>{l(!0),q(j),setTimeout(()=>l(!1),300)},H=()=>{switch(m){case"children":return e.jsxs("div",{className:"space-y-6",children:[e.jsx("h2",{className:"font-heading font-heading-bold text-2xl text-card-foreground",children:"Mes Enfants"}),e.jsx(Y,{children:z==null?void 0:z.children,schools:G(),selectedChild:p,selectedSchool:E,onChildSelect:F,onSchoolChange:R,onManageChild:j=>h(j)}),e.jsxs("div",{className:"relative",children:[t&&e.jsx("div",{className:"absolute inset-0 bg-white/60 backdrop-blur-sm z-10 flex items-center justify-center rounded-2xl",children:e.jsxs("div",{className:"bg-gradient-to-br from-indigo-50 to-purple-50 rounded-2xl p-6 border-2 border-indigo-200 shadow-xl",children:[e.jsx("div",{className:"animate-spin rounded-full h-10 w-10 border-4 border-indigo-200 border-t-indigo-600 mx-auto mb-3"}),e.jsx("span",{className:"text-indigo-900 font-body-bold text-sm",children:"Chargement..."})]})}),e.jsx("div",{className:`transition-opacity duration-300 ${t?"opacity-50":"opacity-100"}`,children:P&&e.jsx(W,{child:P})})]})]});case"grades":return e.jsxs("div",{className:"space-y-6",children:[e.jsx("h2",{className:"font-heading font-heading-bold text-2xl text-card-foreground",children:"Notes et RÃ©sultats"}),P?e.jsx(K,{child:P,grades:(k==null?void 0:k[p==null?void 0:p.id])||[]}):e.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 rounded-2xl border-2 border-blue-200 p-10 text-center shadow-md",children:[e.jsx("div",{className:"w-20 h-20 mx-auto mb-6 rounded-2xl bg-gradient-to-br from-blue-500 to-indigo-600 flex items-center justify-center shadow-md",children:e.jsx(d,{name:"BookOpen",size:40,className:"text-white"})}),e.jsx("p",{className:"text-blue-900 font-display font-bold text-lg",children:"SÃ©lectionnez un enfant pour voir les notes"})]})]});case"attendance":return e.jsxs("div",{className:"space-y-6",children:[e.jsx("h2",{className:"font-heading font-heading-bold text-2xl text-card-foreground",children:"PrÃ©sences et Absences"}),P?e.jsx(Q,{child:P,attendance:(D==null?void 0:D[p==null?void 0:p.id])||{}}):e.jsxs("div",{className:"bg-gradient-to-br from-cyan-50 to-teal-50 rounded-2xl border-2 border-cyan-200 p-10 text-center shadow-md",children:[e.jsx("div",{className:"w-20 h-20 mx-auto mb-6 rounded-2xl bg-gradient-to-br from-cyan-500 to-teal-600 flex items-center justify-center shadow-md",children:e.jsx(d,{name:"Calendar",size:40,className:"text-white"})}),e.jsx("p",{className:"text-cyan-900 font-display font-bold text-lg",children:"SÃ©lectionnez un enfant pour voir les prÃ©sences"})]})]});case"payments":return e.jsxs("div",{className:"space-y-6",children:[e.jsx("h2",{className:"font-heading font-heading-bold text-2xl text-card-foreground",children:"Paiements et Frais"}),P?e.jsx(O,{child:P,payments:(U==null?void 0:U[p==null?void 0:p.id])||[]}):e.jsxs("div",{className:"bg-gradient-to-br from-green-50 to-emerald-50 rounded-2xl border-2 border-green-200 p-10 text-center shadow-md",children:[e.jsx("div",{className:"w-20 h-20 mx-auto mb-6 rounded-2xl bg-gradient-to-br from-green-500 to-emerald-600 flex items-center justify-center shadow-md",children:e.jsx(d,{name:"CreditCard",size:40,className:"text-white"})}),e.jsx("p",{className:"text-green-900 font-display font-bold text-lg",children:"SÃ©lectionnez un enfant pour voir les paiements"})]})]});case"messages":return e.jsxs("div",{className:"space-y-6",children:[e.jsx("h2",{className:"font-heading font-heading-bold text-2xl text-card-foreground",children:"Communications"}),P?e.jsx(ee,{child:P,notifications:(v==null?void 0:v[p==null?void 0:p.id])||[]}):e.jsxs("div",{className:"bg-gradient-to-br from-purple-50 to-pink-50 rounded-2xl border-2 border-purple-200 p-10 text-center shadow-md",children:[e.jsx("div",{className:"w-20 h-20 mx-auto mb-6 rounded-2xl bg-gradient-to-br from-purple-500 to-pink-600 flex items-center justify-center shadow-md",children:e.jsx(d,{name:"MessageCircle",size:40,className:"text-white"})}),e.jsx("p",{className:"text-purple-900 font-display font-bold text-lg",children:"SÃ©lectionnez un enfant pour voir les communications"})]})]});default:return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between bg-gradient-to-br from-white to-gray-50 rounded-2xl p-6 border-2 border-gray-200 shadow-md",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-display font-bold text-xl text-gray-900",children:"Mode d'affichage"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Choisissez comment voir vos enfants"})]}),e.jsxs("div",{className:"flex bg-gray-100 rounded-xl p-1.5 shadow-inner",children:[e.jsxs("button",{onClick:()=>c("traditional"),className:`px-5 py-3 rounded-lg font-body-bold transition-all duration-200 ${x==="traditional"?"bg-gradient-to-br from-indigo-600 to-purple-600 text-white shadow-lg scale-105":"text-gray-600 hover:text-gray-900 hover:bg-gray-200"}`,children:[e.jsx(d,{name:"Users",size:18,className:"mr-2 inline"}),"Vue Traditionnelle"]}),e.jsxs("button",{onClick:()=>c("multischool"),className:`px-5 py-3 rounded-lg font-body-bold transition-all duration-200 ${x==="multischool"?"bg-gradient-to-br from-purple-600 to-pink-600 text-white shadow-lg scale-105":"text-gray-600 hover:text-gray-900 hover:bg-gray-200"}`,children:[e.jsx(d,{name:"Globe",size:18,className:"mr-2 inline"}),"Multi-Ã‰tablissements"]})]})]}),x==="multischool"&&e.jsx(oe,{parentGlobalId:(f==null?void 0:f.id)||"global-parent-1",children:z.children,schools:_,isLoading:S}),x==="traditional"&&e.jsxs(e.Fragment,{children:[e.jsx(Y,{children:z==null?void 0:z.children,schools:G(),selectedChild:p,selectedSchool:E,onChildSelect:F,onSchoolChange:R,onManageChild:j=>h(j)}),e.jsxs("div",{className:"relative",children:[t&&e.jsx("div",{className:"absolute inset-0 bg-white/60 backdrop-blur-sm z-10 flex items-center justify-center rounded-2xl",children:e.jsxs("div",{className:"bg-gradient-to-br from-indigo-50 to-purple-50 rounded-2xl p-6 border-2 border-indigo-200 shadow-xl",children:[e.jsx("div",{className:"animate-spin rounded-full h-10 w-10 border-4 border-indigo-200 border-t-indigo-600 mx-auto mb-3"}),e.jsx("span",{className:"text-indigo-900 font-body-bold text-sm",children:"Chargement..."})]})}),e.jsxs("div",{className:`transition-opacity duration-300 ${t?"opacity-50":"opacity-100"}`,children:[P&&e.jsx(W,{child:P}),P&&e.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-3 gap-6 mt-6",children:[e.jsxs("div",{className:"xl:col-span-2 space-y-6",children:[e.jsx(K,{child:P,grades:(k==null?void 0:k[p==null?void 0:p.id])||[]}),e.jsx(Q,{child:P,attendance:(D==null?void 0:D[p==null?void 0:p.id])||{}})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsx(O,{child:P,payments:(U==null?void 0:U[p==null?void 0:p.id])||[]}),e.jsx(ee,{child:P,notifications:(v==null?void 0:v[p==null?void 0:p.id])||[]})]})]}),e.jsx(ne,{events:r})]})]})]})]})}};return e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx(re,{userRole:"parent",userName:z==null?void 0:z.name,onToggleSidebar:()=>b(!i)}),e.jsx(te,{userRole:"parent",isCollapsed:i,onToggle:()=>b(!i)}),e.jsx("main",{className:`pt-20 sm:pt-16 transition-all duration-300 ${i?"lg:ml-16":"lg:ml-64"}`,children:e.jsxs("div",{className:"px-2 sm:px-4 lg:px-6 py-2 sm:py-3 space-y-2 sm:space-y-3 w-full overflow-x-hidden",children:[S&&A.length===0&&e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsxs("div",{className:"text-center bg-gradient-to-br from-indigo-50 to-purple-50 rounded-2xl p-10 border-2 border-indigo-200 shadow-xl",children:[e.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-4 border-indigo-200 border-t-indigo-600 mx-auto mb-6"}),e.jsx("p",{className:"text-indigo-900 font-display font-bold text-xl",children:"Chargement des donnÃ©es..."}),e.jsx("p",{className:"text-indigo-600 text-sm mt-2",children:"Veuillez patienter"})]})}),!S&&e.jsx("div",{className:"bg-gradient-to-br from-indigo-600 to-purple-600 rounded-2xl shadow-xl p-8 text-white",children:e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-start lg:justify-between gap-6",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-3",children:[e.jsx("div",{className:"w-16 h-16 bg-white/20 backdrop-blur-sm rounded-2xl flex items-center justify-center text-4xl shadow-lg",children:"ðŸ‘‹"}),e.jsxs("div",{children:[e.jsxs("h1",{className:"font-display font-bold text-3xl lg:text-4xl",children:[T(),", M./Mme ",((L=(B=z==null?void 0:z.name)==null?void 0:B.split(" "))==null?void 0:L[1])||(z==null?void 0:z.name)," !"]}),e.jsxs("p",{className:"text-indigo-100 text-sm mt-1",children:[o==null?void 0:o.toLocaleDateString("fr-FR",{weekday:"long",day:"numeric",month:"long",year:"numeric"})," â€¢ ",o==null?void 0:o.toLocaleTimeString("fr-FR",{hour:"2-digit",minute:"2-digit"})]})]})]}),e.jsx("p",{className:"font-body-medium text-white text-lg mt-4",children:"Suivez le parcours scolaire de vos enfants et restez informÃ©(e) de leur progression."})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[e.jsxs("div",{className:"bg-white/20 backdrop-blur-sm rounded-xl px-4 py-3 shadow-md border border-white/30",children:[e.jsx("div",{className:"text-2xl font-display font-bold",children:((X=z==null?void 0:z.children)==null?void 0:X.length)||0}),e.jsxs("div",{className:"text-xs text-indigo-100 mt-1",children:["Enfant",(((V=z==null?void 0:z.children)==null?void 0:V.length)||0)>1?"s":""]})]}),e.jsxs("div",{className:"bg-white/20 backdrop-blur-sm rounded-xl px-4 py-3 shadow-md border border-white/30",children:[e.jsx("div",{className:"text-2xl font-display font-bold",children:(_==null?void 0:_.length)||0}),e.jsxs("div",{className:"text-xs text-indigo-100 mt-1",children:["Ã‰cole",((_==null?void 0:_.length)||0)>1?"s":""]})]}),e.jsxs("div",{className:"bg-white/20 backdrop-blur-sm rounded-xl px-4 py-3 shadow-md border border-white/30",children:[e.jsx("div",{className:"text-2xl font-display font-bold",children:M()}),e.jsxs("div",{className:"text-xs text-indigo-100 mt-1",children:["Notification",M()>1?"s":""]})]})]})]})}),!S&&H()]})}),e.jsx(le,{child:a,isOpen:!!a,onClose:()=>h(null),onUpdate:()=>{window.location.reload()}})]})};export{be as default};
//# sourceMappingURL=index-CTblOtNM.js.map
