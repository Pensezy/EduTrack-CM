{"version":3,"file":"index-C4tejHYV.js","sources":["../../src/pages/teacher-dashboard/components/ClassSelector.jsx","../../src/pages/teacher-dashboard/components/AssignedClassesOverview.jsx","../../src/pages/teacher-dashboard/components/GradeEntryPanel.jsx","../../src/pages/teacher-dashboard/components/GradesSummaryPanel.jsx","../../src/pages/teacher-dashboard/components/ConductPanel.jsx","../../src/pages/teacher-dashboard/components/DocumentManager.jsx","../../src/pages/teacher-dashboard/components/AttendanceManager.jsx","../../src/pages/teacher-dashboard/components/StudentCommunication.jsx","../../src/pages/teacher-dashboard/components/TeacherSchedule.jsx","../../src/pages/teacher-dashboard/components/TeacherMultiSchoolOverview.jsx","../../src/pages/teacher-dashboard/index.jsx"],"sourcesContent":["import React from 'react';\r\nimport Icon from '../../../components/AppIcon';\r\n\r\nconst ClassSelector = ({ classes, selectedClass, onClassSelect }) => {\r\n  return (\r\n    <div className=\"bg-card rounded-lg shadow-card border border-border p-6\">\r\n      <div className=\"flex items-center justify-between mb-6\">\r\n        <h2 className=\"font-heading font-heading-semibold text-xl text-card-foreground\">\r\n          Mes Classes Assign√©es\r\n        </h2>\r\n        <div className=\"flex items-center gap-2 px-3 py-2 bg-primary/10 rounded-lg\">\r\n          <Icon name=\"Users\" size={16} className=\"text-primary\" />\r\n          <span className=\"font-caption font-caption-semibold text-sm text-primary\">\r\n            {classes?.length} classe{classes?.length > 1 ? 's' : ''} assign√©e{classes?.length > 1 ? 's' : ''}\r\n          </span>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Classes Grid */}\r\n      <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\">\r\n        {classes?.map(classData => {\r\n          const isSelected = selectedClass?.id === classData?.id;\r\n\r\n          return (\r\n            <div\r\n              key={classData?.id}\r\n              onClick={() => onClassSelect(classData)}\r\n              className={`relative p-4 rounded-lg border-2 transition-all duration-300 cursor-pointer group ${\r\n                isSelected \r\n                  ? 'border-primary bg-primary/5 shadow-md' \r\n                  : 'border-border hover:border-primary/50 hover:bg-primary/2'\r\n              }`}\r\n            >\r\n              {/* Selection Indicator */}\r\n              {isSelected && (\r\n                <div className=\"absolute -top-2 -right-2 w-6 h-6 bg-primary rounded-full flex items-center justify-center\">\r\n                  <Icon name=\"Check\" size={14} className=\"text-white\" />\r\n                </div>\r\n              )}\r\n\r\n              <div className=\"space-y-3\">\r\n                {/* Class Header */}\r\n                <div className=\"flex items-center justify-between\">\r\n                  <h3 className=\"font-heading font-heading-semibold text-lg text-card-foreground\">\r\n                    {classData?.name}\r\n                  </h3>\r\n                  <span className=\"px-2 py-1 bg-success/10 text-success rounded text-xs font-caption font-caption-semibold\">\r\n                    {classData?.subject}\r\n                  </span>\r\n                </div>\r\n\r\n                {/* Class Info */}\r\n                <div className=\"space-y-2\">\r\n                  <div className=\"flex items-center gap-2\">\r\n                    <Icon name=\"GraduationCap\" size={14} className=\"text-muted-foreground\" />\r\n                    <span className=\"font-body font-body-normal text-sm text-muted-foreground\">\r\n                      Niveau: {classData?.level}\r\n                    </span>\r\n                  </div>\r\n                  \r\n                  <div className=\"flex items-center gap-2\">\r\n                    <Icon name=\"School\" size={14} className=\"text-muted-foreground\" />\r\n                    <span className=\"font-body font-body-normal text-sm text-muted-foreground truncate\">\r\n                      {classData?.school}\r\n                    </span>\r\n                  </div>\r\n                  \r\n                  <div className=\"flex items-center gap-2\">\r\n                    <Icon name=\"Users\" size={14} className=\"text-muted-foreground\" />\r\n                    <span className=\"font-body font-body-normal text-sm text-muted-foreground\">\r\n                      {classData?.students} √©l√®ves\r\n                    </span>\r\n                  </div>\r\n                </div>\r\n\r\n                {/* Schedule Preview */}\r\n                <div className=\"pt-3 border-t border-border\">\r\n                  <h4 className=\"font-caption font-caption-semibold text-xs text-muted-foreground mb-2\">\r\n                    Charge horaire:\r\n                  </h4>\r\n                  <div className=\"space-y-1\">\r\n                    {Array.isArray(classData?.schedule) ? (\r\n                      // Format ancien: array d'horaires\r\n                      <>\r\n                        {classData?.schedule?.slice(0, 2)?.map((slot, index) => (\r\n                          <div key={index} className=\"flex items-center justify-between text-xs\">\r\n                            <span className=\"font-caption font-caption-normal text-muted-foreground\">\r\n                              {slot?.day}\r\n                            </span>\r\n                            <span className=\"font-caption font-caption-semibold text-primary\">\r\n                              {slot?.time}\r\n                            </span>\r\n                          </div>\r\n                        ))}\r\n                        {classData?.schedule?.length > 2 && (\r\n                          <div className=\"text-xs text-center text-muted-foreground\">\r\n                            +{classData?.schedule?.length - 2} autre{classData?.schedule?.length - 2 > 1 ? 's' : ''}\r\n                          </div>\r\n                        )}\r\n                      </>\r\n                    ) : classData?.schedule?.weekly_hours ? (\r\n                      // Format nouveau: objet JSON avec weekly_hours\r\n                      <div className=\"flex items-center justify-between text-xs\">\r\n                        <span className=\"font-caption font-caption-normal text-muted-foreground\">\r\n                          Heures par semaine\r\n                        </span>\r\n                        <span className=\"font-caption font-caption-semibold text-primary\">\r\n                          {classData?.schedule?.weekly_hours}h\r\n                        </span>\r\n                      </div>\r\n                    ) : (\r\n                      <div className=\"text-xs text-center text-muted-foreground\">\r\n                        Horaire non d√©fini\r\n                      </div>\r\n                    )}\r\n                  </div>\r\n                </div>\r\n\r\n                {/* Quick Stats */}\r\n                <div className=\"grid grid-cols-2 gap-2 pt-3 border-t border-border\">\r\n                  <div className=\"text-center p-2 bg-muted/20 rounded\">\r\n                    <div className=\"font-heading font-heading-bold text-sm text-success\">\r\n                      {classData?.average ? `${classData.average.toFixed(1)}/20` : 'N/A'}\r\n                    </div>\r\n                    <p className=\"font-caption font-caption-normal text-xs text-muted-foreground\">\r\n                      Moy. classe\r\n                    </p>\r\n                  </div>\r\n                  <div className=\"text-center p-2 bg-muted/20 rounded\">\r\n                    <div className=\"font-heading font-heading-bold text-sm text-primary\">\r\n                      {classData?.attendanceRate ? `${classData.attendanceRate}%` : 'N/A'}\r\n                    </div>\r\n                    <p className=\"font-caption font-caption-normal text-xs text-muted-foreground\">\r\n                      Pr√©sence\r\n                    </p>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          );\r\n        })}\r\n      </div>\r\n\r\n      {/* No Classes Message */}\r\n      {classes?.length === 0 && (\r\n        <div className=\"text-center py-8\">\r\n          <Icon name=\"Users\" size={48} className=\"text-muted-foreground mx-auto mb-3\" />\r\n          <p className=\"font-body font-body-normal text-muted-foreground\">\r\n            Aucune classe assign√©e pour le moment\r\n          </p>\r\n          <p className=\"font-caption font-caption-normal text-sm text-muted-foreground mt-2\">\r\n            Contactez l'administration pour recevoir vos assignations de classes\r\n          </p>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ClassSelector;","import React from 'react';\nimport Icon from '../../../components/AppIcon';\n\nconst AssignedClassesOverview = ({ classes, selectedClass }) => {\n  if (!selectedClass) return null;\n\n  const getTotalStudents = () => {\n    return classes?.reduce((total, cls) => total + cls?.students, 0);\n  };\n\n  const getWeeklyHours = () => {\n    return classes?.reduce((total, cls) => {\n      // Support pour les deux formats\n      if (Array.isArray(cls?.schedule)) {\n        return total + cls?.schedule?.length * 1.5;\n      } else if (cls?.schedule?.weekly_hours) {\n        return total + cls?.schedule?.weekly_hours;\n      }\n      return total;\n    }, 0) || 0;\n  };\n\n  const getTodaySchedule = () => {\n    const today = new Date()?.toLocaleDateString('fr-FR', { weekday: 'long' });\n    const todayFr = today?.charAt(0)?.toUpperCase() + today?.slice(1)?.toLowerCase();\n    \n    // Support uniquement pour le format array\n    if (Array.isArray(selectedClass?.schedule)) {\n      return selectedClass?.schedule?.filter(slot => \n        slot?.day?.toLowerCase() === todayFr?.toLowerCase()\n      ) || [];\n    }\n    return [];\n  };\n\n  const getNextClass = () => {\n    const now = new Date();\n    const currentDay = now?.toLocaleDateString('fr-FR', { weekday: 'long' });\n    const currentTime = now?.getHours() * 60 + now?.getMinutes();\n    \n    for (const cls of (classes || [])) {\n      // Support uniquement pour le format array\n      if (Array.isArray(cls?.schedule)) {\n        for (const slot of cls?.schedule) {\n          if (slot?.day === currentDay) {\n            const [startHour, startMin] = slot?.time?.split('-')?.[0]?.split(':')?.map(Number);\n            const slotTime = startHour * 60 + startMin;\n            if (slotTime > currentTime) {\n              return { class: cls, slot };\n            }\n          }\n        }\n      }\n    }\n    return null;\n  };\n\n  const nextClass = getNextClass();\n  const todaySchedule = getTodaySchedule();\n\n  return (\n    <div className=\"bg-gradient-to-r from-success/5 to-primary/5 rounded-lg border border-primary/10 p-3 sm:p-6\">\n      <div className=\"flex flex-col lg:flex-row lg:items-center lg:justify-between\">\n        {/* Selected Class Info */}\n        <div className=\"mb-3 sm:mb-4 lg:mb-0\">\n          <h2 className=\"font-heading font-heading-bold text-lg sm:text-xl lg:text-2xl text-card-foreground mb-1 sm:mb-2\">\n            Classe s√©lectionn√©e: {selectedClass?.name}\n          </h2>\n          <div className=\"space-y-1\">\n            <p className=\"font-body font-body-normal text-muted-foreground\">\n              <span className=\"font-body-semibold\">Mati√®re:</span> {selectedClass?.subject}\n            </p>\n            <p className=\"font-body font-body-normal text-muted-foreground\">\n              <span className=\"font-body-semibold\">Niveau:</span> {selectedClass?.level}\n            </p>\n            <p className=\"font-body font-body-normal text-muted-foreground\">\n              <span className=\"font-body-semibold\">√âcole:</span> {selectedClass?.school}\n            </p>\n          </div>\n        </div>\n\n        {/* Teaching Statistics */}\n        <div className=\"grid grid-cols-2 lg:grid-cols-4 gap-2 sm:gap-3 lg:gap-4\">\n          {/* Total Students */}\n          <div className=\"bg-white rounded-lg p-2 sm:p-3 lg:p-4 shadow-sm border border-border text-center\">\n            <Icon name=\"Users\" size={18} className=\"mx-auto mb-2 text-primary\" />\n            <div className=\"font-heading font-heading-bold text-xl text-primary\">\n              {getTotalStudents()}\n            </div>\n            <p className=\"font-caption font-caption-normal text-xs text-muted-foreground mt-1\">\n              Total √©l√®ves\n            </p>\n          </div>\n\n          {/* Classes Count */}\n          <div className=\"bg-white rounded-lg p-2 sm:p-3 lg:p-4 shadow-sm border border-border text-center\">\n            <Icon name=\"GraduationCap\" size={18} className=\"mx-auto mb-2 text-success\" />\n            <div className=\"font-heading font-heading-bold text-xl text-success\">\n              {classes?.length}\n            </div>\n            <p className=\"font-caption font-caption-normal text-xs text-muted-foreground mt-1\">\n              Classes assign√©es\n            </p>\n          </div>\n\n          {/* Weekly Hours */}\n          <div className=\"bg-white rounded-lg p-2 sm:p-3 lg:p-4 shadow-sm border border-border text-center\">\n            <Icon name=\"Clock\" size={18} className=\"mx-auto mb-2 text-warning\" />\n            <div className=\"font-heading font-heading-bold text-xl text-warning\">\n              {getWeeklyHours()}h\n            </div>\n            <p className=\"font-caption font-caption-normal text-xs text-muted-foreground mt-1\">\n              Heures/semaine\n            </p>\n          </div>\n\n          {/* Current Class Students */}\n          <div className=\"bg-white rounded-lg p-2 sm:p-3 lg:p-4 shadow-sm border border-border text-center\">\n            <Icon name=\"User\" size={18} className=\"mx-auto mb-2 text-accent-foreground\" />\n            <div className=\"font-heading font-heading-bold text-xl text-accent-foreground\">\n              {selectedClass?.students}\n            </div>\n            <p className=\"font-caption font-caption-normal text-xs text-muted-foreground mt-1\">\n              √âl√®ves classe\n            </p>\n          </div>\n        </div>\n      </div>\n\n      {/* Today's Schedule & Next Class */}\n      <div className=\"mt-6 grid grid-cols-1 lg:grid-cols-2 gap-3 sm:p-6\">\n        {/* Today's Schedule */}\n        <div className=\"bg-white rounded-lg p-4 border border-border\">\n          <div className=\"flex items-center gap-2 mb-3\">\n            <Icon name=\"Calendar\" size={18} className=\"text-primary\" />\n            <h3 className=\"font-heading font-heading-semibold text-lg text-card-foreground\">\n              Programme d'aujourd'hui\n            </h3>\n          </div>\n          \n          {todaySchedule?.length > 0 ? (\n            <div className=\"space-y-2\">\n              {todaySchedule?.map((slot, index) => (\n                <div key={index} className=\"flex items-center justify-between p-2 bg-primary/5 rounded\">\n                  <div>\n                    <span className=\"font-body font-body-semibold text-sm text-card-foreground\">\n                      {slot?.time}\n                    </span>\n                    <p className=\"font-caption font-caption-normal text-xs text-muted-foreground\">\n                      {slot?.room}\n                    </p>\n                  </div>\n                  <div className=\"text-right\">\n                    <span className=\"font-caption font-caption-semibold text-xs text-primary\">\n                      {selectedClass?.name}\n                    </span>\n                    <p className=\"font-caption font-caption-normal text-xs text-muted-foreground\">\n                      {selectedClass?.subject}\n                    </p>\n                  </div>\n                </div>\n              ))}\n            </div>\n          ) : (\n            <div className=\"text-center py-4\">\n              <Icon name=\"Calendar\" size={32} className=\"text-muted-foreground mx-auto mb-2\" />\n              <p className=\"font-body font-body-normal text-sm text-muted-foreground\">\n                Pas de cours aujourd'hui pour cette classe\n              </p>\n            </div>\n          )}\n        </div>\n\n        {/* Next Class */}\n        <div className=\"bg-white rounded-lg p-4 border border-border\">\n          <div className=\"flex items-center gap-2 mb-3\">\n            <Icon name=\"Clock\" size={18} className=\"text-success\" />\n            <h3 className=\"font-heading font-heading-semibold text-lg text-card-foreground\">\n              Prochain cours\n            </h3>\n          </div>\n          \n          {nextClass ? (\n            <div className=\"p-3 bg-success/5 rounded-lg border border-success/20\">\n              <div className=\"flex items-center justify-between mb-2\">\n                <span className=\"font-heading font-heading-semibold text-lg text-success\">\n                  {nextClass?.slot?.time}\n                </span>\n                <span className=\"px-2 py-1 bg-success/10 text-success rounded text-xs font-caption font-caption-semibold\">\n                  {nextClass?.slot?.day}\n                </span>\n              </div>\n              <div className=\"space-y-1\">\n                <p className=\"font-body font-body-semibold text-sm text-card-foreground\">\n                  {nextClass?.class?.name} - {nextClass?.class?.subject}\n                </p>\n                <p className=\"font-caption font-caption-normal text-xs text-muted-foreground\">\n                  üìç {nextClass?.slot?.room}\n                </p>\n                <p className=\"font-caption font-caption-normal text-xs text-muted-foreground\">\n                  üë• {nextClass?.class?.students} √©l√®ves\n                </p>\n              </div>\n            </div>\n          ) : (\n            <div className=\"text-center py-4\">\n              <Icon name=\"CheckCircle\" size={32} className=\"text-success mx-auto mb-2\" />\n              <p className=\"font-body font-body-normal text-sm text-muted-foreground\">\n                Plus de cours aujourd'hui\n              </p>\n            </div>\n          )}\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default AssignedClassesOverview;","import React, { useState, useEffect } from 'react';\r\nimport Icon from '../../../components/AppIcon';\r\nimport { supabase } from '../../../lib/supabase';\r\n\r\nconst GradeEntryPanel = ({ classData, students, onGradeAdded }) => {\r\n  const [selectedStudent, setSelectedStudent] = useState(null);\r\n  const [schoolType, setSchoolType] = useState('secondaire'); // maternelle, primaire, secondaire\r\n  const [currentSequence, setCurrentSequence] = useState('1');\r\n  const [gradeForm, setGradeForm] = useState({\r\n    student: '',\r\n    type: '',\r\n    grade: '',\r\n    max_grade: '20',\r\n    coefficient: '1',\r\n    description: '',\r\n    sequence: '1',\r\n    trimester: '1',\r\n    date: new Date()?.toISOString()?.split('T')?.[0]\r\n  });\r\n  const [showBulkEntry, setShowBulkEntry] = useState(false);\r\n  const [isSubmitting, setIsSubmitting] = useState(false);\r\n\r\n  // Charger le type d'√©tablissement\r\n  useEffect(() => {\r\n    const loadSchoolType = async () => {\r\n      if (classData?.school_id) {\r\n        const { data, error } = await supabase\r\n          .from('schools')\r\n          .select('type')\r\n          .eq('id', classData.school_id)\r\n          .single();\r\n        \r\n        if (!error && data) {\r\n          setSchoolType(data.type || 'secondaire');\r\n        }\r\n      }\r\n    };\r\n    loadSchoolType();\r\n  }, [classData]);\r\n\r\n  // Auto-calculer le trimestre selon la s√©quence\r\n  useEffect(() => {\r\n    const sequence = parseInt(gradeForm.sequence);\r\n    let trimester = '1';\r\n    if (sequence === 1 || sequence === 2) trimester = '1';\r\n    else if (sequence === 3 || sequence === 4) trimester = '2';\r\n    else if (sequence === 5 || sequence === 6) trimester = '3';\r\n    \r\n    setGradeForm(prev => ({ ...prev, trimester }));\r\n  }, [gradeForm.sequence]);\r\n\r\n  // Types d'√©valuation selon le syst√®me camerounais\r\n  const getEvaluationTypes = () => {\r\n    if (schoolType === 'maternelle') {\r\n      return [\r\n        { value: 'observation', label: 'üé® Observation en classe', color: 'text-blue-600' },\r\n        { value: 'activite', label: 'üéØ Activit√© pratique', color: 'text-green-600' },\r\n        { value: 'participation', label: '‚úã Participation', color: 'text-purple-600' },\r\n        { value: 'autonomie', label: 'üåü Autonomie', color: 'text-orange-600' }\r\n      ];\r\n    } else if (schoolType === 'primaire') {\r\n      return [\r\n        { value: 'evaluation_continue', label: 'üìù √âvaluation continue', color: 'text-blue-600' },\r\n        { value: 'composition', label: 'üìö Composition', color: 'text-red-600' },\r\n        { value: 'exercice', label: '‚úèÔ∏è Exercice', color: 'text-green-600' },\r\n        { value: 'interrogation', label: '‚ùì Interrogation √©crite', color: 'text-purple-600' },\r\n        { value: 'oral', label: 'üó£Ô∏è Interrogation orale', color: 'text-indigo-600' }\r\n      ];\r\n    } else {\r\n      // Secondaire (Coll√®ge/Lyc√©e)\r\n      return [\r\n        { value: 'evaluation_sequence', label: 'üìã √âvaluation de s√©quence', color: 'text-blue-600' },\r\n        { value: 'devoir', label: 'üìù Devoir surveill√©', color: 'text-purple-600' },\r\n        { value: 'composition', label: 'üìö Composition trimestrielle', color: 'text-red-600' },\r\n        { value: 'interrogation_ecrite', label: '‚úçÔ∏è Interrogation √©crite', color: 'text-green-600' },\r\n        { value: 'tp', label: 'üî¨ Travaux Pratiques (TP)', color: 'text-cyan-600' },\r\n        { value: 'tpe', label: 'üë• Travaux Pratiques Encadr√©s (TPE)', color: 'text-orange-600' },\r\n        { value: 'expose', label: 'üé§ Expos√©', color: 'text-pink-600' }\r\n      ];\r\n    }\r\n  };\r\n\r\n  const sequences = [\r\n    { value: '1', label: 'S√©quence 1' },\r\n    { value: '2', label: 'S√©quence 2' },\r\n    { value: '3', label: 'S√©quence 3' },\r\n    { value: '4', label: 'S√©quence 4' },\r\n    { value: '5', label: 'S√©quence 5' },\r\n    { value: '6', label: 'S√©quence 6' }\r\n  ];\r\n\r\n  const trimesters = [\r\n    { value: '1', label: '1er Trimestre (S√©q. 1-2)' },\r\n    { value: '2', label: '2√®me Trimestre (S√©q. 3-4)' },\r\n    { value: '3', label: '3√®me Trimestre (S√©q. 5-6)' }\r\n  ];\r\n\r\n  const coefficients = [\r\n    { value: '1', label: 'Coefficient 1' },\r\n    { value: '2', label: 'Coefficient 2' },\r\n    { value: '3', label: 'Coefficient 3' },\r\n    { value: '4', label: 'Coefficient 4' },\r\n    { value: '5', label: 'Coefficient 5' },\r\n    { value: '6', label: 'Coefficient 6' }\r\n  ];\r\n\r\n  const getGradeColor = (grade) => {\r\n    if (grade >= 16) return 'text-success';\r\n    if (grade >= 14) return 'text-primary';\r\n    if (grade >= 12) return 'text-warning';\r\n    return 'text-error';\r\n  };\r\n\r\n  const getGradeBg = (grade) => {\r\n    if (grade >= 16) return 'bg-success/10';\r\n    if (grade >= 14) return 'bg-primary/10';\r\n    if (grade >= 12) return 'bg-warning/10';\r\n    return 'bg-error/10';\r\n  };\r\n\r\n  const handleGradeSubmit = async (e) => {\r\n    e?.preventDefault();\r\n    \r\n    // Validation\r\n    if (!gradeForm.student || !gradeForm.type || !gradeForm.grade) {\r\n      alert('Veuillez remplir tous les champs obligatoires (√©l√®ve, type, note)');\r\n      return;\r\n    }\r\n\r\n    const gradeValue = parseFloat(gradeForm.grade);\r\n    const maxGrade = parseFloat(gradeForm.max_grade);\r\n    \r\n    if (isNaN(gradeValue) || gradeValue < 0 || gradeValue > maxGrade) {\r\n      alert(`La note doit √™tre entre 0 et ${maxGrade}`);\r\n      return;\r\n    }\r\n\r\n    // D√©terminer le trimestre en fonction de la s√©quence\r\n    let trimester = gradeForm.trimester;\r\n    if (gradeForm.sequence === '1' || gradeForm.sequence === '2') {\r\n      trimester = '1';\r\n    } else if (gradeForm.sequence === '3' || gradeForm.sequence === '4') {\r\n      trimester = '2';\r\n    } else {\r\n      trimester = '3';\r\n    }\r\n\r\n    setIsSubmitting(true);\r\n    \r\n    try {\r\n      // R√©cup√©rer les informations n√©cessaires\r\n      const selectedStudentData = students.find(s => s.id === gradeForm.student);\r\n      \r\n      // Ins√©rer la note dans Supabase\r\n      const { data, error } = await supabase\r\n        .from('grades')\r\n        .insert({\r\n          student_id: gradeForm.student,\r\n          school_id: classData?.school_id || selectedStudentData?.school_id,\r\n          academic_year_id: classData?.academic_year_id,\r\n          class_id: selectedStudentData?.class_id,\r\n          subject_id: classData?.subject_id,\r\n          teacher_id: classData?.teacher_id,\r\n          grade: gradeValue,\r\n          max_grade: maxGrade,\r\n          grade_type: gradeForm.type,\r\n          coefficient: parseFloat(gradeForm.coefficient),\r\n          description: gradeForm.description || null,\r\n          sequence: parseInt(gradeForm.sequence),\r\n          trimester: parseInt(trimester),\r\n          date: gradeForm.date\r\n        })\r\n        .select();\r\n\r\n      if (error) {\r\n        console.error('Erreur enregistrement note:', error);\r\n        alert('Erreur lors de l\\'enregistrement de la note: ' + error.message);\r\n        return;\r\n      }\r\n\r\n      console.log('‚úÖ Note enregistr√©e:', data);\r\n      \r\n      // Reset form\r\n      setGradeForm({\r\n        student: '',\r\n        type: '',\r\n        grade: '',\r\n        max_grade: '20',\r\n        coefficient: '1',\r\n        description: '',\r\n        sequence: currentSequence,\r\n        trimester: trimester,\r\n        date: new Date()?.toISOString()?.split('T')?.[0]\r\n      });\r\n      \r\n      // Callback pour rafra√Æchir les donn√©es\r\n      if (onGradeAdded) {\r\n        onGradeAdded();\r\n      }\r\n      \r\n      alert('Note enregistr√©e avec succ√®s!');\r\n    } catch (error) {\r\n      console.error('Exception enregistrement note:', error);\r\n      alert('Une erreur est survenue lors de l\\'enregistrement');\r\n    } finally {\r\n      setIsSubmitting(false);\r\n    }\r\n  };\r\n\r\n  const handleBulkSubmit = () => {\r\n    console.log('Bulk grade entry for class:', classData?.name);\r\n    setShowBulkEntry(false);\r\n    alert('Saisie group√©e initialis√©e!');\r\n  };\r\n\r\n  const getStudentAverage = (student) => {\r\n    if (!student?.recentGrades?.length) return 0;\r\n    \r\n    // Calculer la moyenne pond√©r√©e par coefficient\r\n    let totalPoints = 0;\r\n    let totalCoefficients = 0;\r\n    \r\n    student.recentGrades.forEach(grade => {\r\n      const coef = grade.coefficient || 1;\r\n      const normalizedGrade = (grade.grade / (grade.max_grade || 20)) * 20; // Normaliser sur 20\r\n      totalPoints += normalizedGrade * coef;\r\n      totalCoefficients += coef;\r\n    });\r\n    \r\n    return totalCoefficients > 0 ? totalPoints / totalCoefficients : 0;\r\n  };\r\n\r\n  const evaluationTypes = getEvaluationTypes();\r\n\r\n  return (\r\n    <div className=\"bg-white rounded-2xl shadow-xl border-2 border-gray-200 p-6\">\r\n      {/* En-t√™te avec info sur la s√©quence actuelle */}\r\n      <div className=\"bg-gradient-to-r from-indigo-50 to-purple-50 rounded-xl p-4 mb-6 border-2 border-indigo-200\">\r\n        <div className=\"flex items-center justify-between\">\r\n          <div>\r\n            <h3 className=\"font-heading font-bold text-2xl text-gray-900 mb-1\">\r\n              üìä Saisie des Notes\r\n            </h3>\r\n            <p className=\"text-sm text-gray-600\">\r\n              {classData?.name} - {classData?.subject}\r\n            </p>\r\n          </div>\r\n          <div className=\"flex items-center gap-3\">\r\n            <select\r\n              value={currentSequence}\r\n              onChange={(e) => {\r\n                setCurrentSequence(e.target.value);\r\n                setGradeForm({...gradeForm, sequence: e.target.value});\r\n              }}\r\n              className=\"px-4 py-2 bg-white border-2 border-indigo-300 rounded-lg font-bold text-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500\"\r\n            >\r\n              {sequences.map(seq => (\r\n                <option key={seq.value} value={seq.value}>{seq.label}</option>\r\n              ))}\r\n            </select>\r\n            <div className=\"px-4 py-2 bg-white rounded-lg border-2 border-purple-300 shadow-md\">\r\n              <span className=\"font-bold text-sm text-purple-700\">\r\n                {students?.length} √©l√®ve{students?.length > 1 ? 's' : ''}\r\n              </span>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      {/* Bulk Entry Toggle */}\r\n      {showBulkEntry && (\r\n        <div className=\"mb-6 p-4 bg-success/5 border border-success/20 rounded-lg\">\r\n          <div className=\"flex items-center justify-between\">\r\n            <div>\r\n              <h4 className=\"font-heading font-heading-semibold text-lg text-card-foreground mb-2\">\r\n                Saisie group√©e d'√©valuation\r\n              </h4>\r\n              <p className=\"font-body font-body-normal text-sm text-muted-foreground\">\r\n                Cr√©er une √©valuation pour toute la classe {classData?.name} en {classData?.subject}\r\n              </p>\r\n            </div>\r\n            <button\r\n              onClick={handleBulkSubmit}\r\n              className=\"px-4 py-2 bg-success text-white hover:bg-success/90 rounded-lg transition-colors\"\r\n            >\r\n              D√©marrer\r\n            </button>\r\n          </div>\r\n        </div>\r\n      )}\r\n      <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\r\n        {/* Grade Entry Form */}\r\n        <div className=\"space-y-4\">\r\n          <h4 className=\"font-heading font-heading-semibold text-lg text-card-foreground\">\r\n            Nouvelle Note\r\n          </h4>\r\n          \r\n          <form onSubmit={handleGradeSubmit} className=\"space-y-4\">\r\n            {/* Student Selection */}\r\n            <div>\r\n              <label className=\"block font-body font-body-semibold text-sm text-card-foreground mb-2\">\r\n                √âl√®ve *\r\n              </label>\r\n              <select\r\n                value={gradeForm?.student}\r\n                onChange={(e) => setGradeForm({...gradeForm, student: e?.target?.value})}\r\n                className=\"w-full px-4 py-2 border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary/50 bg-background\"\r\n                required\r\n              >\r\n                <option value=\"\">S√©lectionner un √©l√®ve</option>\r\n                {students?.map(student => (\r\n                  <option key={student?.id} value={student?.id}>\r\n                    {student?.name} ({student?.matricule})\r\n                  </option>\r\n                ))}\r\n              </select>\r\n            </div>\r\n\r\n            {/* Evaluation Type */}\r\n            <div>\r\n              <label className=\"block font-body font-body-semibold text-sm text-card-foreground mb-2\">\r\n                Type d'√©valuation *\r\n              </label>\r\n              <select\r\n                value={gradeForm?.type}\r\n                onChange={(e) => setGradeForm({...gradeForm, type: e?.target?.value})}\r\n                className=\"w-full px-4 py-2 border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary/50 bg-background\"\r\n                required\r\n              >\r\n                <option value=\"\">Choisir le type</option>\r\n                {evaluationTypes?.map(type => (\r\n                  <option key={type?.value} value={type?.value}>\r\n                    {type?.label}\r\n                  </option>\r\n                ))}\r\n              </select>\r\n            </div>\r\n\r\n            {/* Grade and Coefficient */}\r\n            <div className=\"grid grid-cols-3 gap-3\">\r\n              <div>\r\n                <label className=\"block font-body font-body-semibold text-sm text-card-foreground mb-2\">\r\n                  Note *\r\n                </label>\r\n                <input\r\n                  type=\"number\"\r\n                  min=\"0\"\r\n                  max={gradeForm.max_grade}\r\n                  step=\"0.25\"\r\n                  value={gradeForm?.grade}\r\n                  onChange={(e) => setGradeForm({...gradeForm, grade: e?.target?.value})}\r\n                  className=\"w-full px-4 py-2 border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary/50 bg-background\"\r\n                  placeholder=\"15.5\"\r\n                  required\r\n                />\r\n              </div>\r\n              <div>\r\n                <label className=\"block font-body font-body-semibold text-sm text-card-foreground mb-2\">\r\n                  Sur\r\n                </label>\r\n                <input\r\n                  type=\"number\"\r\n                  min=\"10\"\r\n                  max=\"100\"\r\n                  value={gradeForm?.max_grade}\r\n                  onChange={(e) => setGradeForm({...gradeForm, max_grade: e?.target?.value})}\r\n                  className=\"w-full px-4 py-2 border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary/50 bg-background\"\r\n                  placeholder=\"20\"\r\n                />\r\n              </div>\r\n              <div>\r\n                <label className=\"block font-body font-body-semibold text-sm text-card-foreground mb-2\">\r\n                  Coef.\r\n                </label>\r\n                <select\r\n                  value={gradeForm?.coefficient}\r\n                  onChange={(e) => setGradeForm({...gradeForm, coefficient: e?.target?.value})}\r\n                  className=\"w-full px-4 py-2 border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary/50 bg-background\"\r\n                >\r\n                  {coefficients?.map(coef => (\r\n                    <option key={coef?.value} value={coef?.value}>\r\n                      {coef?.value}\r\n                    </option>\r\n                  ))}\r\n                </select>\r\n              </div>\r\n            </div>\r\n\r\n            {/* Sequence and Trimester */}\r\n            <div className=\"grid grid-cols-2 gap-3\">\r\n              <div>\r\n                <label className=\"block font-body font-body-semibold text-sm text-card-foreground mb-2\">\r\n                  S√©quence *\r\n                </label>\r\n                <select\r\n                  value={gradeForm?.sequence}\r\n                  onChange={(e) => setGradeForm({...gradeForm, sequence: e?.target?.value})}\r\n                  className=\"w-full px-4 py-2 border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary/50 bg-background\"\r\n                  required\r\n                >\r\n                  {sequences.map(seq => (\r\n                    <option key={seq.value} value={seq.value}>{seq.label}</option>\r\n                  ))}\r\n                </select>\r\n              </div>\r\n              <div>\r\n                <label className=\"block font-body font-body-semibold text-sm text-card-foreground mb-2\">\r\n                  Trimestre\r\n                </label>\r\n                <select\r\n                  value={gradeForm?.trimester}\r\n                  onChange={(e) => setGradeForm({...gradeForm, trimester: e?.target?.value})}\r\n                  className=\"w-full px-4 py-2 border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary/50 bg-background\"\r\n                  disabled\r\n                >\r\n                  {trimesters.map(tri => (\r\n                    <option key={tri.value} value={tri.value}>{tri.label}</option>\r\n                  ))}\r\n                </select>\r\n              </div>\r\n            </div>\r\n\r\n            {/* Description */}\r\n            <div>\r\n              <label className=\"block font-body font-body-semibold text-sm text-card-foreground mb-2\">\r\n                Description\r\n              </label>\r\n              <input\r\n                type=\"text\"\r\n                value={gradeForm?.description}\r\n                onChange={(e) => setGradeForm({...gradeForm, description: e?.target?.value})}\r\n                className=\"w-full px-4 py-2 border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary/50 bg-background\"\r\n                placeholder=\"Contr√¥le chapitre 5 - Fonctions\"\r\n              />\r\n            </div>\r\n\r\n            {/* Date */}\r\n            <div>\r\n              <label className=\"block font-body font-body-semibold text-sm text-card-foreground mb-2\">\r\n                Date de l'√©valuation\r\n              </label>\r\n              <input\r\n                type=\"date\"\r\n                value={gradeForm?.date}\r\n                onChange={(e) => setGradeForm({...gradeForm, date: e?.target?.value})}\r\n                className=\"w-full px-4 py-2 border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary/50 bg-background\"\r\n              />\r\n            </div>\r\n\r\n            <button\r\n              type=\"submit\"\r\n              disabled={isSubmitting}\r\n              className=\"w-full bg-primary text-white font-body font-body-semibold py-3 px-4 rounded-lg hover:bg-primary/90 transition-colors flex items-center justify-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed\"\r\n            >\r\n              <Icon name=\"Save\" size={16} />\r\n              {isSubmitting ? 'Enregistrement...' : 'Enregistrer la Note'}\r\n            </button>\r\n          </form>\r\n        </div>\r\n\r\n        {/* Student List with Recent Grades */}\r\n        <div className=\"space-y-4\">\r\n          <h4 className=\"font-heading font-heading-semibold text-lg text-card-foreground\">\r\n            √âl√®ves & Notes R√©centes\r\n          </h4>\r\n\r\n          <div className=\"space-y-3 max-h-96 overflow-y-auto\">\r\n            {students?.map(student => {\r\n              const average = getStudentAverage(student);\r\n              \r\n              return (\r\n                <div\r\n                  key={student?.id}\r\n                  className={`border border-border rounded-lg p-4 transition-all cursor-pointer ${\r\n                    selectedStudent?.id === student?.id ? 'border-primary bg-primary/5' : 'hover:border-primary/50'\r\n                  }`}\r\n                  onClick={() => setSelectedStudent(selectedStudent?.id === student?.id ? null : student)}\r\n                >\r\n                  <div className=\"flex items-center gap-3 mb-3\">\r\n                    <div className=\"w-10 h-10 rounded-full bg-gradient-to-br from-blue-400 to-indigo-600 flex items-center justify-center text-white font-bold text-sm shadow-md border-2 border-white\">\r\n                      {student?.name?.charAt(0)?.toUpperCase() || 'E'}\r\n                    </div>\r\n                    <div className=\"flex-1\">\r\n                      <h5 className=\"font-heading font-heading-semibold text-sm text-card-foreground\">\r\n                        {student?.name}\r\n                      </h5>\r\n                      <p className=\"font-caption font-caption-normal text-xs text-muted-foreground\">\r\n                        {student?.matricule}\r\n                      </p>\r\n                    </div>\r\n                    <div className=\"text-right\">\r\n                      <div className={`font-heading font-heading-bold text-lg ${getGradeColor(average)}`}>\r\n                        {average?.toFixed(1)}/20\r\n                      </div>\r\n                      <p className=\"font-caption font-caption-normal text-xs text-muted-foreground\">\r\n                        Moyenne\r\n                      </p>\r\n                    </div>\r\n                  </div>\r\n                  {/* Recent Grades */}\r\n                  <div className=\"space-y-2\">\r\n                    <h6 className=\"font-caption font-caption-semibold text-xs text-muted-foreground\">\r\n                      Derni√®res notes:\r\n                    </h6>\r\n                    <div className=\"flex flex-wrap gap-2\">\r\n                      {student?.recentGrades?.slice(0, 3)?.map((grade, index) => (\r\n                        <span\r\n                          key={index}\r\n                          className={`px-2 py-1 rounded text-xs font-caption font-caption-semibold ${getGradeBg(grade?.grade)} ${getGradeColor(grade?.grade)}`}\r\n                        >\r\n                          {grade?.grade}/20 ({grade?.type})\r\n                        </span>\r\n                      ))}\r\n                    </div>\r\n                  </div>\r\n                  {/* Expanded Details */}\r\n                  {selectedStudent?.id === student?.id && (\r\n                    <div className=\"mt-4 pt-3 border-t border-border\">\r\n                      <div className=\"grid grid-cols-2 gap-4 text-sm\">\r\n                        <div>\r\n                          <span className=\"font-body font-body-semibold text-muted-foreground\">Pr√©sences:</span>\r\n                          <p className=\"font-body font-body-normal text-card-foreground\">\r\n                            {student?.attendance?.present} pr√©sent, {student?.attendance?.absent} absent\r\n                          </p>\r\n                        </div>\r\n                        <div>\r\n                          <span className=\"font-body font-body-semibold text-muted-foreground\">Retards:</span>\r\n                          <p className=\"font-body font-body-normal text-card-foreground\">\r\n                            {student?.attendance?.late} retard{student?.attendance?.late > 1 ? 's' : ''}\r\n                          </p>\r\n                        </div>\r\n                      </div>\r\n                      \r\n                      <button\r\n                        onClick={(e) => {\r\n                          e?.stopPropagation();\r\n                          setGradeForm({...gradeForm, student: student?.id});\r\n                        }}\r\n                        className=\"mt-3 w-full bg-primary/10 text-primary hover:bg-primary/20 py-2 px-3 rounded-lg transition-colors\"\r\n                      >\r\n                        Attribuer une note\r\n                      </button>\r\n                    </div>\r\n                  )}\r\n                </div>\r\n              );\r\n            })}\r\n          </div>\r\n\r\n          {students?.length === 0 && (\r\n            <div className=\"text-center py-8\">\r\n              <Icon name=\"Users\" size={48} className=\"text-muted-foreground mx-auto mb-3\" />\r\n              <p className=\"font-body font-body-normal text-muted-foreground\">\r\n                Aucun √©l√®ve dans cette classe\r\n              </p>\r\n            </div>\r\n          )}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default GradeEntryPanel;","import React from 'react';\r\nimport { \r\n  computeSubjectAverage, \r\n  computeOverallAverage, \r\n  computeRank, \r\n  getMention, \r\n  getMentionHonorifique,\r\n  detectLanguageSystem,\r\n  detectSchoolLevel\r\n} from '../../../utils/grading';\r\n\r\nconst GradesSummaryPanel = ({ classData, students = [] }) => {\r\n  const schoolType = classData?.school_type || 'secondaire';\r\n  const lang = detectLanguageSystem(schoolType);\r\n  const level = detectSchoolLevel(schoolType);\r\n  const scale = (level === 'primaire' || level === 'maternelle') ? 10 : 20;\r\n\r\n  // Calculer moyenne de chaque √©l√®ve avec les nouvelles fonctions\r\n  const studentsWithAvg = students.map(s => {\r\n    const recent = s.recentGrades || [];\r\n    \r\n    // Utiliser computeSubjectAverage pour normaliser\r\n    const avg = recent && recent.length > 0\r\n      ? computeSubjectAverage(recent.map(g => ({\r\n          grade: g.grade,\r\n          max_grade: g.max_grade || scale,\r\n          coefficient: g.coefficient || 1\r\n        })), { schoolType, targetScale: scale })\r\n      : 0;\r\n\r\n    const mentionInfo = getMention(avg, schoolType);\r\n    const honorMention = getMentionHonorifique(avg, null, schoolType);\r\n\r\n    return { \r\n      ...s, \r\n      avg, \r\n      mention: mentionInfo.mention,\r\n      code: mentionInfo.code || mentionInfo.grade || mentionInfo.letter,\r\n      honorMention\r\n    };\r\n  });\r\n\r\n  // Calculer les rangs\r\n  const allAverages = studentsWithAvg.map(s => s.avg);\r\n  const studentsWithRank = studentsWithAvg.map(s => {\r\n    const rankInfo = computeRank(s.avg, allAverages);\r\n    return { ...s, rank: rankInfo.rank, rankSuffix: rankInfo.suffix };\r\n  }).sort((a, b) => a.rank - b.rank);\r\n\r\n  const classAvg = studentsWithRank.length > 0\r\n    ? (studentsWithRank.reduce((a, b) => a + b.avg, 0) / studentsWithRank.length).toFixed(2)\r\n    : '0.00';\r\n\r\n  const highest = studentsWithRank.length > 0 ? Math.max(...studentsWithRank.map(s => s.avg)) : 0;\r\n  const lowest = studentsWithRank.length > 0 ? Math.min(...studentsWithRank.map(s => s.avg)) : 0;\r\n  const passCount = studentsWithRank.filter(s => s.avg >= (scale / 2)).length;\r\n  const failCount = studentsWithRank.length - passCount;\r\n\r\n  const getMentionColor = (mention) => {\r\n    if (!mention) return 'text-gray-500';\r\n    const m = mention.toLowerCase();\r\n    if (m.includes('tr√®s bien') || m.includes('excellent')) return 'text-green-600';\r\n    if (m.includes('bien') || m.includes('very good') || m.includes('good')) return 'text-blue-600';\r\n    if (m.includes('assez') || m.includes('credit') || m.includes('fair')) return 'text-yellow-600';\r\n    if (m.includes('passable') || m.includes('pass')) return 'text-orange-500';\r\n    return 'text-red-600';\r\n  };\r\n\r\n  const getHonorBadge = (honorMention) => {\r\n    if (!honorMention) return null;\r\n    const colors = {\r\n      'F√©licitations du Conseil': 'bg-yellow-400 text-yellow-900',\r\n      'Encouragements': 'bg-blue-400 text-blue-900',\r\n      \"Tableau d'Honneur\": 'bg-green-400 text-green-900',\r\n      'Avertissement Travail': 'bg-red-400 text-red-900'\r\n    };\r\n    return (\r\n      <span className={`ml-2 px-2 py-0.5 rounded text-xs font-semibold ${colors[honorMention] || 'bg-gray-200'}`}>\r\n        {honorMention}\r\n      </span>\r\n    );\r\n  };\r\n\r\n  return (\r\n    <div className=\"bg-white rounded-2xl shadow p-6 border border-border\">\r\n      {/* Header avec infos syst√®me */}\r\n      <div className=\"flex items-center justify-between mb-4\">\r\n        <div>\r\n          <h3 className=\"font-heading font-bold text-xl\">Synth√®se des Notes</h3>\r\n          <p className=\"text-sm text-muted-foreground\">\r\n            {classData?.name} ‚Äî {classData?.subject}\r\n            <span className=\"ml-2 px-2 py-0.5 bg-indigo-100 text-indigo-700 rounded text-xs\">\r\n              {lang === 'anglophone' ? 'Syst√®me Anglophone' : 'Syst√®me Francophone'} ‚Ä¢ Sur {scale}\r\n            </span>\r\n          </p>\r\n        </div>\r\n        <div className=\"text-right\">\r\n          <div className=\"text-sm text-muted-foreground\">Moyenne de la classe</div>\r\n          <div className=\"font-heading font-bold text-2xl\">{classAvg}/{scale}</div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Statistiques globales */}\r\n      <div className=\"grid grid-cols-2 lg:grid-cols-5 gap-4 mb-6\">\r\n        <div className=\"p-4 bg-surface rounded-lg border border-border\">\r\n          <div className=\"text-sm text-muted-foreground\">√âl√®ves</div>\r\n          <div className=\"font-bold text-lg\">{studentsWithRank.length}</div>\r\n        </div>\r\n        <div className=\"p-4 bg-green-50 rounded-lg border border-green-200\">\r\n          <div className=\"text-sm text-green-700\">Admis (‚â•{scale/2})</div>\r\n          <div className=\"font-bold text-lg text-green-700\">{passCount}</div>\r\n        </div>\r\n        <div className=\"p-4 bg-red-50 rounded-lg border border-red-200\">\r\n          <div className=\"text-sm text-red-700\">Non admis</div>\r\n          <div className=\"font-bold text-lg text-red-700\">{failCount}</div>\r\n        </div>\r\n        <div className=\"p-4 bg-surface rounded-lg border border-border\">\r\n          <div className=\"text-sm text-muted-foreground\">Meilleure</div>\r\n          <div className=\"font-bold text-lg\">{highest}/{scale}</div>\r\n        </div>\r\n        <div className=\"p-4 bg-surface rounded-lg border border-border\">\r\n          <div className=\"text-sm text-muted-foreground\">Plus basse</div>\r\n          <div className=\"font-bold text-lg\">{lowest}/{scale}</div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Tableau des √©l√®ves avec rang et mention */}\r\n      <div>\r\n        <h4 className=\"font-heading font-semibold mb-3\">Classement des √©l√®ves</h4>\r\n        <div className=\"overflow-x-auto\">\r\n          <table className=\"w-full text-sm\">\r\n            <thead>\r\n              <tr className=\"border-b border-border\">\r\n                <th className=\"text-left py-2 px-3\">Rang</th>\r\n                <th className=\"text-left py-2 px-3\">√âl√®ve</th>\r\n                <th className=\"text-left py-2 px-3\">Matricule</th>\r\n                <th className=\"text-right py-2 px-3\">Moyenne</th>\r\n                <th className=\"text-left py-2 px-3\">Mention</th>\r\n              </tr>\r\n            </thead>\r\n            <tbody>\r\n              {studentsWithRank.map(s => (\r\n                <tr key={s.id} className=\"border-b border-border hover:bg-gray-50\">\r\n                  <td className=\"py-2 px-3 font-semibold\">\r\n                    {s.rank}<sup>{s.rankSuffix}</sup>\r\n                  </td>\r\n                  <td className=\"py-2 px-3\">\r\n                    <span className=\"font-medium\">{s.name}</span>\r\n                    {getHonorBadge(s.honorMention)}\r\n                  </td>\r\n                  <td className=\"py-2 px-3 text-muted-foreground\">{s.matricule}</td>\r\n                  <td className=\"py-2 px-3 text-right font-bold\">{s.avg}/{scale}</td>\r\n                  <td className={`py-2 px-3 font-semibold ${getMentionColor(s.mention)}`}>\r\n                    {lang === 'anglophone' && s.code ? `${s.code} ‚Äî ` : ''}{s.mention}\r\n                  </td>\r\n                </tr>\r\n              ))}\r\n            </tbody>\r\n          </table>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default GradesSummaryPanel;\r\n","import React, { useState, useEffect } from 'react';\r\nimport Icon from '../../../components/AppIcon';\r\nimport { supabase } from '../../../lib/supabase';\r\n\r\n/**\r\n * Panneau de gestion du comportement/conduite (Vie Scolaire)\r\n * S√©par√© des notes acad√©miques selon le syst√®me camerounais\r\n */\r\nconst ConductPanel = ({ classData, students = [], onConductSaved }) => {\r\n  const [conductData, setConductData] = useState({});\r\n  const [selectedSequence, setSelectedSequence] = useState('1');\r\n  const [saving, setSaving] = useState(false);\r\n  const [loading, setLoading] = useState(false);\r\n\r\n  const conductCategories = [\r\n    { id: 'assiduity', label: 'Assiduit√©', icon: 'üìÖ', max: 20 },\r\n    { id: 'punctuality', label: 'Ponctualit√©', icon: '‚è∞', max: 20 },\r\n    { id: 'discipline', label: 'Discipline', icon: 'üìã', max: 20 },\r\n    { id: 'respect', label: 'Respect', icon: 'ü§ù', max: 20 },\r\n    { id: 'participation', label: 'Participation', icon: '‚úã', max: 20 },\r\n    { id: 'presentation', label: 'Tenue/Pr√©sentation', icon: 'üëî', max: 20 }\r\n  ];\r\n\r\n  const appreciations = [\r\n    { value: 'excellent', label: 'Excellent', color: 'bg-green-500' },\r\n    { value: 'tres_bien', label: 'Tr√®s bien', color: 'bg-blue-500' },\r\n    { value: 'bien', label: 'Bien', color: 'bg-cyan-500' },\r\n    { value: 'assez_bien', label: 'Assez bien', color: 'bg-yellow-500' },\r\n    { value: 'passable', label: 'Passable', color: 'bg-orange-500' },\r\n    { value: 'insuffisant', label: 'Insuffisant', color: 'bg-red-500' }\r\n  ];\r\n\r\n  // Charger les donn√©es de conduite existantes\r\n  useEffect(() => {\r\n    const loadConductData = async () => {\r\n      if (!classData?.class_id) return;\r\n      \r\n      setLoading(true);\r\n      try {\r\n        const { data, error } = await supabase\r\n          .from('student_conduct')\r\n          .select('*')\r\n          .eq('class_id', classData.class_id)\r\n          .eq('sequence', parseInt(selectedSequence));\r\n\r\n        if (error) {\r\n          console.warn('Erreur chargement conduite:', error);\r\n          return;\r\n        }\r\n\r\n        const conductMap = {};\r\n        (data || []).forEach(record => {\r\n          conductMap[record.student_id] = {\r\n            id: record.id,\r\n            assiduity: record.assiduity || 0,\r\n            punctuality: record.punctuality || 0,\r\n            discipline: record.discipline || 0,\r\n            respect: record.respect || 0,\r\n            participation: record.participation || 0,\r\n            presentation: record.presentation || 0,\r\n            appreciation: record.appreciation || '',\r\n            comment: record.comment || ''\r\n          };\r\n        });\r\n\r\n        setConductData(conductMap);\r\n      } catch (err) {\r\n        console.error('Erreur:', err);\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    };\r\n\r\n    loadConductData();\r\n  }, [classData, selectedSequence]);\r\n\r\n  const handleConductChange = (studentId, field, value) => {\r\n    setConductData(prev => ({\r\n      ...prev,\r\n      [studentId]: {\r\n        ...(prev[studentId] || {}),\r\n        [field]: value\r\n      }\r\n    }));\r\n  };\r\n\r\n  const calculateConductAverage = (studentId) => {\r\n    const data = conductData[studentId];\r\n    if (!data) return 0;\r\n    \r\n    const scores = conductCategories.map(cat => data[cat.id] || 0);\r\n    const total = scores.reduce((a, b) => a + b, 0);\r\n    return (total / conductCategories.length).toFixed(2);\r\n  };\r\n\r\n  const getConductMention = (average) => {\r\n    const avg = parseFloat(average);\r\n    if (avg >= 18) return { label: 'Excellent', color: 'text-green-600' };\r\n    if (avg >= 16) return { label: 'Tr√®s bien', color: 'text-blue-600' };\r\n    if (avg >= 14) return { label: 'Bien', color: 'text-cyan-600' };\r\n    if (avg >= 12) return { label: 'Assez bien', color: 'text-yellow-600' };\r\n    if (avg >= 10) return { label: 'Passable', color: 'text-orange-500' };\r\n    return { label: 'Insuffisant', color: 'text-red-600' };\r\n  };\r\n\r\n  const saveConductData = async () => {\r\n    setSaving(true);\r\n    try {\r\n      const rows = Object.entries(conductData).map(([studentId, data]) => ({\r\n        id: data.id || undefined,\r\n        student_id: studentId,\r\n        class_id: classData.class_id,\r\n        school_id: classData.school_id,\r\n        sequence: parseInt(selectedSequence),\r\n        trimester: Math.ceil(parseInt(selectedSequence) / 2),\r\n        assiduity: data.assiduity || 0,\r\n        punctuality: data.punctuality || 0,\r\n        discipline: data.discipline || 0,\r\n        respect: data.respect || 0,\r\n        participation: data.participation || 0,\r\n        presentation: data.presentation || 0,\r\n        average: parseFloat(calculateConductAverage(studentId)),\r\n        appreciation: data.appreciation || null,\r\n        comment: data.comment || null\r\n      }));\r\n\r\n      const { error } = await supabase\r\n        .from('student_conduct')\r\n        .upsert(rows, { onConflict: ['student_id', 'class_id', 'sequence'] });\r\n\r\n      if (error) throw error;\r\n\r\n      alert('Notes de conduite enregistr√©es avec succ√®s!');\r\n      if (onConductSaved) onConductSaved();\r\n    } catch (err) {\r\n      console.error('Erreur sauvegarde conduite:', err);\r\n      alert('Erreur lors de l\\'enregistrement');\r\n    } finally {\r\n      setSaving(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"bg-white rounded-2xl shadow-xl border border-border p-6\">\r\n      {/* Header */}\r\n      <div className=\"flex items-center justify-between mb-6\">\r\n        <div>\r\n          <h3 className=\"font-heading font-bold text-xl flex items-center gap-2\">\r\n            üìã Notes de Vie Scolaire\r\n          </h3>\r\n          <p className=\"text-sm text-muted-foreground\">\r\n            {classData?.name} ‚Äî √âvaluation du comportement\r\n          </p>\r\n        </div>\r\n        <div className=\"flex items-center gap-3\">\r\n          <select\r\n            value={selectedSequence}\r\n            onChange={(e) => setSelectedSequence(e.target.value)}\r\n            className=\"px-4 py-2 border border-border rounded-lg bg-background\"\r\n          >\r\n            {[1, 2, 3, 4, 5, 6].map(seq => (\r\n              <option key={seq} value={seq}>S√©quence {seq}</option>\r\n            ))}\r\n          </select>\r\n        </div>\r\n      </div>\r\n\r\n      {/* L√©gende des cat√©gories */}\r\n      <div className=\"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-3 mb-6 p-4 bg-gray-50 rounded-lg\">\r\n        {conductCategories.map(cat => (\r\n          <div key={cat.id} className=\"text-center\">\r\n            <span className=\"text-2xl\">{cat.icon}</span>\r\n            <p className=\"text-xs text-muted-foreground\">{cat.label}</p>\r\n          </div>\r\n        ))}\r\n      </div>\r\n\r\n      {loading ? (\r\n        <div className=\"text-center py-8\">\r\n          <Icon name=\"Loader2\" className=\"animate-spin mx-auto mb-2\" size={32} />\r\n          <p className=\"text-muted-foreground\">Chargement...</p>\r\n        </div>\r\n      ) : (\r\n        <>\r\n          {/* Liste des √©l√®ves */}\r\n          <div className=\"space-y-4 max-h-[500px] overflow-y-auto\">\r\n            {students.map(student => {\r\n              const avg = calculateConductAverage(student.id);\r\n              const mention = getConductMention(avg);\r\n              \r\n              return (\r\n                <div key={student.id} className=\"border border-border rounded-lg p-4\">\r\n                  <div className=\"flex items-center justify-between mb-3\">\r\n                    <div className=\"flex items-center gap-3\">\r\n                      <div className=\"w-10 h-10 bg-gray-200 rounded-full flex items-center justify-center font-bold\">\r\n                        {student.name?.charAt(0) || '?'}\r\n                      </div>\r\n                      <div>\r\n                        <p className=\"font-semibold\">{student.name}</p>\r\n                        <p className=\"text-xs text-muted-foreground\">{student.matricule}</p>\r\n                      </div>\r\n                    </div>\r\n                    <div className=\"text-right\">\r\n                      <p className=\"font-bold text-lg\">{avg}/20</p>\r\n                      <p className={`text-xs font-semibold ${mention.color}`}>{mention.label}</p>\r\n                    </div>\r\n                  </div>\r\n\r\n                  {/* Notes par cat√©gorie */}\r\n                  <div className=\"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-2 mb-3\">\r\n                    {conductCategories.map(cat => (\r\n                      <div key={cat.id}>\r\n                        <label className=\"text-xs text-muted-foreground\">{cat.icon} {cat.label}</label>\r\n                        <input\r\n                          type=\"number\"\r\n                          min=\"0\"\r\n                          max={cat.max}\r\n                          step=\"0.5\"\r\n                          value={conductData[student.id]?.[cat.id] || ''}\r\n                          onChange={(e) => handleConductChange(student.id, cat.id, parseFloat(e.target.value) || 0)}\r\n                          className=\"w-full px-2 py-1 border border-border rounded text-center text-sm\"\r\n                          placeholder=\"0\"\r\n                        />\r\n                      </div>\r\n                    ))}\r\n                  </div>\r\n\r\n                  {/* Appr√©ciation et commentaire */}\r\n                  <div className=\"grid grid-cols-1 md:grid-cols-2 gap-3\">\r\n                    <div>\r\n                      <label className=\"text-xs text-muted-foreground\">Appr√©ciation</label>\r\n                      <select\r\n                        value={conductData[student.id]?.appreciation || ''}\r\n                        onChange={(e) => handleConductChange(student.id, 'appreciation', e.target.value)}\r\n                        className=\"w-full px-3 py-1.5 border border-border rounded text-sm\"\r\n                      >\r\n                        <option value=\"\">-- S√©lectionner --</option>\r\n                        {appreciations.map(app => (\r\n                          <option key={app.value} value={app.value}>{app.label}</option>\r\n                        ))}\r\n                      </select>\r\n                    </div>\r\n                    <div>\r\n                      <label className=\"text-xs text-muted-foreground\">Observation</label>\r\n                      <input\r\n                        type=\"text\"\r\n                        value={conductData[student.id]?.comment || ''}\r\n                        onChange={(e) => handleConductChange(student.id, 'comment', e.target.value)}\r\n                        className=\"w-full px-3 py-1.5 border border-border rounded text-sm\"\r\n                        placeholder=\"Observation du prof principal...\"\r\n                      />\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              );\r\n            })}\r\n          </div>\r\n\r\n          {students.length === 0 && (\r\n            <div className=\"text-center py-8\">\r\n              <Icon name=\"Users\" size={48} className=\"text-muted-foreground mx-auto mb-3\" />\r\n              <p className=\"text-muted-foreground\">Aucun √©l√®ve dans cette classe</p>\r\n            </div>\r\n          )}\r\n\r\n          {/* Bouton sauvegarder */}\r\n          <div className=\"mt-6 pt-4 border-t border-border flex justify-end\">\r\n            <button\r\n              onClick={saveConductData}\r\n              disabled={saving}\r\n              className=\"px-6 py-2 bg-primary text-white rounded-lg hover:bg-primary/90 disabled:opacity-50 flex items-center gap-2\"\r\n            >\r\n              {saving ? (\r\n                <Icon name=\"Loader2\" className=\"animate-spin\" size={16} />\r\n              ) : (\r\n                <Icon name=\"Save\" size={16} />\r\n              )}\r\n              Enregistrer les notes de conduite\r\n            </button>\r\n          </div>\r\n        </>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ConductPanel;\r\n","import React, { useState, useRef } from 'react';\r\nimport Icon from '../../../components/AppIcon';\r\nimport { documentService } from '../../../services/documentService';\r\n\r\nconst DocumentManager = ({ classData, documents }) => {\r\n  const [showUploadForm, setShowUploadForm] = useState(false);\r\n  const [uploadForm, setUploadForm] = useState({\r\n    title: '',\r\n    type: '',\r\n    visibility: 'students',\r\n    description: ''\r\n  });\r\n  const [dragOver, setDragOver] = useState(false);\r\n\r\n  const documentTypes = [\r\n    { value: 'course', label: 'Cours', icon: 'BookOpen', color: 'text-primary' },\r\n    { value: 'exercise', label: 'Exercices', icon: 'Edit', color: 'text-success' },\r\n    { value: 'correction', label: 'Corrig√©', icon: 'CheckCircle', color: 'text-warning' },\r\n    { value: 'evaluation', label: '√âvaluation', icon: 'FileText', color: 'text-error' },\r\n    { value: 'resource', label: 'Ressource', icon: 'Folder', color: 'text-accent-foreground' }\r\n  ];\r\n\r\n  const visibilityOptions = [\r\n    { value: 'private', label: 'Priv√© (moi seul)', icon: 'Lock', description: 'Visible uniquement par vous' },\r\n    { value: 'students', label: '√âl√®ves seulement', icon: 'UserCheck', description: 'Visible par les √©l√®ves de la classe' },\r\n    { value: 'students_parents', label: '√âl√®ves et Parents', icon: 'Users', description: 'Visible par les √©l√®ves ET leurs parents' }\r\n  ];\r\n\r\n  const getTypeConfig = (type) => {\r\n    // Chercher le type correspondant, avec fallback sur un type par d√©faut\r\n    const found = documentTypes?.find(t => t?.value === type || t?.value === type?.toLowerCase());\r\n    if (found) return found;\r\n    \r\n    // Type par d√©faut si non trouv√©\r\n    return { value: 'resource', label: 'Document', icon: 'File', color: 'text-muted-foreground' };\r\n  };\r\n\r\n  const getFileIcon = (fileName) => {\r\n    const ext = fileName?.split('.')?.pop()?.toLowerCase();\r\n    switch (ext) {\r\n      case 'pdf': return <Icon name=\"File\" size={16} className=\"text-error\" />;\r\n      case 'doc': case'docx': return <Icon name=\"FileText\" size={16} className=\"text-primary\" />;\r\n      case 'ppt': case'pptx': return <Icon name=\"Presentation\" size={16} className=\"text-warning\" />;\r\n      case 'jpg': case'jpeg': case'png': return <Icon name=\"Image\" size={16} className=\"text-success\" />;\r\n      default: return <Icon name=\"File\" size={16} className=\"text-muted-foreground\" />;\r\n    }\r\n  };\r\n\r\n  // Utilitaire pour trouver la taille du fichier dans tous les cas\r\n  const getFileSize = (doc) => {\r\n    return doc?.file_size ?? doc?.fileSize ?? null;\r\n  };\r\n\r\n  const formatFileSize = (sizeInBytes) => {\r\n    if (!sizeInBytes || isNaN(sizeInBytes)) return 'Non renseign√©';\r\n    const size = Number(sizeInBytes);\r\n    if (size < 1024) return `${size} o`;\r\n    if (size < 1024 * 1024) return `${(size / 1024).toFixed(0)} KB`;\r\n    return `${(size / (1024 * 1024)).toFixed(1)} MB`;\r\n  };\r\n\r\n  // Utilitaire pour trouver la date dans tous les cas\r\n  const getDate = (doc) => {\r\n    return doc?.created_at ?? doc?.upload_date ?? doc?.uploadDate ?? null;\r\n  };\r\n\r\n  const formatDate = (dateString) => {\r\n    if (!dateString) return 'Non renseign√©';\r\n    const d = new Date(dateString);\r\n    if (isNaN(d.getTime())) return 'Non renseign√©';\r\n    return d.toLocaleDateString('fr-FR', {\r\n      day: 'numeric',\r\n      month: 'long',\r\n      year: 'numeric',\r\n      hour: '2-digit',\r\n      minute: '2-digit'\r\n    });\r\n  };\r\n\r\n  const handleDragOver = (e) => {\r\n    e?.preventDefault();\r\n    setDragOver(true);\r\n  };\r\n\r\n  const handleDragLeave = (e) => {\r\n    e?.preventDefault();\r\n    setDragOver(false);\r\n  };\r\n\r\n  const handleDrop = (e) => {\r\n    e?.preventDefault();\r\n    setDragOver(false);\r\n    const files = Array.from(e?.dataTransfer?.files || []);\r\n    if (files.length > 0) {\r\n      setSelectedFile(files[0]);\r\n    }\r\n  };\r\n\r\n  const [selectedFile, setSelectedFile] = useState(null);\r\n  const [uploading, setUploading] = useState(false);\r\n  const [uploadError, setUploadError] = useState(null);\r\n  const fileInputRef = useRef(null);\r\n\r\n  const handleFileChange = (e) => {\r\n    const f = e?.target?.files?.[0];\r\n    console.log('handleFileChange called, file:', f);\r\n    if (f) setSelectedFile(f);\r\n  };\r\n\r\n  const handleUploadSubmit = async (e) => {\r\n    e?.preventDefault();\r\n    if (!selectedFile) return alert('Veuillez s√©lectionner un fichier √† t√©l√©charger.');\r\n    if (!uploadForm?.title || !uploadForm?.type) return alert('Veuillez renseigner le titre et le type du document.');\r\n\r\n    setUploading(true);\r\n    try {\r\n      const documentData = {\r\n        title: uploadForm?.title,\r\n        description: uploadForm?.description,\r\n        document_type: uploadForm?.type,\r\n        class_name: classData?.name || classData?.id,\r\n        class_id: classData?.id, // ID de la classe cible pour les permissions\r\n        visibility: uploadForm?.visibility, // 'students', 'students_parents', ou 'private'\r\n        subject: uploadForm?.type || classData?.name\r\n      };\r\n\r\n      const { data, error } = await documentService.uploadTeacherDocument(documentData, selectedFile);\r\n      if (error) {\r\n        console.error('Upload error:', error);\r\n        const msg = typeof error === 'string' ? error : (error?.message || 'erreur inconnue');\r\n        setUploadError(msg);\r\n        alert('Erreur lors du t√©l√©chargement : ' + msg);\r\n      } else {\r\n        setUploadError(null);\r\n        alert('Document t√©l√©charg√© avec succ√®s!');\r\n        // Optionally refresh the page or invoke a parent refresh\r\n        window.location.reload();\r\n      }\r\n    } catch (err) {\r\n      console.error(err);\r\n      alert('Erreur inattendue lors du t√©l√©chargement.');\r\n    } finally {\r\n      setUploading(false);\r\n      setUploadForm({ title: '', type: '', visibility: 'students', description: '' });\r\n      setSelectedFile(null);\r\n      setShowUploadForm(false);\r\n    }\r\n  };\r\n\r\n  const handleDeleteDocument = async (docId) => {\r\n    if (!docId) {\r\n      alert('ID du document manquant');\r\n      return;\r\n    }\r\n    if (!window.confirm('√ätes-vous s√ªr de vouloir supprimer ce document ?')) return;\r\n    \r\n    console.log('üóëÔ∏è Suppression document:', docId);\r\n    try {\r\n      const { data, error } = await documentService.deleteDocument(docId);\r\n      console.log('üóëÔ∏è R√©sultat suppression:', { data, error });\r\n      if (error) {\r\n        alert('Erreur lors de la suppression : ' + error);\r\n      } else {\r\n        alert('Document supprim√© !');\r\n        window.location.reload();\r\n      }\r\n    } catch (e) {\r\n      console.error('‚ùå Exception suppression:', e);\r\n      alert('Erreur inattendue lors de la suppression: ' + e.message);\r\n    }\r\n  };\r\n\r\n  const handleDownloadDocument = async (docId) => {\r\n    if (!docId) {\r\n      alert('ID du document manquant');\r\n      return;\r\n    }\r\n    console.log('üì• T√©l√©chargement document:', docId);\r\n    try {\r\n      const { data, error } = await documentService.downloadDocument(docId, 'download');\r\n      console.log('üì• R√©sultat t√©l√©chargement:', { data, error });\r\n      if (error || !data?.url) {\r\n        alert('Erreur lors du t√©l√©chargement : ' + (error || 'URL manquante'));\r\n        return;\r\n      }\r\n      \r\n      // Forcer le t√©l√©chargement en cr√©ant un lien temporaire\r\n      const link = document.createElement('a');\r\n      link.href = data.url;\r\n      link.download = data.fileName || 'document';\r\n      link.target = '_blank';\r\n      document.body.appendChild(link);\r\n      link.click();\r\n      document.body.removeChild(link);\r\n    } catch (e) {\r\n      console.error('‚ùå Exception t√©l√©chargement:', e);\r\n      alert('Erreur inattendue lors du t√©l√©chargement: ' + e.message);\r\n    }\r\n  };\r\n\r\n  const handleViewDocument = async (docId) => {\r\n    if (!docId) {\r\n      alert('ID du document manquant');\r\n      return;\r\n    }\r\n    console.log('üëÅÔ∏è Visualisation document:', docId);\r\n    try {\r\n      const { data, error } = await documentService.downloadDocument(docId, 'view');\r\n      console.log('üëÅÔ∏è R√©sultat visualisation:', { data, error });\r\n      if (error || !data?.url) {\r\n        alert('Erreur lors de l\\'ouverture : ' + (error || 'URL manquante'));\r\n        return;\r\n      }\r\n      // Ouvrir dans un nouvel onglet pour visualiser\r\n      window.open(data.url, '_blank', 'noopener,noreferrer');\r\n    } catch (e) {\r\n      console.error('‚ùå Exception visualisation:', e);\r\n      alert('Erreur inattendue lors de l\\'ouverture: ' + e.message);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"bg-card rounded-lg shadow-card border border-border p-6\">\r\n      <div className=\"flex items-center justify-between mb-6\">\r\n        <h3 className=\"font-heading font-heading-semibold text-xl text-card-foreground\">\r\n          Documents - {classData?.name}\r\n        </h3>\r\n        <button\r\n          onClick={() => setShowUploadForm(!showUploadForm)}\r\n          className=\"px-4 py-2 bg-primary text-white hover:bg-primary/90 rounded-lg transition-colors flex items-center gap-2\"\r\n        >\r\n          <Icon name=\"Upload\" size={16} />\r\n          <span className=\"font-caption font-caption-semibold text-sm\">\r\n            T√©l√©charger\r\n          </span>\r\n        </button>\r\n      </div>\r\n      {uploadError && (\r\n        <div className=\"mt-4 p-3 border rounded-lg bg-error/5 border-error text-error\">\r\n          <div className=\"font-body font-body-semibold\">Erreur de stockage : {uploadError}</div>\r\n          <div className=\"text-sm mt-1\">V√©rifiez que le bucket nomm√© <strong>documents</strong> existe dans votre projet Supabase (Dashboard ‚Üí Storage ‚Üí Buckets).</div>\r\n          <div className=\"text-sm mt-1\">Si le bucket porte un autre nom, mettez √† jour la variable dans <strong>src/services/documentService.js</strong> (ligne d'appel √† <code>supabase.storage.from('documents')</code>).</div>\r\n          <div className=\"text-sm mt-1\">Documentation Supabase Storage: <a className=\"underline\" href=\"https://supabase.com/docs/guides/storage\" target=\"_blank\" rel=\"noreferrer\">https://supabase.com/docs/guides/storage</a></div>\r\n        </div>\r\n      )}\r\n      {/* Upload Form */}\r\n      {showUploadForm && (\r\n        <div className=\"mb-6 p-4 bg-primary/5 border border-primary/20 rounded-lg\">\r\n          <form onSubmit={handleUploadSubmit} className=\"space-y-4\">\r\n            <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-4\">\r\n              <div>\r\n                <label className=\"block font-body font-body-semibold text-sm text-card-foreground mb-2\">\r\n                  Titre du document *\r\n                </label>\r\n                <input\r\n                  type=\"text\"\r\n                  value={uploadForm?.title}\r\n                  onChange={(e) => setUploadForm({...uploadForm, title: e?.target?.value})}\r\n                  className=\"w-full px-3 py-2 border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary/50 bg-background\"\r\n                  placeholder=\"Chapitre 3 - Trigonom√©trie\"\r\n                  required\r\n                />\r\n              </div>\r\n              \r\n              <div>\r\n                <label className=\"block font-body font-body-semibold text-sm text-card-foreground mb-2\">\r\n                  Type de document *\r\n                </label>\r\n                <select\r\n                  value={uploadForm?.type}\r\n                  onChange={(e) => setUploadForm({...uploadForm, type: e?.target?.value})}\r\n                  className=\"w-full px-3 py-2 border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary/50 bg-background\"\r\n                  required\r\n                >\r\n                  <option value=\"\">Choisir le type</option>\r\n                  {documentTypes?.map(type => (\r\n                    <option key={type?.value} value={type?.value}>\r\n                      {type?.label}\r\n                    </option>\r\n                  ))}\r\n                </select>\r\n              </div>\r\n            </div>\r\n\r\n            <div>\r\n              <label className=\"block font-body font-body-semibold text-sm text-card-foreground mb-2\">\r\n                Visibilit√©\r\n              </label>\r\n              <div className=\"space-y-2\">\r\n                {visibilityOptions?.map(option => (\r\n                  <label key={option?.value} className=\"flex items-center gap-3 p-3 border border-border rounded-lg cursor-pointer hover:bg-muted/20\">\r\n                    <input\r\n                      type=\"radio\"\r\n                      name=\"visibility\"\r\n                      value={option?.value}\r\n                      checked={uploadForm?.visibility === option?.value}\r\n                      onChange={(e) => setUploadForm({...uploadForm, visibility: e?.target?.value})}\r\n                      className=\"text-primary focus:ring-primary\"\r\n                    />\r\n                    <Icon name={option?.icon} size={16} className=\"text-primary\" />\r\n                    <div>\r\n                      <div className=\"font-body font-body-semibold text-sm text-card-foreground\">\r\n                        {option?.label}\r\n                      </div>\r\n                      <p className=\"font-caption font-caption-normal text-xs text-muted-foreground\">\r\n                        {option?.description}\r\n                      </p>\r\n                    </div>\r\n                  </label>\r\n                ))}\r\n              </div>\r\n            </div>\r\n\r\n            <div>\r\n              <label className=\"block font-body font-body-semibold text-sm text-card-foreground mb-2\">\r\n                Description\r\n              </label>\r\n              <textarea\r\n                value={uploadForm?.description}\r\n                onChange={(e) => setUploadForm({...uploadForm, description: e?.target?.value})}\r\n                className=\"w-full px-3 py-2 border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary/50 bg-background h-20 resize-none\"\r\n                placeholder=\"Description du contenu du document...\"\r\n              />\r\n            </div>\r\n\r\n            {/* File Drop Zone */}\r\n            <div\r\n              onDragOver={handleDragOver}\r\n              onDragLeave={handleDragLeave}\r\n              onDrop={handleDrop}\r\n              onClick={() => {\r\n                console.log('Drop zone clicked - opening file picker');\r\n                fileInputRef.current?.click();\r\n              }}\r\n              tabIndex={0}\r\n              onKeyDown={(e) => { if (e.key === 'Enter' || e.key === ' ') { fileInputRef.current?.click(); } }}\r\n              role=\"button\"\r\n              aria-label=\"Zone de d√©p√¥t ou ouvrir le s√©lecteur de fichiers\"\r\n              className={`border-2 border-dashed rounded-lg p-6 text-center transition-all ${\r\n                dragOver ? 'border-primary bg-primary/5' : 'border-border hover:border-primary/50'\r\n              }`}\r\n            >\r\n              <Icon name=\"Upload\" size={32} className=\"text-muted-foreground mx-auto mb-3\" />\r\n              <p className=\"font-body font-body-normal text-sm text-muted-foreground mb-2\">\r\n                Glissez-d√©posez votre fichier ici ou\r\n              </p>\r\n              <label\r\n                className=\"inline-block px-4 py-2 bg-primary/10 text-primary hover:bg-primary/20 rounded-lg cursor-pointer transition-colors\"\r\n                onClick={() => fileInputRef.current?.click()}\r\n              >\r\n                <input\r\n                  ref={fileInputRef}\r\n                  type=\"file\"\r\n                  style={{ display: 'none' }}\r\n                  accept=\".pdf,.doc,.docx,.ppt,.pptx,.jpg,.jpeg,.png\"\r\n                  onChange={handleFileChange}\r\n                />\r\n                Parcourir les fichiers\r\n              </label>\r\n              {selectedFile ? (\r\n                <div className=\"mt-2 text-sm text-muted-foreground\">Fichier s√©lectionn√©: {selectedFile?.name} ‚Äî {(selectedFile?.size/1024)?.toFixed(0)} KB</div>\r\n              ) : (\r\n                <div className=\"mt-2 text-sm text-muted-foreground\">Aucun fichier s√©lectionn√©</div>\r\n              )}\r\n              <p className=\"font-caption font-caption-normal text-xs text-muted-foreground mt-2\">\r\n                PDF, Word, PowerPoint, Images (max 10MB)\r\n              </p>\r\n            </div>\r\n\r\n            <div className=\"flex items-center gap-3\">\r\n              <button\r\n                type=\"submit\"\r\n                disabled={!selectedFile || uploading}\r\n                className={`flex-1 bg-primary text-white font-body font-body-semibold py-2 px-4 rounded-lg hover:bg-primary/90 transition-colors ${(!selectedFile || uploading) ? 'opacity-50 cursor-not-allowed' : ''}`}\r\n              >\r\n                {uploading ? 'T√©l√©chargement...' : 'T√©l√©charger le Document'}\r\n              </button>\r\n              <button\r\n                type=\"button\"\r\n                onClick={() => setShowUploadForm(false)}\r\n                className=\"px-4 py-2 border border-border text-muted-foreground hover:bg-muted/20 rounded-lg transition-colors\"\r\n              >\r\n                Annuler\r\n              </button>\r\n            </div>\r\n          </form>\r\n        </div>\r\n      )}\r\n      {/* Documents List */}\r\n      <div className=\"space-y-3\">\r\n        {documents?.map(doc => {\r\n          const typeConfig = getTypeConfig(doc?.type || doc?.document_type);\r\n          return (\r\n            <div key={doc?.id} className=\"border border-border rounded-lg p-4 hover:shadow-md transition-shadow\">\r\n              <div className=\"flex items-start gap-4\">\r\n                <div className=\"p-2 bg-primary/10 rounded-lg\">\r\n                  <Icon name={typeConfig?.icon} size={20} className={typeConfig?.color} />\r\n                </div>\r\n                <div className=\"flex-1 min-w-0\">\r\n                  <div className=\"flex items-start justify-between mb-2\">\r\n                    <h4 className=\"font-heading font-heading-semibold text-lg text-card-foreground truncate\">\r\n                      {doc?.title}\r\n                    </h4>\r\n                    <div className=\"flex items-center gap-2 ml-3\">\r\n                      <button\r\n                        onClick={() => handleDownloadDocument(doc?.id)}\r\n                        className=\"p-2 text-primary hover:bg-primary/10 rounded-lg transition-colors\"\r\n                        title=\"T√©l√©charger\"\r\n                      >\r\n                        <Icon name=\"Download\" size={16} />\r\n                      </button>\r\n                      <button\r\n                        onClick={() => handleViewDocument(doc?.id)}\r\n                        className=\"p-2 text-accent hover:bg-accent/10 rounded-lg transition-colors\"\r\n                        title=\"Visualiser\"\r\n                      >\r\n                        <Icon name=\"Eye\" size={16} />\r\n                      </button>\r\n                      <button\r\n                        onClick={() => handleDeleteDocument(doc?.id)}\r\n                        className=\"p-2 text-error hover:bg-error/10 rounded-lg transition-colors\"\r\n                        title=\"Supprimer\"\r\n                      >\r\n                        <Icon name=\"Trash2\" size={16} />\r\n                      </button>\r\n                    </div>\r\n                  </div>\r\n                  <div className=\"flex flex-wrap items-center gap-3 mb-2\">\r\n                    <span className={`px-2 py-1 rounded text-xs font-caption font-caption-semibold bg-primary/10 ${typeConfig?.color}`}>\r\n                      {typeConfig?.label}\r\n                    </span>\r\n                    {/* Badge de visibilit√© / permissions */}\r\n                    <span className={`px-2 py-1 rounded text-xs font-caption font-caption-semibold flex items-center gap-1 ${\r\n                      doc?.visibility === 'school' || doc?.is_public \r\n                        ? 'bg-success/10 text-success' \r\n                        : doc?.visibility === 'private' \r\n                          ? 'bg-warning/10 text-warning'\r\n                          : 'bg-primary/10 text-primary'\r\n                    }`}>\r\n                      <Icon name={doc?.visibility === 'private' ? 'Lock' : doc?.is_public ? 'Users' : 'UserCheck'} size={12} />\r\n                      {doc?.visibility === 'school' || doc?.is_public \r\n                        ? '√âl√®ves + Parents' \r\n                        : doc?.visibility === 'private'\r\n                          ? 'Priv√© (vous seul)'\r\n                          : '√âl√®ves seulement'}\r\n                    </span>\r\n                    {/* Badge auteur */}\r\n                    {doc?.uploader?.full_name && (\r\n                      <span className=\"px-2 py-1 rounded text-xs font-caption font-caption-normal bg-muted/20 text-muted-foreground flex items-center gap-1\">\r\n                        <Icon name=\"User\" size={12} />\r\n                        Par {doc?.uploader?.full_name}\r\n                      </span>\r\n                    )}\r\n                  </div>\r\n                  <div className=\"flex items-center justify-between text-sm\">\r\n                    <div className=\"flex items-center gap-4 text-muted-foreground\">\r\n                      <span className=\"flex items-center gap-1\">\r\n                        {getFileIcon(doc?.file_name || doc?.title)}\r\n                        {formatFileSize(getFileSize(doc))}\r\n                      </span>\r\n                      {/*\r\n                      <span className=\"flex items-center gap-1\">\r\n                        <Icon name=\"Download\" size={14} />\r\n                        {doc?.downloads} t√©l√©chargements\r\n                      </span>\r\n                      */}\r\n                    </div>\r\n                    <span className=\"font-caption font-caption-normal text-muted-foreground\">\r\n                      {formatDate(getDate(doc))}\r\n                    </span>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          );\r\n        })}\r\n\r\n        {documents?.length === 0 && (\r\n          <div className=\"text-center py-8\">\r\n            <Icon name=\"FileText\" size={48} className=\"text-muted-foreground mx-auto mb-3\" />\r\n            <p className=\"font-body font-body-normal text-muted-foreground mb-2\">\r\n              Aucun document t√©l√©charg√© pour cette classe\r\n            </p>\r\n            <p className=\"font-caption font-caption-normal text-sm text-muted-foreground\">\r\n              Cliquez sur \"T√©l√©charger\" pour ajouter vos premiers documents\r\n            </p>\r\n          </div>\r\n        )}\r\n      </div>\r\n      {/* Storage Info */}\r\n      <div className=\"mt-6 p-3 bg-muted/10 rounded-lg border border-border\">\r\n        <div className=\"flex items-center gap-2 mb-2\">\r\n          <Icon name=\"HardDrive\" size={14} className=\"text-primary\" />\r\n          <span className=\"font-caption font-caption-semibold text-sm text-primary\">\r\n            Espace de stockage\r\n          </span>\r\n        </div>\r\n        <div className=\"flex items-center justify-between text-sm\">\r\n          <span className=\"font-caption font-caption-normal text-muted-foreground\">\r\n            {(() => {\r\n              const totalBytes = documents?.reduce((total, doc) => total + (parseFloat(doc?.file_size ?? doc?.fileSize ?? 0) || 0), 0);\r\n              return `${(totalBytes / (1024 * 1024)).toFixed(1)} MB utilis√©s sur 500 MB`;\r\n            })()}\r\n          </span>\r\n          <span className=\"font-caption font-caption-normal text-muted-foreground\">\r\n            {documents?.length} document{documents?.length > 1 ? 's' : ''}\r\n          </span>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default DocumentManager;","import React, { useState, useEffect } from 'react';\r\nimport Icon from '../../../components/AppIcon';\r\nimport { supabase } from '../../../lib/supabase';\r\n\r\nconst AttendanceManager = ({ classData, students }) => {\r\n  const [selectedDate, setSelectedDate] = useState(new Date()?.toISOString()?.split('T')?.[0]);\r\n  const [attendanceData, setAttendanceData] = useState({});\r\n  const [showQuickEntry, setShowQuickEntry] = useState(false);\r\n  const [loading, setLoading] = useState(false);\r\n  const [saving, setSaving] = useState(false);\r\n\r\n  const attendanceStatus = [\r\n    { value: 'present', label: 'Pr√©sent(e)', icon: 'Check', color: 'text-success', bg: 'bg-success' },\r\n    { value: 'absent', label: 'Absent(e)', icon: 'X', color: 'text-error', bg: 'bg-error' },\r\n    { value: 'late', label: 'En retard', icon: 'Clock', color: 'text-warning', bg: 'bg-warning' },\r\n    { value: 'excused', label: 'Excus√©(e)', icon: 'FileText', color: 'text-primary', bg: 'bg-primary' }\r\n  ];\r\n\r\n  const handleAttendanceChange = (studentId, status) => {\r\n    setAttendanceData(prev => ({\r\n      ...prev,\r\n      [selectedDate]: {\r\n        ...prev?.[selectedDate],\r\n        [studentId]: {\r\n          ...(prev?.[selectedDate]?.[studentId] || {}),\r\n          status\r\n        }\r\n      }\r\n    }));\r\n  };\r\n\r\n  const getStudentAttendance = (studentId) => {\r\n    return attendanceData?.[selectedDate]?.[studentId]?.status || 'present';\r\n  };\r\n\r\n  const handleJustificationChange = (studentId, value) => {\r\n    setAttendanceData(prev => ({\r\n      ...prev,\r\n      [selectedDate]: {\r\n        ...(prev?.[selectedDate] || {}),\r\n        [studentId]: {\r\n          ...(prev?.[selectedDate]?.[studentId] || {}),\r\n          justification: value\r\n        }\r\n      }\r\n    }));\r\n  };\r\n\r\n  const getStatusConfig = (status) => {\r\n    return attendanceStatus?.find(s => s?.value === status) || attendanceStatus?.[0];\r\n  };\r\n\r\n  const saveAttendance = () => {\r\n    const dateAttendance = attendanceData?.[selectedDate] || {};\r\n    const rows = Object.keys(dateAttendance).map(studentId => {\r\n      const rec = dateAttendance[studentId];\r\n      return {\r\n        id: rec?.id || undefined,\r\n        student_id: studentId,\r\n        class_id: classData?.class_id || classData?.id,\r\n        school_id: classData?.school_id,\r\n        teacher_id: classData?.teacher_id,\r\n        date: selectedDate,\r\n        status: rec.status,\r\n        justification: rec.justification || null\r\n      };\r\n    });\r\n\r\n    if (rows.length === 0) {\r\n      alert('Aucune modification √† enregistrer');\r\n      return;\r\n    }\r\n\r\n    setSaving(true);\r\n    (async () => {\r\n      try {\r\n        // Upsert rows based on unique constraint (student_id + date + class_id)\r\n        const { data, error } = await supabase\r\n          .from('attendances')\r\n          .upsert(rows, { onConflict: ['student_id', 'date', 'class_id'] })\r\n          .select();\r\n\r\n        if (error) throw error;\r\n\r\n        // Remap returned records to update local state with ids\r\n        const newMap = { ...(attendanceData || {}) };\r\n        newMap[selectedDate] = newMap[selectedDate] || {};\r\n        (data || []).forEach(rec => {\r\n          newMap[selectedDate][String(rec.student_id)] = {\r\n            id: rec.id,\r\n            status: rec.status,\r\n            justification: rec.justification\r\n          };\r\n        });\r\n\r\n        setAttendanceData(newMap);\r\n        alert('Pr√©sences enregistr√©es avec succ√®s!');\r\n      } catch (err) {\r\n        console.error('Erreur enregistrement pr√©sences:', err);\r\n        alert('Erreur lors de l\\'enregistrement des pr√©sences.');\r\n      } finally {\r\n        setSaving(false);\r\n      }\r\n    })();\r\n  };\r\n\r\n  const markAllPresent = () => {\r\n    const dateAttendance = {};\r\n    students?.forEach(student => {\r\n      dateAttendance[student?.id] = 'present';\r\n    });\r\n    \r\n    setAttendanceData(prev => ({\r\n      ...prev,\r\n      [selectedDate]: dateAttendance\r\n    }));\r\n  };\r\n\r\n  const getAttendanceStats = () => {\r\n    const dateData = attendanceData?.[selectedDate] || {};\r\n    const stats = {\r\n      present: 0,\r\n      absent: 0,\r\n      late: 0,\r\n      excused: 0,\r\n      total: students?.length || 0\r\n    };\r\n\r\n    Object.values(dateData)?.forEach(s => {\r\n      const status = s?.status || 'present';\r\n      stats[status] = (stats?.[status] || 0) + 1;\r\n    });\r\n\r\n    // If no data set, assume all present\r\n    if (Object.keys(dateData)?.length === 0) {\r\n      stats.present = stats?.total;\r\n    }\r\n\r\n    return stats;\r\n  };\r\n\r\n  const stats = getAttendanceStats();\r\n\r\n  // Charger les pr√©sences existantes pour la classe + date\r\n  useEffect(() => {\r\n    if (!classData || !classData.class_id) return;\r\n\r\n    const load = async () => {\r\n      setLoading(true);\r\n      try {\r\n        const { data, error } = await supabase\r\n          .from('attendances')\r\n          .select('id, student_id, status, justification, date')\r\n          .eq('class_id', classData.class_id)\r\n          .eq('date', selectedDate);\r\n\r\n        if (error) {\r\n          console.warn('Erreur chargement pr√©sences:', error);\r\n          setLoading(false);\r\n          return;\r\n        }\r\n\r\n        const dateAttendance = {};\r\n        (data || []).forEach(rec => {\r\n          dateAttendance[String(rec.student_id)] = {\r\n            id: rec.id,\r\n            status: rec.status,\r\n            justification: rec.justification\r\n          };\r\n        });\r\n\r\n        setAttendanceData(prev => ({ ...prev, [selectedDate]: dateAttendance }));\r\n      } catch (err) {\r\n        console.error('Erreur chargement pr√©sences:', err);\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    };\r\n\r\n    load();\r\n  }, [classData, selectedDate]);\r\n\r\n  const formatDate = (dateString) => {\r\n    return new Date(dateString)?.toLocaleDateString('fr-FR', {\r\n      weekday: 'long',\r\n      day: 'numeric',\r\n      month: 'long',\r\n      year: 'numeric'\r\n    });\r\n  };\r\n\r\n  const getAttendanceRate = () => {\r\n    if (stats?.total === 0) return 0;\r\n    return ((stats?.present + stats?.excused) / stats?.total * 100)?.toFixed(1);\r\n  };\r\n\r\n  return (\r\n    <div className=\"bg-card rounded-lg shadow-card border border-border p-6\">\r\n      <div className=\"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 mb-6\">\r\n        <h3 className=\"font-heading font-heading-semibold text-xl text-card-foreground\">\r\n          Gestion des Pr√©sences - {classData?.name}\r\n        </h3>\r\n        \r\n        <div className=\"flex items-center gap-3\">\r\n          <input\r\n            type=\"date\"\r\n            value={selectedDate}\r\n            onChange={(e) => setSelectedDate(e?.target?.value)}\r\n            className=\"px-3 py-2 border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary/50 bg-background\"\r\n          />\r\n          <button\r\n            onClick={() => setShowQuickEntry(!showQuickEntry)}\r\n            className=\"px-4 py-2 bg-primary/10 text-primary hover:bg-primary/20 rounded-lg transition-colors flex items-center gap-2\"\r\n          >\r\n            <Icon name=\"Zap\" size={16} />\r\n            <span className=\"font-caption font-caption-semibold text-sm\">\r\n              Saisie rapide\r\n            </span>\r\n          </button>\r\n        </div>\r\n      </div>\r\n      {/* Selected Date Info */}\r\n      <div className=\"mb-6 p-4 bg-primary/5 border border-primary/20 rounded-lg\">\r\n        <div className=\"flex items-center justify-between\">\r\n          <div>\r\n            <h4 className=\"font-heading font-heading-semibold text-lg text-card-foreground\">\r\n              {formatDate(selectedDate)}\r\n            </h4>\r\n            <p className=\"font-body font-body-normal text-sm text-muted-foreground\">\r\n              Cours de {classData?.subject} ‚Ä¢ {stats?.total} √©l√®ves\r\n            </p>\r\n          </div>\r\n          <div className=\"text-right\">\r\n            <div className=\"font-heading font-heading-bold text-2xl text-success\">\r\n              {getAttendanceRate()}%\r\n            </div>\r\n            <p className=\"font-caption font-caption-normal text-xs text-muted-foreground\">\r\n              Taux de pr√©sence\r\n            </p>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      {/* Quick Entry Panel */}\r\n      {showQuickEntry && (\r\n        <div className=\"mb-6 p-4 bg-success/5 border border-success/20 rounded-lg\">\r\n          <div className=\"flex items-center justify-between\">\r\n            <div>\r\n              <h4 className=\"font-heading font-heading-semibold text-lg text-card-foreground mb-2\">\r\n                Saisie rapide des pr√©sences\r\n              </h4>\r\n              <p className=\"font-body font-body-normal text-sm text-muted-foreground\">\r\n                Marquer tous les √©l√®ves pr√©sents, puis ajuster individuellement si n√©cessaire\r\n              </p>\r\n            </div>\r\n            <button\r\n              onClick={markAllPresent}\r\n              className=\"px-4 py-2 bg-success text-white hover:bg-success/90 rounded-lg transition-colors flex items-center gap-2\"\r\n            >\r\n              <Icon name=\"CheckCircle\" size={16} />\r\n              Tous pr√©sents\r\n            </button>\r\n          </div>\r\n        </div>\r\n      )}\r\n      {/* Attendance Statistics */}\r\n      <div className=\"grid grid-cols-2 lg:grid-cols-4 gap-4 mb-6\">\r\n        {attendanceStatus?.map(status => (\r\n          <div key={status?.value} className=\"bg-white rounded-lg p-4 shadow-sm border border-border text-center\">\r\n            <Icon name={status?.icon} size={20} className={`mx-auto mb-2 ${status?.color}`} />\r\n            <div className={`font-heading font-heading-bold text-xl ${status?.color}`}>\r\n              {stats?.[status?.value] || 0}\r\n            </div>\r\n            <p className=\"font-caption font-caption-normal text-xs text-muted-foreground\">\r\n              {status?.label}\r\n            </p>\r\n          </div>\r\n        ))}\r\n      </div>\r\n      {/* Student Attendance List */}\r\n      <div className=\"space-y-3 max-h-96 overflow-y-auto mb-6\">\r\n        {students?.map(student => {\r\n          const currentStatus = getStudentAttendance(student?.id);\r\n          const statusConfig = getStatusConfig(currentStatus);\r\n          \r\n          return (\r\n            <div key={student?.id} className=\"border border-border rounded-lg p-4\">\r\n              <div className=\"flex items-center gap-4\">\r\n                <img\r\n                  src={student?.photo}\r\n                  alt={student?.name}\r\n                  className=\"w-12 h-12 rounded-full object-cover border-2 border-border\"\r\n                />\r\n                \r\n                <div className=\"flex-1\">\r\n                  <h5 className=\"font-heading font-heading-semibold text-lg text-card-foreground\">\r\n                    {student?.name}\r\n                  </h5>\r\n                  <p className=\"font-body font-body-normal text-sm text-muted-foreground\">\r\n                    {student?.matricule}\r\n                  </p>\r\n                </div>\r\n\r\n                {/* Attendance Status Buttons */}\r\n                <div className=\"flex items-center gap-2\">\r\n                  {attendanceStatus?.map(status => (\r\n                    <button\r\n                      key={status?.value}\r\n                      onClick={() => handleAttendanceChange(student?.id, status?.value)}\r\n                      className={`p-2 rounded-lg transition-all ${\r\n                        currentStatus === status?.value\r\n                          ? `${status?.bg} text-white shadow-md`\r\n                          : `${status?.color} hover:bg-${status?.value}/10 border border-border`\r\n                      }`}\r\n                      title={status?.label}\r\n                    >\r\n                      <Icon name={status?.icon} size={16} />\r\n                    </button>\r\n                  ))}\r\n                </div>\r\n              </div>\r\n\r\n              {/* Additional Info for specific statuses */}\r\n              {(currentStatus === 'absent' || currentStatus === 'excused') && (\r\n                <div className=\"mt-3 pt-3 border-t border-border\">\r\n                  <input\r\n                    type=\"text\"\r\n                    placeholder={currentStatus === 'absent' ? 'Raison de l\\'absence (optionnel)' : 'Justification'}\r\n                    className=\"w-full px-3 py-2 text-sm border border-border rounded focus:outline-none focus:ring-1 focus:ring-primary/50\"\r\n                  />\r\n                </div>\r\n              )}\r\n            </div>\r\n          );\r\n        })}\r\n      </div>\r\n      {students?.length === 0 && (\r\n        <div className=\"text-center py-8\">\r\n          <Icon name=\"Users\" size={48} className=\"text-muted-foreground mx-auto mb-3\" />\r\n          <p className=\"font-body font-body-normal text-muted-foreground\">\r\n            Aucun √©l√®ve dans cette classe\r\n          </p>\r\n        </div>\r\n      )}\r\n      {/* Save Button */}\r\n      <div className=\"flex items-center justify-between pt-4 border-t border-border\">\r\n        <div className=\"text-sm text-muted-foreground\">\r\n          <Icon name=\"Info\" size={14} className=\"inline mr-1\" />\r\n          Les pr√©sences sont automatiquement notifi√©es aux parents par SMS\r\n        </div>\r\n        \r\n        <button\r\n          onClick={saveAttendance}\r\n          className=\"px-6 py-3 bg-primary text-white font-body font-body-semibold rounded-lg hover:bg-primary/90 transition-colors flex items-center gap-2\"\r\n        >\r\n          <Icon name=\"Save\" size={16} />\r\n          Enregistrer les Pr√©sences\r\n        </button>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default AttendanceManager;","import React, { useState } from 'react';\nimport Icon from '../../../components/AppIcon';\n\nconst StudentCommunication = ({ classData, students }) => {\n  const [selectedRecipients, setSelectedRecipients] = useState([]);\n  const [messageForm, setMessageForm] = useState({\n    type: 'note',\n    title: '',\n    message: '',\n    priority: 'medium'\n  });\n  const [showComposeForm, setShowComposeForm] = useState(false);\n\n  const messageTypes = [\n    { value: 'note', label: 'Nouvelle note', icon: 'BookOpen', color: 'text-success' },\n    { value: 'absence', label: 'Absence', icon: 'Calendar', color: 'text-error' },\n    { value: 'behavior', label: 'Comportement', icon: 'User', color: 'text-warning' },\n    { value: 'reminder', label: 'Rappel', icon: 'Bell', color: 'text-primary' },\n    { value: 'general', label: 'Information g√©n√©rale', icon: 'MessageSquare', color: 'text-accent-foreground' }\n  ];\n\n  const priorityLevels = [\n    { value: 'low', label: 'Faible', color: 'text-success' },\n    { value: 'medium', label: 'Moyenne', color: 'text-warning' },\n    { value: 'high', label: 'Haute', color: 'text-error' }\n  ];\n\n  const handleRecipientToggle = (studentId) => {\n    setSelectedRecipients(prev => \n      prev?.includes(studentId) \n        ? prev?.filter(id => id !== studentId)\n        : [...prev, studentId]\n    );\n  };\n\n  const selectAll = () => {\n    if (selectedRecipients?.length === students?.length) {\n      setSelectedRecipients([]);\n    } else {\n      setSelectedRecipients(students?.map(s => s?.id) || []);\n    }\n  };\n\n  const handleSendMessage = (e) => {\n    e?.preventDefault();\n    \n    if (selectedRecipients?.length === 0) {\n      alert('Veuillez s√©lectionner au moins un destinataire');\n      return;\n    }\n\n    console.log('Sending message:', {\n      recipients: selectedRecipients,\n      message: messageForm,\n      class: classData?.name\n    });\n    \n    // Reset form\n    setMessageForm({\n      type: 'note',\n      title: '',\n      message: '',\n      priority: 'medium'\n    });\n    setSelectedRecipients([]);\n    setShowComposeForm(false);\n    \n    alert(`Message envoy√© √† ${selectedRecipients?.length} parent(s) !`);\n  };\n\n  const sendQuickNotification = (type, student) => {\n    const templates = {\n      good_behavior: {\n        title: 'Comportement exemplaire',\n        message: `${student?.name} a fait preuve d'un comportement exemplaire aujourd'hui en cours de ${classData?.subject}.`\n      },\n      homework_missing: {\n        title: 'Devoir manquant',\n        message: `${student?.name} n'a pas rendu le devoir de ${classData?.subject} qui √©tait attendu aujourd'hui.`\n      },\n      excellent_work: {\n        title: 'Excellent travail',\n        message: `${student?.name} a fourni un excellent travail en ${classData?.subject}. F√©licitations !`\n      }\n    };\n\n    const template = templates?.[type];\n    console.log('Sending quick notification:', {\n      recipient: student?.id,\n      ...template,\n      class: classData?.name\n    });\n    \n    alert(`Message \"${template?.title}\" envoy√© au parent de ${student?.name} !`);\n  };\n\n  const getTypeConfig = (type) => {\n    return messageTypes?.find(t => t?.value === type) || messageTypes?.[0];\n  };\n\n  const getPriorityConfig = (priority) => {\n    return priorityLevels?.find(p => p?.value === priority) || priorityLevels?.[1];\n  };\n\n  return (\n    <div className=\"bg-card rounded-lg shadow-card border border-border p-6\">\n      <div className=\"flex items-center justify-between mb-6\">\n        <h3 className=\"font-heading font-heading-semibold text-xl text-card-foreground\">\n          Communication Parentale\n        </h3>\n        <button\n          onClick={() => setShowComposeForm(!showComposeForm)}\n          className=\"px-4 py-2 bg-primary text-white hover:bg-primary/90 rounded-lg transition-colors flex items-center gap-2\"\n        >\n          <Icon name=\"MessageSquare\" size={16} />\n          <span className=\"font-caption font-caption-semibold text-sm\">\n            Nouveau message\n          </span>\n        </button>\n      </div>\n      {/* Message Compose Form */}\n      {showComposeForm && (\n        <div className=\"mb-6 p-4 bg-primary/5 border border-primary/20 rounded-lg\">\n          <form onSubmit={handleSendMessage} className=\"space-y-4\">\n            <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-4\">\n              <div>\n                <label className=\"block font-body font-body-semibold text-sm text-card-foreground mb-2\">\n                  Type de message *\n                </label>\n                <select\n                  value={messageForm?.type}\n                  onChange={(e) => setMessageForm({...messageForm, type: e?.target?.value})}\n                  className=\"w-full px-3 py-2 border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary/50 bg-background\"\n                  required\n                >\n                  {messageTypes?.map(type => (\n                    <option key={type?.value} value={type?.value}>\n                      {type?.label}\n                    </option>\n                  ))}\n                </select>\n              </div>\n\n              <div>\n                <label className=\"block font-body font-body-semibold text-sm text-card-foreground mb-2\">\n                  Priorit√©\n                </label>\n                <select\n                  value={messageForm?.priority}\n                  onChange={(e) => setMessageForm({...messageForm, priority: e?.target?.value})}\n                  className=\"w-full px-3 py-2 border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary/50 bg-background\"\n                >\n                  {priorityLevels?.map(priority => (\n                    <option key={priority?.value} value={priority?.value}>\n                      {priority?.label}\n                    </option>\n                  ))}\n                </select>\n              </div>\n            </div>\n\n            <div>\n              <label className=\"block font-body font-body-semibold text-sm text-card-foreground mb-2\">\n                Objet *\n              </label>\n              <input\n                type=\"text\"\n                value={messageForm?.title}\n                onChange={(e) => setMessageForm({...messageForm, title: e?.target?.value})}\n                className=\"w-full px-3 py-2 border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary/50 bg-background\"\n                placeholder=\"Objet du message...\"\n                required\n              />\n            </div>\n\n            <div>\n              <label className=\"block font-body font-body-semibold text-sm text-card-foreground mb-2\">\n                Message *\n              </label>\n              <textarea\n                value={messageForm?.message}\n                onChange={(e) => setMessageForm({...messageForm, message: e?.target?.value})}\n                className=\"w-full px-3 py-2 border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary/50 bg-background h-24 resize-none\"\n                placeholder=\"Votre message aux parents...\"\n                required\n              />\n            </div>\n\n            {/* Recipients Selection */}\n            <div>\n              <div className=\"flex items-center justify-between mb-3\">\n                <label className=\"font-body font-body-semibold text-sm text-card-foreground\">\n                  Destinataires * ({selectedRecipients?.length} s√©lectionn√©{selectedRecipients?.length > 1 ? 's' : ''})\n                </label>\n                <button\n                  type=\"button\"\n                  onClick={selectAll}\n                  className=\"px-3 py-1 text-sm bg-primary/10 text-primary hover:bg-primary/20 rounded transition-colors\"\n                >\n                  {selectedRecipients?.length === students?.length ? 'D√©s√©lectionner tout' : 'S√©lectionner tout'}\n                </button>\n              </div>\n              \n              <div className=\"max-h-48 overflow-y-auto border border-border rounded-lg\">\n                {students?.map(student => (\n                  <label key={student?.id} className=\"flex items-center gap-3 p-3 hover:bg-muted/20 cursor-pointer border-b border-border last:border-b-0\">\n                    <input\n                      type=\"checkbox\"\n                      checked={selectedRecipients?.includes(student?.id)}\n                      onChange={() => handleRecipientToggle(student?.id)}\n                      className=\"text-primary focus:ring-primary\"\n                    />\n                    <img\n                      src={student?.photo}\n                      alt={student?.name}\n                      className=\"w-8 h-8 rounded-full object-cover\"\n                    />\n                    <div className=\"flex-1\">\n                      <div className=\"font-body font-body-semibold text-sm text-card-foreground\">\n                        {student?.name}\n                      </div>\n                      <div className=\"font-caption font-caption-normal text-xs text-muted-foreground\">\n                        {student?.matricule}\n                      </div>\n                    </div>\n                  </label>\n                ))}\n              </div>\n            </div>\n\n            <div className=\"flex items-center gap-3\">\n              <button\n                type=\"submit\"\n                className=\"flex-1 bg-primary text-white font-body font-body-semibold py-3 px-4 rounded-lg hover:bg-primary/90 transition-colors flex items-center justify-center gap-2\"\n              >\n                <Icon name=\"Send\" size={16} />\n                Envoyer le Message\n              </button>\n              <button\n                type=\"button\"\n                onClick={() => setShowComposeForm(false)}\n                className=\"px-4 py-3 border border-border text-muted-foreground hover:bg-muted/20 rounded-lg transition-colors\"\n              >\n                Annuler\n              </button>\n            </div>\n          </form>\n        </div>\n      )}\n      {/* Student List with Quick Actions */}\n      <div className=\"space-y-3\">\n        <h4 className=\"font-heading font-heading-semibold text-lg text-card-foreground\">\n          Actions Rapides par √âl√®ve\n        </h4>\n\n        {students?.map(student => (\n          <div key={student?.id} className=\"border border-border rounded-lg p-4\">\n            <div className=\"flex items-center gap-4 mb-3\">\n              <img\n                src={student?.photo}\n                alt={student?.name}\n                className=\"w-12 h-12 rounded-full object-cover border-2 border-border\"\n              />\n              \n              <div className=\"flex-1\">\n                <h5 className=\"font-heading font-heading-semibold text-lg text-card-foreground\">\n                  {student?.name}\n                </h5>\n                <p className=\"font-body font-body-normal text-sm text-muted-foreground\">\n                  {student?.matricule}\n                </p>\n              </div>\n\n              {/* Student Stats */}\n              <div className=\"hidden sm:flex items-center gap-4 text-sm\">\n                <div className=\"text-center\">\n                  <div className=\"font-heading font-heading-bold text-success\">\n                    {student?.recentGrades?.[0]?.grade || 0}/20\n                  </div>\n                  <p className=\"font-caption font-caption-normal text-xs text-muted-foreground\">\n                    Derni√®re note\n                  </p>\n                </div>\n                <div className=\"text-center\">\n                  <div className=\"font-heading font-heading-bold text-primary\">\n                    {student?.attendance?.present || 0}\n                  </div>\n                  <p className=\"font-caption font-caption-normal text-xs text-muted-foreground\">\n                    Pr√©sences\n                  </p>\n                </div>\n              </div>\n            </div>\n\n            {/* Quick Action Buttons */}\n            <div className=\"flex flex-wrap gap-2\">\n              <button\n                onClick={() => sendQuickNotification('good_behavior', student)}\n                className=\"px-3 py-2 bg-success/10 text-success hover:bg-success/20 rounded-lg transition-colors flex items-center gap-2\"\n              >\n                <Icon name=\"ThumbsUp\" size={14} />\n                <span className=\"font-caption font-caption-semibold text-xs\">\n                  F√©liciter\n                </span>\n              </button>\n\n              <button\n                onClick={() => sendQuickNotification('homework_missing', student)}\n                className=\"px-3 py-2 bg-warning/10 text-warning hover:bg-warning/20 rounded-lg transition-colors flex items-center gap-2\"\n              >\n                <Icon name=\"AlertCircle\" size={14} />\n                <span className=\"font-caption font-caption-semibold text-xs\">\n                  Devoir manquant\n                </span>\n              </button>\n\n              <button\n                onClick={() => sendQuickNotification('excellent_work', student)}\n                className=\"px-3 py-2 bg-primary/10 text-primary hover:bg-primary/20 rounded-lg transition-colors flex items-center gap-2\"\n              >\n                <Icon name=\"Award\" size={14} />\n                <span className=\"font-caption font-caption-semibold text-xs\">\n                  Excellent travail\n                </span>\n              </button>\n\n              <button\n                onClick={() => {\n                  setSelectedRecipients([student?.id]);\n                  setShowComposeForm(true);\n                }}\n                className=\"px-3 py-2 bg-accent/10 text-accent-foreground hover:bg-accent/20 rounded-lg transition-colors flex items-center gap-2\"\n              >\n                <Icon name=\"MessageSquare\" size={14} />\n                <span className=\"font-caption font-caption-semibold text-xs\">\n                  Message perso\n                </span>\n              </button>\n            </div>\n          </div>\n        ))}\n\n        {students?.length === 0 && (\n          <div className=\"text-center py-8\">\n            <Icon name=\"Users\" size={48} className=\"text-muted-foreground mx-auto mb-3\" />\n            <p className=\"font-body font-body-normal text-muted-foreground\">\n              Aucun √©l√®ve dans cette classe\n            </p>\n          </div>\n        )}\n      </div>\n      {/* SMS Information */}\n      <div className=\"mt-6 p-4 bg-accent/5 border border-accent/20 rounded-lg\">\n        <div className=\"flex items-start gap-3\">\n          <Icon name=\"MessageSquare\" size={16} className=\"text-accent-foreground mt-0.5\" />\n          <div className=\"text-sm\">\n            <p className=\"font-body font-body-semibold text-accent-foreground mb-1\">\n              Notifications SMS automatiques\n            </p>\n            <p className=\"font-body font-body-normal text-muted-foreground\">\n              Tous les messages envoy√©s via cette interface sont √©galement transmis \n              aux parents par SMS. Les accus√©s de r√©ception sont track√©s.\n            </p>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default StudentCommunication;","import React from 'react';\nimport Icon from '../../../components/AppIcon';\n\nconst TeacherSchedule = ({ schedule, teacherName }) => {\n  const getTypeIcon = (type) => {\n    switch (type) {\n      case 'course': return <Icon name=\"BookOpen\" size={16} className=\"text-primary\" />;\n      case 'evaluation': return <Icon name=\"FileText\" size={16} className=\"text-error\" />;\n      case 'tp': return <Icon name=\"Laptop\" size={16} className=\"text-success\" />;\n      case 'meeting': return <Icon name=\"Users\" size={16} className=\"text-warning\" />;\n      default: return <Icon name=\"Calendar\" size={16} className=\"text-muted-foreground\" />;\n    }\n  };\n\n  const getTypeColor = (type) => {\n    switch (type) {\n      case 'course': return 'bg-primary/10 border-primary/20';\n      case 'evaluation': return 'bg-error/10 border-error/20';\n      case 'tp': return 'bg-success/10 border-success/20';\n      case 'meeting': return 'bg-warning/10 border-warning/20';\n      default: return 'bg-muted/10 border-border';\n    }\n  };\n\n  const getTypeText = (type) => {\n    switch (type) {\n      case 'course': return 'Cours';\n      case 'evaluation': return '√âvaluation';\n      case 'tp': return 'Travaux Pratiques';\n      case 'meeting': return 'R√©union';\n      default: return 'Activit√©';\n    }\n  };\n\n  const formatTime = (timeString) => {\n    return timeString?.replace('-', ' - ');\n  };\n\n  const formatDate = (dateString) => {\n    const date = new Date(dateString);\n    const today = new Date();\n    const isToday = date?.toDateString() === today?.toDateString();\n    \n    if (isToday) {\n      return 'Aujourd\\'hui';\n    }\n    \n    const tomorrow = new Date(today);\n    tomorrow?.setDate(today?.getDate() + 1);\n    const isTomorrow = date?.toDateString() === tomorrow?.toDateString();\n    \n    if (isTomorrow) {\n      return 'Demain';\n    }\n    \n    return date?.toLocaleDateString('fr-FR', {\n      weekday: 'long',\n      day: 'numeric',\n      month: 'long'\n    });\n  };\n\n  const getDayOfWeek = (dateString) => {\n    return new Date(dateString)?.toLocaleDateString('fr-FR', { weekday: 'long' });\n  };\n\n  const isToday = (dateString) => {\n    return new Date(dateString)?.toDateString() === new Date()?.toDateString();\n  };\n\n  const getCurrentTime = () => {\n    const now = new Date();\n    return now?.getHours() * 60 + now?.getMinutes();\n  };\n\n  const getTimeInMinutes = (timeString) => {\n    const [startTime] = timeString?.split('-');\n    const [hours, minutes] = startTime?.split(':')?.map(Number);\n    return hours * 60 + minutes;\n  };\n\n  const isCurrentClass = (scheduleItem) => {\n    if (!isToday(scheduleItem?.date)) return false;\n    \n    const now = getCurrentTime();\n    const [startTime, endTime] = scheduleItem?.time?.split('-');\n    const startMinutes = getTimeInMinutes(startTime + ':00');\n    const endMinutes = getTimeInMinutes(endTime + ':00');\n    \n    return now >= startMinutes && now <= endMinutes;\n  };\n\n  const getNextClass = () => {\n    const now = getCurrentTime();\n    const today = new Date()?.toDateString();\n    \n    return schedule?.find(item => {\n      if (new Date(item.date)?.toDateString() !== today) return false;\n      const startMinutes = getTimeInMinutes(item?.time?.split('-')?.[0] + ':00');\n      return startMinutes > now;\n    });\n  };\n\n  const nextClass = getNextClass();\n  const currentClass = schedule?.find(item => isCurrentClass(item));\n\n  // Group schedule by date\n  const groupedSchedule = schedule?.reduce((groups, item) => {\n    const date = item?.date;\n    if (!groups?.[date]) {\n      groups[date] = [];\n    }\n    groups?.[date]?.push(item);\n    return groups;\n  }, {}) || {};\n\n  return (\n    <div className=\"bg-card rounded-lg shadow-card border border-border p-6\">\n      <div className=\"flex items-center justify-between mb-6\">\n        <h3 className=\"font-heading font-heading-semibold text-xl text-card-foreground\">\n          Mon Planning de la Semaine\n        </h3>\n        <div className=\"flex items-center gap-2 px-3 py-2 bg-primary/10 rounded-lg\">\n          <Icon name=\"Calendar\" size={16} className=\"text-primary\" />\n          <span className=\"font-caption font-caption-semibold text-sm text-primary\">\n            {schedule?.length} cours cette semaine\n          </span>\n        </div>\n      </div>\n      {/* Current/Next Class Alert */}\n      {(currentClass || nextClass) && (\n        <div className={`mb-6 p-4 rounded-lg border ${\n          currentClass \n            ? 'bg-success/5 border-success/20' :'bg-primary/5 border-primary/20'\n        }`}>\n          <div className=\"flex items-center gap-3\">\n            <div className={`p-2 rounded-lg ${\n              currentClass ? 'bg-success/10' : 'bg-primary/10'\n            }`}>\n              {currentClass \n                ? <Icon name=\"PlayCircle\" size={20} className=\"text-success\" />\n                : <Icon name=\"Clock\" size={20} className=\"text-primary\" />\n              }\n            </div>\n            \n            <div className=\"flex-1\">\n              <h4 className={`font-heading font-heading-semibold text-lg ${\n                currentClass ? 'text-success' : 'text-primary'\n              }`}>\n                {currentClass ? 'Cours en cours' : 'Prochain cours'}\n              </h4>\n              <div className=\"mt-1\">\n                {(currentClass || nextClass) && (\n                  <div>\n                    <p className=\"font-body font-body-semibold text-card-foreground\">\n                      {(currentClass || nextClass)?.className} - {(currentClass || nextClass)?.topic}\n                    </p>\n                    <div className=\"flex items-center gap-4 mt-1 text-sm text-muted-foreground\">\n                      <span className=\"flex items-center gap-1\">\n                        <Icon name=\"Clock\" size={14} />\n                        {formatTime((currentClass || nextClass)?.time)}\n                      </span>\n                      <span className=\"flex items-center gap-1\">\n                        <Icon name=\"MapPin\" size={14} />\n                        {(currentClass || nextClass)?.room}\n                      </span>\n                    </div>\n                  </div>\n                )}\n              </div>\n            </div>\n            \n            {currentClass && (\n              <div className=\"text-right\">\n                <div className=\"font-heading font-heading-bold text-success text-lg\">\n                  EN COURS\n                </div>\n              </div>\n            )}\n          </div>\n        </div>\n      )}\n      {/* Schedule by Day */}\n      <div className=\"space-y-6\">\n        {Object.entries(groupedSchedule)?.map(([date, daySchedule]) => (\n          <div key={date}>\n            <div className={`flex items-center gap-3 mb-4 ${\n              isToday(date) ? 'text-primary' : 'text-muted-foreground'\n            }`}>\n              <h4 className=\"font-heading font-heading-semibold text-lg\">\n                {formatDate(date)}\n              </h4>\n              {isToday(date) && (\n                <span className=\"px-2 py-1 bg-primary/10 text-primary rounded text-xs font-caption font-caption-semibold\">\n                  Aujourd'hui\n                </span>\n              )}\n              <div className=\"flex-1 h-px bg-border\"></div>\n            </div>\n\n            <div className=\"space-y-3\">\n              {daySchedule\n                ?.sort((a, b) => getTimeInMinutes(a?.time) - getTimeInMinutes(b?.time))\n                ?.map(item => (\n                <div\n                  key={item?.id}\n                  className={`border rounded-lg p-4 transition-all ${getTypeColor(item?.type)} ${\n                    isCurrentClass(item) ? 'ring-2 ring-success shadow-md' : 'hover:shadow-sm'\n                  }`}\n                >\n                  <div className=\"flex items-center gap-4\">\n                    <div className=\"flex items-center gap-3\">\n                      {getTypeIcon(item?.type)}\n                      <div>\n                        <span className={`px-2 py-1 rounded text-xs font-caption font-caption-semibold ${\n                          item?.type === 'course' ? 'bg-primary/10 text-primary' :\n                          item?.type === 'evaluation' ? 'bg-error/10 text-error' :\n                          item?.type === 'tp'? 'bg-success/10 text-success' : 'bg-warning/10 text-warning'\n                        }`}>\n                          {getTypeText(item?.type)}\n                        </span>\n                      </div>\n                    </div>\n\n                    <div className=\"flex-1\">\n                      <h5 className=\"font-heading font-heading-semibold text-lg text-card-foreground\">\n                        {item?.className} - {item?.topic}\n                      </h5>\n                      <p className=\"font-body font-body-normal text-sm text-muted-foreground\">\n                        {item?.subject}\n                      </p>\n                    </div>\n\n                    <div className=\"text-right\">\n                      <div className=\"font-heading font-heading-bold text-lg text-card-foreground\">\n                        {formatTime(item?.time)}\n                      </div>\n                      <p className=\"font-caption font-caption-normal text-sm text-muted-foreground\">\n                        üìç {item?.room}\n                      </p>\n                    </div>\n                  </div>\n\n                  {isCurrentClass(item) && (\n                    <div className=\"mt-3 pt-3 border-t border-success/20\">\n                      <div className=\"flex items-center justify-between\">\n                        <span className=\"font-body font-body-semibold text-success\">\n                          Cours en cours - {item?.className}\n                        </span>\n                        <div className=\"flex items-center gap-2\">\n                          <button className=\"px-3 py-1 bg-success/10 text-success hover:bg-success/20 rounded-lg transition-colors\">\n                            <Icon name=\"Users\" size={12} className=\"inline mr-1\" />\n                            Liste classe\n                          </button>\n                          <button className=\"px-3 py-1 bg-primary/10 text-primary hover:bg-primary/20 rounded-lg transition-colors\">\n                            <Icon name=\"Calendar\" size={12} className=\"inline mr-1\" />\n                            Pr√©sences\n                          </button>\n                        </div>\n                      </div>\n                    </div>\n                  )}\n                </div>\n              ))}\n            </div>\n          </div>\n        ))}\n\n        {schedule?.length === 0 && (\n          <div className=\"text-center py-12\">\n            <Icon name=\"Calendar\" size={64} className=\"text-muted-foreground mx-auto mb-4\" />\n            <h4 className=\"font-heading font-heading-semibold text-xl text-card-foreground mb-2\">\n              Aucun cours programm√©\n            </h4>\n            <p className=\"font-body font-body-normal text-muted-foreground\">\n              Votre planning de la semaine est vide.\n            </p>\n          </div>\n        )}\n      </div>\n      {/* Weekly Summary */}\n      {schedule?.length > 0 && (\n        <div className=\"mt-8 pt-6 border-t border-border\">\n          <h4 className=\"font-heading font-heading-semibold text-lg text-card-foreground mb-4\">\n            R√©sum√© de la semaine\n          </h4>\n          \n          <div className=\"grid grid-cols-2 sm:grid-cols-4 gap-4\">\n            <div className=\"text-center p-3 bg-primary/5 rounded-lg\">\n              <div className=\"font-heading font-heading-bold text-xl text-primary\">\n                {schedule?.filter(s => s?.type === 'course')?.length}\n              </div>\n              <p className=\"font-caption font-caption-normal text-xs text-muted-foreground\">\n                Cours\n              </p>\n            </div>\n            \n            <div className=\"text-center p-3 bg-error/5 rounded-lg\">\n              <div className=\"font-heading font-heading-bold text-xl text-error\">\n                {schedule?.filter(s => s?.type === 'evaluation')?.length}\n              </div>\n              <p className=\"font-caption font-caption-normal text-xs text-muted-foreground\">\n                √âvaluations\n              </p>\n            </div>\n            \n            <div className=\"text-center p-3 bg-success/5 rounded-lg\">\n              <div className=\"font-heading font-heading-bold text-xl text-success\">\n                {schedule?.length * 1.5}h\n              </div>\n              <p className=\"font-caption font-caption-normal text-xs text-muted-foreground\">\n                Total heures\n              </p>\n            </div>\n            \n            <div className=\"text-center p-3 bg-warning/5 rounded-lg\">\n              <div className=\"font-heading font-heading-bold text-xl text-warning\">\n                {new Set(schedule?.map(s => s.className))?.size}\n              </div>\n              <p className=\"font-caption font-caption-normal text-xs text-muted-foreground\">\n                Classes diff.\n              </p>\n            </div>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default TeacherSchedule;","import React, { useState, useEffect } from 'react';\r\nimport Icon from '../../../components/AppIcon';\r\nimport { supabase } from '../../../lib/supabase';\r\n\r\nconst TeacherMultiSchoolOverview = ({ teacherId }) => {\r\n  const [teacherData, setTeacherData] = useState(null);\r\n  const [selectedSchool, setSelectedSchool] = useState(null);\r\n  const [loading, setLoading] = useState(true);\r\n\r\n  useEffect(() => {\r\n    const loadTeacherData = async () => {\r\n      setLoading(true);\r\n      try {\r\n        // Charger les assignations de l'enseignant pour tous les √©tablissements\r\n        const { data: assignments, error: assignmentsError } = await supabase\r\n          .from('teacher_assignments')\r\n          .select(`\r\n            id,\r\n            school_id,\r\n            class_name,\r\n            subject_name,\r\n            schedule,\r\n            start_date,\r\n            end_date,\r\n            is_active,\r\n            schools!teacher_assignments_school_id_fkey (\r\n              id,\r\n              name,\r\n              type\r\n            )\r\n          `)\r\n          .eq('teacher_id', teacherId)\r\n          .eq('is_active', true);\r\n\r\n        if (assignmentsError) throw assignmentsError;\r\n\r\n        if (!assignments || assignments.length === 0) {\r\n          setTeacherData(null);\r\n          setLoading(false);\r\n          return;\r\n        }\r\n\r\n        // Grouper les assignations par √©cole\r\n        const schoolsMap = new Map();\r\n        let totalWeeklyHours = 0;\r\n        let totalStudents = 0;\r\n\r\n        for (const assignment of assignments) {\r\n          const schoolId = assignment.school_id;\r\n          const weeklyHours = assignment.schedule?.weekly_hours || 0;\r\n          totalWeeklyHours += weeklyHours;\r\n\r\n          if (!schoolsMap.has(schoolId)) {\r\n            schoolsMap.set(schoolId, {\r\n              schoolId: schoolId,\r\n              school: assignment.schools,\r\n              classes: [],\r\n              subjects: new Set(),\r\n              weeklyHours: 0,\r\n              assignedClasses: [],\r\n              startDate: assignment.start_date,\r\n              endDate: assignment.end_date,\r\n              isActive: assignment.is_active\r\n            });\r\n          }\r\n\r\n          const schoolData = schoolsMap.get(schoolId);\r\n          schoolData.weeklyHours += weeklyHours;\r\n          schoolData.subjects.add(assignment.subject_name);\r\n          \r\n          // Charger les √©l√®ves pour cette classe\r\n          const { data: students } = await supabase\r\n            .from('students')\r\n            .select('id')\r\n            .eq('school_id', schoolId)\r\n            .eq('is_active', true)\r\n            .or(`class_name.eq.${assignment.class_name},current_class.eq.${assignment.class_name}`);\r\n\r\n          const studentsCount = students?.length || 0;\r\n          totalStudents += studentsCount;\r\n\r\n          schoolData.assignedClasses.push({\r\n            name: assignment.class_name,\r\n            studentsCount: studentsCount,\r\n            subject: assignment.subject_name,\r\n            weeklyHours: weeklyHours\r\n          });\r\n\r\n          schoolData.classes.push(assignment.class_name);\r\n        }\r\n\r\n        // Convertir en tableau et formatter\r\n        const schoolAssignments = Array.from(schoolsMap.values()).map(school => ({\r\n          ...school,\r\n          subjects: Array.from(school.subjects),\r\n          classes: [...new Set(school.classes)],\r\n          assignmentType: school.weeklyHours > 15 ? 'principal' : 'secondaire',\r\n          position: 'Enseignant'\r\n        }));\r\n\r\n        const formattedData = {\r\n          totalSchools: schoolAssignments.length,\r\n          totalWeeklyHours: totalWeeklyHours,\r\n          totalStudents: totalStudents,\r\n          availableHours: Math.max(0, 40 - totalWeeklyHours),\r\n          assignments: schoolAssignments\r\n        };\r\n\r\n        setTeacherData(formattedData);\r\n        \r\n        if (schoolAssignments.length > 0) {\r\n          setSelectedSchool(schoolAssignments[0].schoolId);\r\n        }\r\n\r\n      } catch (error) {\r\n        console.error('Erreur lors du chargement des donn√©es enseignant:', error);\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    };\r\n\r\n    if (teacherId) {\r\n      loadTeacherData();\r\n    }\r\n  }, [teacherId]);\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"bg-gradient-to-br from-white to-gray-50 rounded-2xl border-2 border-gray-200 p-8 shadow-lg\">\r\n        <div className=\"animate-pulse space-y-6\">\r\n          <div className=\"h-6 bg-gradient-to-r from-gray-200 to-gray-300 rounded-xl w-1/3\"></div>\r\n          <div className=\"h-12 bg-gradient-to-r from-gray-200 to-gray-300 rounded-xl w-2/3\"></div>\r\n          <div className=\"grid grid-cols-3 gap-4\">\r\n            <div className=\"h-24 bg-gradient-to-br from-gray-200 to-gray-300 rounded-xl\"></div>\r\n            <div className=\"h-24 bg-gradient-to-br from-gray-200 to-gray-300 rounded-xl\"></div>\r\n            <div className=\"h-24 bg-gradient-to-br from-gray-200 to-gray-300 rounded-xl\"></div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (!teacherData || teacherData.totalSchools === 0) {\r\n    return (\r\n      <div className=\"bg-gradient-to-br from-blue-50 to-indigo-50 rounded-2xl border-2 border-blue-200 p-8 text-center shadow-lg\">\r\n        <div className=\"w-16 h-16 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-2xl flex items-center justify-center mx-auto mb-4 shadow-md\">\r\n          <Icon name=\"School\" size={32} className=\"text-white\" />\r\n        </div>\r\n        <h3 className=\"font-heading font-bold text-xl text-gray-900 mb-2\">\r\n          Affectation unique\r\n        </h3>\r\n        <p className=\"text-gray-600\">\r\n          Vous √™tes actuellement affect√© √† un seul √©tablissement\r\n        </p>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  const selectedAssignment = teacherData.assignments.find(a => a.schoolId === selectedSchool);\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      {/* Vue d'ensemble globale - Modernis√©e */}\r\n      <div className=\"bg-gradient-to-br from-purple-50 via-pink-50 to-orange-50 rounded-2xl border-2 border-purple-200 p-6 shadow-xl\">\r\n        <div className=\"flex items-start justify-between mb-6\">\r\n          <div>\r\n            <div className=\"flex items-center gap-3 mb-2\">\r\n              <div className=\"w-12 h-12 bg-gradient-to-br from-purple-500 to-pink-600 rounded-xl flex items-center justify-center shadow-lg\">\r\n                <Icon name=\"Building\" size={24} className=\"text-white\" />\r\n              </div>\r\n              <div>\r\n                <h3 className=\"font-heading font-bold text-2xl text-gray-900\">\r\n                  Multi-√âtablissements\r\n                </h3>\r\n                <p className=\"text-sm text-gray-600\">\r\n                  Votre activit√© r√©partie sur plusieurs √©coles\r\n                </p>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div className=\"text-right bg-white rounded-xl p-4 shadow-md border-2 border-purple-200\">\r\n            <div className=\"text-4xl font-display font-bold bg-gradient-to-r from-purple-600 to-pink-600 bg-clip-text text-transparent\">\r\n              {teacherData.totalSchools}\r\n            </div>\r\n            <div className=\"text-xs text-gray-600 font-medium\">√âtablissement{teacherData.totalSchools > 1 ? 's' : ''}</div>\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\r\n          <div className=\"bg-white/80 backdrop-blur rounded-xl p-5 border-2 border-blue-200 shadow-md hover:shadow-xl transition-all hover:scale-105\">\r\n            <div className=\"flex items-center gap-3 mb-3\">\r\n              <div className=\"p-2.5 rounded-xl bg-gradient-to-br from-blue-500 to-cyan-600 shadow-md\">\r\n                <Icon name=\"Clock\" size={20} className=\"text-white\" />\r\n              </div>\r\n              <span className=\"font-bold text-sm text-gray-700\">Charge totale</span>\r\n            </div>\r\n            <div className=\"text-3xl font-display font-bold bg-gradient-to-r from-blue-600 to-cyan-600 bg-clip-text text-transparent\">\r\n              {teacherData.totalWeeklyHours}<span className=\"text-xl\">h</span>\r\n            </div>\r\n            <div className=\"text-xs text-gray-600 mt-1\">par semaine</div>\r\n          </div>\r\n\r\n          <div className=\"bg-white/80 backdrop-blur rounded-xl p-5 border-2 border-green-200 shadow-md hover:shadow-xl transition-all hover:scale-105\">\r\n            <div className=\"flex items-center gap-3 mb-3\">\r\n              <div className=\"p-2.5 rounded-xl bg-gradient-to-br from-green-500 to-emerald-600 shadow-md\">\r\n                <Icon name=\"Users\" size={20} className=\"text-white\" />\r\n              </div>\r\n              <span className=\"font-bold text-sm text-gray-700\">Total √©l√®ves</span>\r\n            </div>\r\n            <div className=\"text-3xl font-display font-bold bg-gradient-to-r from-green-600 to-emerald-600 bg-clip-text text-transparent\">\r\n              {teacherData.totalStudents}\r\n            </div>\r\n            <div className=\"text-xs text-gray-600 mt-1\">√† encadrer</div>\r\n          </div>\r\n\r\n          <div className=\"bg-white/80 backdrop-blur rounded-xl p-5 border-2 border-orange-200 shadow-md hover:shadow-xl transition-all hover:scale-105\">\r\n            <div className=\"flex items-center gap-3 mb-3\">\r\n              <div className=\"p-2.5 rounded-xl bg-gradient-to-br from-orange-500 to-amber-600 shadow-md\">\r\n                <Icon name=\"TrendingUp\" size={20} className=\"text-white\" />\r\n              </div>\r\n              <span className=\"font-bold text-sm text-gray-700\">Disponibilit√©</span>\r\n            </div>\r\n            <div className={`text-3xl font-display font-bold bg-clip-text text-transparent ${\r\n              teacherData.availableHours > 10 \r\n                ? 'bg-gradient-to-r from-green-600 to-emerald-600' \r\n                : teacherData.availableHours > 5 \r\n                ? 'bg-gradient-to-r from-orange-600 to-amber-600' \r\n                : 'bg-gradient-to-r from-red-600 to-rose-600'\r\n            }`}>\r\n              {teacherData.availableHours}<span className=\"text-xl\">h</span>\r\n            </div>\r\n            <div className=\"text-xs text-gray-600 mt-1\">restantes</div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* S√©lecteur d'√©tablissement - Modernis√© */}\r\n      {teacherData.assignments.length > 1 && (\r\n        <div className=\"bg-white rounded-2xl border-2 border-gray-200 p-6 shadow-lg\">\r\n          <h4 className=\"font-heading font-bold text-lg text-gray-900 mb-4 flex items-center gap-2\">\r\n            <Icon name=\"MapPin\" size={20} className=\"text-indigo-600\" />\r\n            S√©lectionner un √©tablissement\r\n          </h4>\r\n          <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\">\r\n            {teacherData.assignments.map((assignment) => (\r\n              <button\r\n                key={assignment.schoolId}\r\n                onClick={() => setSelectedSchool(assignment.schoolId)}\r\n                className={`group text-left p-4 rounded-xl border-2 transition-all shadow-md hover:shadow-xl hover:scale-105 ${\r\n                  selectedSchool === assignment.schoolId\r\n                    ? 'border-indigo-500 bg-gradient-to-br from-indigo-50 to-purple-50 shadow-indigo-200'\r\n                    : 'border-gray-200 bg-white hover:border-indigo-300'\r\n                }`}\r\n              >\r\n                <div className=\"flex items-center justify-between mb-3\">\r\n                  <div className=\"flex items-center gap-2\">\r\n                    <div className={`w-10 h-10 rounded-lg flex items-center justify-center shadow-md ${\r\n                      selectedSchool === assignment.schoolId\r\n                        ? 'bg-gradient-to-br from-indigo-500 to-purple-600'\r\n                        : 'bg-gradient-to-br from-gray-400 to-gray-500'\r\n                    }`}>\r\n                      <Icon name=\"School\" size={20} className=\"text-white\" />\r\n                    </div>\r\n                    <h5 className=\"font-bold text-sm text-gray-900 group-hover:text-indigo-600 transition-colors\">\r\n                      {assignment.school?.name || '√âcole'}\r\n                    </h5>\r\n                  </div>\r\n                  {assignment.assignmentType === 'principal' && (\r\n                    <span className=\"bg-gradient-to-r from-yellow-400 to-orange-500 text-white text-xs px-2.5 py-1 rounded-full font-bold shadow-md\">\r\n                      Principal\r\n                    </span>\r\n                  )}\r\n                </div>\r\n                <div className=\"space-y-2\">\r\n                  <div className=\"flex items-center gap-2 text-xs\">\r\n                    <Icon name=\"BookOpen\" size={14} className=\"text-indigo-600\" />\r\n                    <span className=\"text-gray-700 font-medium\">\r\n                      {assignment.classes.length} classe{assignment.classes.length > 1 ? 's' : ''}\r\n                    </span>\r\n                  </div>\r\n                  <div className=\"flex items-center gap-2 text-xs\">\r\n                    <Icon name=\"Clock\" size={14} className=\"text-blue-600\" />\r\n                    <span className=\"text-gray-700 font-medium\">{assignment.weeklyHours}h/semaine</span>\r\n                  </div>\r\n                </div>\r\n              </button>\r\n            ))}\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* D√©tails de l'√©tablissement s√©lectionn√© - Modernis√© */}\r\n      {selectedAssignment && (\r\n        <div className=\"bg-white rounded-2xl border-2 border-gray-200 overflow-hidden shadow-xl\">\r\n          <div className=\"bg-gradient-to-r from-indigo-500 to-purple-600 p-6 text-white\">\r\n            <div className=\"flex items-center justify-between\">\r\n              <div>\r\n                <h4 className=\"font-heading font-bold text-2xl mb-2 flex items-center gap-2\">\r\n                  <Icon name=\"School\" size={28} />\r\n                  {selectedAssignment.school?.name || '√âcole'}\r\n                </h4>\r\n                <p className=\"text-indigo-100 text-sm\">\r\n                  {selectedAssignment.position}\r\n                </p>\r\n              </div>\r\n              <div className=\"text-right bg-white/20 backdrop-blur rounded-xl p-4 border border-white/30\">\r\n                <div className=\"text-3xl font-display font-bold\">{selectedAssignment.weeklyHours}h</div>\r\n                <div className=\"text-xs text-indigo-100\">par semaine</div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"p-6 space-y-6\">\r\n            {/* Mati√®res enseign√©es */}\r\n            <div>\r\n              <h5 className=\"font-bold text-base text-gray-900 mb-3 flex items-center gap-2\">\r\n                <Icon name=\"BookOpen\" size={18} className=\"text-indigo-600\" />\r\n                Mati√®res enseign√©es\r\n              </h5>\r\n              <div className=\"flex flex-wrap gap-2\">\r\n                {selectedAssignment.subjects.map((subject, index) => (\r\n                  <span \r\n                    key={index}\r\n                    className=\"bg-gradient-to-r from-indigo-500 to-purple-600 text-white text-sm px-4 py-2 rounded-full font-medium shadow-md hover:shadow-lg transition-all hover:scale-105\"\r\n                  >\r\n                    {subject}\r\n                  </span>\r\n                ))}\r\n              </div>\r\n            </div>\r\n\r\n            {/* Classes assign√©es */}\r\n            <div>\r\n              <h5 className=\"font-bold text-base text-gray-900 mb-3 flex items-center gap-2\">\r\n                <Icon name=\"Users\" size={18} className=\"text-green-600\" />\r\n                Classes assign√©es ({selectedAssignment.assignedClasses.length})\r\n              </h5>\r\n              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-3\">\r\n                {selectedAssignment.assignedClasses.map((classInfo, index) => (\r\n                  <div key={index} className=\"group bg-gradient-to-br from-gray-50 to-white rounded-xl p-4 border-2 border-gray-200 shadow-md hover:shadow-xl hover:border-green-300 transition-all hover:scale-105\">\r\n                    <div className=\"flex items-center justify-between\">\r\n                      <div>\r\n                        <h6 className=\"font-bold text-sm text-gray-900 mb-1\">{classInfo.name}</h6>\r\n                        <div className=\"flex items-center gap-3 text-xs\">\r\n                          <span className=\"flex items-center gap-1 text-gray-600\">\r\n                            <Icon name=\"Users\" size={12} className=\"text-green-600\" />\r\n                            {classInfo.studentsCount} √©l√®ve{classInfo.studentsCount > 1 ? 's' : ''}\r\n                          </span>\r\n                          {classInfo.weeklyHours > 0 && (\r\n                            <span className=\"flex items-center gap-1 text-gray-600\">\r\n                              <Icon name=\"Clock\" size={12} className=\"text-blue-600\" />\r\n                              {classInfo.weeklyHours}h/sem\r\n                            </span>\r\n                          )}\r\n                        </div>\r\n                      </div>\r\n                      <div className=\"w-10 h-10 rounded-lg bg-gradient-to-br from-green-500 to-emerald-600 flex items-center justify-center shadow-md group-hover:scale-110 transition-transform\">\r\n                        <Icon name=\"GraduationCap\" size={20} className=\"text-white\" />\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                ))}\r\n              </div>\r\n            </div>\r\n\r\n            {/* R√©sum√© de l'assignation */}\r\n            <div className=\"bg-gradient-to-br from-green-50 to-emerald-50 border-2 border-green-200 rounded-xl p-5 shadow-md\">\r\n              <div className=\"flex items-center gap-2 mb-4\">\r\n                <div className=\"w-8 h-8 rounded-lg bg-gradient-to-br from-green-500 to-emerald-600 flex items-center justify-center shadow-md\">\r\n                  <Icon name=\"CheckCircle\" size={18} className=\"text-white\" />\r\n                </div>\r\n                <span className=\"font-bold text-base text-gray-900\">R√©sum√© de l'assignation</span>\r\n              </div>\r\n              <div className=\"grid grid-cols-2 gap-4 text-sm\">\r\n                <div className=\"bg-white rounded-lg p-3 shadow-sm\">\r\n                  <span className=\"text-gray-600 text-xs block mb-1\">D√©but</span>\r\n                  <span className=\"text-gray-900 font-bold\">\r\n                    {new Date(selectedAssignment.startDate).toLocaleDateString('fr-FR')}\r\n                  </span>\r\n                </div>\r\n                <div className=\"bg-white rounded-lg p-3 shadow-sm\">\r\n                  <span className=\"text-gray-600 text-xs block mb-1\">Fin</span>\r\n                  <span className=\"text-gray-900 font-bold\">\r\n                    {new Date(selectedAssignment.endDate).toLocaleDateString('fr-FR')}\r\n                  </span>\r\n                </div>\r\n                <div className=\"bg-white rounded-lg p-3 shadow-sm\">\r\n                  <span className=\"text-gray-600 text-xs block mb-1\">Type</span>\r\n                  <span className=\"text-gray-900 font-bold capitalize\">\r\n                    {selectedAssignment.assignmentType}\r\n                  </span>\r\n                </div>\r\n                <div className=\"bg-white rounded-lg p-3 shadow-sm\">\r\n                  <span className=\"text-gray-600 text-xs block mb-1\">Statut</span>\r\n                  <span className=\"flex items-center gap-1\">\r\n                    <span className={`w-2 h-2 rounded-full ${selectedAssignment.isActive ? 'bg-green-500' : 'bg-gray-400'}`}></span>\r\n                    <span className={`font-bold ${selectedAssignment.isActive ? 'text-green-600' : 'text-gray-600'}`}>\r\n                      {selectedAssignment.isActive ? 'Actif' : 'Inactif'}\r\n                    </span>\r\n                  </span>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Indicateur de charge de travail - Modernis√© */}\r\n      <div className=\"bg-white rounded-2xl border-2 border-gray-200 p-6 shadow-lg\">\r\n        <div className=\"flex items-center justify-between mb-4\">\r\n          <h5 className=\"font-bold text-base text-gray-900 flex items-center gap-2\">\r\n            <Icon name=\"Activity\" size={20} className=\"text-blue-600\" />\r\n            Charge de travail globale\r\n          </h5>\r\n          <span className={`text-xs font-bold px-3 py-1.5 rounded-full shadow-md ${\r\n            teacherData.totalWeeklyHours > 30 \r\n              ? 'bg-gradient-to-r from-red-500 to-rose-600 text-white' :\r\n            teacherData.totalWeeklyHours > 20 \r\n              ? 'bg-gradient-to-r from-orange-500 to-amber-600 text-white' :\r\n            'bg-gradient-to-r from-green-500 to-emerald-600 text-white'\r\n          }`}>\r\n            {teacherData.totalWeeklyHours > 30 ? '‚ö†Ô∏è √âlev√©e' :\r\n             teacherData.totalWeeklyHours > 20 ? '‚ö° Mod√©r√©e' : '‚úÖ L√©g√®re'}\r\n          </span>\r\n        </div>\r\n        \r\n        <div className=\"space-y-4\">\r\n          <div className=\"flex justify-between text-sm\">\r\n            <span className=\"text-gray-600 font-medium\">Heures enseign√©es</span>\r\n            <span className=\"font-bold text-gray-900\">\r\n              {teacherData.totalWeeklyHours}h <span className=\"text-gray-400\">/</span> 40h\r\n            </span>\r\n          </div>\r\n          \r\n          <div className=\"relative\">\r\n            <div className=\"w-full bg-gray-200 rounded-full h-4 overflow-hidden shadow-inner\">\r\n              <div \r\n                className={`h-4 rounded-full transition-all duration-500 shadow-md ${\r\n                  teacherData.totalWeeklyHours > 30 \r\n                    ? 'bg-gradient-to-r from-red-500 to-rose-600' :\r\n                  teacherData.totalWeeklyHours > 20 \r\n                    ? 'bg-gradient-to-r from-orange-500 to-amber-600' \r\n                    : 'bg-gradient-to-r from-green-500 to-emerald-600'\r\n                }`}\r\n                style={{ width: `${Math.min((teacherData.totalWeeklyHours / 40) * 100, 100)}%` }}\r\n              />\r\n            </div>\r\n            <div className=\"flex justify-between mt-2 text-xs text-gray-500 font-medium\">\r\n              <span>0h</span>\r\n              <span>20h</span>\r\n              <span>40h (max)</span>\r\n            </div>\r\n          </div>\r\n\r\n          {teacherData.totalWeeklyHours > 35 && (\r\n            <div className=\"bg-red-50 border-2 border-red-200 rounded-lg p-3 flex items-start gap-2\">\r\n              <Icon name=\"AlertTriangle\" size={16} className=\"text-red-600 mt-0.5\" />\r\n              <p className=\"text-xs text-red-700\">\r\n                <strong>Attention :</strong> Votre charge de travail d√©passe le maximum recommand√©. \r\n                Pensez √† prendre du repos !\r\n              </p>\r\n            </div>\r\n          )}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default TeacherMultiSchoolOverview;","import React, { useState, useEffect } from 'react';\r\nimport { Link, useSearchParams } from 'react-router-dom';\r\nimport Header from '../../components/ui/Header';\r\nimport Sidebar from '../../components/ui/Sidebar';\r\nimport Icon from '../../components/AppIcon';\r\nimport { supabase } from '../../lib/supabase';\r\nimport { useAuth } from '../../contexts/AuthContext';\r\nimport { RESPONSIVE_CLASSES } from '../../utils/responsive';\r\nimport ResponsiveGrid, { MetricCard } from '../../components/ui/ResponsiveGrid';\r\n\r\nimport ClassSelector from './components/ClassSelector';\r\nimport AssignedClassesOverview from './components/AssignedClassesOverview';\r\nimport GradeEntryPanel from './components/GradeEntryPanel';\r\nimport GradesSummaryPanel from './components/GradesSummaryPanel';\r\nimport ConductPanel from './components/ConductPanel';\r\nimport ReportCard from './components/ReportCard';\r\nimport DocumentManager from './components/DocumentManager';\r\nimport AttendanceManager from './components/AttendanceManager';\r\nimport StudentCommunication from './components/StudentCommunication';\r\nimport TeacherSchedule from './components/TeacherSchedule';\r\nimport TeacherMultiSchoolOverview from './components/TeacherMultiSchoolOverview';\r\n\r\nconst TeacherDashboard = () => {\r\n  const [searchParams] = useSearchParams();\r\n  const currentTab = searchParams.get('tab') || 'dashboard';\r\n  const [sidebarCollapsed, setSidebarCollapsed] = useState(false);\r\n  const [selectedClass, setSelectedClass] = useState(null);\r\n  const [selectedSubject, setSelectedSubject] = useState(null);\r\n  const [gradesSubTab, setGradesSubTab] = useState('entry'); // 'entry' | 'summary' | 'conduct' | 'bulletin'\r\n  const [showReportCard, setShowReportCard] = useState(null); // student object or null\r\n  const [currentTime, setCurrentTime] = useState(new Date());\r\n  const [viewMode, setViewMode] = useState('single'); // 'single' ou 'multi-school'\r\n\r\n  // R√©cup√©rer l'utilisateur connect√©\r\n  const { user } = useAuth();\r\n\r\n  // √âtats pour les donn√©es r√©elles\r\n  const [teacherData, setTeacherData] = useState(null);\r\n  const [loading, setLoading] = useState(true);\r\n  const [studentsData, setStudentsData] = useState({});\r\n  const [documentsData, setDocumentsData] = useState({});\r\n  const [upcomingSchedule, setUpcomingSchedule] = useState([]);\r\n  \r\n  console.log('üè´ TeacherDashboard RENDER:', {\r\n    hasUser: !!user,\r\n    userId: user?.id,\r\n    userEmail: user?.email,\r\n    teacherDataName: teacherData?.name,\r\n    classesInTeacherData: teacherData?.assignedClasses?.map(c => c.name)\r\n  });\r\n\r\n  // Helper function pour obtenir la date du prochain jour de la semaine\r\n  const getCurrentDateForDay = (dayName) => {\r\n    const daysOfWeek = ['Dimanche', 'Lundi', 'Mardi', 'Mercredi', 'Jeudi', 'Vendredi', 'Samedi'];\r\n    const targetDay = daysOfWeek.indexOf(dayName);\r\n    \r\n    if (targetDay === -1) {\r\n      return new Date().toISOString().split('T')[0]; // Fallback sur aujourd'hui\r\n    }\r\n    \r\n    const today = new Date();\r\n    const currentDay = today.getDay();\r\n    const daysUntilTarget = (targetDay - currentDay + 7) % 7 || 7; // Si c'est aujourd'hui, prendre la semaine prochaine\r\n    \r\n    const targetDate = new Date(today);\r\n    targetDate.setDate(today.getDate() + daysUntilTarget);\r\n    \r\n    return targetDate.toISOString().split('T')[0]; // Format YYYY-MM-DD\r\n  };\r\n\r\n  // Charger les donn√©es r√©elles depuis Supabase\r\n  useEffect(() => {\r\n    const loadTeacherData = async () => {\r\n      console.log('üîç TeacherDashboard - Chargement des donn√©es...');\r\n      console.log('  - user:', user);\r\n\r\n      if (!user || !user.id) {\r\n        console.log('‚ö†Ô∏è Pas d\\'utilisateur connect√©');\r\n        setLoading(false);\r\n        return;\r\n      }\r\n\r\n      try {\r\n        console.log('‚úÖ Chargement des donn√©es r√©elles...');\r\n        console.log('  - User ID:', user.id);\r\n        console.log('  - School ID:', user.current_school_id);\r\n        \r\n        setLoading(true);\r\n\r\n        // 1. R√©cup√©rer les infos de l'enseignant depuis la table teachers\r\n        const { data: teacherInfo, error: teacherError } = await supabase\r\n          .from('teachers')\r\n          .select(`\r\n            id,\r\n            user_id,\r\n            first_name,\r\n            last_name,\r\n            specialty,\r\n            hire_date,\r\n            is_active,\r\n            users!teachers_user_id_fkey (\r\n              id,\r\n              email,\r\n              full_name,\r\n              phone,\r\n              current_school_id\r\n            ),\r\n            schools!teachers_school_id_fkey (\r\n              id,\r\n              name,\r\n              code\r\n            )\r\n          `)\r\n          .eq('user_id', user.id)\r\n          .eq('is_active', true)\r\n          .single();\r\n\r\n        if (teacherError) {\r\n          console.error('‚ùå Erreur chargement enseignant:', teacherError);\r\n          throw teacherError;\r\n        }\r\n\r\n        console.log('‚úÖ Infos enseignant charg√©es:', teacherInfo);\r\n\r\n        // 2. R√©cup√©rer l'ann√©e acad√©mique actuelle\r\n        const { data: academicYear, error: academicYearError } = await supabase\r\n          .from('academic_years')\r\n          .select('id, name, start_date, end_date')\r\n          .eq('school_id', teacherInfo.school_id)\r\n          .eq('is_current', true)\r\n          .single();\r\n        \r\n        if (academicYearError) {\r\n          console.warn('‚ö†Ô∏è Ann√©e acad√©mique non trouv√©e:', academicYearError);\r\n        } else {\r\n          console.log('‚úÖ Ann√©e acad√©mique actuelle:', academicYear);\r\n        }\r\n\r\n        // 3. R√©cup√©rer les assignations (classes assign√©es)\r\n        const { data: assignments, error: assignmentsError } = await supabase\r\n          .from('teacher_assignments')\r\n          .select(`\r\n            id,\r\n            class_id,\r\n            subject_id,\r\n            class_name,\r\n            subject_name,\r\n            school_id,\r\n            schedule,\r\n            is_active,\r\n            classes!teacher_assignments_class_id_fkey (\r\n              id,\r\n              name,\r\n              level,\r\n              section\r\n            ),\r\n            subjects!teacher_assignments_subject_id_fkey (\r\n              id,\r\n              name,\r\n              code\r\n            ),\r\n            schools!teacher_assignments_school_id_fkey (\r\n              id,\r\n              name\r\n            )\r\n          `)\r\n          .eq('teacher_id', teacherInfo.id)\r\n          .eq('is_active', true);\r\n\r\n        if (assignmentsError) {\r\n          console.error('‚ùå Erreur chargement assignations:', assignmentsError);\r\n          throw assignmentsError;\r\n        }\r\n\r\n        console.log('‚úÖ Assignations charg√©es:', assignments?.length || 0);\r\n\r\n        // 3. Pour chaque classe, r√©cup√©rer les √©l√®ves avec leurs notes et pr√©sences\r\n        const studentsDataByClass = {};\r\n        \r\n        if (assignments && assignments.length > 0) {\r\n          for (const assignment of assignments) {\r\n            const classId = assignment.class_id;\r\n            const className = assignment.class_name;\r\n            const schoolId = assignment.school_id;\r\n            \r\n            let students = [];\r\n            \r\n            // Si on a un class_id, on l'utilise\r\n            if (classId) {\r\n              const { data, error: studentsError } = await supabase\r\n                .from('students')\r\n                .select(`\r\n                  id,\r\n                  matricule,\r\n                  user_id,\r\n                  class_id,\r\n                  users!students_user_id_fkey (\r\n                    id,\r\n                    full_name,\r\n                    email,\r\n                    phone\r\n                  )\r\n                `)\r\n                .eq('class_id', classId)\r\n                .eq('is_active', true);\r\n\r\n              if (studentsError) {\r\n                console.error('Erreur chargement √©l√®ves par class_id:', studentsError);\r\n              } else {\r\n                students = data || [];\r\n              }\r\n            }\r\n            // Sinon, on utilise class_name + school_id\r\n            else if (className && schoolId) {\r\n              console.log(`üîç Recherche √©l√®ves pour classe: ${className}, √©cole: ${schoolId}`);\r\n              \r\n              const { data, error: studentsError } = await supabase\r\n                .from('students')\r\n                .select(`\r\n                  id,\r\n                  matricule,\r\n                  user_id,\r\n                  class_name,\r\n                  current_class,\r\n                  school_id,\r\n                  users!students_user_id_fkey (\r\n                    id,\r\n                    full_name,\r\n                    email,\r\n                    phone\r\n                  )\r\n                `)\r\n                .eq('school_id', schoolId)\r\n                .eq('is_active', true);\r\n\r\n              if (studentsError) {\r\n                console.error('‚ùå Erreur chargement √©l√®ves par class_name:', studentsError);\r\n              } else {\r\n                // Filtrer c√¥t√© client pour g√©rer class_name OU current_class\r\n                const filteredStudents = (data || []).filter(student => \r\n                  student.class_name === className || student.current_class === className\r\n                );\r\n                students = filteredStudents;\r\n                console.log(`‚úÖ ${students.length} √©l√®ve(s) trouv√©(s) pour \"${className}\" sur ${data?.length || 0} √©l√®ves de l'√©cole`);\r\n              }\r\n            }\r\n            // Si ni class_id ni class_name, on ne peut pas charger les √©l√®ves\r\n            else {\r\n              console.log('‚ÑπÔ∏è Assignation sans class_id ni class_name:', assignment);\r\n              studentsDataByClass[assignment.id] = [];\r\n              continue;\r\n            }\r\n\r\n            // Pour chaque √©l√®ve, r√©cup√©rer les notes r√©centes\r\n            const studentIds = students?.map(s => s.id) || [];\r\n            \r\n            const { data: grades, error: gradesError } = await supabase\r\n              .from('grades')\r\n              .select('student_id, grade, evaluation_type, created_at, subject_name')\r\n              .in('student_id', studentIds)\r\n              .order('created_at', { ascending: false })\r\n              .limit(100);\r\n\r\n            if (gradesError) {\r\n              console.warn('Erreur chargement notes:', gradesError);\r\n            }\r\n\r\n            // R√©cup√©rer les pr√©sences\r\n            const { data: attendances, error: attendancesError } = await supabase\r\n              .from('attendances')\r\n              .select('student_id, status')\r\n              .in('student_id', studentIds);\r\n\r\n            if (attendancesError) {\r\n              console.warn('Erreur chargement pr√©sences:', attendancesError);\r\n            }\r\n\r\n            // Cr√©er des maps pour acc√®s rapide\r\n            const gradesByStudent = new Map();\r\n            (grades || []).forEach(grade => {\r\n              if (!gradesByStudent.has(grade.student_id)) {\r\n                gradesByStudent.set(grade.student_id, []);\r\n              }\r\n              gradesByStudent.get(grade.student_id).push(grade);\r\n            });\r\n\r\n            const attendancesByStudent = new Map();\r\n            (attendances || []).forEach(att => {\r\n              if (!attendancesByStudent.has(att.student_id)) {\r\n                attendancesByStudent.set(att.student_id, { present: 0, absent: 0, late: 0 });\r\n              }\r\n              const stats = attendancesByStudent.get(att.student_id);\r\n              if (att.status === 'present') stats.present++;\r\n              else if (att.status === 'absent') stats.absent++;\r\n              else if (att.status === 'late') stats.late++;\r\n            });\r\n\r\n            // Formatter les donn√©es des √©l√®ves\r\n            if (students) {\r\n              studentsDataByClass[assignment.id] = students.map(student => {\r\n                const studentGrades = gradesByStudent.get(student.id) || [];\r\n                const studentAttendance = attendancesByStudent.get(student.id) || { present: 0, absent: 0, late: 0 };\r\n                \r\n                return {\r\n                  id: student.id,\r\n                  name: student.users?.full_name || '√âl√®ve',\r\n                  matricule: student.matricule,\r\n                  email: student.users?.email,\r\n                  phone: student.users?.phone,\r\n                  recentGrades: studentGrades.slice(0, 5).map(g => ({\r\n                    subject: g.subject_name || assignment.subject_name,\r\n                    grade: g.grade,\r\n                    date: new Date(g.created_at).toLocaleDateString('fr-FR'),\r\n                    type: g.evaluation_type || '√âvaluation'\r\n                  })),\r\n                  attendance: studentAttendance\r\n                };\r\n              });\r\n            }\r\n          }\r\n        }\r\n\r\n        console.log('‚úÖ √âl√®ves charg√©s pour', Object.keys(studentsDataByClass).length, 'assignations');\r\n\r\n        // 4. Formatter les donn√©es pour correspondre au format attendu\r\n        const formattedTeacherData = {\r\n          id: teacherInfo.id,\r\n          name: teacherInfo.users?.full_name || `${teacherInfo.first_name} ${teacherInfo.last_name}`,\r\n          email: teacherInfo.users?.email,\r\n          phone: teacherInfo.users?.phone,\r\n          specialty: teacherInfo.specialty,\r\n          school: teacherInfo.schools?.name || '√âtablissement non renseign√©',\r\n          employeeId: `ENS-${teacherInfo.id.substring(0, 8)}`,\r\n          assignedClasses: (assignments || []).map(assignment => {\r\n            const students = studentsDataByClass[assignment.id] || [];\r\n            \r\n            // Calculer la moyenne de la classe\r\n            let classAverage = null;\r\n            if (students.length > 0) {\r\n              const studentsWithGrades = students.filter(s => s.recentGrades && s.recentGrades.length > 0);\r\n              if (studentsWithGrades.length > 0) {\r\n                const totalAvg = studentsWithGrades.reduce((sum, student) => {\r\n                  const studentAvg = student.recentGrades.reduce((s, g) => s + g.grade, 0) / student.recentGrades.length;\r\n                  return sum + studentAvg;\r\n                }, 0);\r\n                classAverage = totalAvg / studentsWithGrades.length;\r\n              }\r\n            }\r\n            \r\n            // Calculer le taux de pr√©sence\r\n            let attendanceRate = null;\r\n            if (students.length > 0) {\r\n              const totalPresent = students.reduce((sum, s) => sum + (s.attendance?.present || 0), 0);\r\n              const totalAbsent = students.reduce((sum, s) => sum + (s.attendance?.absent || 0), 0);\r\n              const totalLate = students.reduce((sum, s) => sum + (s.attendance?.late || 0), 0);\r\n              const total = totalPresent + totalAbsent + totalLate;\r\n              if (total > 0) {\r\n                attendanceRate = Math.round((totalPresent / total) * 100);\r\n              }\r\n            }\r\n            \r\n            return {\r\n              id: assignment.id,\r\n              name: assignment.class_name || assignment.classes?.name || 'Classe',\r\n              level: assignment.classes?.level || assignment.class_name || 'Non d√©fini',\r\n              section: assignment.classes?.section || '',\r\n              school: assignment.schools?.name || teacherInfo.schools?.name || '√âcole',\r\n              subject: assignment.subject_name || assignment.subjects?.name || 'Mati√®re',\r\n              students: students.length,\r\n              schedule: assignment.schedule || { weekly_hours: 0 },\r\n              average: classAverage,\r\n              attendanceRate: attendanceRate,\r\n              // IDs n√©cessaires pour l'enregistrement des notes\r\n              school_id: assignment.school_id || teacherInfo.school_id,\r\n              subject_id: assignment.subject_id,\r\n              class_id: assignment.class_id,\r\n              teacher_id: teacherInfo.id,\r\n              academic_year_id: academicYear?.id || null\r\n            };\r\n          })\r\n        };\r\n\r\n        console.log('‚úÖ Donn√©es format√©es:', formattedTeacherData);\r\n\r\n        // 5. G√©n√©rer l'emploi du temps √† partir des assignations\r\n        const scheduleData = [];\r\n        if (assignments && assignments.length > 0) {\r\n          assignments.forEach(assignment => {\r\n            if (assignment.schedule && Array.isArray(assignment.schedule)) {\r\n              assignment.schedule.forEach(slot => {\r\n                scheduleData.push({\r\n                  id: `schedule-${assignment.id}-${slot.day}`,\r\n                  className: assignment.class_name || assignment.classes?.name,\r\n                  subject: assignment.subject_name || assignment.subjects?.name,\r\n                  day: slot.day,\r\n                  time: slot.time,\r\n                  room: slot.room,\r\n                  date: getCurrentDateForDay(slot.day), // Fonction helper pour obtenir la prochaine occurrence du jour\r\n                  type: 'course'\r\n                });\r\n              });\r\n            }\r\n          });\r\n        }\r\n        console.log('‚úÖ Emploi du temps g√©n√©r√©:', scheduleData.length, 'cr√©neaux');\r\n\r\n        // 6. Charger les documents de l'enseignant depuis la base de donn√©es\r\n        // Note: uploaded_by contient l'ID de la table users (pas auth.users)\r\n        // Pour les utilisateurs Supabase Auth classiques, user.id = users.id\r\n        // Mais on recherche aussi par school_id pour √™tre s√ªr de r√©cup√©rer tous les documents\r\n        const documentsDataByClass = {};\r\n        try {\r\n          // R√©cup√©rer d'abord l'ID utilisateur depuis la table users\r\n          const { data: dbUserData } = await supabase\r\n            .from('users')\r\n            .select('id')\r\n            .eq('email', user.email)\r\n            .single();\r\n          \r\n          const dbUserId = dbUserData?.id || user.id;\r\n          console.log('üìÑ Chargement documents pour user ID:', dbUserId);\r\n          \r\n          const { data: teacherDocs, error: docsError } = await supabase\r\n            .from('documents')\r\n            .select('*')\r\n            .eq('uploaded_by', dbUserId)\r\n            .order('created_at', { ascending: false });\r\n\r\n          if (docsError) {\r\n            console.warn('‚ö†Ô∏è Erreur chargement documents:', docsError);\r\n          } else if (teacherDocs && teacherDocs.length > 0) {\r\n            console.log('‚úÖ Documents charg√©s:', teacherDocs.length);\r\n            \r\n            // Organiser les documents par classe (class_name)\r\n            teacherDocs.forEach(doc => {\r\n              const classKey = doc.class_name || 'general';\r\n              if (!documentsDataByClass[classKey]) {\r\n                documentsDataByClass[classKey] = [];\r\n              }\r\n              documentsDataByClass[classKey].push({\r\n                id: doc.id,\r\n                title: doc.title,\r\n                type: doc.document_type,\r\n                document_type: doc.document_type, // Double mapping pour compatibilit√©\r\n                file_name: doc.file_name,\r\n                file_path: doc.file_path,\r\n                file_size: doc.file_size,\r\n                mime_type: doc.mime_type,\r\n                visibility: doc.visibility,\r\n                is_public: doc.is_public,\r\n                created_at: doc.created_at, // Date de cr√©ation\r\n                uploadedAt: doc.created_at,\r\n                class_name: doc.class_name\r\n              });\r\n            });\r\n            \r\n            // Aussi indexer par class_id si disponible dans les assignations\r\n            if (assignments && assignments.length > 0) {\r\n              assignments.forEach(assignment => {\r\n                const className = assignment.class_name || assignment.classes?.name;\r\n                if (className && documentsDataByClass[className]) {\r\n                  // Copier aussi sous l'ID de la classe pour compatibilit√©\r\n                  documentsDataByClass[assignment.class_id] = documentsDataByClass[className];\r\n                }\r\n              });\r\n            }\r\n          }\r\n        } catch (docErr) {\r\n          console.warn('‚ö†Ô∏è Erreur lors du chargement des documents:', docErr);\r\n        }\r\n        console.log('‚úÖ Documents organis√©s par classe:', Object.keys(documentsDataByClass));\r\n\r\n        setTeacherData(formattedTeacherData);\r\n        setStudentsData(studentsDataByClass);\r\n        setDocumentsData(documentsDataByClass);\r\n        setUpcomingSchedule(scheduleData);\r\n        \r\n        console.log('üéØ DONN√âES R√âELLES D√âFINIES:');\r\n        console.log('  - Nombre de classes:', formattedTeacherData.assignedClasses?.length);\r\n        console.log('  - Classes:', formattedTeacherData.assignedClasses?.map(c => c.name));\r\n        console.log('  - Nom enseignant:', formattedTeacherData.name);\r\n\r\n      } catch (error) {\r\n        console.error('‚ùå Erreur chargement donn√©es enseignant:', error);\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    };\r\n\r\n    loadTeacherData();\r\n  }, [user]);\r\n\r\n  useEffect(() => {\r\n    const timer = setInterval(() => {\r\n      setCurrentTime(new Date());\r\n    }, 1000);\r\n\r\n    return () => clearInterval(timer);\r\n  }, []);\r\n\r\n  // NE PAS s√©lectionner automatiquement une classe\r\n  // L'utilisateur doit choisir manuellement\r\n  /*\r\n  useEffect(() => {\r\n    // Set first class as selected by default\r\n    if (teacherData?.assignedClasses?.length > 0 && !selectedClass) {\r\n      setSelectedClass(teacherData?.assignedClasses?.[0]);\r\n      setSelectedSubject(teacherData?.assignedClasses?.[0]?.subject);\r\n    }\r\n  }, [teacherData]);\r\n  */\r\n\r\n  const handleClassSelect = (classData) => {\r\n    console.log('üìå Classe s√©lectionn√©e:', classData);\r\n    setSelectedClass(classData);\r\n    setSelectedSubject(classData?.subject);\r\n  };\r\n\r\n  const getGreeting = () => {\r\n    const hour = currentTime?.getHours();\r\n    if (hour < 12) return \"Bonjour\";\r\n    if (hour < 18) return \"Bon apr√®s-midi\";  \r\n    return \"Bonsoir\";\r\n  };\r\n\r\n  const getTotalStudents = () => {\r\n    return teacherData?.assignedClasses?.reduce((total, cls) => total + cls?.students, 0);\r\n  };\r\n\r\n  const getCurrentWeekSchedule = () => {\r\n    const today = new Date();\r\n    const startOfWeek = new Date(today);\r\n    startOfWeek?.setDate(today?.getDate() - today?.getDay() + 1); // Monday\r\n    \r\n    return upcomingSchedule?.filter(schedule => {\r\n      const scheduleDate = new Date(schedule?.date);\r\n      const diffTime = scheduleDate - startOfWeek;\r\n      const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));\r\n      return diffDays >= 0 && diffDays < 7;\r\n    });\r\n  };\r\n\r\n  const renderTabContent = () => {\r\n    console.log('üñºÔ∏è RENDER TAB - teacherData:', {\r\n      hasData: !!teacherData,\r\n      name: teacherData?.name,\r\n      classCount: teacherData?.assignedClasses?.length,\r\n      classes: teacherData?.assignedClasses\r\n    });\r\n    \r\n    switch (currentTab) {\r\n      case 'classes':\r\n        return (\r\n          <div className=\"space-y-6\">\r\n            <h2 className=\"font-heading font-heading-bold text-2xl text-card-foreground\">Mes Classes</h2>\r\n            {teacherData?.assignedClasses && teacherData?.assignedClasses?.length > 0 ? (\r\n              <>\r\n                <ClassSelector\r\n                  classes={teacherData?.assignedClasses}\r\n                  selectedClass={selectedClass}\r\n                  onClassSelect={handleClassSelect}\r\n                />\r\n                {selectedClass && (\r\n                  <AssignedClassesOverview \r\n                    classes={teacherData?.assignedClasses}\r\n                    selectedClass={selectedClass}\r\n                  />\r\n                )}\r\n              </>\r\n            ) : (\r\n              <div className=\"bg-card rounded-lg border border-border p-8 text-center\">\r\n                <Icon name=\"GraduationCap\" size={48} className=\"mx-auto text-muted-foreground mb-4\" />\r\n                <p className=\"text-text-secondary\">Aucune classe assign√©e pour le moment</p>\r\n                <p className=\"text-sm text-muted-foreground mt-2\">Contactez votre directeur pour obtenir vos affectations</p>\r\n              </div>\r\n            )}\r\n          </div>\r\n        );\r\n\r\n      case 'grades':\r\n        return (\r\n          <div className=\"space-y-6\">\r\n            <h2 className=\"font-heading font-heading-bold text-2xl text-card-foreground\">Gestion des Notes</h2>\r\n            {teacherData?.assignedClasses && teacherData?.assignedClasses?.length > 0 ? (\r\n              selectedClass ? (\r\n                <div>\r\n                  {/* Sous-onglets Notes */}\r\n                  <div className=\"flex items-center gap-2 mb-4 flex-wrap\">\r\n                    <button\r\n                      onClick={() => setGradesSubTab('entry')}\r\n                      className={`px-4 py-2 rounded-md flex items-center gap-2 ${gradesSubTab === 'entry' ? 'bg-indigo-600 text-white' : 'bg-white border border-border hover:bg-gray-50'}`}\r\n                    >\r\n                      <Icon name=\"Edit3\" size={16} />\r\n                      Saisie\r\n                    </button>\r\n                    <button\r\n                      onClick={() => setGradesSubTab('summary')}\r\n                      className={`px-4 py-2 rounded-md flex items-center gap-2 ${gradesSubTab === 'summary' ? 'bg-indigo-600 text-white' : 'bg-white border border-border hover:bg-gray-50'}`}\r\n                    >\r\n                      <Icon name=\"BarChart2\" size={16} />\r\n                      Synth√®se\r\n                    </button>\r\n                    <button\r\n                      onClick={() => setGradesSubTab('conduct')}\r\n                      className={`px-4 py-2 rounded-md flex items-center gap-2 ${gradesSubTab === 'conduct' ? 'bg-indigo-600 text-white' : 'bg-white border border-border hover:bg-gray-50'}`}\r\n                    >\r\n                      <Icon name=\"UserCheck\" size={16} />\r\n                      Vie Scolaire\r\n                    </button>\r\n                    {/* Bouton Bulletins supprim√© du dashboard enseignant */}\r\n                  </div>\r\n\r\n                  {gradesSubTab === 'entry' && (\r\n                    <GradeEntryPanel \r\n                      classData={selectedClass}\r\n                      students={studentsData?.[selectedClass?.id] || []}\r\n                      onGradeAdded={() => {\r\n                        const loadTeacherData = async () => {\r\n                          setLoading(true);\r\n                          try {\r\n                            window.location.reload();\r\n                          } catch (error) {\r\n                            console.error('Erreur rechargement:', error);\r\n                          }\r\n                        };\r\n                        loadTeacherData();\r\n                      }}\r\n                    />\r\n                  )}\r\n\r\n                  {gradesSubTab === 'summary' && (\r\n                    <GradesSummaryPanel\r\n                      classData={selectedClass}\r\n                      students={studentsData?.[selectedClass?.id] || []}\r\n                    />\r\n                  )}\r\n\r\n                  {gradesSubTab === 'conduct' && (\r\n                    <ConductPanel\r\n                      classData={selectedClass}\r\n                      students={studentsData?.[selectedClass?.id] || []}\r\n                    />\r\n                  )}\r\n\r\n                  {/* Panneau Bulletins supprim√© du dashboard enseignant */}\r\n\r\n                  {/* Modal Bulletin supprim√© du dashboard enseignant */}\r\n                </div>\r\n              ) : (\r\n                <div className=\"bg-card rounded-lg border border-border p-8 text-center\">\r\n                  <Icon name=\"BookOpen\" size={48} className=\"mx-auto text-muted-foreground mb-4\" />\r\n                  <p className=\"text-text-secondary\">S√©lectionnez une classe pour g√©rer les notes</p>\r\n                </div>\r\n              )\r\n            ) : (\r\n              <div className=\"bg-card rounded-lg border border-border p-8 text-center\">\r\n                <Icon name=\"BookOpen\" size={48} className=\"mx-auto text-muted-foreground mb-4\" />\r\n                <p className=\"text-text-secondary\">Aucune classe assign√©e pour le moment</p>\r\n                <p className=\"text-sm text-muted-foreground mt-2\">Contactez votre directeur pour obtenir vos affectations</p>\r\n              </div>\r\n            )}\r\n          </div>\r\n        );\r\n\r\n      case 'attendance':\r\n        return (\r\n          <div className=\"space-y-6\">\r\n            <h2 className=\"font-heading font-heading-bold text-2xl text-card-foreground\">Gestion des Pr√©sences</h2>\r\n            {teacherData?.assignedClasses && teacherData?.assignedClasses?.length > 0 ? (\r\n              selectedClass ? (\r\n                <AttendanceManager\r\n                  classData={selectedClass}\r\n                  students={studentsData?.[selectedClass?.id] || []}\r\n                />\r\n              ) : (\r\n                <div className=\"bg-card rounded-lg border border-border p-8 text-center\">\r\n                  <Icon name=\"Calendar\" size={48} className=\"mx-auto text-muted-foreground mb-4\" />\r\n                  <p className=\"text-text-secondary\">S√©lectionnez une classe pour g√©rer les pr√©sences</p>\r\n                </div>\r\n              )\r\n            ) : (\r\n              <div className=\"bg-card rounded-lg border border-border p-8 text-center\">\r\n                <Icon name=\"Calendar\" size={48} className=\"mx-auto text-muted-foreground mb-4\" />\r\n                <p className=\"text-text-secondary\">Aucune classe assign√©e pour le moment</p>\r\n                <p className=\"text-sm text-muted-foreground mt-2\">Contactez votre directeur pour obtenir vos affectations</p>\r\n              </div>\r\n            )}\r\n          </div>\r\n        );\r\n\r\n      case 'documents':\r\n        // R√©cup√©rer les documents pour la classe s√©lectionn√©e (par ID ou par nom)\r\n        const classDocuments = selectedClass \r\n          ? (documentsData?.[selectedClass?.id] || documentsData?.[selectedClass?.name] || [])\r\n          : [];\r\n        console.log('üìÑ Documents pour la classe:', selectedClass?.name, '‚Üí', classDocuments?.length, 'documents');\r\n        console.log('üìÑ documentsData keys:', Object.keys(documentsData || {}));\r\n        \r\n        return (\r\n          <div className=\"space-y-6\">\r\n            <h2 className=\"font-heading font-heading-bold text-2xl text-card-foreground\">Mes Documents</h2>\r\n            {teacherData?.assignedClasses && teacherData?.assignedClasses?.length > 0 ? (\r\n              selectedClass ? (\r\n                <DocumentManager \r\n                  classData={selectedClass}\r\n                  documents={classDocuments}\r\n                />\r\n              ) : (\r\n                <div className=\"bg-card rounded-lg border border-border p-8 text-center\">\r\n                  <Icon name=\"Files\" size={48} className=\"mx-auto text-muted-foreground mb-4\" />\r\n                  <p className=\"text-text-secondary\">S√©lectionnez une classe pour g√©rer les documents</p>\r\n                </div>\r\n              )\r\n            ) : (\r\n              <div className=\"bg-card rounded-lg border border-border p-8 text-center\">\r\n                <Icon name=\"Files\" size={48} className=\"mx-auto text-muted-foreground mb-4\" />\r\n                <p className=\"text-text-secondary\">Aucune classe assign√©e pour le moment</p>\r\n                <p className=\"text-sm text-muted-foreground mt-2\">Contactez votre directeur pour obtenir vos affectations</p>\r\n              </div>\r\n            )}\r\n          </div>\r\n        );\r\n\r\n      case 'account':\r\n        return (\r\n          <div className=\"space-y-6\">\r\n            {/* Header modernis√© */}\r\n            <div className=\"bg-gradient-to-br from-indigo-600 to-purple-600 rounded-2xl shadow-xl p-6 text-white\">\r\n              <div className=\"flex items-center space-x-3\">\r\n                <div className=\"w-12 h-12 bg-white/20 backdrop-blur-sm rounded-xl flex items-center justify-center text-3xl\">\r\n                  üë§\r\n                </div>\r\n                <div>\r\n                  <h2 className=\"font-display font-bold text-2xl\">\r\n                    Mon Profil Enseignant\r\n                  </h2>\r\n                  <p className=\"text-indigo-100 text-sm mt-1\">\r\n                    Informations personnelles et professionnelles\r\n                  </p>\r\n                </div>\r\n              </div>\r\n            </div>\r\n            \r\n            {/* Carte principale du profil - Modernis√©e */}\r\n            <div className=\"bg-white rounded-2xl border-2 border-gray-200 shadow-lg p-8\">\r\n              <div className=\"flex items-start space-x-6 mb-8\">\r\n                <div className=\"w-28 h-28 rounded-2xl bg-gradient-to-br from-indigo-500 to-purple-600 flex items-center justify-center flex-shrink-0 shadow-lg\">\r\n                  <Icon name=\"User\" size={56} className=\"text-white\" />\r\n                </div>\r\n                <div className=\"flex-1\">\r\n                  <h3 className=\"font-display font-bold text-3xl text-gray-900 mb-3\">\r\n                    {teacherData?.name || 'Nom non disponible'}\r\n                  </h3>\r\n                  <div className=\"space-y-2\">\r\n                    <div className=\"flex items-center gap-3 p-2 bg-gray-50 rounded-xl\">\r\n                      <div className=\"p-1.5 rounded-lg bg-blue-100\">\r\n                        <Icon name=\"Mail\" size={18} className=\"text-blue-600\" />\r\n                      </div>\r\n                      <span className=\"font-body-medium text-gray-700\">{teacherData?.email || 'Email non renseign√©'}</span>\r\n                    </div>\r\n                    {teacherData?.phone && (\r\n                      <div className=\"flex items-center gap-3 p-2 bg-gray-50 rounded-xl\">\r\n                        <div className=\"p-1.5 rounded-lg bg-green-100\">\r\n                          <Icon name=\"Phone\" size={18} className=\"text-green-600\" />\r\n                        </div>\r\n                        <span className=\"font-body-medium text-gray-700\">{teacherData.phone}</span>\r\n                      </div>\r\n                    )}\r\n                    <div className=\"flex items-center gap-3 p-2 bg-gray-50 rounded-xl\">\r\n                      <div className=\"p-1.5 rounded-lg bg-purple-100\">\r\n                        <Icon name=\"Hash\" size={18} className=\"text-purple-600\" />\r\n                      </div>\r\n                      <span className=\"font-body-medium text-gray-700\">Matricule: {teacherData?.employeeId || 'Non attribu√©'}</span>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n                <div className=\"flex items-center gap-2 px-5 py-3 bg-gradient-to-r from-green-500 to-emerald-600 text-white rounded-xl shadow-md\">\r\n                  <Icon name=\"CheckCircle\" size={22} />\r\n                  <span className=\"font-body-bold\">Actif</span>\r\n                </div>\r\n              </div>\r\n\r\n              <div className=\"border-t-2 border-gray-100 pt-8\">\r\n                <h4 className=\"font-body-bold text-xl text-gray-900 mb-6 flex items-center gap-2\">\r\n                  <Icon name=\"Briefcase\" size={24} className=\"text-indigo-600\" />\r\n                  Informations professionnelles\r\n                </h4>\r\n                <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-3 sm:gap-4 mb-4 sm:mb-6\">\r\n                  {/* Sp√©cialit√© - Modernis√©e */}\r\n                  {teacherData?.specialty && (\r\n                    <div className=\"bg-gradient-to-br from-blue-50 to-indigo-50 rounded-2xl p-5 border-2 border-blue-200 shadow-md hover:shadow-lg transition-all\">\r\n                      <div className=\"flex items-center gap-3 mb-3\">\r\n                        <div className=\"p-2 rounded-xl bg-gradient-to-br from-blue-500 to-indigo-600 shadow-md\">\r\n                          <Icon name=\"BookOpen\" size={20} className=\"text-white\" />\r\n                        </div>\r\n                        <div className=\"text-sm font-body-bold text-gray-600\">\r\n                          Sp√©cialit√©\r\n                        </div>\r\n                      </div>\r\n                      <div className=\"font-body-bold text-lg text-gray-900\">\r\n                        {teacherData.specialty}\r\n                      </div>\r\n                    </div>\r\n                  )}\r\n\r\n                  {/* √âtablissement - Modernis√© */}\r\n                  <div className=\"bg-gradient-to-br from-purple-50 to-pink-50 rounded-2xl p-5 border-2 border-purple-200 shadow-md hover:shadow-lg transition-all\">\r\n                    <div className=\"flex items-center gap-3 mb-3\">\r\n                      <div className=\"p-2 rounded-xl bg-gradient-to-br from-purple-500 to-pink-600 shadow-md\">\r\n                        <Icon name=\"School\" size={20} className=\"text-white\" />\r\n                      </div>\r\n                      <div className=\"text-sm font-body-bold text-gray-600\">\r\n                        √âtablissement\r\n                      </div>\r\n                    </div>\r\n                    <div className=\"font-body-bold text-lg text-gray-900\">\r\n                      {teacherData?.school || teacherData?.assignedClasses?.[0]?.school || 'Non renseign√©'}\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n\r\n                {/* Statistiques - Modernis√©es */}\r\n                <div className=\"grid grid-cols-1 sm:grid-cols-3 gap-3 sm:gap-4\">\r\n                  {/* Classes assign√©es */}\r\n                  <div className=\"bg-gradient-to-br from-green-50 to-emerald-50 rounded-2xl p-5 border-2 border-green-200 shadow-md hover:shadow-xl transition-all hover:scale-105\">\r\n                    <div className=\"flex items-center gap-3 mb-3\">\r\n                      <div className=\"p-2.5 rounded-xl bg-gradient-to-br from-green-500 to-emerald-600 shadow-md\">\r\n                        <Icon name=\"GraduationCap\" size={22} className=\"text-white\" />\r\n                      </div>\r\n                      <div className=\"text-sm font-body-bold text-gray-600\">\r\n                        Classes assign√©es\r\n                      </div>\r\n                    </div>\r\n                    <div className=\"text-4xl font-display font-bold bg-gradient-to-r from-green-600 to-emerald-600 bg-clip-text text-transparent\">\r\n                      {teacherData?.assignedClasses?.length || 0}\r\n                    </div>\r\n                  </div>\r\n\r\n                  {/* Total √©l√®ves */}\r\n                  <div className=\"bg-gradient-to-br from-orange-50 to-amber-50 rounded-2xl p-5 border-2 border-orange-200 shadow-md hover:shadow-xl transition-all hover:scale-105\">\r\n                    <div className=\"flex items-center gap-3 mb-3\">\r\n                      <div className=\"p-2.5 rounded-xl bg-gradient-to-br from-orange-500 to-amber-600 shadow-md\">\r\n                        <Icon name=\"Users\" size={22} className=\"text-white\" />\r\n                      </div>\r\n                      <div className=\"text-sm font-body-bold text-gray-600\">\r\n                        Total √©l√®ves\r\n                      </div>\r\n                    </div>\r\n                    <div className=\"text-4xl font-display font-bold bg-gradient-to-r from-orange-600 to-amber-600 bg-clip-text text-transparent\">\r\n                      {getTotalStudents() || 0}\r\n                    </div>\r\n                  </div>\r\n\r\n                  {/* Heures par semaine */}\r\n                  <div className=\"bg-gradient-to-br from-blue-50 to-indigo-50 rounded-2xl p-5 border-2 border-blue-200 shadow-md hover:shadow-xl transition-all hover:scale-105\">\r\n                    <div className=\"flex items-center gap-3 mb-3\">\r\n                      <div className=\"p-2.5 rounded-xl bg-gradient-to-br from-blue-500 to-indigo-600 shadow-md\">\r\n                        <Icon name=\"Clock\" size={22} className=\"text-white\" />\r\n                      </div>\r\n                      <div className=\"text-sm font-body-bold text-gray-600\">\r\n                        Heures / semaine\r\n                      </div>\r\n                    </div>\r\n                    <div className=\"text-4xl font-display font-bold bg-gradient-to-r from-blue-600 to-indigo-600 bg-clip-text text-transparent\">\r\n                      {teacherData?.assignedClasses?.reduce((total, cls) => {\r\n                        return total + (cls.schedule?.weekly_hours || 0);\r\n                      }, 0) || 0}<span className=\"text-2xl\">h</span>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n\r\n              {/* Liste des classes assign√©es - Modernis√©e */}\r\n              {teacherData?.assignedClasses && teacherData.assignedClasses.length > 0 && (\r\n                <div className=\"border-t-2 border-gray-100 pt-8 mt-8\">\r\n                  <h4 className=\"font-body-bold text-xl text-gray-900 mb-6 flex items-center gap-2\">\r\n                    <Icon name=\"BookOpen\" size={24} className=\"text-green-600\" />\r\n                    Mes classes et mati√®res\r\n                  </h4>\r\n                  <div className=\"grid grid-cols-1 gap-3\">\r\n                    {teacherData.assignedClasses.map((cls, index) => (\r\n                      <div \r\n                        key={cls.id} \r\n                        className=\"group bg-gradient-to-br from-gray-50 to-white rounded-2xl p-5 border-2 border-gray-200 shadow-md hover:shadow-xl hover:scale-102 transition-all duration-300\"\r\n                      >\r\n                        <div className=\"flex items-center justify-between\">\r\n                          <div className=\"flex items-center gap-4\">\r\n                            <div className=\"w-12 h-12 rounded-xl bg-gradient-to-br from-green-500 to-emerald-600 flex items-center justify-center shadow-md group-hover:scale-110 transition-transform\">\r\n                              <span className=\"font-display font-bold text-white text-lg\">\r\n                                {index + 1}\r\n                              </span>\r\n                            </div>\r\n                            <div>\r\n                              <div className=\"font-display font-bold text-lg text-gray-900\">\r\n                                {cls.name}\r\n                              </div>\r\n                              <div className=\"flex items-center gap-2 text-sm text-gray-600 mt-1\">\r\n                                <span className=\"px-3 py-1 bg-indigo-100 text-indigo-700 rounded-lg font-body-bold\">\r\n                                  {cls.subject}\r\n                                </span>\r\n                                {cls.level && cls.level !== 'Non d√©fini' && (\r\n                                  <span className=\"px-3 py-1 bg-purple-100 text-purple-700 rounded-lg font-body-bold\">\r\n                                    {cls.level}\r\n                                  </span>\r\n                                )}\r\n                              </div>\r\n                            </div>\r\n                          </div>\r\n                          <div className=\"flex items-center gap-6\">\r\n                            <div className=\"flex items-center gap-2 px-4 py-2 bg-orange-50 rounded-xl border border-orange-200\">\r\n                              <Icon name=\"Users\" size={18} className=\"text-orange-600\" />\r\n                              <span className=\"font-body-bold text-orange-700\">\r\n                                {cls.students} √©l√®ve{cls.students > 1 ? 's' : ''}\r\n                              </span>\r\n                            </div>\r\n                            {cls.schedule?.weekly_hours > 0 && (\r\n                              <div className=\"flex items-center gap-2 px-4 py-2 bg-blue-50 rounded-xl border border-blue-200\">\r\n                                <Icon name=\"Clock\" size={18} className=\"text-blue-600\" />\r\n                                <span className=\"font-body-bold text-blue-700\">\r\n                                  {cls.schedule.weekly_hours}h/sem\r\n                                </span>\r\n                              </div>\r\n                            )}\r\n                          </div>\r\n                        </div>\r\n                      </div>\r\n                    ))}\r\n                  </div>\r\n                </div>\r\n              )}\r\n            </div>\r\n          </div>\r\n        );\r\n\r\n      default: // 'dashboard'\r\n        return (\r\n          <>\r\n            {/* Bandeau de bienvenue modernis√© */}\r\n            <div className=\"bg-gradient-to-br from-green-600 to-emerald-600 rounded-2xl shadow-xl p-6 text-white mb-6\">\r\n              <div className=\"flex items-center justify-between\">\r\n                <div className=\"flex items-center space-x-3\">\r\n                  <div className=\"w-14 h-14 bg-white/20 backdrop-blur-sm rounded-xl flex items-center justify-center text-3xl\">\r\n                    üéì\r\n                  </div>\r\n                  <div>\r\n                    <p className=\"text-green-100 text-sm\">{getGreeting()},</p>\r\n                    <h2 className=\"font-display font-bold text-2xl\">\r\n                      {teacherData?.name || 'Enseignant'}\r\n                    </h2>\r\n                    <p className=\"text-green-100 text-sm mt-1\">\r\n                      {teacherData?.specialty || 'Mati√®re'} ‚Ä¢ {teacherData?.assignedClasses?.length || 0} classe{teacherData?.assignedClasses?.length > 1 ? 's' : ''}\r\n                    </p>\r\n                  </div>\r\n                </div>\r\n                <div className=\"text-right hidden sm:block\">\r\n                  <p className=\"text-green-100 text-sm\">{currentTime.toLocaleDateString('fr-FR', { weekday: 'long', day: 'numeric', month: 'long', year: 'numeric' })}</p>\r\n                  <p className=\"font-display font-bold text-2xl\">{currentTime.toLocaleTimeString('fr-FR', { hour: '2-digit', minute: '2-digit' })}</p>\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n            {/* Message si aucune classe assign√©e - Modernis√© */}\r\n            {(!teacherData?.assignedClasses || teacherData?.assignedClasses?.length === 0) && (\r\n              <div className=\"bg-white border-2 border-blue-200 rounded-2xl shadow-lg p-12 text-center\">\r\n                <div className=\"inline-flex p-4 rounded-full bg-gradient-to-br from-blue-100 to-indigo-200 mb-4\">\r\n                  <Icon name=\"GraduationCap\" size={48} className=\"text-blue-600\" />\r\n                </div>\r\n                <h3 className=\"text-2xl font-display font-bold text-gray-900 mb-2\">\r\n                  Aucune classe assign√©e\r\n                </h3>\r\n                <p className=\"text-gray-600 font-body-medium mb-6 max-w-md mx-auto\">\r\n                  Vous n'avez pas encore de classes assign√©es. Contactez votre directeur d'√©tablissement pour obtenir vos affectations de cours.\r\n                </p>\r\n                <div className=\"bg-gradient-to-r from-blue-50 to-indigo-50 border-2 border-blue-200 rounded-2xl p-6 inline-block\">\r\n                  <p className=\"text-sm text-gray-800 font-body-bold mb-3\">\r\n                    üí° Conseil : Une fois vos classes assign√©es, vous pourrez :\r\n                  </p>\r\n                  <ul className=\"text-sm text-gray-700 text-left space-y-2\">\r\n                    <li className=\"flex items-center gap-2\">\r\n                      <span className=\"w-2 h-2 bg-blue-500 rounded-full\"></span>\r\n                      G√©rer les notes de vos √©l√®ves\r\n                    </li>\r\n                    <li className=\"flex items-center gap-2\">\r\n                      <span className=\"w-2 h-2 bg-blue-500 rounded-full\"></span>\r\n                      Suivre les pr√©sences\r\n                    </li>\r\n                    <li className=\"flex items-center gap-2\">\r\n                      <span className=\"w-2 h-2 bg-blue-500 rounded-full\"></span>\r\n                      Partager des documents p√©dagogiques\r\n                    </li>\r\n                    <li className=\"flex items-center gap-2\">\r\n                      <span className=\"w-2 h-2 bg-blue-500 rounded-full\"></span>\r\n                      Communiquer avec les √©l√®ves et parents\r\n                    </li>\r\n                  </ul>\r\n                </div>\r\n              </div>\r\n            )}\r\n\r\n            {/* Mode Selector - Modernis√© */}\r\n            {teacherData?.assignedClasses && teacherData?.assignedClasses?.length > 0 && (\r\n              <div className=\"bg-white rounded-2xl border-2 border-gray-200 shadow-lg p-6\">\r\n                <div className=\"flex items-center justify-between flex-wrap gap-4\">\r\n                  <div>\r\n                    <h3 className=\"font-body-bold text-lg text-gray-900 mb-1 flex items-center gap-2\">\r\n                      <Icon name=\"Layout\" size={20} className=\"text-green-600\" />\r\n                      Mode d'affichage\r\n                    </h3>\r\n                    <p className=\"text-sm text-gray-600 font-body-medium\">\r\n                      Choisissez entre vue √©tablissement unique ou multi-√©tablissements\r\n                    </p>\r\n                  </div>\r\n                  <div className=\"flex items-center space-x-3\">\r\n                    <button\r\n                      onClick={() => setViewMode('single')}\r\n                      className={`px-6 py-3 rounded-xl text-sm font-bold transition-all shadow-md hover:shadow-lg ${\r\n                        viewMode === 'single'\r\n                          ? 'bg-gradient-to-r from-green-600 to-emerald-600 text-white'\r\n                          : 'bg-white text-gray-600 hover:bg-gray-50 border-2 border-gray-200'\r\n                      }`}\r\n                    >\r\n                      <Icon name=\"School\" size={18} className=\"mr-2 inline\" />\r\n                      Vue Simple\r\n                    </button>\r\n                    <button\r\n                      onClick={() => setViewMode('multi-school')}\r\n                      className={`px-6 py-3 rounded-xl text-sm font-bold transition-all shadow-md hover:shadow-lg ${\r\n                        viewMode === 'multi-school'\r\n                          ? 'bg-gradient-to-r from-purple-600 to-pink-600 text-white'\r\n                          : 'bg-white text-gray-600 hover:bg-gray-50 border-2 border-gray-200'\r\n                      }`}\r\n                    >\r\n                      <Icon name=\"Building\" size={18} className=\"mr-2 inline\" />\r\n                      Multi-√âtablissements\r\n                    </button>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            )}\r\n\r\n            {/* Vue Multi-√âtablissements - Affich√© uniquement si classes assign√©es */}\r\n            {viewMode === 'multi-school' && teacherData?.assignedClasses && teacherData?.assignedClasses?.length > 0 && (\r\n              <TeacherMultiSchoolOverview teacherId={teacherData?.id} />\r\n            )}\r\n\r\n            {/* Vue Simple - Contenu existant */}\r\n            {viewMode === 'single' && teacherData?.assignedClasses && teacherData?.assignedClasses?.length > 0 && (\r\n              <>\r\n                {/* Class Selector */}\r\n                <ClassSelector\r\n                  classes={teacherData?.assignedClasses}\r\n                  selectedClass={selectedClass}\r\n                  onClassSelect={handleClassSelect}\r\n                />\r\n\r\n                {/* Assigned Classes Overview */}\r\n                <AssignedClassesOverview \r\n                  classes={teacherData?.assignedClasses}\r\n                  selectedClass={selectedClass}\r\n                />\r\n\r\n                {/* Main Dashboard Content */}\r\n                {selectedClass && (\r\n                  <div className=\"grid grid-cols-1 xl:grid-cols-3 gap-6\">\r\n                    {/* Left Column - Grade Entry and Attendance */}\r\n                    <div className=\"xl:col-span-2 space-y-6\">\r\n                      <GradeEntryPanel \r\n                        classData={selectedClass}\r\n                        students={studentsData?.[selectedClass?.id] || []}\r\n                        onGradeAdded={() => {\r\n                          // Recharger les donn√©es apr√®s ajout d'une note\r\n                          window.location.reload();\r\n                        }}\r\n                      />\r\n                      <AttendanceManager\r\n                        classData={selectedClass}\r\n                        students={studentsData?.[selectedClass?.id] || []}\r\n                      />\r\n                    </div>\r\n\r\n                    {/* Right Column - Documents and Communication */}\r\n                    <div className=\"space-y-6\">\r\n                      <DocumentManager \r\n                        classData={selectedClass}\r\n                        documents={\r\n                          documentsData?.[selectedClass?.id] ||\r\n                          documentsData?.[selectedClass?.name] ||\r\n                          []\r\n                        }\r\n                      />\r\n                      <StudentCommunication \r\n                        classData={selectedClass}\r\n                        students={studentsData?.[selectedClass?.id] || []}\r\n                      />\r\n                    </div>\r\n                  </div>\r\n                )}\r\n\r\n                {/* Teacher Schedule */}\r\n                <TeacherSchedule \r\n                  schedule={getCurrentWeekSchedule()}\r\n                  teacherName={teacherData?.name}\r\n                />\r\n              </>\r\n            )}\r\n          </>\r\n        );\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-background\">\r\n      <Header \r\n        userRole=\"teacher\" \r\n        userName={teacherData?.name || 'Enseignant'}\r\n        onToggleSidebar={() => setSidebarCollapsed(!sidebarCollapsed)}\r\n      />\r\n      <Sidebar \r\n        userRole=\"teacher\"\r\n        isCollapsed={sidebarCollapsed}\r\n        onToggle={() => setSidebarCollapsed(!sidebarCollapsed)}\r\n      />\r\n      <main className={`pt-20 sm:pt-16 transition-all duration-300 ${\r\n        sidebarCollapsed ? 'lg:ml-16' : 'lg:ml-64'\r\n      }`}>\r\n        <div className=\"px-2 sm:px-4 lg:px-6 py-3 sm:py-4 space-y-3 sm:space-y-4 w-full overflow-x-hidden\">\r\n          \r\n          {/* Indicateur de chargement */}\r\n          {loading && (\r\n            <div className=\"bg-blue-50 rounded-lg p-4 text-center\">\r\n              <div className=\"animate-spin rounded-full h-8 w-8 border-2 border-blue-200 border-t-blue-600 mx-auto mb-2\"></div>\r\n              <p className=\"text-blue-900 text-sm font-semibold\">Chargement...</p>\r\n            </div>\r\n          )}\r\n\r\n          {/* Welcome Section */}\r\n          {!loading && teacherData && (\r\n            <div className=\"bg-gradient-to-r from-green-500 to-emerald-500 rounded-lg p-3 sm:p-4 text-white\">\r\n              <div className=\"flex items-center justify-between gap-2\">\r\n                <div className=\"flex items-center gap-2 min-w-0 flex-1\">\r\n                  <div className=\"w-8 h-8 sm:w-10 sm:h-10 bg-white/20 rounded-lg flex items-center justify-center text-lg sm:text-xl flex-shrink-0\">\r\n                    üë©‚Äçüè´\r\n                  </div>\r\n                  <div className=\"min-w-0\">\r\n                    <h1 className=\"text-sm sm:text-base font-bold truncate\">\r\n                      {getGreeting()}, {teacherData?.name?.split(' ')[0] || teacherData?.name}\r\n                    </h1>\r\n                    <p className=\"text-xs text-green-100\">\r\n                      {currentTime?.toLocaleTimeString('fr-FR', { hour: '2-digit', minute: '2-digit' })}\r\n                    </p>\r\n                  </div>\r\n                </div>\r\n                {teacherData?.assignedClasses?.length > 0 && (\r\n                  <div className=\"flex gap-2 flex-shrink-0\">\r\n                    <div className=\"bg-white/20 rounded px-2 py-1 text-center\">\r\n                      <div className=\"text-sm sm:text-base font-bold\">{teacherData?.assignedClasses?.length}</div>\r\n                      <div className=\"text-xs\">Classes</div>\r\n                    </div>\r\n                    <div className=\"bg-white/20 rounded px-2 py-1 text-center\">\r\n                      <div className=\"text-sm sm:text-base font-bold\">{getTotalStudents()}</div>\r\n                      <div className=\"text-xs\">√âl√®ves</div>\r\n                    </div>\r\n                  </div>\r\n                )}\r\n              </div>\r\n            </div>\r\n          )}\r\n\r\n          {/* Tab Content */}\r\n          {!loading && teacherData && renderTabContent()}\r\n          \r\n          {/* Message si pas de donn√©es - Modernis√© */}\r\n          {!loading && !teacherData && (\r\n            <div className=\"bg-gradient-to-br from-yellow-50 to-amber-50 border-2 border-yellow-300 rounded-2xl p-8 text-center shadow-lg\">\r\n              <div className=\"w-20 h-20 mx-auto mb-6 rounded-2xl bg-gradient-to-br from-yellow-500 to-amber-600 flex items-center justify-center shadow-md\">\r\n                <Icon name=\"AlertTriangle\" size={40} className=\"text-white\" />\r\n              </div>\r\n              <h3 className=\"text-2xl font-display font-bold text-yellow-900 mb-3\">Aucune donn√©e disponible</h3>\r\n              <p className=\"text-yellow-700 font-body-medium text-lg\">\r\n                Veuillez contacter votre directeur pour configurer votre compte enseignant.\r\n              </p>\r\n            </div>\r\n          )}\r\n        </div>\r\n      </main>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default TeacherDashboard;"],"names":["ClassSelector","classes","selectedClass","onClassSelect","jsxs","jsx","Icon","classData","isSelected","Fragment","_b","_a","slot","index","_c","_d","_e","_f","_g","AssignedClassesOverview","getTotalStudents","total","cls","getWeeklyHours","getTodaySchedule","today","todayFr","nextClass","now","currentDay","currentTime","startHour","startMin","todaySchedule","GradeEntryPanel","students","onGradeAdded","selectedStudent","setSelectedStudent","useState","schoolType","setSchoolType","currentSequence","setCurrentSequence","gradeForm","setGradeForm","showBulkEntry","setShowBulkEntry","isSubmitting","setIsSubmitting","useEffect","data","error","supabase","sequence","trimester","prev","getEvaluationTypes","sequences","trimesters","coefficients","getGradeColor","grade","getGradeBg","handleGradeSubmit","e","gradeValue","maxGrade","selectedStudentData","s","handleBulkSubmit","getStudentAverage","student","totalPoints","totalCoefficients","coef","normalizedGrade","evaluationTypes","seq","type","tri","average","_h","GradesSummaryPanel","lang","detectLanguageSystem","level","detectSchoolLevel","scale","studentsWithAvg","recent","avg","computeSubjectAverage","g","mentionInfo","getMention","honorMention","getMentionHonorifique","allAverages","studentsWithRank","rankInfo","computeRank","a","b","classAvg","highest","lowest","passCount","failCount","getMentionColor","mention","m","getHonorBadge","colors","ConductPanel","onConductSaved","conductData","setConductData","selectedSequence","setSelectedSequence","saving","setSaving","loading","setLoading","conductCategories","appreciations","conductMap","record","err","handleConductChange","studentId","field","value","calculateConductAverage","cat","getConductMention","saveConductData","rows","app","DocumentManager","documents","showUploadForm","setShowUploadForm","uploadForm","setUploadForm","dragOver","setDragOver","documentTypes","visibilityOptions","getTypeConfig","found","t","getFileIcon","fileName","getFileSize","doc","formatFileSize","sizeInBytes","size","getDate","formatDate","dateString","d","handleDragOver","handleDragLeave","handleDrop","files","setSelectedFile","selectedFile","uploading","setUploading","uploadError","setUploadError","fileInputRef","useRef","handleFileChange","f","handleUploadSubmit","documentData","documentService","msg","handleDeleteDocument","docId","handleDownloadDocument","link","handleViewDocument","option","typeConfig","AttendanceManager","selectedDate","setSelectedDate","attendanceData","setAttendanceData","showQuickEntry","setShowQuickEntry","attendanceStatus","handleAttendanceChange","status","getStudentAttendance","getStatusConfig","saveAttendance","dateAttendance","rec","newMap","markAllPresent","stats","dateData","getAttendanceRate","currentStatus","StudentCommunication","selectedRecipients","setSelectedRecipients","messageForm","setMessageForm","showComposeForm","setShowComposeForm","messageTypes","priorityLevels","handleRecipientToggle","id","selectAll","handleSendMessage","sendQuickNotification","templates","template","priority","TeacherSchedule","schedule","teacherName","getTypeIcon","getTypeColor","getTypeText","formatTime","timeString","date","tomorrow","isToday","getCurrentTime","getTimeInMinutes","startTime","hours","minutes","isCurrentClass","scheduleItem","endTime","startMinutes","endMinutes","item","currentClass","groupedSchedule","groups","daySchedule","TeacherMultiSchoolOverview","teacherId","teacherData","setTeacherData","selectedSchool","setSelectedSchool","assignments","assignmentsError","schoolsMap","totalWeeklyHours","totalStudents","assignment","schoolId","weeklyHours","schoolData","studentsCount","schoolAssignments","school","formattedData","selectedAssignment","subject","classInfo","TeacherDashboard","searchParams","useSearchParams","currentTab","sidebarCollapsed","setSidebarCollapsed","setSelectedClass","selectedSubject","setSelectedSubject","gradesSubTab","setGradesSubTab","showReportCard","setShowReportCard","setCurrentTime","viewMode","setViewMode","user","useAuth","studentsData","setStudentsData","documentsData","setDocumentsData","upcomingSchedule","setUpcomingSchedule","c","getCurrentDateForDay","dayName","targetDay","daysUntilTarget","targetDate","teacherInfo","teacherError","academicYear","academicYearError","studentsDataByClass","classId","className","studentsError","studentIds","grades","gradesError","attendances","attendancesError","gradesByStudent","attendancesByStudent","att","studentGrades","studentAttendance","formattedTeacherData","classAverage","studentsWithGrades","sum","studentAvg","attendanceRate","totalPresent","totalAbsent","totalLate","scheduleData","documentsDataByClass","dbUserData","dbUserId","teacherDocs","docsError","classKey","docErr","timer","handleClassSelect","getGreeting","hour","getCurrentWeekSchedule","startOfWeek","diffTime","diffDays","renderTabContent","classDocuments","_i","_j","_k","_l","_m","_n","_o","Header","Sidebar"],"mappings":"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"}